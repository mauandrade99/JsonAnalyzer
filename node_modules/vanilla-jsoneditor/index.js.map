{"version":3,"file":"index.js","sources":["../node_modules/svelte/src/version.js","../node_modules/svelte/src/internal/disclose-version.js","../node_modules/svelte/src/internal/flags/index.js","../node_modules/svelte/src/constants.js","../node_modules/svelte/src/internal/shared/utils.js","../node_modules/svelte/src/internal/client/constants.js","../node_modules/svelte/src/internal/client/reactivity/equality.js","../node_modules/svelte/src/internal/shared/errors.js","../node_modules/svelte/src/internal/client/context.js","../node_modules/svelte/src/internal/client/proxy.js","../node_modules/svelte/src/internal/client/errors.js","../node_modules/svelte/src/internal/client/reactivity/deriveds.js","../node_modules/svelte/src/internal/client/reactivity/sources.js","../node_modules/svelte/src/internal/client/runtime.js","../node_modules/svelte/src/internal/client/dom/hydration.js","../node_modules/svelte/src/internal/client/dom/operations.js","../node_modules/svelte/src/internal/client/reactivity/effects.js","../node_modules/svelte/src/internal/client/dom/task.js","../node_modules/svelte/src/internal/client/error-handling.js","../node_modules/svelte/src/internal/client/dom/elements/misc.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/shared.js","../node_modules/svelte/src/internal/client/dom/elements/events.js","../node_modules/svelte/src/internal/client/dom/reconciler.js","../node_modules/svelte/src/internal/client/dom/template.js","../node_modules/svelte/src/utils.js","../node_modules/svelte/src/internal/client/render.js","../node_modules/svelte/src/index-client.js","../node_modules/svelte/src/internal/client/dom/blocks/if.js","../node_modules/svelte/src/internal/client/dom/blocks/key.js","../node_modules/svelte/src/internal/client/dom/blocks/each.js","../node_modules/svelte/src/internal/client/dom/blocks/html.js","../node_modules/svelte/src/internal/client/dom/blocks/slot.js","../node_modules/svelte/src/internal/client/dom/blocks/svelte-component.js","../node_modules/svelte/src/internal/client/dom/elements/actions.js","../node_modules/svelte/src/internal/client/dom/elements/attachments.js","../node_modules/clsx/dist/clsx.mjs","../node_modules/svelte/src/internal/shared/attributes.js","../node_modules/svelte/src/internal/client/dom/elements/class.js","../node_modules/svelte/src/internal/client/dom/elements/style.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/select.js","../node_modules/svelte/src/internal/client/warnings.js","../node_modules/svelte/src/internal/client/dom/elements/attributes.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/input.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/props.js","../node_modules/svelte/src/internal/client/dom/elements/bindings/this.js","../node_modules/svelte/src/internal/client/dom/legacy/event-modifiers.js","../node_modules/svelte/src/internal/client/dom/legacy/lifecycle.js","../node_modules/svelte/src/internal/client/dom/legacy/misc.js","../node_modules/svelte/src/internal/client/reactivity/store.js","../node_modules/svelte/src/internal/client/reactivity/props.js","../src/lib/utils/debug.ts","../src/lib/utils/uniqueId.ts","../src/lib/utils/numberUtils.ts","../src/lib/utils/typeUtils.ts","../src/lib/utils/arrayUtils.ts","../src/lib/utils/jsonUtils.ts","../src/lib/types.ts","../src/lib/utils/domUtils.ts","../src/lib/utils/navigatorUtils.ts","../src/lib/utils/keyBindings.ts","../node_modules/style-inject/dist/style-inject.es.js","../src/lib/components/modals/popup/AbsolutePopupEntry.svelte","../src/lib/components/modals/popup/AbsolutePopup.svelte","../src/lib/utils/stringUtils.ts","../src/lib/plugins/query/jsonQueryLanguage.ts","../node_modules/svelte-awesome/package/components/svg/Raw.svelte","../node_modules/svelte-awesome/package/components/Icon.svelte","../node_modules/svelte-awesome/package/components/svg/Svg.svelte","../src/lib/plugins/value/components/BooleanToggle.svelte","../src/lib/components/controls/ColorPickerPopup.svelte","../src/lib/plugins/value/components/ColorPicker.svelte","../src/lib/constants.ts","../src/lib/logic/expandItemsSections.ts","../src/lib/typeguards.ts","../src/lib/logic/documentState.ts","../src/lib/logic/selection.ts","../src/lib/utils/cssUtils.ts","../src/lib/plugins/value/components/utils/getValueClass.ts","../src/lib/components/controls/EditableDiv.svelte","../src/lib/plugins/value/components/EditableValue.svelte","../src/lib/logic/operations.ts","../src/lib/logic/search.ts","../src/lib/components/modes/treemode/highlight/SearchResultHighlighter.svelte","../src/lib/utils/fileUtils.ts","../src/lib/components/controls/Tag.svelte","../node_modules/svelte/src/internal/client/dom/blocks/snippet.js","../src/lib/plugins/value/components/ReadonlyValue.svelte","../src/lib/components/controls/tooltip/Tooltip.svelte","../src/lib/components/controls/tooltip/tooltip.ts","../src/lib/plugins/value/components/TimestampTag.svelte","../src/lib/plugins/value/renderValue.ts","../src/lib/utils/pathUtils.ts","../src/lib/components/modals/transformModalStates.ts","../node_modules/@floating-ui/utils/dist/floating-ui.utils.mjs","../node_modules/@floating-ui/core/dist/floating-ui.core.mjs","../node_modules/@floating-ui/utils/dist/floating-ui.utils.dom.mjs","../node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs","../node_modules/svelte-floating-ui/index.js","../node_modules/svelte-select/filter.js","../node_modules/svelte-select/get-items.js","../node_modules/svelte-select/Select.svelte","../src/lib/components/modals/TransformWizard.svelte","../src/lib/components/controls/selectQueryLanguage/SelectQueryLanguage.svelte","../src/lib/components/modals/Header.svelte","../src/lib/components/controls/createAutoScrollHandler.ts","../src/lib/assets/jump.js/src/easing.ts","../src/lib/assets/jump.js/src/jump.ts","../src/lib/utils/timeUtils.ts","../src/lib/logic/validation.ts","../src/lib/components/controls/createFocusTracker.ts","../src/lib/components/controls/Message.svelte","../src/lib/components/controls/ValidationErrorsOverview.svelte","../src/lib/actions/onEscape.ts","../src/lib/components/modals/Modal.svelte","../src/lib/components/modals/CopyPasteModal.svelte","../src/lib/components/controls/Menu.svelte","../src/lib/components/modals/repair/JSONRepairComponent.svelte","../src/lib/components/modals/JSONRepairModal.svelte","../src/lib/components/modes/treemode/CollapsedItems.svelte","../src/lib/components/controls/contextmenu/ContextMenuPointer.svelte","../src/lib/components/modes/treemode/JSONValue.svelte","../src/lib/components/modes/treemode/singleton.ts","../src/lib/logic/dragging.ts","../src/lib/components/modes/treemode/ValidationErrorIcon.svelte","../src/lib/components/modes/treemode/JSONNode.svelte","../src/lib/components/modes/treemode/JSONKey.svelte","../src/lib/img/customFontawesomeIcons.ts","../src/lib/components/modes/treemode/Welcome.svelte","../src/lib/logic/sort.ts","../src/lib/components/controls/navigationBar/NavigationBarDropdown.svelte","../src/lib/components/controls/navigationBar/NavigationBarItem.svelte","../src/lib/utils/copyToClipboard.ts","../src/lib/components/controls/navigationBar/NavigationBarPathEditor.svelte","../src/lib/components/controls/navigationBar/NavigationBar.svelte","../src/lib/components/controls/SearchBox.svelte","../src/lib/logic/table.ts","../src/lib/logic/actions.ts","../src/lib/components/controls/JSONPreview.svelte","../src/lib/components/controls/contextmenu/ContextMenuButton.svelte","../src/lib/components/controls/contextmenu/ContextMenuDropDownButton.svelte","../src/lib/components/controls/DropdownButton.svelte","../src/lib/components/controls/contextmenu/ContextMenu.svelte","../src/lib/plugins/value/components/EnumValue.svelte","../src/lib/utils/jsonSchemaUtils.ts","../src/lib/plugins/value/renderJSONSchemaEnum.ts","../src/lib/plugins/validator/createAjvValidator.ts","../src/lib/plugins/query/jmespathQueryLanguage.ts","../src/lib/plugins/query/jsonpathQueryLanguage.ts","../src/lib/plugins/query/lodashQueryLanguage.ts","../src/lib/plugins/query/javascriptQueryLanguage.ts","../src/lib/actions/resizeObserver.ts","../src/lib/components/modes/treemode/TreeMode.svelte","../src/lib/components/modes/treemode/contextmenu/createTreeContextMenuItems.ts","../src/lib/components/modes/treemode/menu/TreeMenu.svelte","../src/lib/utils/readonlyProxy.ts","../src/lib/logic/history.ts","../src/lib/components/modals/TransformModal.svelte","../src/lib/components/modals/TransformModalHeader.svelte","../src/lib/utils/noop.ts","../src/lib/components/modes/textmode/codemirror/codemirror-theme.ts","../node_modules/codemirror-wrapped-line-indent/dist/index.js","../src/lib/components/modes/textmode/TextMode.svelte","../src/lib/components/modes/textmode/menu/TextMenu.svelte","../src/lib/components/modes/textmode/StatusBar.svelte","../src/lib/components/modes/tablemode/TableModeWelcome.svelte","../src/lib/components/modes/tablemode/TableMode.svelte","../src/lib/components/modes/tablemode/contextmenu/createTableContextMenuItems.ts","../src/lib/components/modes/tablemode/menu/TableMenu.svelte","../src/lib/components/modes/tablemode/ColumnHeader.svelte","../src/lib/components/modes/tablemode/RefreshColumnHeader.svelte","../src/lib/components/modes/tablemode/tag/InlineValue.svelte","../src/lib/components/modes/JSONEditorRoot.svelte","../src/lib/components/modals/sortModalStates.ts","../src/lib/components/JSONEditor.svelte","../src/lib/components/modals/SortModal.svelte","../src/lib/components/modals/JSONEditorModal.svelte","../src/lib/index-vanilla.ts"],"sourcesContent":["// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n * @type {string}\n */\nexport const VERSION = '5.35.6';\nexport const PUBLIC_VERSION = '5';\n","import { PUBLIC_VERSION } from '../version.js';\n\nif (typeof window !== 'undefined') {\n\t// @ts-expect-error\n\t((window.__svelte ??= {}).v ??= new Set()).add(PUBLIC_VERSION);\n}\n","export let legacy_mode_flag = false;\nexport let tracing_mode_flag = false;\n\nexport function enable_legacy_mode_flag() {\n\tlegacy_mode_flag = true;\n}\n\nexport function enable_tracing_mode_flag() {\n\ttracing_mode_flag = true;\n}\n","export const EACH_ITEM_REACTIVE = 1;\nexport const EACH_INDEX_REACTIVE = 1 << 1;\n/** See EachBlock interface metadata.is_controlled for an explanation what this is */\nexport const EACH_IS_CONTROLLED = 1 << 2;\nexport const EACH_IS_ANIMATED = 1 << 3;\nexport const EACH_ITEM_IMMUTABLE = 1 << 4;\n\nexport const PROPS_IS_IMMUTABLE = 1;\nexport const PROPS_IS_RUNES = 1 << 1;\nexport const PROPS_IS_UPDATED = 1 << 2;\nexport const PROPS_IS_BINDABLE = 1 << 3;\nexport const PROPS_IS_LAZY_INITIAL = 1 << 4;\n\nexport const TRANSITION_IN = 1;\nexport const TRANSITION_OUT = 1 << 1;\nexport const TRANSITION_GLOBAL = 1 << 2;\n\nexport const TEMPLATE_FRAGMENT = 1;\nexport const TEMPLATE_USE_IMPORT_NODE = 1 << 1;\nexport const TEMPLATE_USE_SVG = 1 << 2;\nexport const TEMPLATE_USE_MATHML = 1 << 3;\n\nexport const HYDRATION_START = '[';\n/** used to indicate that an `{:else}...` block was rendered */\nexport const HYDRATION_START_ELSE = '[!';\nexport const HYDRATION_END = ']';\nexport const HYDRATION_ERROR = {};\n\nexport const ELEMENT_IS_NAMESPACED = 1;\nexport const ELEMENT_PRESERVE_ATTRIBUTE_CASE = 1 << 1;\n\nexport const UNINITIALIZED = Symbol();\n\n// Dev-time component properties\nexport const FILENAME = Symbol('filename');\nexport const HMR = Symbol('hmr');\n\nexport const NAMESPACE_HTML = 'http://www.w3.org/1999/xhtml';\nexport const NAMESPACE_SVG = 'http://www.w3.org/2000/svg';\nexport const NAMESPACE_MATHML = 'http://www.w3.org/1998/Math/MathML';\n\n// we use a list of ignorable runtime warnings because not every runtime warning\n// can be ignored and we want to keep the validation for svelte-ignore in place\nexport const IGNORABLE_RUNTIME_WARNINGS = /** @type {const} */ ([\n\t'state_snapshot_uncloneable',\n\t'binding_property_non_reactive',\n\t'hydration_attribute_changed',\n\t'hydration_html_changed',\n\t'ownership_invalid_binding',\n\t'ownership_invalid_mutation'\n]);\n\n/**\n * Whitespace inside one of these elements will not result in\n * a whitespace node being created in any circumstances. (This\n * list is almost certainly very incomplete)\n * TODO this is currently unused\n */\nexport const ELEMENTS_WITHOUT_TEXT = ['audio', 'datalist', 'dl', 'optgroup', 'select', 'video'];\n\nexport const ATTACHMENT_KEY = '@attach';\n","// Store the references to globals in case someone tries to monkey patch these, causing the below\n// to de-opt (this occurs often when using popular extensions).\nexport var is_array = Array.isArray;\nexport var index_of = Array.prototype.indexOf;\nexport var array_from = Array.from;\nexport var object_keys = Object.keys;\nexport var define_property = Object.defineProperty;\nexport var get_descriptor = Object.getOwnPropertyDescriptor;\nexport var get_descriptors = Object.getOwnPropertyDescriptors;\nexport var object_prototype = Object.prototype;\nexport var array_prototype = Array.prototype;\nexport var get_prototype_of = Object.getPrototypeOf;\nexport var is_extensible = Object.isExtensible;\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\nexport const noop = () => {};\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n\n/**\n * @template [T=any]\n * @param {any} value\n * @returns {value is PromiseLike<T>}\n */\nexport function is_promise(value) {\n\treturn typeof value?.then === 'function';\n}\n\n/** @param {Function} fn */\nexport function run(fn) {\n\treturn fn();\n}\n\n/** @param {Array<() => void>} arr */\nexport function run_all(arr) {\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tarr[i]();\n\t}\n}\n\n/**\n * TODO replace with Promise.withResolvers once supported widely enough\n * @template T\n */\nexport function deferred() {\n\t/** @type {(value: T) => void} */\n\tvar resolve;\n\n\t/** @type {(reason: any) => void} */\n\tvar reject;\n\n\t/** @type {Promise<T>} */\n\tvar promise = new Promise((res, rej) => {\n\t\tresolve = res;\n\t\treject = rej;\n\t});\n\n\t// @ts-expect-error\n\treturn { promise, resolve, reject };\n}\n\n/**\n * @template V\n * @param {V} value\n * @param {V | (() => V)} fallback\n * @param {boolean} [lazy]\n * @returns {V}\n */\nexport function fallback(value, fallback, lazy = false) {\n\treturn value === undefined\n\t\t? lazy\n\t\t\t? /** @type {() => V} */ (fallback)()\n\t\t\t: /** @type {V} */ (fallback)\n\t\t: value;\n}\n\n/**\n * When encountering a situation like `let [a, b, c] = $derived(blah())`,\n * we need to stash an intermediate value that `a`, `b`, and `c` derive\n * from, in case it's an iterable\n * @template T\n * @param {ArrayLike<T> | Iterable<T>} value\n * @param {number} [n]\n * @returns {Array<T>}\n */\nexport function to_array(value, n) {\n\t// return arrays unchanged\n\tif (Array.isArray(value)) {\n\t\treturn value;\n\t}\n\n\t// if value is not iterable, or `n` is unspecified (indicates a rest\n\t// element, which means we're not concerned about unbounded iterables)\n\t// convert to an array with `Array.from`\n\tif (n === undefined || !(Symbol.iterator in value)) {\n\t\treturn Array.from(value);\n\t}\n\n\t// otherwise, populate an array with `n` values\n\n\t/** @type {T[]} */\n\tconst array = [];\n\n\tfor (const element of value) {\n\t\tarray.push(element);\n\t\tif (array.length === n) break;\n\t}\n\n\treturn array;\n}\n","export const DERIVED = 1 << 1;\nexport const EFFECT = 1 << 2;\nexport const RENDER_EFFECT = 1 << 3;\nexport const BLOCK_EFFECT = 1 << 4;\nexport const BRANCH_EFFECT = 1 << 5;\nexport const ROOT_EFFECT = 1 << 6;\nexport const BOUNDARY_EFFECT = 1 << 7;\nexport const UNOWNED = 1 << 8;\nexport const DISCONNECTED = 1 << 9;\nexport const CLEAN = 1 << 10;\nexport const DIRTY = 1 << 11;\nexport const MAYBE_DIRTY = 1 << 12;\nexport const INERT = 1 << 13;\nexport const DESTROYED = 1 << 14;\nexport const EFFECT_RAN = 1 << 15;\n/** 'Transparent' effects do not create a transition boundary */\nexport const EFFECT_TRANSPARENT = 1 << 16;\nexport const INSPECT_EFFECT = 1 << 17;\nexport const HEAD_EFFECT = 1 << 18;\nexport const EFFECT_PRESERVED = 1 << 19;\nexport const EFFECT_IS_UPDATING = 1 << 20;\nexport const USER_EFFECT = 1 << 21;\n\nexport const STATE_SYMBOL = Symbol('$state');\nexport const LEGACY_PROPS = Symbol('legacy props');\nexport const LOADING_ATTR_SYMBOL = Symbol('');\nexport const PROXY_PATH_SYMBOL = Symbol('proxy path');\n\n/** allow users to ignore aborted signal errors if `reason.name === 'StaleReactionError` */\nexport const STALE_REACTION = new (class StaleReactionError extends Error {\n\tname = 'StaleReactionError';\n\tmessage = 'The reaction that called `getAbortSignal()` was re-run or destroyed';\n})();\n\nexport const ELEMENT_NODE = 1;\nexport const TEXT_NODE = 3;\nexport const COMMENT_NODE = 8;\nexport const DOCUMENT_FRAGMENT_NODE = 11;\n","/** @import { Equals } from '#client' */\n\n/** @type {Equals} */\nexport function equals(value) {\n\treturn value === this.v;\n}\n\n/**\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport function safe_not_equal(a, b) {\n\treturn a != a\n\t\t? b == b\n\t\t: a !== b || (a !== null && typeof a === 'object') || typeof a === 'function';\n}\n\n/**\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport function not_equal(a, b) {\n\treturn a !== b;\n}\n\n/** @type {Equals} */\nexport function safe_equals(value) {\n\treturn !safe_not_equal(value, this.v);\n}\n","/* This file is generated by scripts/process-messages/index.js. Do not edit! */\n\nimport { DEV } from 'esm-env';\n\n/**\n * Cannot use `{@render children(...)}` if the parent component uses `let:` directives. Consider using a named snippet instead\n * @returns {never}\n */\nexport function invalid_default_snippet() {\n\tif (DEV) {\n\t\tconst error = new Error(`invalid_default_snippet\\nCannot use \\`{@render children(...)}\\` if the parent component uses \\`let:\\` directives. Consider using a named snippet instead\\nhttps://svelte.dev/e/invalid_default_snippet`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/invalid_default_snippet`);\n\t}\n}\n\n/**\n * A snippet function was passed invalid arguments. Snippets should only be instantiated via `{@render ...}`\n * @returns {never}\n */\nexport function invalid_snippet_arguments() {\n\tif (DEV) {\n\t\tconst error = new Error(`invalid_snippet_arguments\\nA snippet function was passed invalid arguments. Snippets should only be instantiated via \\`{@render ...}\\`\\nhttps://svelte.dev/e/invalid_snippet_arguments`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/invalid_snippet_arguments`);\n\t}\n}\n\n/**\n * `%name%(...)` can only be used during component initialisation\n * @param {string} name\n * @returns {never}\n */\nexport function lifecycle_outside_component(name) {\n\tif (DEV) {\n\t\tconst error = new Error(`lifecycle_outside_component\\n\\`${name}(...)\\` can only be used during component initialisation\\nhttps://svelte.dev/e/lifecycle_outside_component`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/lifecycle_outside_component`);\n\t}\n}\n\n/**\n * Attempted to render a snippet without a `{@render}` block. This would cause the snippet code to be stringified instead of its content being rendered to the DOM. To fix this, change `{snippet}` to `{@render snippet()}`.\n * @returns {never}\n */\nexport function snippet_without_render_tag() {\n\tif (DEV) {\n\t\tconst error = new Error(`snippet_without_render_tag\\nAttempted to render a snippet without a \\`{@render}\\` block. This would cause the snippet code to be stringified instead of its content being rendered to the DOM. To fix this, change \\`{snippet}\\` to \\`{@render snippet()}\\`.\\nhttps://svelte.dev/e/snippet_without_render_tag`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/snippet_without_render_tag`);\n\t}\n}\n\n/**\n * `%name%` is not a store with a `subscribe` method\n * @param {string} name\n * @returns {never}\n */\nexport function store_invalid_shape(name) {\n\tif (DEV) {\n\t\tconst error = new Error(`store_invalid_shape\\n\\`${name}\\` is not a store with a \\`subscribe\\` method\\nhttps://svelte.dev/e/store_invalid_shape`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/store_invalid_shape`);\n\t}\n}\n\n/**\n * The `this` prop on `<svelte:element>` must be a string, if defined\n * @returns {never}\n */\nexport function svelte_element_invalid_this_value() {\n\tif (DEV) {\n\t\tconst error = new Error(`svelte_element_invalid_this_value\\nThe \\`this\\` prop on \\`<svelte:element>\\` must be a string, if defined\\nhttps://svelte.dev/e/svelte_element_invalid_this_value`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/svelte_element_invalid_this_value`);\n\t}\n}","/** @import { ComponentContext, DevStackEntry } from '#client' */\n\nimport { DEV } from 'esm-env';\nimport { lifecycle_outside_component } from '../shared/errors.js';\nimport { source } from './reactivity/sources.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tset_active_effect,\n\tset_active_reaction\n} from './runtime.js';\nimport { create_user_effect, teardown } from './reactivity/effects.js';\nimport { legacy_mode_flag } from '../flags/index.js';\nimport { FILENAME } from '../../constants.js';\n\n/** @type {ComponentContext | null} */\nexport let component_context = null;\n\n/** @param {ComponentContext | null} context */\nexport function set_component_context(context) {\n\tcomponent_context = context;\n}\n\n/** @type {DevStackEntry | null} */\nexport let dev_stack = null;\n\n/** @param {DevStackEntry | null} stack */\nexport function set_dev_stack(stack) {\n\tdev_stack = stack;\n}\n\n/**\n * Execute a callback with a new dev stack entry\n * @param {() => any} callback - Function to execute\n * @param {DevStackEntry['type']} type - Type of block/component\n * @param {any} component - Component function\n * @param {number} line - Line number\n * @param {number} column - Column number\n * @param {Record<string, any>} [additional] - Any additional properties to add to the dev stack entry\n * @returns {any}\n */\nexport function add_svelte_meta(callback, type, component, line, column, additional) {\n\tconst parent = dev_stack;\n\n\tdev_stack = {\n\t\ttype,\n\t\tfile: component[FILENAME],\n\t\tline,\n\t\tcolumn,\n\t\tparent,\n\t\t...additional\n\t};\n\n\ttry {\n\t\treturn callback();\n\t} finally {\n\t\tdev_stack = parent;\n\t}\n}\n\n/**\n * The current component function. Different from current component context:\n * ```html\n * <!-- App.svelte -->\n * <Foo>\n *   <Bar /> <!-- context == Foo.svelte, function == App.svelte -->\n * </Foo>\n * ```\n * @type {ComponentContext['function']}\n */\nexport let dev_current_component_function = null;\n\n/** @param {ComponentContext['function']} fn */\nexport function set_dev_current_component_function(fn) {\n\tdev_current_component_function = fn;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\tconst context_map = get_or_init_context_map('getContext');\n\tconst result = /** @type {T} */ (context_map.get(key));\n\treturn result;\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tconst context_map = get_or_init_context_map('setContext');\n\tcontext_map.set(key, context);\n\treturn context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\tconst context_map = get_or_init_context_map('hasContext');\n\treturn context_map.has(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\tconst context_map = get_or_init_context_map('getAllContexts');\n\treturn /** @type {T} */ (context_map);\n}\n\n/**\n * @param {Record<string, unknown>} props\n * @param {any} runes\n * @param {Function} [fn]\n * @returns {void}\n */\nexport function push(props, runes = false, fn) {\n\tcomponent_context = {\n\t\tp: component_context,\n\t\tc: null,\n\t\te: null,\n\t\ts: props,\n\t\tx: null,\n\t\tl: null\n\t};\n\n\tif (legacy_mode_flag && !runes) {\n\t\tcomponent_context.l = {\n\t\t\ts: null,\n\t\t\tu: null,\n\t\t\tr1: [],\n\t\t\tr2: source(false)\n\t\t};\n\t}\n\n\tif (DEV) {\n\t\t// component function\n\t\tcomponent_context.function = fn;\n\t\tdev_current_component_function = fn;\n\t}\n}\n\n/**\n * @template {Record<string, any>} T\n * @param {T} [component]\n * @returns {T}\n */\nexport function pop(component) {\n\tvar context = /** @type {ComponentContext} */ (component_context);\n\tvar effects = context.e;\n\n\tif (effects !== null) {\n\t\tcontext.e = null;\n\n\t\tfor (var fn of effects) {\n\t\t\tcreate_user_effect(fn);\n\t\t}\n\t}\n\n\tif (component !== undefined) {\n\t\tcontext.x = component;\n\t}\n\n\tcomponent_context = context.p;\n\n\tif (DEV) {\n\t\tdev_current_component_function = component_context?.function ?? null;\n\t}\n\n\treturn component ?? /** @type {T} */ ({});\n}\n\n/** @returns {boolean} */\nexport function is_runes() {\n\treturn !legacy_mode_flag || (component_context !== null && component_context.l === null);\n}\n\n/**\n * @param {string} name\n * @returns {Map<unknown, unknown>}\n */\nfunction get_or_init_context_map(name) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component(name);\n\t}\n\n\treturn (component_context.c ??= new Map(get_parent_context(component_context) || undefined));\n}\n\n/**\n * @param {ComponentContext} component_context\n * @returns {Map<unknown, unknown> | null}\n */\nfunction get_parent_context(component_context) {\n\tlet parent = component_context.p;\n\twhile (parent !== null) {\n\t\tconst context_map = parent.c;\n\t\tif (context_map !== null) {\n\t\t\treturn context_map;\n\t\t}\n\t\tparent = parent.p;\n\t}\n\treturn null;\n}\n","/** @import { Source } from '#client' */\nimport { DEV } from 'esm-env';\nimport {\n\tget,\n\tactive_effect,\n\tupdate_version,\n\tactive_reaction,\n\tset_update_version,\n\tset_active_reaction\n} from './runtime.js';\nimport {\n\tarray_prototype,\n\tget_descriptor,\n\tget_prototype_of,\n\tis_array,\n\tobject_prototype\n} from '../shared/utils.js';\nimport { state as source, set, increment } from './reactivity/sources.js';\nimport { PROXY_PATH_SYMBOL, STATE_SYMBOL } from '#client/constants';\nimport { UNINITIALIZED } from '../../constants.js';\nimport * as e from './errors.js';\nimport { get_stack, tag } from './dev/tracing.js';\nimport { tracing_mode_flag } from '../flags/index.js';\n\n// TODO move all regexes into shared module?\nconst regex_is_valid_identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n/**\n * @template T\n * @param {T} value\n * @returns {T}\n */\nexport function proxy(value) {\n\t// if non-proxyable, or is already a proxy, return `value`\n\tif (typeof value !== 'object' || value === null || STATE_SYMBOL in value) {\n\t\treturn value;\n\t}\n\n\tconst prototype = get_prototype_of(value);\n\n\tif (prototype !== object_prototype && prototype !== array_prototype) {\n\t\treturn value;\n\t}\n\n\t/** @type {Map<any, Source<any>>} */\n\tvar sources = new Map();\n\tvar is_proxied_array = is_array(value);\n\tvar version = source(0);\n\n\tvar stack = DEV && tracing_mode_flag ? get_stack('CreatedAt') : null;\n\tvar parent_version = update_version;\n\n\t/**\n\t * Executes the proxy in the context of the reaction it was originally created in, if any\n\t * @template T\n\t * @param {() => T} fn\n\t */\n\tvar with_parent = (fn) => {\n\t\tif (update_version === parent_version) {\n\t\t\treturn fn();\n\t\t}\n\n\t\t// child source is being created after the initial proxy —\n\t\t// prevent it from being associated with the current reaction\n\t\tvar reaction = active_reaction;\n\t\tvar version = update_version;\n\n\t\tset_active_reaction(null);\n\t\tset_update_version(parent_version);\n\n\t\tvar result = fn();\n\n\t\tset_active_reaction(reaction);\n\t\tset_update_version(version);\n\n\t\treturn result;\n\t};\n\n\tif (is_proxied_array) {\n\t\t// We need to create the length source eagerly to ensure that\n\t\t// mutations to the array are properly synced with our proxy\n\t\tsources.set('length', source(/** @type {any[]} */ (value).length, stack));\n\t}\n\n\t/** Used in dev for $inspect.trace() */\n\tvar path = '';\n\n\t/** @param {string} new_path */\n\tfunction update_path(new_path) {\n\t\tpath = new_path;\n\n\t\ttag(version, `${path} version`);\n\n\t\t// rename all child sources and child proxies\n\t\tfor (const [prop, source] of sources) {\n\t\t\ttag(source, get_label(path, prop));\n\t\t}\n\t}\n\n\treturn new Proxy(/** @type {any} */ (value), {\n\t\tdefineProperty(_, prop, descriptor) {\n\t\t\tif (\n\t\t\t\t!('value' in descriptor) ||\n\t\t\t\tdescriptor.configurable === false ||\n\t\t\t\tdescriptor.enumerable === false ||\n\t\t\t\tdescriptor.writable === false\n\t\t\t) {\n\t\t\t\t// we disallow non-basic descriptors, because unless they are applied to the\n\t\t\t\t// target object — which we avoid, so that state can be forked — we will run\n\t\t\t\t// afoul of the various invariants\n\t\t\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/getOwnPropertyDescriptor#invariants\n\t\t\t\te.state_descriptors_fixed();\n\t\t\t}\n\t\t\tvar s = sources.get(prop);\n\t\t\tif (s === undefined) {\n\t\t\t\ts = with_parent(() => {\n\t\t\t\t\tvar s = source(descriptor.value, stack);\n\t\t\t\t\tsources.set(prop, s);\n\t\t\t\t\tif (DEV && typeof prop === 'string') {\n\t\t\t\t\t\ttag(s, get_label(path, prop));\n\t\t\t\t\t}\n\t\t\t\t\treturn s;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tset(s, descriptor.value, true);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tdeleteProperty(target, prop) {\n\t\t\tvar s = sources.get(prop);\n\n\t\t\tif (s === undefined) {\n\t\t\t\tif (prop in target) {\n\t\t\t\t\tconst s = with_parent(() => source(UNINITIALIZED, stack));\n\t\t\t\t\tsources.set(prop, s);\n\t\t\t\t\tincrement(version);\n\n\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\ttag(s, get_label(path, prop));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// When working with arrays, we need to also ensure we update the length when removing\n\t\t\t\t// an indexed property\n\t\t\t\tif (is_proxied_array && typeof prop === 'string') {\n\t\t\t\t\tvar ls = /** @type {Source<number>} */ (sources.get('length'));\n\t\t\t\t\tvar n = Number(prop);\n\n\t\t\t\t\tif (Number.isInteger(n) && n < ls.v) {\n\t\t\t\t\t\tset(ls, n);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tset(s, UNINITIALIZED);\n\t\t\t\tincrement(version);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tget(target, prop, receiver) {\n\t\t\tif (prop === STATE_SYMBOL) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tif (DEV && prop === PROXY_PATH_SYMBOL) {\n\t\t\t\treturn update_path;\n\t\t\t}\n\n\t\t\tvar s = sources.get(prop);\n\t\t\tvar exists = prop in target;\n\n\t\t\t// create a source, but only if it's an own property and not a prototype property\n\t\t\tif (s === undefined && (!exists || get_descriptor(target, prop)?.writable)) {\n\t\t\t\ts = with_parent(() => {\n\t\t\t\t\tvar p = proxy(exists ? target[prop] : UNINITIALIZED);\n\t\t\t\t\tvar s = source(p, stack);\n\n\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\ttag(s, get_label(path, prop));\n\t\t\t\t\t}\n\n\t\t\t\t\treturn s;\n\t\t\t\t});\n\n\t\t\t\tsources.set(prop, s);\n\t\t\t}\n\n\t\t\tif (s !== undefined) {\n\t\t\t\tvar v = get(s);\n\t\t\t\treturn v === UNINITIALIZED ? undefined : v;\n\t\t\t}\n\n\t\t\treturn Reflect.get(target, prop, receiver);\n\t\t},\n\n\t\tgetOwnPropertyDescriptor(target, prop) {\n\t\t\tvar descriptor = Reflect.getOwnPropertyDescriptor(target, prop);\n\n\t\t\tif (descriptor && 'value' in descriptor) {\n\t\t\t\tvar s = sources.get(prop);\n\t\t\t\tif (s) descriptor.value = get(s);\n\t\t\t} else if (descriptor === undefined) {\n\t\t\t\tvar source = sources.get(prop);\n\t\t\t\tvar value = source?.v;\n\n\t\t\t\tif (source !== undefined && value !== UNINITIALIZED) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tenumerable: true,\n\t\t\t\t\t\tconfigurable: true,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\twritable: true\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn descriptor;\n\t\t},\n\n\t\thas(target, prop) {\n\t\t\tif (prop === STATE_SYMBOL) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar s = sources.get(prop);\n\t\t\tvar has = (s !== undefined && s.v !== UNINITIALIZED) || Reflect.has(target, prop);\n\n\t\t\tif (\n\t\t\t\ts !== undefined ||\n\t\t\t\t(active_effect !== null && (!has || get_descriptor(target, prop)?.writable))\n\t\t\t) {\n\t\t\t\tif (s === undefined) {\n\t\t\t\t\ts = with_parent(() => {\n\t\t\t\t\t\tvar p = has ? proxy(target[prop]) : UNINITIALIZED;\n\t\t\t\t\t\tvar s = source(p, stack);\n\n\t\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\t\ttag(s, get_label(path, prop));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn s;\n\t\t\t\t\t});\n\n\t\t\t\t\tsources.set(prop, s);\n\t\t\t\t}\n\n\t\t\t\tvar value = get(s);\n\t\t\t\tif (value === UNINITIALIZED) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn has;\n\t\t},\n\n\t\tset(target, prop, value, receiver) {\n\t\t\tvar s = sources.get(prop);\n\t\t\tvar has = prop in target;\n\n\t\t\t// variable.length = value -> clear all signals with index >= value\n\t\t\tif (is_proxied_array && prop === 'length') {\n\t\t\t\tfor (var i = value; i < /** @type {Source<number>} */ (s).v; i += 1) {\n\t\t\t\t\tvar other_s = sources.get(i + '');\n\t\t\t\t\tif (other_s !== undefined) {\n\t\t\t\t\t\tset(other_s, UNINITIALIZED);\n\t\t\t\t\t} else if (i in target) {\n\t\t\t\t\t\t// If the item exists in the original, we need to create a uninitialized source,\n\t\t\t\t\t\t// else a later read of the property would result in a source being created with\n\t\t\t\t\t\t// the value of the original item at that index.\n\t\t\t\t\t\tother_s = with_parent(() => source(UNINITIALIZED, stack));\n\t\t\t\t\t\tsources.set(i + '', other_s);\n\n\t\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\t\ttag(other_s, get_label(path, i));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we haven't yet created a source for this property, we need to ensure\n\t\t\t// we do so otherwise if we read it later, then the write won't be tracked and\n\t\t\t// the heuristics of effects will be different vs if we had read the proxied\n\t\t\t// object property before writing to that property.\n\t\t\tif (s === undefined) {\n\t\t\t\tif (!has || get_descriptor(target, prop)?.writable) {\n\t\t\t\t\ts = with_parent(() => source(undefined, stack));\n\t\t\t\t\tset(s, proxy(value));\n\n\t\t\t\t\tsources.set(prop, s);\n\n\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\ttag(s, get_label(path, prop));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\thas = s.v !== UNINITIALIZED;\n\n\t\t\t\tvar p = with_parent(() => proxy(value));\n\t\t\t\tset(s, p);\n\t\t\t}\n\n\t\t\tvar descriptor = Reflect.getOwnPropertyDescriptor(target, prop);\n\n\t\t\t// Set the new value before updating any signals so that any listeners get the new value\n\t\t\tif (descriptor?.set) {\n\t\t\t\tdescriptor.set.call(receiver, value);\n\t\t\t}\n\n\t\t\tif (!has) {\n\t\t\t\t// If we have mutated an array directly, we might need to\n\t\t\t\t// signal that length has also changed. Do it before updating metadata\n\t\t\t\t// to ensure that iterating over the array as a result of a metadata update\n\t\t\t\t// will not cause the length to be out of sync.\n\t\t\t\tif (is_proxied_array && typeof prop === 'string') {\n\t\t\t\t\tvar ls = /** @type {Source<number>} */ (sources.get('length'));\n\t\t\t\t\tvar n = Number(prop);\n\n\t\t\t\t\tif (Number.isInteger(n) && n >= ls.v) {\n\t\t\t\t\t\tset(ls, n + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tincrement(version);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\townKeys(target) {\n\t\t\tget(version);\n\n\t\t\tvar own_keys = Reflect.ownKeys(target).filter((key) => {\n\t\t\t\tvar source = sources.get(key);\n\t\t\t\treturn source === undefined || source.v !== UNINITIALIZED;\n\t\t\t});\n\n\t\t\tfor (var [key, source] of sources) {\n\t\t\t\tif (source.v !== UNINITIALIZED && !(key in target)) {\n\t\t\t\t\town_keys.push(key);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn own_keys;\n\t\t},\n\n\t\tsetPrototypeOf() {\n\t\t\te.state_prototype_fixed();\n\t\t}\n\t});\n}\n\n/**\n * @param {string} path\n * @param {string | symbol} prop\n */\nfunction get_label(path, prop) {\n\tif (typeof prop === 'symbol') return `${path}[Symbol(${prop.description ?? ''})]`;\n\tif (regex_is_valid_identifier.test(prop)) return `${path}.${prop}`;\n\treturn /^\\d+$/.test(prop) ? `${path}[${prop}]` : `${path}['${prop}']`;\n}\n\n/**\n * @param {any} value\n */\nexport function get_proxied_value(value) {\n\ttry {\n\t\tif (value !== null && typeof value === 'object' && STATE_SYMBOL in value) {\n\t\t\treturn value[STATE_SYMBOL];\n\t\t}\n\t} catch {\n\t\t// the above if check can throw an error if the value in question\n\t\t// is the contentWindow of an iframe on another domain, in which\n\t\t// case we want to just return the value (because it's definitely\n\t\t// not a proxied value) so we don't break any JavaScript interacting\n\t\t// with that iframe (such as various payment companies client side\n\t\t// JavaScript libraries interacting with their iframes on the same\n\t\t// domain)\n\t}\n\n\treturn value;\n}\n\n/**\n * @param {any} a\n * @param {any} b\n */\nexport function is(a, b) {\n\treturn Object.is(get_proxied_value(a), get_proxied_value(b));\n}\n","/* This file is generated by scripts/process-messages/index.js. Do not edit! */\n\nimport { DEV } from 'esm-env';\n\n/**\n * Using `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\n * @returns {never}\n */\nexport function bind_invalid_checkbox_value() {\n\tif (DEV) {\n\t\tconst error = new Error(`bind_invalid_checkbox_value\\nUsing \\`bind:value\\` together with a checkbox input is not allowed. Use \\`bind:checked\\` instead\\nhttps://svelte.dev/e/bind_invalid_checkbox_value`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/bind_invalid_checkbox_value`);\n\t}\n}\n\n/**\n * Component %component% has an export named `%key%` that a consumer component is trying to access using `bind:%key%`, which is disallowed. Instead, use `bind:this` (e.g. `<%name% bind:this={component} />`) and then access the property on the bound component instance (e.g. `component.%key%`)\n * @param {string} component\n * @param {string} key\n * @param {string} name\n * @returns {never}\n */\nexport function bind_invalid_export(component, key, name) {\n\tif (DEV) {\n\t\tconst error = new Error(`bind_invalid_export\\nComponent ${component} has an export named \\`${key}\\` that a consumer component is trying to access using \\`bind:${key}\\`, which is disallowed. Instead, use \\`bind:this\\` (e.g. \\`<${name} bind:this={component} />\\`) and then access the property on the bound component instance (e.g. \\`component.${key}\\`)\\nhttps://svelte.dev/e/bind_invalid_export`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/bind_invalid_export`);\n\t}\n}\n\n/**\n * A component is attempting to bind to a non-bindable property `%key%` belonging to %component% (i.e. `<%name% bind:%key%={...}>`). To mark a property as bindable: `let { %key% = $bindable() } = $props()`\n * @param {string} key\n * @param {string} component\n * @param {string} name\n * @returns {never}\n */\nexport function bind_not_bindable(key, component, name) {\n\tif (DEV) {\n\t\tconst error = new Error(`bind_not_bindable\\nA component is attempting to bind to a non-bindable property \\`${key}\\` belonging to ${component} (i.e. \\`<${name} bind:${key}={...}>\\`). To mark a property as bindable: \\`let { ${key} = $bindable() } = $props()\\`\\nhttps://svelte.dev/e/bind_not_bindable`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/bind_not_bindable`);\n\t}\n}\n\n/**\n * Calling `%method%` on a component instance (of %component%) is no longer valid in Svelte 5\n * @param {string} method\n * @param {string} component\n * @returns {never}\n */\nexport function component_api_changed(method, component) {\n\tif (DEV) {\n\t\tconst error = new Error(`component_api_changed\\nCalling \\`${method}\\` on a component instance (of ${component}) is no longer valid in Svelte 5\\nhttps://svelte.dev/e/component_api_changed`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/component_api_changed`);\n\t}\n}\n\n/**\n * Attempted to instantiate %component% with `new %name%`, which is no longer valid in Svelte 5. If this component is not under your control, set the `compatibility.componentApi` compiler option to `4` to keep it working.\n * @param {string} component\n * @param {string} name\n * @returns {never}\n */\nexport function component_api_invalid_new(component, name) {\n\tif (DEV) {\n\t\tconst error = new Error(`component_api_invalid_new\\nAttempted to instantiate ${component} with \\`new ${name}\\`, which is no longer valid in Svelte 5. If this component is not under your control, set the \\`compatibility.componentApi\\` compiler option to \\`4\\` to keep it working.\\nhttps://svelte.dev/e/component_api_invalid_new`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/component_api_invalid_new`);\n\t}\n}\n\n/**\n * A derived value cannot reference itself recursively\n * @returns {never}\n */\nexport function derived_references_self() {\n\tif (DEV) {\n\t\tconst error = new Error(`derived_references_self\\nA derived value cannot reference itself recursively\\nhttps://svelte.dev/e/derived_references_self`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/derived_references_self`);\n\t}\n}\n\n/**\n * Keyed each block has duplicate key `%value%` at indexes %a% and %b%\n * @param {string} a\n * @param {string} b\n * @param {string | undefined | null} [value]\n * @returns {never}\n */\nexport function each_key_duplicate(a, b, value) {\n\tif (DEV) {\n\t\tconst error = new Error(`each_key_duplicate\\n${value\n\t\t\t? `Keyed each block has duplicate key \\`${value}\\` at indexes ${a} and ${b}`\n\t\t\t: `Keyed each block has duplicate key at indexes ${a} and ${b}`}\\nhttps://svelte.dev/e/each_key_duplicate`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/each_key_duplicate`);\n\t}\n}\n\n/**\n * `%rune%` cannot be used inside an effect cleanup function\n * @param {string} rune\n * @returns {never}\n */\nexport function effect_in_teardown(rune) {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_in_teardown\\n\\`${rune}\\` cannot be used inside an effect cleanup function\\nhttps://svelte.dev/e/effect_in_teardown`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_in_teardown`);\n\t}\n}\n\n/**\n * Effect cannot be created inside a `$derived` value that was not itself created inside an effect\n * @returns {never}\n */\nexport function effect_in_unowned_derived() {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_in_unowned_derived\\nEffect cannot be created inside a \\`$derived\\` value that was not itself created inside an effect\\nhttps://svelte.dev/e/effect_in_unowned_derived`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_in_unowned_derived`);\n\t}\n}\n\n/**\n * `%rune%` can only be used inside an effect (e.g. during component initialisation)\n * @param {string} rune\n * @returns {never}\n */\nexport function effect_orphan(rune) {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_orphan\\n\\`${rune}\\` can only be used inside an effect (e.g. during component initialisation)\\nhttps://svelte.dev/e/effect_orphan`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_orphan`);\n\t}\n}\n\n/**\n * Maximum update depth exceeded. This can happen when a reactive block or effect repeatedly sets a new value. Svelte limits the number of nested updates to prevent infinite loops\n * @returns {never}\n */\nexport function effect_update_depth_exceeded() {\n\tif (DEV) {\n\t\tconst error = new Error(`effect_update_depth_exceeded\\nMaximum update depth exceeded. This can happen when a reactive block or effect repeatedly sets a new value. Svelte limits the number of nested updates to prevent infinite loops\\nhttps://svelte.dev/e/effect_update_depth_exceeded`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/effect_update_depth_exceeded`);\n\t}\n}\n\n/**\n * `getAbortSignal()` can only be called inside an effect or derived\n * @returns {never}\n */\nexport function get_abort_signal_outside_reaction() {\n\tif (DEV) {\n\t\tconst error = new Error(`get_abort_signal_outside_reaction\\n\\`getAbortSignal()\\` can only be called inside an effect or derived\\nhttps://svelte.dev/e/get_abort_signal_outside_reaction`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/get_abort_signal_outside_reaction`);\n\t}\n}\n\n/**\n * Failed to hydrate the application\n * @returns {never}\n */\nexport function hydration_failed() {\n\tif (DEV) {\n\t\tconst error = new Error(`hydration_failed\\nFailed to hydrate the application\\nhttps://svelte.dev/e/hydration_failed`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/hydration_failed`);\n\t}\n}\n\n/**\n * Could not `{@render}` snippet due to the expression being `null` or `undefined`. Consider using optional chaining `{@render snippet?.()}`\n * @returns {never}\n */\nexport function invalid_snippet() {\n\tif (DEV) {\n\t\tconst error = new Error(`invalid_snippet\\nCould not \\`{@render}\\` snippet due to the expression being \\`null\\` or \\`undefined\\`. Consider using optional chaining \\`{@render snippet?.()}\\`\\nhttps://svelte.dev/e/invalid_snippet`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/invalid_snippet`);\n\t}\n}\n\n/**\n * `%name%(...)` cannot be used in runes mode\n * @param {string} name\n * @returns {never}\n */\nexport function lifecycle_legacy_only(name) {\n\tif (DEV) {\n\t\tconst error = new Error(`lifecycle_legacy_only\\n\\`${name}(...)\\` cannot be used in runes mode\\nhttps://svelte.dev/e/lifecycle_legacy_only`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/lifecycle_legacy_only`);\n\t}\n}\n\n/**\n * Cannot do `bind:%key%={undefined}` when `%key%` has a fallback value\n * @param {string} key\n * @returns {never}\n */\nexport function props_invalid_value(key) {\n\tif (DEV) {\n\t\tconst error = new Error(`props_invalid_value\\nCannot do \\`bind:${key}={undefined}\\` when \\`${key}\\` has a fallback value\\nhttps://svelte.dev/e/props_invalid_value`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/props_invalid_value`);\n\t}\n}\n\n/**\n * Rest element properties of `$props()` such as `%property%` are readonly\n * @param {string} property\n * @returns {never}\n */\nexport function props_rest_readonly(property) {\n\tif (DEV) {\n\t\tconst error = new Error(`props_rest_readonly\\nRest element properties of \\`$props()\\` such as \\`${property}\\` are readonly\\nhttps://svelte.dev/e/props_rest_readonly`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/props_rest_readonly`);\n\t}\n}\n\n/**\n * The `%rune%` rune is only available inside `.svelte` and `.svelte.js/ts` files\n * @param {string} rune\n * @returns {never}\n */\nexport function rune_outside_svelte(rune) {\n\tif (DEV) {\n\t\tconst error = new Error(`rune_outside_svelte\\nThe \\`${rune}\\` rune is only available inside \\`.svelte\\` and \\`.svelte.js/ts\\` files\\nhttps://svelte.dev/e/rune_outside_svelte`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/rune_outside_svelte`);\n\t}\n}\n\n/**\n * Property descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\n * @returns {never}\n */\nexport function state_descriptors_fixed() {\n\tif (DEV) {\n\t\tconst error = new Error(`state_descriptors_fixed\\nProperty descriptors defined on \\`$state\\` objects must contain \\`value\\` and always be \\`enumerable\\`, \\`configurable\\` and \\`writable\\`.\\nhttps://svelte.dev/e/state_descriptors_fixed`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/state_descriptors_fixed`);\n\t}\n}\n\n/**\n * Cannot set prototype of `$state` object\n * @returns {never}\n */\nexport function state_prototype_fixed() {\n\tif (DEV) {\n\t\tconst error = new Error(`state_prototype_fixed\\nCannot set prototype of \\`$state\\` object\\nhttps://svelte.dev/e/state_prototype_fixed`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/state_prototype_fixed`);\n\t}\n}\n\n/**\n * Updating state inside `$derived(...)`, `$inspect(...)` or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\n * @returns {never}\n */\nexport function state_unsafe_mutation() {\n\tif (DEV) {\n\t\tconst error = new Error(`state_unsafe_mutation\\nUpdating state inside \\`$derived(...)\\`, \\`$inspect(...)\\` or a template expression is forbidden. If the value should not be reactive, declare it without \\`$state\\`\\nhttps://svelte.dev/e/state_unsafe_mutation`);\n\n\t\terror.name = 'Svelte error';\n\n\t\tthrow error;\n\t} else {\n\t\tthrow new Error(`https://svelte.dev/e/state_unsafe_mutation`);\n\t}\n}","/** @import { Derived, Effect } from '#client' */\nimport { DEV } from 'esm-env';\nimport { CLEAN, DERIVED, DIRTY, EFFECT_PRESERVED, MAYBE_DIRTY, UNOWNED } from '#client/constants';\nimport {\n\tactive_reaction,\n\tactive_effect,\n\tset_signal_status,\n\tskip_reaction,\n\tupdate_reaction,\n\tincrement_write_version,\n\tset_active_effect,\n\tpush_reaction_value,\n\tis_destroying_effect\n} from '../runtime.js';\nimport { equals, safe_equals } from './equality.js';\nimport * as e from '../errors.js';\nimport { destroy_effect } from './effects.js';\nimport { inspect_effects, set_inspect_effects } from './sources.js';\nimport { get_stack } from '../dev/tracing.js';\nimport { tracing_mode_flag } from '../../flags/index.js';\nimport { component_context } from '../context.js';\nimport { UNINITIALIZED } from '../../../constants.js';\n\n/**\n * @template V\n * @param {() => V} fn\n * @returns {Derived<V>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function derived(fn) {\n\tvar flags = DERIVED | DIRTY;\n\tvar parent_derived =\n\t\tactive_reaction !== null && (active_reaction.f & DERIVED) !== 0\n\t\t\t? /** @type {Derived} */ (active_reaction)\n\t\t\t: null;\n\n\tif (active_effect === null || (parent_derived !== null && (parent_derived.f & UNOWNED) !== 0)) {\n\t\tflags |= UNOWNED;\n\t} else {\n\t\t// Since deriveds are evaluated lazily, any effects created inside them are\n\t\t// created too late to ensure that the parent effect is added to the tree\n\t\tactive_effect.f |= EFFECT_PRESERVED;\n\t}\n\n\t/** @type {Derived<V>} */\n\tconst signal = {\n\t\tctx: component_context,\n\t\tdeps: null,\n\t\teffects: null,\n\t\tequals,\n\t\tf: flags,\n\t\tfn,\n\t\treactions: null,\n\t\trv: 0,\n\t\tv: /** @type {V} */ (UNINITIALIZED),\n\t\twv: 0,\n\t\tparent: parent_derived ?? active_effect,\n\t\tac: null\n\t};\n\n\tif (DEV && tracing_mode_flag) {\n\t\tsignal.created = get_stack('CreatedAt');\n\t}\n\n\treturn signal;\n}\n\n/**\n * @template V\n * @param {() => V} fn\n * @returns {Derived<V>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function user_derived(fn) {\n\tconst d = derived(fn);\n\n\tpush_reaction_value(d);\n\n\treturn d;\n}\n\n/**\n * @template V\n * @param {() => V} fn\n * @returns {Derived<V>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function derived_safe_equal(fn) {\n\tconst signal = derived(fn);\n\tsignal.equals = safe_equals;\n\treturn signal;\n}\n\n/**\n * @param {Derived} derived\n * @returns {void}\n */\nexport function destroy_derived_effects(derived) {\n\tvar effects = derived.effects;\n\n\tif (effects !== null) {\n\t\tderived.effects = null;\n\n\t\tfor (var i = 0; i < effects.length; i += 1) {\n\t\t\tdestroy_effect(/** @type {Effect} */ (effects[i]));\n\t\t}\n\t}\n}\n\n/**\n * The currently updating deriveds, used to detect infinite recursion\n * in dev mode and provide a nicer error than 'too much recursion'\n * @type {Derived[]}\n */\nlet stack = [];\n\n/**\n * @param {Derived} derived\n * @returns {Effect | null}\n */\nfunction get_derived_parent_effect(derived) {\n\tvar parent = derived.parent;\n\twhile (parent !== null) {\n\t\tif ((parent.f & DERIVED) === 0) {\n\t\t\treturn /** @type {Effect} */ (parent);\n\t\t}\n\t\tparent = parent.parent;\n\t}\n\treturn null;\n}\n\n/**\n * @template T\n * @param {Derived} derived\n * @returns {T}\n */\nexport function execute_derived(derived) {\n\tvar value;\n\tvar prev_active_effect = active_effect;\n\n\tset_active_effect(get_derived_parent_effect(derived));\n\n\tif (DEV) {\n\t\tlet prev_inspect_effects = inspect_effects;\n\t\tset_inspect_effects(new Set());\n\t\ttry {\n\t\t\tif (stack.includes(derived)) {\n\t\t\t\te.derived_references_self();\n\t\t\t}\n\n\t\t\tstack.push(derived);\n\n\t\t\tdestroy_derived_effects(derived);\n\t\t\tvalue = update_reaction(derived);\n\t\t} finally {\n\t\t\tset_active_effect(prev_active_effect);\n\t\t\tset_inspect_effects(prev_inspect_effects);\n\t\t\tstack.pop();\n\t\t}\n\t} else {\n\t\ttry {\n\t\t\tdestroy_derived_effects(derived);\n\t\t\tvalue = update_reaction(derived);\n\t\t} finally {\n\t\t\tset_active_effect(prev_active_effect);\n\t\t}\n\t}\n\n\treturn value;\n}\n\n/**\n * @param {Derived} derived\n * @returns {void}\n */\nexport function update_derived(derived) {\n\tvar value = execute_derived(derived);\n\n\tif (!derived.equals(value)) {\n\t\tderived.v = value;\n\t\tderived.wv = increment_write_version();\n\t}\n\n\t// don't mark derived clean if we're reading it inside a\n\t// cleanup function, or it will cache a stale value\n\tif (is_destroying_effect) return;\n\n\tvar status =\n\t\t(skip_reaction || (derived.f & UNOWNED) !== 0) && derived.deps !== null ? MAYBE_DIRTY : CLEAN;\n\n\tset_signal_status(derived, status);\n}\n","/** @import { Derived, Effect, Source, Value } from '#client' */\nimport { DEV } from 'esm-env';\nimport {\n\tactive_reaction,\n\tactive_effect,\n\tuntracked_writes,\n\tget,\n\tschedule_effect,\n\tset_untracked_writes,\n\tset_signal_status,\n\tuntrack,\n\tincrement_write_version,\n\tupdate_effect,\n\tcurrent_sources,\n\tcheck_dirtiness,\n\tuntracking,\n\tis_destroying_effect,\n\tpush_reaction_value\n} from '../runtime.js';\nimport { equals, safe_equals } from './equality.js';\nimport {\n\tCLEAN,\n\tDERIVED,\n\tDIRTY,\n\tBRANCH_EFFECT,\n\tINSPECT_EFFECT,\n\tUNOWNED,\n\tMAYBE_DIRTY,\n\tBLOCK_EFFECT,\n\tROOT_EFFECT\n} from '#client/constants';\nimport * as e from '../errors.js';\nimport { legacy_mode_flag, tracing_mode_flag } from '../../flags/index.js';\nimport { get_stack, tag_proxy } from '../dev/tracing.js';\nimport { component_context, is_runes } from '../context.js';\nimport { proxy } from '../proxy.js';\nimport { execute_derived } from './deriveds.js';\n\nexport let inspect_effects = new Set();\n\n/** @type {Map<Source, any>} */\nexport const old_values = new Map();\n\n/**\n * @param {Set<any>} v\n */\nexport function set_inspect_effects(v) {\n\tinspect_effects = v;\n}\n\n/**\n * @template V\n * @param {V} v\n * @param {Error | null} [stack]\n * @returns {Source<V>}\n */\n// TODO rename this to `state` throughout the codebase\nexport function source(v, stack) {\n\t/** @type {Value} */\n\tvar signal = {\n\t\tf: 0, // TODO ideally we could skip this altogether, but it causes type errors\n\t\tv,\n\t\treactions: null,\n\t\tequals,\n\t\trv: 0,\n\t\twv: 0\n\t};\n\n\tif (DEV && tracing_mode_flag) {\n\t\tsignal.created = stack ?? get_stack('CreatedAt');\n\t\tsignal.updated = null;\n\t\tsignal.set_during_effect = false;\n\t\tsignal.trace = null;\n\t}\n\n\treturn signal;\n}\n\n/**\n * @template V\n * @param {V} v\n * @param {Error | null} [stack]\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function state(v, stack) {\n\tconst s = source(v, stack);\n\n\tpush_reaction_value(s);\n\n\treturn s;\n}\n\n/**\n * @template V\n * @param {V} initial_value\n * @param {boolean} [immutable]\n * @returns {Source<V>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function mutable_source(initial_value, immutable = false, trackable = true) {\n\tconst s = source(initial_value);\n\tif (!immutable) {\n\t\ts.equals = safe_equals;\n\t}\n\n\t// bind the signal to the component context, in case we need to\n\t// track updates to trigger beforeUpdate/afterUpdate callbacks\n\tif (legacy_mode_flag && trackable && component_context !== null && component_context.l !== null) {\n\t\t(component_context.l.s ??= []).push(s);\n\t}\n\n\treturn s;\n}\n\n/**\n * @template V\n * @param {Value<V>} source\n * @param {V} value\n */\nexport function mutate(source, value) {\n\tset(\n\t\tsource,\n\t\tuntrack(() => get(source))\n\t);\n\treturn value;\n}\n\n/**\n * @template V\n * @param {Source<V>} source\n * @param {V} value\n * @param {boolean} [should_proxy]\n * @returns {V}\n */\nexport function set(source, value, should_proxy = false) {\n\tif (\n\t\tactive_reaction !== null &&\n\t\t// since we are untracking the function inside `$inspect.with` we need to add this check\n\t\t// to ensure we error if state is set inside an inspect effect\n\t\t(!untracking || (active_reaction.f & INSPECT_EFFECT) !== 0) &&\n\t\tis_runes() &&\n\t\t(active_reaction.f & (DERIVED | BLOCK_EFFECT | INSPECT_EFFECT)) !== 0 &&\n\t\t!current_sources?.includes(source)\n\t) {\n\t\te.state_unsafe_mutation();\n\t}\n\n\tlet new_value = should_proxy ? proxy(value) : value;\n\n\tif (DEV) {\n\t\ttag_proxy(new_value, /** @type {string} */ (source.label));\n\t}\n\n\treturn internal_set(source, new_value);\n}\n\n/**\n * @template V\n * @param {Source<V>} source\n * @param {V} value\n * @returns {V}\n */\nexport function internal_set(source, value) {\n\tif (!source.equals(value)) {\n\t\tvar old_value = source.v;\n\n\t\tif (is_destroying_effect) {\n\t\t\told_values.set(source, value);\n\t\t} else {\n\t\t\told_values.set(source, old_value);\n\t\t}\n\n\t\tsource.v = value;\n\n\t\tif (DEV && tracing_mode_flag) {\n\t\t\tsource.updated = get_stack('UpdatedAt');\n\n\t\t\tif (active_effect !== null) {\n\t\t\t\tsource.set_during_effect = true;\n\t\t\t}\n\t\t}\n\n\t\tif ((source.f & DERIVED) !== 0) {\n\t\t\t// if we are assigning to a dirty derived we set it to clean/maybe dirty but we also eagerly execute it to track the dependencies\n\t\t\tif ((source.f & DIRTY) !== 0) {\n\t\t\t\texecute_derived(/** @type {Derived} */ (source));\n\t\t\t}\n\t\t\tset_signal_status(source, (source.f & UNOWNED) === 0 ? CLEAN : MAYBE_DIRTY);\n\t\t}\n\n\t\tsource.wv = increment_write_version();\n\n\t\tmark_reactions(source, DIRTY);\n\n\t\t// It's possible that the current reaction might not have up-to-date dependencies\n\t\t// whilst it's actively running. So in the case of ensuring it registers the reaction\n\t\t// properly for itself, we need to ensure the current effect actually gets\n\t\t// scheduled. i.e: `$effect(() => x++)`\n\t\tif (\n\t\t\tis_runes() &&\n\t\t\tactive_effect !== null &&\n\t\t\t(active_effect.f & CLEAN) !== 0 &&\n\t\t\t(active_effect.f & (BRANCH_EFFECT | ROOT_EFFECT)) === 0\n\t\t) {\n\t\t\tif (untracked_writes === null) {\n\t\t\t\tset_untracked_writes([source]);\n\t\t\t} else {\n\t\t\t\tuntracked_writes.push(source);\n\t\t\t}\n\t\t}\n\n\t\tif (DEV && inspect_effects.size > 0) {\n\t\t\tconst inspects = Array.from(inspect_effects);\n\n\t\t\tfor (const effect of inspects) {\n\t\t\t\t// Mark clean inspect-effects as maybe dirty and then check their dirtiness\n\t\t\t\t// instead of just updating the effects - this way we avoid overfiring.\n\t\t\t\tif ((effect.f & CLEAN) !== 0) {\n\t\t\t\t\tset_signal_status(effect, MAYBE_DIRTY);\n\t\t\t\t}\n\t\t\t\tif (check_dirtiness(effect)) {\n\t\t\t\t\tupdate_effect(effect);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tinspect_effects.clear();\n\t\t}\n\t}\n\n\treturn value;\n}\n\n/**\n * @template {number | bigint} T\n * @param {Source<T>} source\n * @param {1 | -1} [d]\n * @returns {T}\n */\nexport function update(source, d = 1) {\n\tvar value = get(source);\n\tvar result = d === 1 ? value++ : value--;\n\n\tset(source, value);\n\n\t// @ts-expect-error\n\treturn result;\n}\n\n/**\n * @template {number | bigint} T\n * @param {Source<T>} source\n * @param {1 | -1} [d]\n * @returns {T}\n */\nexport function update_pre(source, d = 1) {\n\tvar value = get(source);\n\n\t// @ts-expect-error\n\treturn set(source, d === 1 ? ++value : --value);\n}\n\n/**\n * Silently (without using `get`) increment a source\n * @param {Source<number>} source\n */\nexport function increment(source) {\n\tset(source, source.v + 1);\n}\n\n/**\n * @param {Value} signal\n * @param {number} status should be DIRTY or MAYBE_DIRTY\n * @returns {void}\n */\nfunction mark_reactions(signal, status) {\n\tvar reactions = signal.reactions;\n\tif (reactions === null) return;\n\n\tvar runes = is_runes();\n\tvar length = reactions.length;\n\n\tfor (var i = 0; i < length; i++) {\n\t\tvar reaction = reactions[i];\n\t\tvar flags = reaction.f;\n\n\t\t// Skip any effects that are already dirty\n\t\tif ((flags & DIRTY) !== 0) continue;\n\n\t\t// In legacy mode, skip the current effect to prevent infinite loops\n\t\tif (!runes && reaction === active_effect) continue;\n\n\t\t// Inspect effects need to run immediately, so that the stack trace makes sense\n\t\tif (DEV && (flags & INSPECT_EFFECT) !== 0) {\n\t\t\tinspect_effects.add(reaction);\n\t\t\tcontinue;\n\t\t}\n\n\t\tset_signal_status(reaction, status);\n\n\t\t// If the signal a) was previously clean or b) is an unowned derived, then mark it\n\t\tif ((flags & (CLEAN | UNOWNED)) !== 0) {\n\t\t\tif ((flags & DERIVED) !== 0) {\n\t\t\t\tmark_reactions(/** @type {Derived} */ (reaction), MAYBE_DIRTY);\n\t\t\t} else {\n\t\t\t\tschedule_effect(/** @type {Effect} */ (reaction));\n\t\t\t}\n\t\t}\n\t}\n}\n","/** @import { Derived, Effect, Reaction, Signal, Source, Value } from '#client' */\nimport { DEV } from 'esm-env';\nimport { define_property, get_descriptors, get_prototype_of, index_of } from '../shared/utils.js';\nimport {\n\tdestroy_block_effect_children,\n\tdestroy_effect_children,\n\texecute_effect_teardown,\n\tunlink_effect\n} from './reactivity/effects.js';\nimport {\n\tEFFECT,\n\tDIRTY,\n\tMAYBE_DIRTY,\n\tCLEAN,\n\tDERIVED,\n\tUNOWNED,\n\tDESTROYED,\n\tINERT,\n\tBRANCH_EFFECT,\n\tSTATE_SYMBOL,\n\tBLOCK_EFFECT,\n\tROOT_EFFECT,\n\tDISCONNECTED,\n\tEFFECT_IS_UPDATING,\n\tSTALE_REACTION,\n\tUSER_EFFECT\n} from './constants.js';\nimport { flush_tasks } from './dom/task.js';\nimport { internal_set, old_values } from './reactivity/sources.js';\nimport { destroy_derived_effects, execute_derived, update_derived } from './reactivity/deriveds.js';\nimport * as e from './errors.js';\n\nimport { tracing_mode_flag } from '../flags/index.js';\nimport { tracing_expressions, get_stack } from './dev/tracing.js';\nimport {\n\tcomponent_context,\n\tdev_current_component_function,\n\tdev_stack,\n\tis_runes,\n\tset_component_context,\n\tset_dev_current_component_function,\n\tset_dev_stack\n} from './context.js';\nimport { handle_error, invoke_error_boundary } from './error-handling.js';\nimport { UNINITIALIZED } from '../../constants.js';\n\nlet is_flushing = false;\n\n/** @type {Effect | null} */\nlet last_scheduled_effect = null;\n\nlet is_updating_effect = false;\n\nexport let is_destroying_effect = false;\n\n/** @param {boolean} value */\nexport function set_is_destroying_effect(value) {\n\tis_destroying_effect = value;\n}\n\n// Handle effect queues\n\n/** @type {Effect[]} */\nlet queued_root_effects = [];\n\n/** @type {Effect[]} Stack of effects, dev only */\nlet dev_effect_stack = [];\n// Handle signal reactivity tree dependencies and reactions\n\n/** @type {null | Reaction} */\nexport let active_reaction = null;\n\nexport let untracking = false;\n\n/** @param {null | Reaction} reaction */\nexport function set_active_reaction(reaction) {\n\tactive_reaction = reaction;\n}\n\n/** @type {null | Effect} */\nexport let active_effect = null;\n\n/** @param {null | Effect} effect */\nexport function set_active_effect(effect) {\n\tactive_effect = effect;\n}\n\n/**\n * When sources are created within a reaction, reading and writing\n * them within that reaction should not cause a re-run\n * @type {null | Source[]}\n */\nexport let current_sources = null;\n\n/** @param {Value} value */\nexport function push_reaction_value(value) {\n\tif (active_reaction !== null && active_reaction.f & EFFECT_IS_UPDATING) {\n\t\tif (current_sources === null) {\n\t\t\tcurrent_sources = [value];\n\t\t} else {\n\t\t\tcurrent_sources.push(value);\n\t\t}\n\t}\n}\n\n/**\n * The dependencies of the reaction that is currently being executed. In many cases,\n * the dependencies are unchanged between runs, and so this will be `null` unless\n * and until a new dependency is accessed — we track this via `skipped_deps`\n * @type {null | Value[]}\n */\nlet new_deps = null;\n\nlet skipped_deps = 0;\n\n/**\n * Tracks writes that the effect it's executed in doesn't listen to yet,\n * so that the dependency can be added to the effect later on if it then reads it\n * @type {null | Source[]}\n */\nexport let untracked_writes = null;\n\n/** @param {null | Source[]} value */\nexport function set_untracked_writes(value) {\n\tuntracked_writes = value;\n}\n\n/**\n * @type {number} Used by sources and deriveds for handling updates.\n * Version starts from 1 so that unowned deriveds differentiate between a created effect and a run one for tracing\n **/\nlet write_version = 1;\n\n/** @type {number} Used to version each read of a source of derived to avoid duplicating depedencies inside a reaction */\nlet read_version = 0;\n\nexport let update_version = read_version;\n\n/** @param {number} value */\nexport function set_update_version(value) {\n\tupdate_version = value;\n}\n\n// If we are working with a get() chain that has no active container,\n// to prevent memory leaks, we skip adding the reaction.\nexport let skip_reaction = false;\n// Handle collecting all signals which are read during a specific time frame\n/** @type {Set<Value> | null} */\nexport let captured_signals = null;\n\n/** @param {Set<Value> | null} value */\nexport function set_captured_signals(value) {\n\tcaptured_signals = value;\n}\n\nexport function increment_write_version() {\n\treturn ++write_version;\n}\n\n/**\n * Determines whether a derived or effect is dirty.\n * If it is MAYBE_DIRTY, will set the status to CLEAN\n * @param {Reaction} reaction\n * @returns {boolean}\n */\nexport function check_dirtiness(reaction) {\n\tvar flags = reaction.f;\n\n\tif ((flags & DIRTY) !== 0) {\n\t\treturn true;\n\t}\n\n\tif ((flags & MAYBE_DIRTY) !== 0) {\n\t\tvar dependencies = reaction.deps;\n\t\tvar is_unowned = (flags & UNOWNED) !== 0;\n\n\t\tif (dependencies !== null) {\n\t\t\tvar i;\n\t\t\tvar dependency;\n\t\t\tvar is_disconnected = (flags & DISCONNECTED) !== 0;\n\t\t\tvar is_unowned_connected = is_unowned && active_effect !== null && !skip_reaction;\n\t\t\tvar length = dependencies.length;\n\n\t\t\t// If we are working with a disconnected or an unowned signal that is now connected (due to an active effect)\n\t\t\t// then we need to re-connect the reaction to the dependency\n\t\t\tif (is_disconnected || is_unowned_connected) {\n\t\t\t\tvar derived = /** @type {Derived} */ (reaction);\n\t\t\t\tvar parent = derived.parent;\n\n\t\t\t\tfor (i = 0; i < length; i++) {\n\t\t\t\t\tdependency = dependencies[i];\n\n\t\t\t\t\t// We always re-add all reactions (even duplicates) if the derived was\n\t\t\t\t\t// previously disconnected, however we don't if it was unowned as we\n\t\t\t\t\t// de-duplicate dependencies in that case\n\t\t\t\t\tif (is_disconnected || !dependency?.reactions?.includes(derived)) {\n\t\t\t\t\t\t(dependency.reactions ??= []).push(derived);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (is_disconnected) {\n\t\t\t\t\tderived.f ^= DISCONNECTED;\n\t\t\t\t}\n\t\t\t\t// If the unowned derived is now fully connected to the graph again (it's unowned and reconnected, has a parent\n\t\t\t\t// and the parent is not unowned), then we can mark it as connected again, removing the need for the unowned\n\t\t\t\t// flag\n\t\t\t\tif (is_unowned_connected && parent !== null && (parent.f & UNOWNED) === 0) {\n\t\t\t\t\tderived.f ^= UNOWNED;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0; i < length; i++) {\n\t\t\t\tdependency = dependencies[i];\n\n\t\t\t\tif (check_dirtiness(/** @type {Derived} */ (dependency))) {\n\t\t\t\t\tupdate_derived(/** @type {Derived} */ (dependency));\n\t\t\t\t}\n\n\t\t\t\tif (dependency.wv > reaction.wv) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Unowned signals should never be marked as clean unless they\n\t\t// are used within an active_effect without skip_reaction\n\t\tif (!is_unowned || (active_effect !== null && !skip_reaction)) {\n\t\t\tset_signal_status(reaction, CLEAN);\n\t\t}\n\t}\n\n\treturn false;\n}\n\n/**\n * @param {Value} signal\n * @param {Effect} effect\n * @param {boolean} [root]\n */\nfunction schedule_possible_effect_self_invalidation(signal, effect, root = true) {\n\tvar reactions = signal.reactions;\n\tif (reactions === null) return;\n\n\tif (current_sources?.includes(signal)) {\n\t\treturn;\n\t}\n\n\tfor (var i = 0; i < reactions.length; i++) {\n\t\tvar reaction = reactions[i];\n\n\t\tif ((reaction.f & DERIVED) !== 0) {\n\t\t\tschedule_possible_effect_self_invalidation(/** @type {Derived} */ (reaction), effect, false);\n\t\t} else if (effect === reaction) {\n\t\t\tif (root) {\n\t\t\t\tset_signal_status(reaction, DIRTY);\n\t\t\t} else if ((reaction.f & CLEAN) !== 0) {\n\t\t\t\tset_signal_status(reaction, MAYBE_DIRTY);\n\t\t\t}\n\t\t\tschedule_effect(/** @type {Effect} */ (reaction));\n\t\t}\n\t}\n}\n\n/** @param {Reaction} reaction */\nexport function update_reaction(reaction) {\n\tvar previous_deps = new_deps;\n\tvar previous_skipped_deps = skipped_deps;\n\tvar previous_untracked_writes = untracked_writes;\n\tvar previous_reaction = active_reaction;\n\tvar previous_skip_reaction = skip_reaction;\n\tvar previous_sources = current_sources;\n\tvar previous_component_context = component_context;\n\tvar previous_untracking = untracking;\n\tvar previous_update_version = update_version;\n\n\tvar flags = reaction.f;\n\n\tnew_deps = /** @type {null | Value[]} */ (null);\n\tskipped_deps = 0;\n\tuntracked_writes = null;\n\tskip_reaction =\n\t\t(flags & UNOWNED) !== 0 && (untracking || !is_updating_effect || active_reaction === null);\n\tactive_reaction = (flags & (BRANCH_EFFECT | ROOT_EFFECT)) === 0 ? reaction : null;\n\n\tcurrent_sources = null;\n\tset_component_context(reaction.ctx);\n\tuntracking = false;\n\tupdate_version = ++read_version;\n\n\treaction.f |= EFFECT_IS_UPDATING;\n\n\tif (reaction.ac !== null) {\n\t\treaction.ac.abort(STALE_REACTION);\n\t\treaction.ac = null;\n\t}\n\n\ttry {\n\t\tvar result = /** @type {Function} */ (0, reaction.fn)();\n\t\tvar deps = reaction.deps;\n\n\t\tif (new_deps !== null) {\n\t\t\tvar i;\n\n\t\t\tremove_reactions(reaction, skipped_deps);\n\n\t\t\tif (deps !== null && skipped_deps > 0) {\n\t\t\t\tdeps.length = skipped_deps + new_deps.length;\n\t\t\t\tfor (i = 0; i < new_deps.length; i++) {\n\t\t\t\t\tdeps[skipped_deps + i] = new_deps[i];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treaction.deps = deps = new_deps;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!skip_reaction ||\n\t\t\t\t// Deriveds that already have reactions can cleanup, so we still add them as reactions\n\t\t\t\t((flags & DERIVED) !== 0 &&\n\t\t\t\t\t/** @type {import('#client').Derived} */ (reaction).reactions !== null)\n\t\t\t) {\n\t\t\t\tfor (i = skipped_deps; i < deps.length; i++) {\n\t\t\t\t\t(deps[i].reactions ??= []).push(reaction);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (deps !== null && skipped_deps < deps.length) {\n\t\t\tremove_reactions(reaction, skipped_deps);\n\t\t\tdeps.length = skipped_deps;\n\t\t}\n\n\t\t// If we're inside an effect and we have untracked writes, then we need to\n\t\t// ensure that if any of those untracked writes result in re-invalidation\n\t\t// of the current effect, then that happens accordingly\n\t\tif (\n\t\t\tis_runes() &&\n\t\t\tuntracked_writes !== null &&\n\t\t\t!untracking &&\n\t\t\tdeps !== null &&\n\t\t\t(reaction.f & (DERIVED | MAYBE_DIRTY | DIRTY)) === 0\n\t\t) {\n\t\t\tfor (i = 0; i < /** @type {Source[]} */ (untracked_writes).length; i++) {\n\t\t\t\tschedule_possible_effect_self_invalidation(\n\t\t\t\t\tuntracked_writes[i],\n\t\t\t\t\t/** @type {Effect} */ (reaction)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// If we are returning to an previous reaction then\n\t\t// we need to increment the read version to ensure that\n\t\t// any dependencies in this reaction aren't marked with\n\t\t// the same version\n\t\tif (previous_reaction !== null && previous_reaction !== reaction) {\n\t\t\tread_version++;\n\n\t\t\tif (untracked_writes !== null) {\n\t\t\t\tif (previous_untracked_writes === null) {\n\t\t\t\t\tprevious_untracked_writes = untracked_writes;\n\t\t\t\t} else {\n\t\t\t\t\tprevious_untracked_writes.push(.../** @type {Source[]} */ (untracked_writes));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t} catch (error) {\n\t\thandle_error(error);\n\t} finally {\n\t\tnew_deps = previous_deps;\n\t\tskipped_deps = previous_skipped_deps;\n\t\tuntracked_writes = previous_untracked_writes;\n\t\tactive_reaction = previous_reaction;\n\t\tskip_reaction = previous_skip_reaction;\n\t\tcurrent_sources = previous_sources;\n\t\tset_component_context(previous_component_context);\n\t\tuntracking = previous_untracking;\n\t\tupdate_version = previous_update_version;\n\n\t\treaction.f ^= EFFECT_IS_UPDATING;\n\t}\n}\n\n/**\n * @template V\n * @param {Reaction} signal\n * @param {Value<V>} dependency\n * @returns {void}\n */\nfunction remove_reaction(signal, dependency) {\n\tlet reactions = dependency.reactions;\n\tif (reactions !== null) {\n\t\tvar index = index_of.call(reactions, signal);\n\t\tif (index !== -1) {\n\t\t\tvar new_length = reactions.length - 1;\n\t\t\tif (new_length === 0) {\n\t\t\t\treactions = dependency.reactions = null;\n\t\t\t} else {\n\t\t\t\t// Swap with last element and then remove.\n\t\t\t\treactions[index] = reactions[new_length];\n\t\t\t\treactions.pop();\n\t\t\t}\n\t\t}\n\t}\n\t// If the derived has no reactions, then we can disconnect it from the graph,\n\t// allowing it to either reconnect in the future, or be GC'd by the VM.\n\tif (\n\t\treactions === null &&\n\t\t(dependency.f & DERIVED) !== 0 &&\n\t\t// Destroying a child effect while updating a parent effect can cause a dependency to appear\n\t\t// to be unused, when in fact it is used by the currently-updating parent. Checking `new_deps`\n\t\t// allows us to skip the expensive work of disconnecting and immediately reconnecting it\n\t\t(new_deps === null || !new_deps.includes(dependency))\n\t) {\n\t\tset_signal_status(dependency, MAYBE_DIRTY);\n\t\t// If we are working with a derived that is owned by an effect, then mark it as being\n\t\t// disconnected.\n\t\tif ((dependency.f & (UNOWNED | DISCONNECTED)) === 0) {\n\t\t\tdependency.f ^= DISCONNECTED;\n\t\t}\n\t\t// Disconnect any reactions owned by this reaction\n\t\tdestroy_derived_effects(/** @type {Derived} **/ (dependency));\n\t\tremove_reactions(/** @type {Derived} **/ (dependency), 0);\n\t}\n}\n\n/**\n * @param {Reaction} signal\n * @param {number} start_index\n * @returns {void}\n */\nexport function remove_reactions(signal, start_index) {\n\tvar dependencies = signal.deps;\n\tif (dependencies === null) return;\n\n\tfor (var i = start_index; i < dependencies.length; i++) {\n\t\tremove_reaction(signal, dependencies[i]);\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @returns {void}\n */\nexport function update_effect(effect) {\n\tvar flags = effect.f;\n\n\tif ((flags & DESTROYED) !== 0) {\n\t\treturn;\n\t}\n\n\tset_signal_status(effect, CLEAN);\n\n\tvar previous_effect = active_effect;\n\tvar was_updating_effect = is_updating_effect;\n\n\tactive_effect = effect;\n\tis_updating_effect = true;\n\n\tif (DEV) {\n\t\tvar previous_component_fn = dev_current_component_function;\n\t\tset_dev_current_component_function(effect.component_function);\n\t\tvar previous_stack = /** @type {any} */ (dev_stack);\n\t\t// only block effects have a dev stack, keep the current one otherwise\n\t\tset_dev_stack(effect.dev_stack ?? dev_stack);\n\t}\n\n\ttry {\n\t\tif ((flags & BLOCK_EFFECT) !== 0) {\n\t\t\tdestroy_block_effect_children(effect);\n\t\t} else {\n\t\t\tdestroy_effect_children(effect);\n\t\t}\n\n\t\texecute_effect_teardown(effect);\n\t\tvar teardown = update_reaction(effect);\n\t\teffect.teardown = typeof teardown === 'function' ? teardown : null;\n\t\teffect.wv = write_version;\n\n\t\t// In DEV, increment versions of any sources that were written to during the effect,\n\t\t// so that they are correctly marked as dirty when the effect re-runs\n\t\tif (DEV && tracing_mode_flag && (effect.f & DIRTY) !== 0 && effect.deps !== null) {\n\t\t\tfor (var dep of effect.deps) {\n\t\t\t\tif (dep.set_during_effect) {\n\t\t\t\t\tdep.wv = increment_write_version();\n\t\t\t\t\tdep.set_during_effect = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (DEV) {\n\t\t\tdev_effect_stack.push(effect);\n\t\t}\n\t} finally {\n\t\tis_updating_effect = was_updating_effect;\n\t\tactive_effect = previous_effect;\n\n\t\tif (DEV) {\n\t\t\tset_dev_current_component_function(previous_component_fn);\n\t\t\tset_dev_stack(previous_stack);\n\t\t}\n\t}\n}\n\nfunction log_effect_stack() {\n\t// eslint-disable-next-line no-console\n\tconsole.error(\n\t\t'Last ten effects were: ',\n\t\tdev_effect_stack.slice(-10).map((d) => d.fn)\n\t);\n\tdev_effect_stack = [];\n}\n\nfunction infinite_loop_guard() {\n\ttry {\n\t\te.effect_update_depth_exceeded();\n\t} catch (error) {\n\t\tif (DEV) {\n\t\t\t// stack is garbage, ignore. Instead add a console.error message.\n\t\t\tdefine_property(error, 'stack', {\n\t\t\t\tvalue: ''\n\t\t\t});\n\t\t}\n\t\t// Try and handle the error so it can be caught at a boundary, that's\n\t\t// if there's an effect available from when it was last scheduled\n\t\tif (last_scheduled_effect !== null) {\n\t\t\tif (DEV) {\n\t\t\t\ttry {\n\t\t\t\t\tinvoke_error_boundary(error, last_scheduled_effect);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Only log the effect stack if the error is re-thrown\n\t\t\t\t\tlog_effect_stack();\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tinvoke_error_boundary(error, last_scheduled_effect);\n\t\t\t}\n\t\t} else {\n\t\t\tif (DEV) {\n\t\t\t\tlog_effect_stack();\n\t\t\t}\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nfunction flush_queued_root_effects() {\n\tvar was_updating_effect = is_updating_effect;\n\n\ttry {\n\t\tvar flush_count = 0;\n\t\tis_updating_effect = true;\n\n\t\twhile (queued_root_effects.length > 0) {\n\t\t\tif (flush_count++ > 1000) {\n\t\t\t\tinfinite_loop_guard();\n\t\t\t}\n\n\t\t\tvar root_effects = queued_root_effects;\n\t\t\tvar length = root_effects.length;\n\n\t\t\tqueued_root_effects = [];\n\n\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\tvar collected_effects = process_effects(root_effects[i]);\n\t\t\t\tflush_queued_effects(collected_effects);\n\t\t\t}\n\t\t\told_values.clear();\n\t\t}\n\t} finally {\n\t\tis_flushing = false;\n\t\tis_updating_effect = was_updating_effect;\n\n\t\tlast_scheduled_effect = null;\n\t\tif (DEV) {\n\t\t\tdev_effect_stack = [];\n\t\t}\n\t}\n}\n\n/**\n * @param {Array<Effect>} effects\n * @returns {void}\n */\nfunction flush_queued_effects(effects) {\n\tvar length = effects.length;\n\tif (length === 0) return;\n\n\tfor (var i = 0; i < length; i++) {\n\t\tvar effect = effects[i];\n\n\t\tif ((effect.f & (DESTROYED | INERT)) === 0) {\n\t\t\tif (check_dirtiness(effect)) {\n\t\t\t\tvar wv = write_version;\n\n\t\t\t\tupdate_effect(effect);\n\n\t\t\t\t// Effects with no dependencies or teardown do not get added to the effect tree.\n\t\t\t\t// Deferred effects (e.g. `$effect(...)`) _are_ added to the tree because we\n\t\t\t\t// don't know if we need to keep them until they are executed. Doing the check\n\t\t\t\t// here (rather than in `update_effect`) allows us to skip the work for\n\t\t\t\t// immediate effects.\n\t\t\t\tif (effect.deps === null && effect.first === null && effect.nodes_start === null) {\n\t\t\t\t\tif (effect.teardown === null) {\n\t\t\t\t\t\t// remove this effect from the graph\n\t\t\t\t\t\tunlink_effect(effect);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// keep the effect in the graph, but free up some memory\n\t\t\t\t\t\teffect.fn = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// if state is written in a user effect, abort and re-schedule, lest we run\n\t\t\t\t// effects that should be removed as a result of the state change\n\t\t\t\tif (write_version > wv && (effect.f & USER_EFFECT) !== 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (; i < length; i += 1) {\n\t\tschedule_effect(effects[i]);\n\t}\n}\n\n/**\n * @param {Effect} signal\n * @returns {void}\n */\nexport function schedule_effect(signal) {\n\tif (!is_flushing) {\n\t\tis_flushing = true;\n\t\tqueueMicrotask(flush_queued_root_effects);\n\t}\n\n\tvar effect = (last_scheduled_effect = signal);\n\n\twhile (effect.parent !== null) {\n\t\teffect = effect.parent;\n\t\tvar flags = effect.f;\n\n\t\tif ((flags & (ROOT_EFFECT | BRANCH_EFFECT)) !== 0) {\n\t\t\tif ((flags & CLEAN) === 0) return;\n\t\t\teffect.f ^= CLEAN;\n\t\t}\n\t}\n\n\tqueued_root_effects.push(effect);\n}\n\n/**\n *\n * This function both runs render effects and collects user effects in topological order\n * from the starting effect passed in. Effects will be collected when they match the filtered\n * bitwise flag passed in only. The collected effects array will be populated with all the user\n * effects to be flushed.\n *\n * @param {Effect} root\n * @returns {Effect[]}\n */\nfunction process_effects(root) {\n\t/** @type {Effect[]} */\n\tvar effects = [];\n\n\t/** @type {Effect | null} */\n\tvar effect = root;\n\n\twhile (effect !== null) {\n\t\tvar flags = effect.f;\n\t\tvar is_branch = (flags & (BRANCH_EFFECT | ROOT_EFFECT)) !== 0;\n\t\tvar is_skippable_branch = is_branch && (flags & CLEAN) !== 0;\n\n\t\tif (!is_skippable_branch && (flags & INERT) === 0) {\n\t\t\tif ((flags & EFFECT) !== 0) {\n\t\t\t\teffects.push(effect);\n\t\t\t} else if (is_branch) {\n\t\t\t\teffect.f ^= CLEAN;\n\t\t\t} else {\n\t\t\t\tif (check_dirtiness(effect)) {\n\t\t\t\t\tupdate_effect(effect);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/** @type {Effect | null} */\n\t\t\tvar child = effect.first;\n\n\t\t\tif (child !== null) {\n\t\t\t\teffect = child;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tvar parent = effect.parent;\n\t\teffect = effect.next;\n\n\t\twhile (effect === null && parent !== null) {\n\t\t\teffect = parent.next;\n\t\t\tparent = parent.parent;\n\t\t}\n\t}\n\n\treturn effects;\n}\n\n/**\n * Synchronously flush any pending updates.\n * Returns void if no callback is provided, otherwise returns the result of calling the callback.\n * @template [T=void]\n * @param {(() => T) | undefined} [fn]\n * @returns {T}\n */\nexport function flushSync(fn) {\n\tvar result;\n\n\tif (fn) {\n\t\tis_flushing = true;\n\t\tflush_queued_root_effects();\n\n\t\tis_flushing = true;\n\t\tresult = fn();\n\t}\n\n\twhile (true) {\n\t\tflush_tasks();\n\n\t\tif (queued_root_effects.length === 0) {\n\t\t\t// this would be reset in `flush_queued_root_effects` but since we are early returning here,\n\t\t\t// we need to reset it here as well in case the first time there's 0 queued root effects\n\t\t\tis_flushing = false;\n\t\t\tlast_scheduled_effect = null;\n\t\t\tif (DEV) {\n\t\t\t\tdev_effect_stack = [];\n\t\t\t}\n\t\t\treturn /** @type {T} */ (result);\n\t\t}\n\n\t\tis_flushing = true;\n\t\tflush_queued_root_effects();\n\t}\n}\n\n/**\n * Returns a promise that resolves once any pending state changes have been applied.\n * @returns {Promise<void>}\n */\nexport async function tick() {\n\tawait Promise.resolve();\n\t// By calling flushSync we guarantee that any pending state changes are applied after one tick.\n\t// TODO look into whether we can make flushing subsequent updates synchronously in the future.\n\tflushSync();\n}\n\n/**\n * @template V\n * @param {Value<V>} signal\n * @returns {V}\n */\nexport function get(signal) {\n\tvar flags = signal.f;\n\tvar is_derived = (flags & DERIVED) !== 0;\n\n\tif (captured_signals !== null) {\n\t\tcaptured_signals.add(signal);\n\t}\n\n\t// Register the dependency on the current reaction signal.\n\tif (active_reaction !== null && !untracking) {\n\t\tif (!current_sources?.includes(signal)) {\n\t\t\tvar deps = active_reaction.deps;\n\t\t\tif (signal.rv < read_version) {\n\t\t\t\tsignal.rv = read_version;\n\t\t\t\t// If the signal is accessing the same dependencies in the same\n\t\t\t\t// order as it did last time, increment `skipped_deps`\n\t\t\t\t// rather than updating `new_deps`, which creates GC cost\n\t\t\t\tif (new_deps === null && deps !== null && deps[skipped_deps] === signal) {\n\t\t\t\t\tskipped_deps++;\n\t\t\t\t} else if (new_deps === null) {\n\t\t\t\t\tnew_deps = [signal];\n\t\t\t\t} else if (!skip_reaction || !new_deps.includes(signal)) {\n\t\t\t\t\t// Normally we can push duplicated dependencies to `new_deps`, but if we're inside\n\t\t\t\t\t// an unowned derived because skip_reaction is true, then we need to ensure that\n\t\t\t\t\t// we don't have duplicates\n\t\t\t\t\tnew_deps.push(signal);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else if (\n\t\tis_derived &&\n\t\t/** @type {Derived} */ (signal).deps === null &&\n\t\t/** @type {Derived} */ (signal).effects === null\n\t) {\n\t\tvar derived = /** @type {Derived} */ (signal);\n\t\tvar parent = derived.parent;\n\n\t\tif (parent !== null && (parent.f & UNOWNED) === 0) {\n\t\t\t// If the derived is owned by another derived then mark it as unowned\n\t\t\t// as the derived value might have been referenced in a different context\n\t\t\t// since and thus its parent might not be its true owner anymore\n\t\t\tderived.f ^= UNOWNED;\n\t\t}\n\t}\n\n\tif (is_derived && !is_destroying_effect) {\n\t\tderived = /** @type {Derived} */ (signal);\n\n\t\tif (check_dirtiness(derived)) {\n\t\t\tupdate_derived(derived);\n\t\t}\n\t}\n\n\tif (\n\t\tDEV &&\n\t\ttracing_mode_flag &&\n\t\t!untracking &&\n\t\ttracing_expressions !== null &&\n\t\tactive_reaction !== null &&\n\t\ttracing_expressions.reaction === active_reaction\n\t) {\n\t\t// Used when mapping state between special blocks like `each`\n\t\tif (signal.trace) {\n\t\t\tsignal.trace();\n\t\t} else {\n\t\t\tvar trace = get_stack('TracedAt');\n\n\t\t\tif (trace) {\n\t\t\t\tvar entry = tracing_expressions.entries.get(signal);\n\n\t\t\t\tif (entry === undefined) {\n\t\t\t\t\tentry = { traces: [] };\n\t\t\t\t\ttracing_expressions.entries.set(signal, entry);\n\t\t\t\t}\n\n\t\t\t\tvar last = entry.traces[entry.traces.length - 1];\n\n\t\t\t\t// traces can be duplicated, e.g. by `snapshot` invoking both\n\t\t\t\t// both `getOwnPropertyDescriptor` and `get` traps at once\n\t\t\t\tif (trace.stack !== last?.stack) {\n\t\t\t\t\tentry.traces.push(trace);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (is_destroying_effect) {\n\t\tif (old_values.has(signal)) {\n\t\t\treturn old_values.get(signal);\n\t\t}\n\n\t\tif (is_derived) {\n\t\t\tderived = /** @type {Derived} */ (signal);\n\n\t\t\tvar value = derived.v;\n\n\t\t\t// if the derived is dirty, or depends on the values that just changed, re-execute\n\t\t\tif ((derived.f & CLEAN) !== 0 || depends_on_old_values(derived)) {\n\t\t\t\tvalue = execute_derived(derived);\n\t\t\t}\n\n\t\t\told_values.set(derived, value);\n\n\t\t\treturn value;\n\t\t}\n\t}\n\n\treturn signal.v;\n}\n\n/** @param {Derived} derived */\nfunction depends_on_old_values(derived) {\n\tif (derived.v === UNINITIALIZED) return true; // we don't know, so assume the worst\n\tif (derived.deps === null) return false;\n\n\tfor (const dep of derived.deps) {\n\t\tif (old_values.has(dep)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ((dep.f & DERIVED) !== 0 && depends_on_old_values(/** @type {Derived} */ (dep))) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\n/**\n * Like `get`, but checks for `undefined`. Used for `var` declarations because they can be accessed before being declared\n * @template V\n * @param {Value<V> | undefined} signal\n * @returns {V | undefined}\n */\nexport function safe_get(signal) {\n\treturn signal && get(signal);\n}\n\n/**\n * Capture an array of all the signals that are read when `fn` is called\n * @template T\n * @param {() => T} fn\n */\nfunction capture_signals(fn) {\n\tvar previous_captured_signals = captured_signals;\n\tcaptured_signals = new Set();\n\n\tvar captured = captured_signals;\n\tvar signal;\n\n\ttry {\n\t\tuntrack(fn);\n\t\tif (previous_captured_signals !== null) {\n\t\t\tfor (signal of captured_signals) {\n\t\t\t\tprevious_captured_signals.add(signal);\n\t\t\t}\n\t\t}\n\t} finally {\n\t\tcaptured_signals = previous_captured_signals;\n\t}\n\n\treturn captured;\n}\n\n/**\n * Invokes a function and captures all signals that are read during the invocation,\n * then invalidates them.\n * @param {() => any} fn\n */\nexport function invalidate_inner_signals(fn) {\n\tvar captured = capture_signals(() => untrack(fn));\n\n\tfor (var signal of captured) {\n\t\tinternal_set(signal, signal.v);\n\t}\n}\n\n/**\n * When used inside a [`$derived`](https://svelte.dev/docs/svelte/$derived) or [`$effect`](https://svelte.dev/docs/svelte/$effect),\n * any state read inside `fn` will not be treated as a dependency.\n *\n * ```ts\n * $effect(() => {\n *   // this will run when `data` changes, but not when `time` changes\n *   save(data, {\n *     timestamp: untrack(() => time)\n *   });\n * });\n * ```\n * @template T\n * @param {() => T} fn\n * @returns {T}\n */\nexport function untrack(fn) {\n\tvar previous_untracking = untracking;\n\ttry {\n\t\tuntracking = true;\n\t\treturn fn();\n\t} finally {\n\t\tuntracking = previous_untracking;\n\t}\n}\n\nconst STATUS_MASK = ~(DIRTY | MAYBE_DIRTY | CLEAN);\n\n/**\n * @param {Signal} signal\n * @param {number} status\n * @returns {void}\n */\nexport function set_signal_status(signal, status) {\n\tsignal.f = (signal.f & STATUS_MASK) | status;\n}\n\n/**\n * @param {Record<string, unknown>} obj\n * @param {string[]} keys\n * @returns {Record<string, unknown>}\n */\nexport function exclude_from_object(obj, keys) {\n\t/** @type {Record<string, unknown>} */\n\tvar result = {};\n\n\tfor (var key in obj) {\n\t\tif (!keys.includes(key)) {\n\t\t\tresult[key] = obj[key];\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/**\n * Possibly traverse an object and read all its properties so that they're all reactive in case this is `$state`.\n * Does only check first level of an object for performance reasons (heuristic should be good for 99% of all cases).\n * @param {any} value\n * @returns {void}\n */\nexport function deep_read_state(value) {\n\tif (typeof value !== 'object' || !value || value instanceof EventTarget) {\n\t\treturn;\n\t}\n\n\tif (STATE_SYMBOL in value) {\n\t\tdeep_read(value);\n\t} else if (!Array.isArray(value)) {\n\t\tfor (let key in value) {\n\t\t\tconst prop = value[key];\n\t\t\tif (typeof prop === 'object' && prop && STATE_SYMBOL in prop) {\n\t\t\t\tdeep_read(prop);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Deeply traverse an object and read all its properties\n * so that they're all reactive in case this is `$state`\n * @param {any} value\n * @param {Set<any>} visited\n * @returns {void}\n */\nexport function deep_read(value, visited = new Set()) {\n\tif (\n\t\ttypeof value === 'object' &&\n\t\tvalue !== null &&\n\t\t// We don't want to traverse DOM elements\n\t\t!(value instanceof EventTarget) &&\n\t\t!visited.has(value)\n\t) {\n\t\tvisited.add(value);\n\t\t// When working with a possible SvelteDate, this\n\t\t// will ensure we capture changes to it.\n\t\tif (value instanceof Date) {\n\t\t\tvalue.getTime();\n\t\t}\n\t\tfor (let key in value) {\n\t\t\ttry {\n\t\t\t\tdeep_read(value[key], visited);\n\t\t\t} catch (e) {\n\t\t\t\t// continue\n\t\t\t}\n\t\t}\n\t\tconst proto = get_prototype_of(value);\n\t\tif (\n\t\t\tproto !== Object.prototype &&\n\t\t\tproto !== Array.prototype &&\n\t\t\tproto !== Map.prototype &&\n\t\t\tproto !== Set.prototype &&\n\t\t\tproto !== Date.prototype\n\t\t) {\n\t\t\tconst descriptors = get_descriptors(proto);\n\t\t\tfor (let key in descriptors) {\n\t\t\t\tconst get = descriptors[key].get;\n\t\t\t\tif (get) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tget.call(value);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// continue\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/** @import { TemplateNode } from '#client' */\n\nimport { COMMENT_NODE } from '#client/constants';\nimport {\n\tHYDRATION_END,\n\tHYDRATION_ERROR,\n\tHYDRATION_START,\n\tHYDRATION_START_ELSE\n} from '../../../constants.js';\nimport * as w from '../warnings.js';\nimport { get_next_sibling } from './operations.js';\n\n/**\n * Use this variable to guard everything related to hydration code so it can be treeshaken out\n * if the user doesn't use the `hydrate` method and these code paths are therefore not needed.\n */\nexport let hydrating = false;\n\n/** @param {boolean} value */\nexport function set_hydrating(value) {\n\thydrating = value;\n}\n\n/**\n * The node that is currently being hydrated. This starts out as the first node inside the opening\n * <!--[--> comment, and updates each time a component calls `$.child(...)` or `$.sibling(...)`.\n * When entering a block (e.g. `{#if ...}`), `hydrate_node` is the block opening comment; by the\n * time we leave the block it is the closing comment, which serves as the block's anchor.\n * @type {TemplateNode}\n */\nexport let hydrate_node;\n\n/** @param {TemplateNode} node */\nexport function set_hydrate_node(node) {\n\tif (node === null) {\n\t\tw.hydration_mismatch();\n\t\tthrow HYDRATION_ERROR;\n\t}\n\n\treturn (hydrate_node = node);\n}\n\nexport function hydrate_next() {\n\treturn set_hydrate_node(/** @type {TemplateNode} */ (get_next_sibling(hydrate_node)));\n}\n\n/** @param {TemplateNode} node */\nexport function reset(node) {\n\tif (!hydrating) return;\n\n\t// If the node has remaining siblings, something has gone wrong\n\tif (get_next_sibling(hydrate_node) !== null) {\n\t\tw.hydration_mismatch();\n\t\tthrow HYDRATION_ERROR;\n\t}\n\n\thydrate_node = node;\n}\n\n/**\n * @param {HTMLTemplateElement} template\n */\nexport function hydrate_template(template) {\n\tif (hydrating) {\n\t\t// @ts-expect-error TemplateNode doesn't include DocumentFragment, but it's actually fine\n\t\thydrate_node = template.content;\n\t}\n}\n\nexport function next(count = 1) {\n\tif (hydrating) {\n\t\tvar i = count;\n\t\tvar node = hydrate_node;\n\n\t\twhile (i--) {\n\t\t\tnode = /** @type {TemplateNode} */ (get_next_sibling(node));\n\t\t}\n\n\t\thydrate_node = node;\n\t}\n}\n\n/**\n * Removes all nodes starting at `hydrate_node` up until the next hydration end comment\n */\nexport function remove_nodes() {\n\tvar depth = 0;\n\tvar node = hydrate_node;\n\n\twhile (true) {\n\t\tif (node.nodeType === COMMENT_NODE) {\n\t\t\tvar data = /** @type {Comment} */ (node).data;\n\n\t\t\tif (data === HYDRATION_END) {\n\t\t\t\tif (depth === 0) return node;\n\t\t\t\tdepth -= 1;\n\t\t\t} else if (data === HYDRATION_START || data === HYDRATION_START_ELSE) {\n\t\t\t\tdepth += 1;\n\t\t\t}\n\t\t}\n\n\t\tvar next = /** @type {TemplateNode} */ (get_next_sibling(node));\n\t\tnode.remove();\n\t\tnode = next;\n\t}\n}\n\n/**\n *\n * @param {TemplateNode} node\n */\nexport function read_hydration_instruction(node) {\n\tif (!node || node.nodeType !== COMMENT_NODE) {\n\t\tw.hydration_mismatch();\n\t\tthrow HYDRATION_ERROR;\n\t}\n\n\treturn /** @type {Comment} */ (node).data;\n}\n","/** @import { TemplateNode } from '#client' */\nimport { hydrate_node, hydrating, set_hydrate_node } from './hydration.js';\nimport { DEV } from 'esm-env';\nimport { init_array_prototype_warnings } from '../dev/equality.js';\nimport { get_descriptor, is_extensible } from '../../shared/utils.js';\nimport { TEXT_NODE } from '#client/constants';\n\n// export these for reference in the compiled code, making global name deduplication unnecessary\n/** @type {Window} */\nexport var $window;\n\n/** @type {Document} */\nexport var $document;\n\n/** @type {boolean} */\nexport var is_firefox;\n\n/** @type {() => Node | null} */\nvar first_child_getter;\n/** @type {() => Node | null} */\nvar next_sibling_getter;\n\n/**\n * Initialize these lazily to avoid issues when using the runtime in a server context\n * where these globals are not available while avoiding a separate server entry point\n */\nexport function init_operations() {\n\tif ($window !== undefined) {\n\t\treturn;\n\t}\n\n\t$window = window;\n\t$document = document;\n\tis_firefox = /Firefox/.test(navigator.userAgent);\n\n\tvar element_prototype = Element.prototype;\n\tvar node_prototype = Node.prototype;\n\tvar text_prototype = Text.prototype;\n\n\t// @ts-ignore\n\tfirst_child_getter = get_descriptor(node_prototype, 'firstChild').get;\n\t// @ts-ignore\n\tnext_sibling_getter = get_descriptor(node_prototype, 'nextSibling').get;\n\n\tif (is_extensible(element_prototype)) {\n\t\t// the following assignments improve perf of lookups on DOM nodes\n\t\t// @ts-expect-error\n\t\telement_prototype.__click = undefined;\n\t\t// @ts-expect-error\n\t\telement_prototype.__className = undefined;\n\t\t// @ts-expect-error\n\t\telement_prototype.__attributes = null;\n\t\t// @ts-expect-error\n\t\telement_prototype.__style = undefined;\n\t\t// @ts-expect-error\n\t\telement_prototype.__e = undefined;\n\t}\n\n\tif (is_extensible(text_prototype)) {\n\t\t// @ts-expect-error\n\t\ttext_prototype.__t = undefined;\n\t}\n\n\tif (DEV) {\n\t\t// @ts-expect-error\n\t\telement_prototype.__svelte_meta = null;\n\n\t\tinit_array_prototype_warnings();\n\t}\n}\n\n/**\n * @param {string} value\n * @returns {Text}\n */\nexport function create_text(value = '') {\n\treturn document.createTextNode(value);\n}\n\n/**\n * @template {Node} N\n * @param {N} node\n * @returns {Node | null}\n */\n/*@__NO_SIDE_EFFECTS__*/\nexport function get_first_child(node) {\n\treturn first_child_getter.call(node);\n}\n\n/**\n * @template {Node} N\n * @param {N} node\n * @returns {Node | null}\n */\n/*@__NO_SIDE_EFFECTS__*/\nexport function get_next_sibling(node) {\n\treturn next_sibling_getter.call(node);\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @template {Node} N\n * @param {N} node\n * @param {boolean} is_text\n * @returns {Node | null}\n */\nexport function child(node, is_text) {\n\tif (!hydrating) {\n\t\treturn get_first_child(node);\n\t}\n\n\tvar child = /** @type {TemplateNode} */ (get_first_child(hydrate_node));\n\n\t// Child can be null if we have an element with a single child, like `<p>{text}</p>`, where `text` is empty\n\tif (child === null) {\n\t\tchild = hydrate_node.appendChild(create_text());\n\t} else if (is_text && child.nodeType !== TEXT_NODE) {\n\t\tvar text = create_text();\n\t\tchild?.before(text);\n\t\tset_hydrate_node(text);\n\t\treturn text;\n\t}\n\n\tset_hydrate_node(child);\n\treturn child;\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @param {DocumentFragment | TemplateNode[]} fragment\n * @param {boolean} is_text\n * @returns {Node | null}\n */\nexport function first_child(fragment, is_text) {\n\tif (!hydrating) {\n\t\t// when not hydrating, `fragment` is a `DocumentFragment` (the result of calling `open_frag`)\n\t\tvar first = /** @type {DocumentFragment} */ (get_first_child(/** @type {Node} */ (fragment)));\n\n\t\t// TODO prevent user comments with the empty string when preserveComments is true\n\t\tif (first instanceof Comment && first.data === '') return get_next_sibling(first);\n\n\t\treturn first;\n\t}\n\n\t// if an {expression} is empty during SSR, there might be no\n\t// text node to hydrate — we must therefore create one\n\tif (is_text && hydrate_node?.nodeType !== TEXT_NODE) {\n\t\tvar text = create_text();\n\n\t\thydrate_node?.before(text);\n\t\tset_hydrate_node(text);\n\t\treturn text;\n\t}\n\n\treturn hydrate_node;\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @param {TemplateNode} node\n * @param {number} count\n * @param {boolean} is_text\n * @returns {Node | null}\n */\nexport function sibling(node, count = 1, is_text = false) {\n\tlet next_sibling = hydrating ? hydrate_node : node;\n\tvar last_sibling;\n\n\twhile (count--) {\n\t\tlast_sibling = next_sibling;\n\t\tnext_sibling = /** @type {TemplateNode} */ (get_next_sibling(next_sibling));\n\t}\n\n\tif (!hydrating) {\n\t\treturn next_sibling;\n\t}\n\n\t// if a sibling {expression} is empty during SSR, there might be no\n\t// text node to hydrate — we must therefore create one\n\tif (is_text && next_sibling?.nodeType !== TEXT_NODE) {\n\t\tvar text = create_text();\n\t\t// If the next sibling is `null` and we're handling text then it's because\n\t\t// the SSR content was empty for the text, so we need to generate a new text\n\t\t// node and insert it after the last sibling\n\t\tif (next_sibling === null) {\n\t\t\tlast_sibling?.after(text);\n\t\t} else {\n\t\t\tnext_sibling.before(text);\n\t\t}\n\t\tset_hydrate_node(text);\n\t\treturn text;\n\t}\n\n\tset_hydrate_node(next_sibling);\n\treturn /** @type {TemplateNode} */ (next_sibling);\n}\n\n/**\n * @template {Node} N\n * @param {N} node\n * @returns {void}\n */\nexport function clear_text_content(node) {\n\tnode.textContent = '';\n}\n\n/**\n *\n * @param {string} tag\n * @param {string} [namespace]\n * @param {string} [is]\n * @returns\n */\nexport function create_element(tag, namespace, is) {\n\tlet options = is ? { is } : undefined;\n\tif (namespace) {\n\t\treturn document.createElementNS(namespace, tag, options);\n\t}\n\treturn document.createElement(tag, options);\n}\n\nexport function create_fragment() {\n\treturn document.createDocumentFragment();\n}\n\n/**\n * @param {string} data\n * @returns\n */\nexport function create_comment(data = '') {\n\treturn document.createComment(data);\n}\n\n/**\n * @param {Element} element\n * @param {string} key\n * @param {string} value\n * @returns\n */\nexport function set_attribute(element, key, value = '') {\n\tif (key.startsWith('xlink:')) {\n\t\telement.setAttributeNS('http://www.w3.org/1999/xlink', key, value);\n\t\treturn;\n\t}\n\treturn element.setAttribute(key, value);\n}\n","/** @import { ComponentContext, ComponentContextLegacy, Derived, Effect, TemplateNode, TransitionManager } from '#client' */\nimport {\n\tcheck_dirtiness,\n\tactive_effect,\n\tactive_reaction,\n\tupdate_effect,\n\tget,\n\tis_destroying_effect,\n\tremove_reactions,\n\tschedule_effect,\n\tset_active_reaction,\n\tset_is_destroying_effect,\n\tset_signal_status,\n\tuntrack,\n\tuntracking\n} from '../runtime.js';\nimport {\n\tDIRTY,\n\tBRANCH_EFFECT,\n\tRENDER_EFFECT,\n\tEFFECT,\n\tDESTROYED,\n\tINERT,\n\tEFFECT_RAN,\n\tBLOCK_EFFECT,\n\tROOT_EFFECT,\n\tEFFECT_TRANSPARENT,\n\tDERIVED,\n\tUNOWNED,\n\tCLEAN,\n\tINSPECT_EFFECT,\n\tHEAD_EFFECT,\n\tMAYBE_DIRTY,\n\tEFFECT_PRESERVED,\n\tBOUNDARY_EFFECT,\n\tSTALE_REACTION,\n\tUSER_EFFECT\n} from '#client/constants';\nimport { set } from './sources.js';\nimport * as e from '../errors.js';\nimport { DEV } from 'esm-env';\nimport { define_property } from '../../shared/utils.js';\nimport { get_next_sibling } from '../dom/operations.js';\nimport { derived } from './deriveds.js';\nimport { component_context, dev_current_component_function, dev_stack } from '../context.js';\n\n/**\n * @param {'$effect' | '$effect.pre' | '$inspect'} rune\n */\nexport function validate_effect(rune) {\n\tif (active_effect === null && active_reaction === null) {\n\t\te.effect_orphan(rune);\n\t}\n\n\tif (active_reaction !== null && (active_reaction.f & UNOWNED) !== 0 && active_effect === null) {\n\t\te.effect_in_unowned_derived();\n\t}\n\n\tif (is_destroying_effect) {\n\t\te.effect_in_teardown(rune);\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @param {Effect} parent_effect\n */\nfunction push_effect(effect, parent_effect) {\n\tvar parent_last = parent_effect.last;\n\tif (parent_last === null) {\n\t\tparent_effect.last = parent_effect.first = effect;\n\t} else {\n\t\tparent_last.next = effect;\n\t\teffect.prev = parent_last;\n\t\tparent_effect.last = effect;\n\t}\n}\n\n/**\n * @param {number} type\n * @param {null | (() => void | (() => void))} fn\n * @param {boolean} sync\n * @param {boolean} push\n * @returns {Effect}\n */\nfunction create_effect(type, fn, sync, push = true) {\n\tvar parent = active_effect;\n\n\tif (DEV) {\n\t\t// Ensure the parent is never an inspect effect\n\t\twhile (parent !== null && (parent.f & INSPECT_EFFECT) !== 0) {\n\t\t\tparent = parent.parent;\n\t\t}\n\t}\n\n\t/** @type {Effect} */\n\tvar effect = {\n\t\tctx: component_context,\n\t\tdeps: null,\n\t\tnodes_start: null,\n\t\tnodes_end: null,\n\t\tf: type | DIRTY,\n\t\tfirst: null,\n\t\tfn,\n\t\tlast: null,\n\t\tnext: null,\n\t\tparent,\n\t\tb: parent && parent.b,\n\t\tprev: null,\n\t\tteardown: null,\n\t\ttransitions: null,\n\t\twv: 0,\n\t\tac: null\n\t};\n\n\tif (DEV) {\n\t\teffect.component_function = dev_current_component_function;\n\t}\n\n\tif (sync) {\n\t\ttry {\n\t\t\tupdate_effect(effect);\n\t\t\teffect.f |= EFFECT_RAN;\n\t\t} catch (e) {\n\t\t\tdestroy_effect(effect);\n\t\t\tthrow e;\n\t\t}\n\t} else if (fn !== null) {\n\t\tschedule_effect(effect);\n\t}\n\n\t// if an effect has no dependencies, no DOM and no teardown function,\n\t// don't bother adding it to the effect tree\n\tvar inert =\n\t\tsync &&\n\t\teffect.deps === null &&\n\t\teffect.first === null &&\n\t\teffect.nodes_start === null &&\n\t\teffect.teardown === null &&\n\t\t(effect.f & (EFFECT_PRESERVED | BOUNDARY_EFFECT)) === 0;\n\n\tif (!inert && push) {\n\t\tif (parent !== null) {\n\t\t\tpush_effect(effect, parent);\n\t\t}\n\n\t\t// if we're in a derived, add the effect there too\n\t\tif (active_reaction !== null && (active_reaction.f & DERIVED) !== 0) {\n\t\t\tvar derived = /** @type {Derived} */ (active_reaction);\n\t\t\t(derived.effects ??= []).push(effect);\n\t\t}\n\t}\n\n\treturn effect;\n}\n\n/**\n * Internal representation of `$effect.tracking()`\n * @returns {boolean}\n */\nexport function effect_tracking() {\n\treturn active_reaction !== null && !untracking;\n}\n\n/**\n * @param {() => void} fn\n */\nexport function teardown(fn) {\n\tconst effect = create_effect(RENDER_EFFECT, null, false);\n\tset_signal_status(effect, CLEAN);\n\teffect.teardown = fn;\n\treturn effect;\n}\n\n/**\n * Internal representation of `$effect(...)`\n * @param {() => void | (() => void)} fn\n */\nexport function user_effect(fn) {\n\tvalidate_effect('$effect');\n\n\tif (DEV) {\n\t\tdefine_property(fn, 'name', {\n\t\t\tvalue: '$effect'\n\t\t});\n\t}\n\n\tif (!active_reaction && active_effect && (active_effect.f & BRANCH_EFFECT) !== 0) {\n\t\t// Top-level `$effect(...)` in a component — defer until mount\n\t\tvar context = /** @type {ComponentContext} */ (component_context);\n\t\t(context.e ??= []).push(fn);\n\t} else {\n\t\t// Everything else — create immediately\n\t\treturn create_user_effect(fn);\n\t}\n}\n\n/**\n * @param {() => void | (() => void)} fn\n */\nexport function create_user_effect(fn) {\n\treturn create_effect(EFFECT | USER_EFFECT, fn, false);\n}\n\n/**\n * Internal representation of `$effect.pre(...)`\n * @param {() => void | (() => void)} fn\n * @returns {Effect}\n */\nexport function user_pre_effect(fn) {\n\tvalidate_effect('$effect.pre');\n\tif (DEV) {\n\t\tdefine_property(fn, 'name', {\n\t\t\tvalue: '$effect.pre'\n\t\t});\n\t}\n\treturn create_effect(RENDER_EFFECT | USER_EFFECT, fn, true);\n}\n\n/** @param {() => void | (() => void)} fn */\nexport function inspect_effect(fn) {\n\treturn create_effect(INSPECT_EFFECT, fn, true);\n}\n\n/**\n * Internal representation of `$effect.root(...)`\n * @param {() => void | (() => void)} fn\n * @returns {() => void}\n */\nexport function effect_root(fn) {\n\tconst effect = create_effect(ROOT_EFFECT, fn, true);\n\n\treturn () => {\n\t\tdestroy_effect(effect);\n\t};\n}\n\n/**\n * An effect root whose children can transition out\n * @param {() => void} fn\n * @returns {(options?: { outro?: boolean }) => Promise<void>}\n */\nexport function component_root(fn) {\n\tconst effect = create_effect(ROOT_EFFECT, fn, true);\n\n\treturn (options = {}) => {\n\t\treturn new Promise((fulfil) => {\n\t\t\tif (options.outro) {\n\t\t\t\tpause_effect(effect, () => {\n\t\t\t\t\tdestroy_effect(effect);\n\t\t\t\t\tfulfil(undefined);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdestroy_effect(effect);\n\t\t\t\tfulfil(undefined);\n\t\t\t}\n\t\t});\n\t};\n}\n\n/**\n * @param {() => void | (() => void)} fn\n * @returns {Effect}\n */\nexport function effect(fn) {\n\treturn create_effect(EFFECT, fn, false);\n}\n\n/**\n * Internal representation of `$: ..`\n * @param {() => any} deps\n * @param {() => void | (() => void)} fn\n */\nexport function legacy_pre_effect(deps, fn) {\n\tvar context = /** @type {ComponentContextLegacy} */ (component_context);\n\n\t/** @type {{ effect: null | Effect, ran: boolean }} */\n\tvar token = { effect: null, ran: false };\n\tcontext.l.r1.push(token);\n\n\ttoken.effect = render_effect(() => {\n\t\tdeps();\n\n\t\t// If this legacy pre effect has already run before the end of the reset, then\n\t\t// bail out to emulate the same behavior.\n\t\tif (token.ran) return;\n\n\t\ttoken.ran = true;\n\t\tset(context.l.r2, true);\n\t\tuntrack(fn);\n\t});\n}\n\nexport function legacy_pre_effect_reset() {\n\tvar context = /** @type {ComponentContextLegacy} */ (component_context);\n\n\trender_effect(() => {\n\t\tif (!get(context.l.r2)) return;\n\n\t\t// Run dirty `$:` statements\n\t\tfor (var token of context.l.r1) {\n\t\t\tvar effect = token.effect;\n\n\t\t\t// If the effect is CLEAN, then make it MAYBE_DIRTY. This ensures we traverse through\n\t\t\t// the effects dependencies and correctly ensure each dependency is up-to-date.\n\t\t\tif ((effect.f & CLEAN) !== 0) {\n\t\t\t\tset_signal_status(effect, MAYBE_DIRTY);\n\t\t\t}\n\n\t\t\tif (check_dirtiness(effect)) {\n\t\t\t\tupdate_effect(effect);\n\t\t\t}\n\n\t\t\ttoken.ran = false;\n\t\t}\n\n\t\tcontext.l.r2.v = false; // set directly to avoid rerunning this effect\n\t});\n}\n\n/**\n * @param {() => void | (() => void)} fn\n * @returns {Effect}\n */\nexport function render_effect(fn) {\n\treturn create_effect(RENDER_EFFECT, fn, true);\n}\n\n/**\n * @param {(...expressions: any) => void | (() => void)} fn\n * @param {Array<() => any>} thunks\n * @param {<T>(fn: () => T) => Derived<T>} d\n * @returns {Effect}\n */\nexport function template_effect(fn, thunks = [], d = derived) {\n\tif (DEV) {\n\t\t// wrap the effect so that we can decorate stack trace with `in {expression}`\n\t\t// (TODO maybe there's a better approach?)\n\t\treturn render_effect(() => {\n\t\t\tvar outer = /** @type {Effect} */ (active_effect);\n\t\t\tvar inner = () => fn(...deriveds.map(get));\n\n\t\t\tdefine_property(outer.fn, 'name', { value: '{expression}' });\n\t\t\tdefine_property(inner, 'name', { value: '{expression}' });\n\n\t\t\tconst deriveds = thunks.map(d);\n\t\t\tblock(inner);\n\t\t});\n\t}\n\n\tconst deriveds = thunks.map(d);\n\treturn block(() => fn(...deriveds.map(get)));\n}\n\n/**\n * @param {(() => void)} fn\n * @param {number} flags\n */\nexport function block(fn, flags = 0) {\n\tvar effect = create_effect(RENDER_EFFECT | BLOCK_EFFECT | flags, fn, true);\n\tif (DEV) {\n\t\teffect.dev_stack = dev_stack;\n\t}\n\treturn effect;\n}\n\n/**\n * @param {(() => void)} fn\n * @param {boolean} [push]\n */\nexport function branch(fn, push = true) {\n\treturn create_effect(RENDER_EFFECT | BRANCH_EFFECT, fn, true, push);\n}\n\n/**\n * @param {Effect} effect\n */\nexport function execute_effect_teardown(effect) {\n\tvar teardown = effect.teardown;\n\tif (teardown !== null) {\n\t\tconst previously_destroying_effect = is_destroying_effect;\n\t\tconst previous_reaction = active_reaction;\n\t\tset_is_destroying_effect(true);\n\t\tset_active_reaction(null);\n\t\ttry {\n\t\t\tteardown.call(null);\n\t\t} finally {\n\t\t\tset_is_destroying_effect(previously_destroying_effect);\n\t\t\tset_active_reaction(previous_reaction);\n\t\t}\n\t}\n}\n\n/**\n * @param {Effect} signal\n * @param {boolean} remove_dom\n * @returns {void}\n */\nexport function destroy_effect_children(signal, remove_dom = false) {\n\tvar effect = signal.first;\n\tsignal.first = signal.last = null;\n\n\twhile (effect !== null) {\n\t\teffect.ac?.abort(STALE_REACTION);\n\n\t\tvar next = effect.next;\n\n\t\tif ((effect.f & ROOT_EFFECT) !== 0) {\n\t\t\t// this is now an independent root\n\t\t\teffect.parent = null;\n\t\t} else {\n\t\t\tdestroy_effect(effect, remove_dom);\n\t\t}\n\n\t\teffect = next;\n\t}\n}\n\n/**\n * @param {Effect} signal\n * @returns {void}\n */\nexport function destroy_block_effect_children(signal) {\n\tvar effect = signal.first;\n\n\twhile (effect !== null) {\n\t\tvar next = effect.next;\n\t\tif ((effect.f & BRANCH_EFFECT) === 0) {\n\t\t\tdestroy_effect(effect);\n\t\t}\n\t\teffect = next;\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @param {boolean} [remove_dom]\n * @returns {void}\n */\nexport function destroy_effect(effect, remove_dom = true) {\n\tvar removed = false;\n\n\tif (\n\t\t(remove_dom || (effect.f & HEAD_EFFECT) !== 0) &&\n\t\teffect.nodes_start !== null &&\n\t\teffect.nodes_end !== null\n\t) {\n\t\tremove_effect_dom(effect.nodes_start, /** @type {TemplateNode} */ (effect.nodes_end));\n\t\tremoved = true;\n\t}\n\n\tdestroy_effect_children(effect, remove_dom && !removed);\n\tremove_reactions(effect, 0);\n\tset_signal_status(effect, DESTROYED);\n\n\tvar transitions = effect.transitions;\n\n\tif (transitions !== null) {\n\t\tfor (const transition of transitions) {\n\t\t\ttransition.stop();\n\t\t}\n\t}\n\n\texecute_effect_teardown(effect);\n\n\tvar parent = effect.parent;\n\n\t// If the parent doesn't have any children, then skip this work altogether\n\tif (parent !== null && parent.first !== null) {\n\t\tunlink_effect(effect);\n\t}\n\n\tif (DEV) {\n\t\teffect.component_function = null;\n\t}\n\n\t// `first` and `child` are nulled out in destroy_effect_children\n\t// we don't null out `parent` so that error propagation can work correctly\n\teffect.next =\n\t\teffect.prev =\n\t\teffect.teardown =\n\t\teffect.ctx =\n\t\teffect.deps =\n\t\teffect.fn =\n\t\teffect.nodes_start =\n\t\teffect.nodes_end =\n\t\teffect.ac =\n\t\t\tnull;\n}\n\n/**\n *\n * @param {TemplateNode | null} node\n * @param {TemplateNode} end\n */\nexport function remove_effect_dom(node, end) {\n\twhile (node !== null) {\n\t\t/** @type {TemplateNode | null} */\n\t\tvar next = node === end ? null : /** @type {TemplateNode} */ (get_next_sibling(node));\n\n\t\tnode.remove();\n\t\tnode = next;\n\t}\n}\n\n/**\n * Detach an effect from the effect tree, freeing up memory and\n * reducing the amount of work that happens on subsequent traversals\n * @param {Effect} effect\n */\nexport function unlink_effect(effect) {\n\tvar parent = effect.parent;\n\tvar prev = effect.prev;\n\tvar next = effect.next;\n\n\tif (prev !== null) prev.next = next;\n\tif (next !== null) next.prev = prev;\n\n\tif (parent !== null) {\n\t\tif (parent.first === effect) parent.first = next;\n\t\tif (parent.last === effect) parent.last = prev;\n\t}\n}\n\n/**\n * When a block effect is removed, we don't immediately destroy it or yank it\n * out of the DOM, because it might have transitions. Instead, we 'pause' it.\n * It stays around (in memory, and in the DOM) until outro transitions have\n * completed, and if the state change is reversed then we _resume_ it.\n * A paused effect does not update, and the DOM subtree becomes inert.\n * @param {Effect} effect\n * @param {() => void} [callback]\n */\nexport function pause_effect(effect, callback) {\n\t/** @type {TransitionManager[]} */\n\tvar transitions = [];\n\n\tpause_children(effect, transitions, true);\n\n\trun_out_transitions(transitions, () => {\n\t\tdestroy_effect(effect);\n\t\tif (callback) callback();\n\t});\n}\n\n/**\n * @param {TransitionManager[]} transitions\n * @param {() => void} fn\n */\nexport function run_out_transitions(transitions, fn) {\n\tvar remaining = transitions.length;\n\tif (remaining > 0) {\n\t\tvar check = () => --remaining || fn();\n\t\tfor (var transition of transitions) {\n\t\t\ttransition.out(check);\n\t\t}\n\t} else {\n\t\tfn();\n\t}\n}\n\n/**\n * @param {Effect} effect\n * @param {TransitionManager[]} transitions\n * @param {boolean} local\n */\nexport function pause_children(effect, transitions, local) {\n\tif ((effect.f & INERT) !== 0) return;\n\teffect.f ^= INERT;\n\n\tif (effect.transitions !== null) {\n\t\tfor (const transition of effect.transitions) {\n\t\t\tif (transition.is_global || local) {\n\t\t\t\ttransitions.push(transition);\n\t\t\t}\n\t\t}\n\t}\n\n\tvar child = effect.first;\n\n\twhile (child !== null) {\n\t\tvar sibling = child.next;\n\t\tvar transparent = (child.f & EFFECT_TRANSPARENT) !== 0 || (child.f & BRANCH_EFFECT) !== 0;\n\t\t// TODO we don't need to call pause_children recursively with a linked list in place\n\t\t// it's slightly more involved though as we have to account for `transparent` changing\n\t\t// through the tree.\n\t\tpause_children(child, transitions, transparent ? local : false);\n\t\tchild = sibling;\n\t}\n}\n\n/**\n * The opposite of `pause_effect`. We call this if (for example)\n * `x` becomes falsy then truthy: `{#if x}...{/if}`\n * @param {Effect} effect\n */\nexport function resume_effect(effect) {\n\tresume_children(effect, true);\n}\n\n/**\n * @param {Effect} effect\n * @param {boolean} local\n */\nfunction resume_children(effect, local) {\n\tif ((effect.f & INERT) === 0) return;\n\teffect.f ^= INERT;\n\n\tvar child = effect.first;\n\n\twhile (child !== null) {\n\t\tvar sibling = child.next;\n\t\tvar transparent = (child.f & EFFECT_TRANSPARENT) !== 0 || (child.f & BRANCH_EFFECT) !== 0;\n\t\t// TODO we don't need to call resume_children recursively with a linked list in place\n\t\t// it's slightly more involved though as we have to account for `transparent` changing\n\t\t// through the tree.\n\t\tresume_children(child, transparent ? local : false);\n\t\tchild = sibling;\n\t}\n\n\tif (effect.transitions !== null) {\n\t\tfor (const transition of effect.transitions) {\n\t\t\tif (transition.is_global || local) {\n\t\t\t\ttransition.in();\n\t\t\t}\n\t\t}\n\t}\n}\n","import { run_all } from '../../shared/utils.js';\n\n// Fallback for when requestIdleCallback is not available\nconst request_idle_callback =\n\ttypeof requestIdleCallback === 'undefined'\n\t\t? (/** @type {() => void} */ cb) => setTimeout(cb, 1)\n\t\t: requestIdleCallback;\n\n/** @type {Array<() => void>} */\nlet micro_tasks = [];\n\n/** @type {Array<() => void>} */\nlet idle_tasks = [];\n\nfunction run_micro_tasks() {\n\tvar tasks = micro_tasks;\n\tmicro_tasks = [];\n\trun_all(tasks);\n}\n\nfunction run_idle_tasks() {\n\tvar tasks = idle_tasks;\n\tidle_tasks = [];\n\trun_all(tasks);\n}\n\n/**\n * @param {() => void} fn\n */\nexport function queue_micro_task(fn) {\n\tif (micro_tasks.length === 0) {\n\t\tqueueMicrotask(run_micro_tasks);\n\t}\n\n\tmicro_tasks.push(fn);\n}\n\n/**\n * @param {() => void} fn\n */\nexport function queue_idle_task(fn) {\n\tif (idle_tasks.length === 0) {\n\t\trequest_idle_callback(run_idle_tasks);\n\t}\n\n\tidle_tasks.push(fn);\n}\n\n/**\n * Synchronously run any queued tasks.\n */\nexport function flush_tasks() {\n\tif (micro_tasks.length > 0) {\n\t\trun_micro_tasks();\n\t}\n\n\tif (idle_tasks.length > 0) {\n\t\trun_idle_tasks();\n\t}\n}\n","/** @import { Effect } from '#client' */\n/** @import { Boundary } from './dom/blocks/boundary.js' */\nimport { DEV } from 'esm-env';\nimport { FILENAME } from '../../constants.js';\nimport { is_firefox } from './dom/operations.js';\nimport { BOUNDARY_EFFECT, EFFECT_RAN } from './constants.js';\nimport { define_property, get_descriptor } from '../shared/utils.js';\nimport { active_effect } from './runtime.js';\n\n/**\n * @param {unknown} error\n */\nexport function handle_error(error) {\n\tvar effect = /** @type {Effect} */ (active_effect);\n\n\tif (DEV && error instanceof Error) {\n\t\tadjust_error(error, effect);\n\t}\n\n\tif ((effect.f & EFFECT_RAN) === 0) {\n\t\t// if the error occurred while creating this subtree, we let it\n\t\t// bubble up until it hits a boundary that can handle it\n\t\tif ((effect.f & BOUNDARY_EFFECT) === 0) {\n\t\t\tthrow error;\n\t\t}\n\n\t\t// @ts-expect-error\n\t\teffect.fn(error);\n\t} else {\n\t\t// otherwise we bubble up the effect tree ourselves\n\t\tinvoke_error_boundary(error, effect);\n\t}\n}\n\n/**\n * @param {unknown} error\n * @param {Effect | null} effect\n */\nexport function invoke_error_boundary(error, effect) {\n\twhile (effect !== null) {\n\t\tif ((effect.f & BOUNDARY_EFFECT) !== 0) {\n\t\t\ttry {\n\t\t\t\t/** @type {Boundary} */ (effect.b).error(error);\n\t\t\t\treturn;\n\t\t\t} catch {}\n\t\t}\n\n\t\teffect = effect.parent;\n\t}\n\n\tthrow error;\n}\n\n/** @type {WeakSet<Error>} */\nconst adjusted_errors = new WeakSet();\n\n/**\n * Add useful information to the error message/stack in development\n * @param {Error} error\n * @param {Effect} effect\n */\nfunction adjust_error(error, effect) {\n\tif (adjusted_errors.has(error)) return;\n\tadjusted_errors.add(error);\n\n\tconst message_descriptor = get_descriptor(error, 'message');\n\n\t// if the message was already changed and it's not configurable we can't change it\n\t// or it will throw a different error swallowing the original error\n\tif (message_descriptor && !message_descriptor.configurable) return;\n\n\tvar indent = is_firefox ? '  ' : '\\t';\n\tvar component_stack = `\\n${indent}in ${effect.fn?.name || '<unknown>'}`;\n\tvar context = effect.ctx;\n\n\twhile (context !== null) {\n\t\tcomponent_stack += `\\n${indent}in ${context.function?.[FILENAME].split('/').pop()}`;\n\t\tcontext = context.p;\n\t}\n\n\tdefine_property(error, 'message', {\n\t\tvalue: error.message + `\\n${component_stack}\\n`\n\t});\n\n\tif (error.stack) {\n\t\t// Filter out internal modules\n\t\tdefine_property(error, 'stack', {\n\t\t\tvalue: error.stack\n\t\t\t\t.split('\\n')\n\t\t\t\t.filter((line) => !line.includes('svelte/src/internal'))\n\t\t\t\t.join('\\n')\n\t\t});\n\t}\n}\n","import { hydrating } from '../hydration.js';\nimport { clear_text_content, get_first_child } from '../operations.js';\nimport { queue_micro_task } from '../task.js';\n\n/**\n * @param {HTMLElement} dom\n * @param {boolean} value\n * @returns {void}\n */\nexport function autofocus(dom, value) {\n\tif (value) {\n\t\tconst body = document.body;\n\t\tdom.autofocus = true;\n\n\t\tqueue_micro_task(() => {\n\t\t\tif (document.activeElement === body) {\n\t\t\t\tdom.focus();\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * The child of a textarea actually corresponds to the defaultValue property, so we need\n * to remove it upon hydration to avoid a bug when someone resets the form value.\n * @param {HTMLTextAreaElement} dom\n * @returns {void}\n */\nexport function remove_textarea_child(dom) {\n\tif (hydrating && get_first_child(dom) !== null) {\n\t\tclear_text_content(dom);\n\t}\n}\n\nlet listening_to_form_reset = false;\n\nexport function add_form_reset_listener() {\n\tif (!listening_to_form_reset) {\n\t\tlistening_to_form_reset = true;\n\t\tdocument.addEventListener(\n\t\t\t'reset',\n\t\t\t(evt) => {\n\t\t\t\t// Needs to happen one tick later or else the dom properties of the form\n\t\t\t\t// elements have not updated to their reset values yet\n\t\t\t\tPromise.resolve().then(() => {\n\t\t\t\t\tif (!evt.defaultPrevented) {\n\t\t\t\t\t\tfor (const e of /**@type {HTMLFormElement} */ (evt.target).elements) {\n\t\t\t\t\t\t\t// @ts-expect-error\n\t\t\t\t\t\t\te.__on_r?.();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t// In the capture phase to guarantee we get noticed of it (no possiblity of stopPropagation)\n\t\t\t{ capture: true }\n\t\t);\n\t}\n}\n","import { teardown } from '../../../reactivity/effects.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tset_active_effect,\n\tset_active_reaction\n} from '../../../runtime.js';\nimport { add_form_reset_listener } from '../misc.js';\n\n/**\n * Fires the handler once immediately (unless corresponding arg is set to `false`),\n * then listens to the given events until the render effect context is destroyed\n * @param {EventTarget} target\n * @param {Array<string>} events\n * @param {(event?: Event) => void} handler\n * @param {any} call_handler_immediately\n */\nexport function listen(target, events, handler, call_handler_immediately = true) {\n\tif (call_handler_immediately) {\n\t\thandler();\n\t}\n\n\tfor (var name of events) {\n\t\ttarget.addEventListener(name, handler);\n\t}\n\n\tteardown(() => {\n\t\tfor (var name of events) {\n\t\t\ttarget.removeEventListener(name, handler);\n\t\t}\n\t});\n}\n\n/**\n * @template T\n * @param {() => T} fn\n */\nexport function without_reactive_context(fn) {\n\tvar previous_reaction = active_reaction;\n\tvar previous_effect = active_effect;\n\tset_active_reaction(null);\n\tset_active_effect(null);\n\ttry {\n\t\treturn fn();\n\t} finally {\n\t\tset_active_reaction(previous_reaction);\n\t\tset_active_effect(previous_effect);\n\t}\n}\n\n/**\n * Listen to the given event, and then instantiate a global form reset listener if not already done,\n * to notify all bindings when the form is reset\n * @param {HTMLElement} element\n * @param {string} event\n * @param {(is_reset?: true) => void} handler\n * @param {(is_reset?: true) => void} [on_reset]\n */\nexport function listen_to_event_and_reset_event(element, event, handler, on_reset = handler) {\n\telement.addEventListener(event, () => without_reactive_context(handler));\n\t// @ts-expect-error\n\tconst prev = element.__on_r;\n\tif (prev) {\n\t\t// special case for checkbox that can have multiple binds (group & checked)\n\t\t// @ts-expect-error\n\t\telement.__on_r = () => {\n\t\t\tprev();\n\t\t\ton_reset(true);\n\t\t};\n\t} else {\n\t\t// @ts-expect-error\n\t\telement.__on_r = () => on_reset(true);\n\t}\n\n\tadd_form_reset_listener();\n}\n","import { teardown } from '../../reactivity/effects.js';\nimport { define_property, is_array } from '../../../shared/utils.js';\nimport { hydrating } from '../hydration.js';\nimport { queue_micro_task } from '../task.js';\nimport { FILENAME } from '../../../../constants.js';\nimport * as w from '../../warnings.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tset_active_effect,\n\tset_active_reaction\n} from '../../runtime.js';\nimport { without_reactive_context } from './bindings/shared.js';\n\n/** @type {Set<string>} */\nexport const all_registered_events = new Set();\n\n/** @type {Set<(events: Array<string>) => void>} */\nexport const root_event_handles = new Set();\n\n/**\n * SSR adds onload and onerror attributes to catch those events before the hydration.\n * This function detects those cases, removes the attributes and replays the events.\n * @param {HTMLElement} dom\n */\nexport function replay_events(dom) {\n\tif (!hydrating) return;\n\n\tdom.removeAttribute('onload');\n\tdom.removeAttribute('onerror');\n\t// @ts-expect-error\n\tconst event = dom.__e;\n\tif (event !== undefined) {\n\t\t// @ts-expect-error\n\t\tdom.__e = undefined;\n\t\tqueueMicrotask(() => {\n\t\t\tif (dom.isConnected) {\n\t\t\t\tdom.dispatchEvent(event);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * @param {string} event_name\n * @param {EventTarget} dom\n * @param {EventListener} [handler]\n * @param {AddEventListenerOptions} [options]\n */\nexport function create_event(event_name, dom, handler, options = {}) {\n\t/**\n\t * @this {EventTarget}\n\t */\n\tfunction target_handler(/** @type {Event} */ event) {\n\t\tif (!options.capture) {\n\t\t\t// Only call in the bubble phase, else delegated events would be called before the capturing events\n\t\t\thandle_event_propagation.call(dom, event);\n\t\t}\n\t\tif (!event.cancelBubble) {\n\t\t\treturn without_reactive_context(() => {\n\t\t\t\treturn handler?.call(this, event);\n\t\t\t});\n\t\t}\n\t}\n\n\t// Chrome has a bug where pointer events don't work when attached to a DOM element that has been cloned\n\t// with cloneNode() and the DOM element is disconnected from the document. To ensure the event works, we\n\t// defer the attachment till after it's been appended to the document. TODO: remove this once Chrome fixes\n\t// this bug. The same applies to wheel events and touch events.\n\tif (\n\t\tevent_name.startsWith('pointer') ||\n\t\tevent_name.startsWith('touch') ||\n\t\tevent_name === 'wheel'\n\t) {\n\t\tqueue_micro_task(() => {\n\t\t\tdom.addEventListener(event_name, target_handler, options);\n\t\t});\n\t} else {\n\t\tdom.addEventListener(event_name, target_handler, options);\n\t}\n\n\treturn target_handler;\n}\n\n/**\n * Attaches an event handler to an element and returns a function that removes the handler. Using this\n * rather than `addEventListener` will preserve the correct order relative to handlers added declaratively\n * (with attributes like `onclick`), which use event delegation for performance reasons\n *\n * @param {EventTarget} element\n * @param {string} type\n * @param {EventListener} handler\n * @param {AddEventListenerOptions} [options]\n */\nexport function on(element, type, handler, options = {}) {\n\tvar target_handler = create_event(type, element, handler, options);\n\n\treturn () => {\n\t\telement.removeEventListener(type, target_handler, options);\n\t};\n}\n\n/**\n * @param {string} event_name\n * @param {Element} dom\n * @param {EventListener} [handler]\n * @param {boolean} [capture]\n * @param {boolean} [passive]\n * @returns {void}\n */\nexport function event(event_name, dom, handler, capture, passive) {\n\tvar options = { capture, passive };\n\tvar target_handler = create_event(event_name, dom, handler, options);\n\n\tif (\n\t\tdom === document.body ||\n\t\t// @ts-ignore\n\t\tdom === window ||\n\t\t// @ts-ignore\n\t\tdom === document ||\n\t\t// Firefox has quirky behavior, it can happen that we still get \"canplay\" events when the element is already removed\n\t\tdom instanceof HTMLMediaElement\n\t) {\n\t\tteardown(() => {\n\t\t\tdom.removeEventListener(event_name, target_handler, options);\n\t\t});\n\t}\n}\n\n/**\n * @param {Array<string>} events\n * @returns {void}\n */\nexport function delegate(events) {\n\tfor (var i = 0; i < events.length; i++) {\n\t\tall_registered_events.add(events[i]);\n\t}\n\n\tfor (var fn of root_event_handles) {\n\t\tfn(events);\n\t}\n}\n\n/**\n * @this {EventTarget}\n * @param {Event} event\n * @returns {void}\n */\nexport function handle_event_propagation(event) {\n\tvar handler_element = this;\n\tvar owner_document = /** @type {Node} */ (handler_element).ownerDocument;\n\tvar event_name = event.type;\n\tvar path = event.composedPath?.() || [];\n\tvar current_target = /** @type {null | Element} */ (path[0] || event.target);\n\n\t// composedPath contains list of nodes the event has propagated through.\n\t// We check __root to skip all nodes below it in case this is a\n\t// parent of the __root node, which indicates that there's nested\n\t// mounted apps. In this case we don't want to trigger events multiple times.\n\tvar path_idx = 0;\n\n\t// @ts-expect-error is added below\n\tvar handled_at = event.__root;\n\n\tif (handled_at) {\n\t\tvar at_idx = path.indexOf(handled_at);\n\t\tif (\n\t\t\tat_idx !== -1 &&\n\t\t\t(handler_element === document || handler_element === /** @type {any} */ (window))\n\t\t) {\n\t\t\t// This is the fallback document listener or a window listener, but the event was already handled\n\t\t\t// -> ignore, but set handle_at to document/window so that we're resetting the event\n\t\t\t// chain in case someone manually dispatches the same event object again.\n\t\t\t// @ts-expect-error\n\t\t\tevent.__root = handler_element;\n\t\t\treturn;\n\t\t}\n\n\t\t// We're deliberately not skipping if the index is higher, because\n\t\t// someone could create an event programmatically and emit it multiple times,\n\t\t// in which case we want to handle the whole propagation chain properly each time.\n\t\t// (this will only be a false negative if the event is dispatched multiple times and\n\t\t// the fallback document listener isn't reached in between, but that's super rare)\n\t\tvar handler_idx = path.indexOf(handler_element);\n\t\tif (handler_idx === -1) {\n\t\t\t// handle_idx can theoretically be -1 (happened in some JSDOM testing scenarios with an event listener on the window object)\n\t\t\t// so guard against that, too, and assume that everything was handled at this point.\n\t\t\treturn;\n\t\t}\n\n\t\tif (at_idx <= handler_idx) {\n\t\t\tpath_idx = at_idx;\n\t\t}\n\t}\n\n\tcurrent_target = /** @type {Element} */ (path[path_idx] || event.target);\n\t// there can only be one delegated event per element, and we either already handled the current target,\n\t// or this is the very first target in the chain which has a non-delegated listener, in which case it's safe\n\t// to handle a possible delegated event on it later (through the root delegation listener for example).\n\tif (current_target === handler_element) return;\n\n\t// Proxy currentTarget to correct target\n\tdefine_property(event, 'currentTarget', {\n\t\tconfigurable: true,\n\t\tget() {\n\t\t\treturn current_target || owner_document;\n\t\t}\n\t});\n\n\t// This started because of Chromium issue https://chromestatus.com/feature/5128696823545856,\n\t// where removal or moving of of the DOM can cause sync `blur` events to fire, which can cause logic\n\t// to run inside the current `active_reaction`, which isn't what we want at all. However, on reflection,\n\t// it's probably best that all event handled by Svelte have this behaviour, as we don't really want\n\t// an event handler to run in the context of another reaction or effect.\n\tvar previous_reaction = active_reaction;\n\tvar previous_effect = active_effect;\n\tset_active_reaction(null);\n\tset_active_effect(null);\n\n\ttry {\n\t\t/**\n\t\t * @type {unknown}\n\t\t */\n\t\tvar throw_error;\n\t\t/**\n\t\t * @type {unknown[]}\n\t\t */\n\t\tvar other_errors = [];\n\n\t\twhile (current_target !== null) {\n\t\t\t/** @type {null | Element} */\n\t\t\tvar parent_element =\n\t\t\t\tcurrent_target.assignedSlot ||\n\t\t\t\tcurrent_target.parentNode ||\n\t\t\t\t/** @type {any} */ (current_target).host ||\n\t\t\t\tnull;\n\n\t\t\ttry {\n\t\t\t\t// @ts-expect-error\n\t\t\t\tvar delegated = current_target['__' + event_name];\n\n\t\t\t\tif (\n\t\t\t\t\tdelegated != null &&\n\t\t\t\t\t(!(/** @type {any} */ (current_target).disabled) ||\n\t\t\t\t\t\t// DOM could've been updated already by the time this is reached, so we check this as well\n\t\t\t\t\t\t// -> the target could not have been disabled because it emits the event in the first place\n\t\t\t\t\t\tevent.target === current_target)\n\t\t\t\t) {\n\t\t\t\t\tif (is_array(delegated)) {\n\t\t\t\t\t\tvar [fn, ...data] = delegated;\n\t\t\t\t\t\tfn.apply(current_target, [event, ...data]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelegated.call(current_target, event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tif (throw_error) {\n\t\t\t\t\tother_errors.push(error);\n\t\t\t\t} else {\n\t\t\t\t\tthrow_error = error;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (event.cancelBubble || parent_element === handler_element || parent_element === null) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcurrent_target = parent_element;\n\t\t}\n\n\t\tif (throw_error) {\n\t\t\tfor (let error of other_errors) {\n\t\t\t\t// Throw the rest of the errors, one-by-one on a microtask\n\t\t\t\tqueueMicrotask(() => {\n\t\t\t\t\tthrow error;\n\t\t\t\t});\n\t\t\t}\n\t\t\tthrow throw_error;\n\t\t}\n\t} finally {\n\t\t// @ts-expect-error is used above\n\t\tevent.__root = handler_element;\n\t\t// @ts-ignore remove proxy on currentTarget\n\t\tdelete event.currentTarget;\n\t\tset_active_reaction(previous_reaction);\n\t\tset_active_effect(previous_effect);\n\t}\n}\n\n/**\n * In dev, warn if an event handler is not a function, as it means the\n * user probably called the handler or forgot to add a `() =>`\n * @param {() => (event: Event, ...args: any) => void} thunk\n * @param {EventTarget} element\n * @param {[Event, ...any]} args\n * @param {any} component\n * @param {[number, number]} [loc]\n * @param {boolean} [remove_parens]\n */\nexport function apply(\n\tthunk,\n\telement,\n\targs,\n\tcomponent,\n\tloc,\n\thas_side_effects = false,\n\tremove_parens = false\n) {\n\tlet handler;\n\tlet error;\n\n\ttry {\n\t\thandler = thunk();\n\t} catch (e) {\n\t\terror = e;\n\t}\n\n\tif (typeof handler !== 'function' && (has_side_effects || handler != null || error)) {\n\t\tconst filename = component?.[FILENAME];\n\t\tconst location = loc ? ` at ${filename}:${loc[0]}:${loc[1]}` : ` in ${filename}`;\n\t\tconst phase = args[0]?.eventPhase < Event.BUBBLING_PHASE ? 'capture' : '';\n\t\tconst event_name = args[0]?.type + phase;\n\t\tconst description = `\\`${event_name}\\` handler${location}`;\n\t\tconst suggestion = remove_parens ? 'remove the trailing `()`' : 'add a leading `() =>`';\n\n\t\tw.event_handler_invalid(description, suggestion);\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n\thandler?.apply(element, args);\n}\n","/** @param {string} html */\nexport function create_fragment_from_html(html) {\n\tvar elem = document.createElement('template');\n\telem.innerHTML = html.replaceAll('<!>', '<!---->'); // XHTML compliance\n\treturn elem.content;\n}\n","/** @import { Effect, TemplateNode } from '#client' */\n/** @import { TemplateStructure } from './types' */\nimport { hydrate_next, hydrate_node, hydrating, set_hydrate_node } from './hydration.js';\nimport {\n\tcreate_text,\n\tget_first_child,\n\tis_firefox,\n\tcreate_element,\n\tcreate_fragment,\n\tcreate_comment,\n\tset_attribute\n} from './operations.js';\nimport { create_fragment_from_html } from './reconciler.js';\nimport { active_effect } from '../runtime.js';\nimport {\n\tNAMESPACE_MATHML,\n\tNAMESPACE_SVG,\n\tTEMPLATE_FRAGMENT,\n\tTEMPLATE_USE_IMPORT_NODE,\n\tTEMPLATE_USE_MATHML,\n\tTEMPLATE_USE_SVG\n} from '../../../constants.js';\nimport { COMMENT_NODE, DOCUMENT_FRAGMENT_NODE, TEXT_NODE } from '#client/constants';\n\n/**\n * @param {TemplateNode} start\n * @param {TemplateNode | null} end\n */\nexport function assign_nodes(start, end) {\n\tvar effect = /** @type {Effect} */ (active_effect);\n\tif (effect.nodes_start === null) {\n\t\teffect.nodes_start = start;\n\t\teffect.nodes_end = end;\n\t}\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function from_html(content, flags) {\n\tvar is_fragment = (flags & TEMPLATE_FRAGMENT) !== 0;\n\tvar use_import_node = (flags & TEMPLATE_USE_IMPORT_NODE) !== 0;\n\n\t/** @type {Node} */\n\tvar node;\n\n\t/**\n\t * Whether or not the first item is a text/element node. If not, we need to\n\t * create an additional comment node to act as `effect.nodes.start`\n\t */\n\tvar has_start = !content.startsWith('<!>');\n\n\treturn () => {\n\t\tif (hydrating) {\n\t\t\tassign_nodes(hydrate_node, null);\n\t\t\treturn hydrate_node;\n\t\t}\n\n\t\tif (node === undefined) {\n\t\t\tnode = create_fragment_from_html(has_start ? content : '<!>' + content);\n\t\t\tif (!is_fragment) node = /** @type {Node} */ (get_first_child(node));\n\t\t}\n\n\t\tvar clone = /** @type {TemplateNode} */ (\n\t\t\tuse_import_node || is_firefox ? document.importNode(node, true) : node.cloneNode(true)\n\t\t);\n\n\t\tif (is_fragment) {\n\t\t\tvar start = /** @type {TemplateNode} */ (get_first_child(clone));\n\t\t\tvar end = /** @type {TemplateNode} */ (clone.lastChild);\n\n\t\t\tassign_nodes(start, end);\n\t\t} else {\n\t\t\tassign_nodes(clone, clone);\n\t\t}\n\n\t\treturn clone;\n\t};\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n * @param {'svg' | 'math'} ns\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nfunction from_namespace(content, flags, ns = 'svg') {\n\t/**\n\t * Whether or not the first item is a text/element node. If not, we need to\n\t * create an additional comment node to act as `effect.nodes.start`\n\t */\n\tvar has_start = !content.startsWith('<!>');\n\n\tvar is_fragment = (flags & TEMPLATE_FRAGMENT) !== 0;\n\tvar wrapped = `<${ns}>${has_start ? content : '<!>' + content}</${ns}>`;\n\n\t/** @type {Element | DocumentFragment} */\n\tvar node;\n\n\treturn () => {\n\t\tif (hydrating) {\n\t\t\tassign_nodes(hydrate_node, null);\n\t\t\treturn hydrate_node;\n\t\t}\n\n\t\tif (!node) {\n\t\t\tvar fragment = /** @type {DocumentFragment} */ (create_fragment_from_html(wrapped));\n\t\t\tvar root = /** @type {Element} */ (get_first_child(fragment));\n\n\t\t\tif (is_fragment) {\n\t\t\t\tnode = document.createDocumentFragment();\n\t\t\t\twhile (get_first_child(root)) {\n\t\t\t\t\tnode.appendChild(/** @type {Node} */ (get_first_child(root)));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode = /** @type {Element} */ (get_first_child(root));\n\t\t\t}\n\t\t}\n\n\t\tvar clone = /** @type {TemplateNode} */ (node.cloneNode(true));\n\n\t\tif (is_fragment) {\n\t\t\tvar start = /** @type {TemplateNode} */ (get_first_child(clone));\n\t\t\tvar end = /** @type {TemplateNode} */ (clone.lastChild);\n\n\t\t\tassign_nodes(start, end);\n\t\t} else {\n\t\t\tassign_nodes(clone, clone);\n\t\t}\n\n\t\treturn clone;\n\t};\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function from_svg(content, flags) {\n\treturn from_namespace(content, flags, 'svg');\n}\n\n/**\n * @param {string} content\n * @param {number} flags\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function from_mathml(content, flags) {\n\treturn from_namespace(content, flags, 'math');\n}\n\n/**\n * @param {TemplateStructure[]} structure\n * @param {NAMESPACE_SVG | NAMESPACE_MATHML | undefined} [ns]\n */\nfunction fragment_from_tree(structure, ns) {\n\tvar fragment = create_fragment();\n\n\tfor (var item of structure) {\n\t\tif (typeof item === 'string') {\n\t\t\tfragment.append(create_text(item));\n\t\t\tcontinue;\n\t\t}\n\n\t\t// if `preserveComments === true`, comments are represented as `['// <data>']`\n\t\tif (item === undefined || item[0][0] === '/') {\n\t\t\tfragment.append(create_comment(item ? item[0].slice(3) : ''));\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst [name, attributes, ...children] = item;\n\n\t\tconst namespace = name === 'svg' ? NAMESPACE_SVG : name === 'math' ? NAMESPACE_MATHML : ns;\n\n\t\tvar element = create_element(name, namespace, attributes?.is);\n\n\t\tfor (var key in attributes) {\n\t\t\tset_attribute(element, key, attributes[key]);\n\t\t}\n\n\t\tif (children.length > 0) {\n\t\t\tvar target =\n\t\t\t\telement.tagName === 'TEMPLATE'\n\t\t\t\t\t? /** @type {HTMLTemplateElement} */ (element).content\n\t\t\t\t\t: element;\n\n\t\t\ttarget.append(\n\t\t\t\tfragment_from_tree(children, element.tagName === 'foreignObject' ? undefined : namespace)\n\t\t\t);\n\t\t}\n\n\t\tfragment.append(element);\n\t}\n\n\treturn fragment;\n}\n\n/**\n * @param {TemplateStructure[]} structure\n * @param {number} flags\n * @returns {() => Node | Node[]}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function from_tree(structure, flags) {\n\tvar is_fragment = (flags & TEMPLATE_FRAGMENT) !== 0;\n\tvar use_import_node = (flags & TEMPLATE_USE_IMPORT_NODE) !== 0;\n\n\t/** @type {Node} */\n\tvar node;\n\n\treturn () => {\n\t\tif (hydrating) {\n\t\t\tassign_nodes(hydrate_node, null);\n\t\t\treturn hydrate_node;\n\t\t}\n\n\t\tif (node === undefined) {\n\t\t\tconst ns =\n\t\t\t\t(flags & TEMPLATE_USE_SVG) !== 0\n\t\t\t\t\t? NAMESPACE_SVG\n\t\t\t\t\t: (flags & TEMPLATE_USE_MATHML) !== 0\n\t\t\t\t\t\t? NAMESPACE_MATHML\n\t\t\t\t\t\t: undefined;\n\n\t\t\tnode = fragment_from_tree(structure, ns);\n\t\t\tif (!is_fragment) node = /** @type {Node} */ (get_first_child(node));\n\t\t}\n\n\t\tvar clone = /** @type {TemplateNode} */ (\n\t\t\tuse_import_node || is_firefox ? document.importNode(node, true) : node.cloneNode(true)\n\t\t);\n\n\t\tif (is_fragment) {\n\t\t\tvar start = /** @type {TemplateNode} */ (get_first_child(clone));\n\t\t\tvar end = /** @type {TemplateNode} */ (clone.lastChild);\n\n\t\t\tassign_nodes(start, end);\n\t\t} else {\n\t\t\tassign_nodes(clone, clone);\n\t\t}\n\n\t\treturn clone;\n\t};\n}\n\n/**\n * @param {() => Element | DocumentFragment} fn\n */\nexport function with_script(fn) {\n\treturn () => run_scripts(fn());\n}\n\n/**\n * Creating a document fragment from HTML that contains script tags will not execute\n * the scripts. We need to replace the script tags with new ones so that they are executed.\n * @param {Element | DocumentFragment} node\n * @returns {Node | Node[]}\n */\nfunction run_scripts(node) {\n\t// scripts were SSR'd, in which case they will run\n\tif (hydrating) return node;\n\n\tconst is_fragment = node.nodeType === DOCUMENT_FRAGMENT_NODE;\n\tconst scripts =\n\t\t/** @type {HTMLElement} */ (node).tagName === 'SCRIPT'\n\t\t\t? [/** @type {HTMLScriptElement} */ (node)]\n\t\t\t: node.querySelectorAll('script');\n\tconst effect = /** @type {Effect} */ (active_effect);\n\n\tfor (const script of scripts) {\n\t\tconst clone = document.createElement('script');\n\t\tfor (var attribute of script.attributes) {\n\t\t\tclone.setAttribute(attribute.name, attribute.value);\n\t\t}\n\n\t\tclone.textContent = script.textContent;\n\n\t\t// The script has changed - if it's at the edges, the effect now points at dead nodes\n\t\tif (is_fragment ? node.firstChild === script : node === script) {\n\t\t\teffect.nodes_start = clone;\n\t\t}\n\t\tif (is_fragment ? node.lastChild === script : node === script) {\n\t\t\teffect.nodes_end = clone;\n\t\t}\n\n\t\tscript.replaceWith(clone);\n\t}\n\treturn node;\n}\n\n/**\n * Don't mark this as side-effect-free, hydration needs to walk all nodes\n * @param {any} value\n */\nexport function text(value = '') {\n\tif (!hydrating) {\n\t\tvar t = create_text(value + '');\n\t\tassign_nodes(t, t);\n\t\treturn t;\n\t}\n\n\tvar node = hydrate_node;\n\n\tif (node.nodeType !== TEXT_NODE) {\n\t\t// if an {expression} is empty during SSR, we need to insert an empty text node\n\t\tnode.before((node = create_text()));\n\t\tset_hydrate_node(node);\n\t}\n\n\tassign_nodes(node, node);\n\treturn node;\n}\n\nexport function comment() {\n\t// we're not delegating to `template` here for performance reasons\n\tif (hydrating) {\n\t\tassign_nodes(hydrate_node, null);\n\t\treturn hydrate_node;\n\t}\n\n\tvar frag = document.createDocumentFragment();\n\tvar start = document.createComment('');\n\tvar anchor = create_text();\n\tfrag.append(start, anchor);\n\n\tassign_nodes(start, anchor);\n\n\treturn frag;\n}\n\n/**\n * Assign the created (or in hydration mode, traversed) dom elements to the current block\n * and insert the elements into the dom (in client mode).\n * @param {Text | Comment | Element} anchor\n * @param {DocumentFragment | Element} dom\n */\nexport function append(anchor, dom) {\n\tif (hydrating) {\n\t\t/** @type {Effect} */ (active_effect).nodes_end = hydrate_node;\n\t\thydrate_next();\n\t\treturn;\n\t}\n\n\tif (anchor === null) {\n\t\t// edge case — void `<svelte:element>` with content\n\t\treturn;\n\t}\n\n\tanchor.before(/** @type {Node} */ (dom));\n}\n\n/**\n * Create (or hydrate) an unique UID for the component instance.\n */\nexport function props_id() {\n\tif (\n\t\thydrating &&\n\t\thydrate_node &&\n\t\thydrate_node.nodeType === COMMENT_NODE &&\n\t\thydrate_node.textContent?.startsWith(`#`)\n\t) {\n\t\tconst id = hydrate_node.textContent.substring(1);\n\t\thydrate_next();\n\t\treturn id;\n\t}\n\n\t// @ts-expect-error This way we ensure the id is unique even across Svelte runtimes\n\t(window.__svelte ??= {}).uid ??= 1;\n\n\t// @ts-expect-error\n\treturn `c${window.__svelte.uid++}`;\n}\n","const regex_return_characters = /\\r/g;\n\n/**\n * @param {string} str\n * @returns {string}\n */\nexport function hash(str) {\n\tstr = str.replace(regex_return_characters, '');\n\tlet hash = 5381;\n\tlet i = str.length;\n\n\twhile (i--) hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n\treturn (hash >>> 0).toString(36);\n}\n\nconst VOID_ELEMENT_NAMES = [\n\t'area',\n\t'base',\n\t'br',\n\t'col',\n\t'command',\n\t'embed',\n\t'hr',\n\t'img',\n\t'input',\n\t'keygen',\n\t'link',\n\t'meta',\n\t'param',\n\t'source',\n\t'track',\n\t'wbr'\n];\n\n/**\n * Returns `true` if `name` is of a void element\n * @param {string} name\n */\nexport function is_void(name) {\n\treturn VOID_ELEMENT_NAMES.includes(name) || name.toLowerCase() === '!doctype';\n}\n\nconst RESERVED_WORDS = [\n\t'arguments',\n\t'await',\n\t'break',\n\t'case',\n\t'catch',\n\t'class',\n\t'const',\n\t'continue',\n\t'debugger',\n\t'default',\n\t'delete',\n\t'do',\n\t'else',\n\t'enum',\n\t'eval',\n\t'export',\n\t'extends',\n\t'false',\n\t'finally',\n\t'for',\n\t'function',\n\t'if',\n\t'implements',\n\t'import',\n\t'in',\n\t'instanceof',\n\t'interface',\n\t'let',\n\t'new',\n\t'null',\n\t'package',\n\t'private',\n\t'protected',\n\t'public',\n\t'return',\n\t'static',\n\t'super',\n\t'switch',\n\t'this',\n\t'throw',\n\t'true',\n\t'try',\n\t'typeof',\n\t'var',\n\t'void',\n\t'while',\n\t'with',\n\t'yield'\n];\n\n/**\n * Returns `true` if `word` is a reserved JavaScript keyword\n * @param {string} word\n */\nexport function is_reserved(word) {\n\treturn RESERVED_WORDS.includes(word);\n}\n\n/**\n * @param {string} name\n */\nexport function is_capture_event(name) {\n\treturn name.endsWith('capture') && name !== 'gotpointercapture' && name !== 'lostpointercapture';\n}\n\n/** List of Element events that will be delegated */\nconst DELEGATED_EVENTS = [\n\t'beforeinput',\n\t'click',\n\t'change',\n\t'dblclick',\n\t'contextmenu',\n\t'focusin',\n\t'focusout',\n\t'input',\n\t'keydown',\n\t'keyup',\n\t'mousedown',\n\t'mousemove',\n\t'mouseout',\n\t'mouseover',\n\t'mouseup',\n\t'pointerdown',\n\t'pointermove',\n\t'pointerout',\n\t'pointerover',\n\t'pointerup',\n\t'touchend',\n\t'touchmove',\n\t'touchstart'\n];\n\n/**\n * Returns `true` if `event_name` is a delegated event\n * @param {string} event_name\n */\nexport function is_delegated(event_name) {\n\treturn DELEGATED_EVENTS.includes(event_name);\n}\n\n/**\n * Attributes that are boolean, i.e. they are present or not present.\n */\nconst DOM_BOOLEAN_ATTRIBUTES = [\n\t'allowfullscreen',\n\t'async',\n\t'autofocus',\n\t'autoplay',\n\t'checked',\n\t'controls',\n\t'default',\n\t'disabled',\n\t'formnovalidate',\n\t'hidden',\n\t'indeterminate',\n\t'inert',\n\t'ismap',\n\t'loop',\n\t'multiple',\n\t'muted',\n\t'nomodule',\n\t'novalidate',\n\t'open',\n\t'playsinline',\n\t'readonly',\n\t'required',\n\t'reversed',\n\t'seamless',\n\t'selected',\n\t'webkitdirectory',\n\t'defer',\n\t'disablepictureinpicture',\n\t'disableremoteplayback'\n];\n\n/**\n * Returns `true` if `name` is a boolean attribute\n * @param {string} name\n */\nexport function is_boolean_attribute(name) {\n\treturn DOM_BOOLEAN_ATTRIBUTES.includes(name);\n}\n\n/**\n * @type {Record<string, string>}\n * List of attribute names that should be aliased to their property names\n * because they behave differently between setting them as an attribute and\n * setting them as a property.\n */\nconst ATTRIBUTE_ALIASES = {\n\t// no `class: 'className'` because we handle that separately\n\tformnovalidate: 'formNoValidate',\n\tismap: 'isMap',\n\tnomodule: 'noModule',\n\tplaysinline: 'playsInline',\n\treadonly: 'readOnly',\n\tdefaultvalue: 'defaultValue',\n\tdefaultchecked: 'defaultChecked',\n\tsrcobject: 'srcObject',\n\tnovalidate: 'noValidate',\n\tallowfullscreen: 'allowFullscreen',\n\tdisablepictureinpicture: 'disablePictureInPicture',\n\tdisableremoteplayback: 'disableRemotePlayback'\n};\n\n/**\n * @param {string} name\n */\nexport function normalize_attribute(name) {\n\tname = name.toLowerCase();\n\treturn ATTRIBUTE_ALIASES[name] ?? name;\n}\n\nconst DOM_PROPERTIES = [\n\t...DOM_BOOLEAN_ATTRIBUTES,\n\t'formNoValidate',\n\t'isMap',\n\t'noModule',\n\t'playsInline',\n\t'readOnly',\n\t'value',\n\t'volume',\n\t'defaultValue',\n\t'defaultChecked',\n\t'srcObject',\n\t'noValidate',\n\t'allowFullscreen',\n\t'disablePictureInPicture',\n\t'disableRemotePlayback'\n];\n\n/**\n * @param {string} name\n */\nexport function is_dom_property(name) {\n\treturn DOM_PROPERTIES.includes(name);\n}\n\nconst NON_STATIC_PROPERTIES = ['autofocus', 'muted', 'defaultValue', 'defaultChecked'];\n\n/**\n * Returns `true` if the given attribute cannot be set through the template\n * string, i.e. needs some kind of JavaScript handling to work.\n * @param {string} name\n */\nexport function cannot_be_set_statically(name) {\n\treturn NON_STATIC_PROPERTIES.includes(name);\n}\n\n/**\n * Subset of delegated events which should be passive by default.\n * These two are already passive via browser defaults on window, document and body.\n * But since\n * - we're delegating them\n * - they happen often\n * - they apply to mobile which is generally less performant\n * we're marking them as passive by default for other elements, too.\n */\nconst PASSIVE_EVENTS = ['touchstart', 'touchmove'];\n\n/**\n * Returns `true` if `name` is a passive event\n * @param {string} name\n */\nexport function is_passive_event(name) {\n\treturn PASSIVE_EVENTS.includes(name);\n}\n\nconst CONTENT_EDITABLE_BINDINGS = ['textContent', 'innerHTML', 'innerText'];\n\n/** @param {string} name */\nexport function is_content_editable_binding(name) {\n\treturn CONTENT_EDITABLE_BINDINGS.includes(name);\n}\n\nconst LOAD_ERROR_ELEMENTS = [\n\t'body',\n\t'embed',\n\t'iframe',\n\t'img',\n\t'link',\n\t'object',\n\t'script',\n\t'style',\n\t'track'\n];\n\n/**\n * Returns `true` if the element emits `load` and `error` events\n * @param {string} name\n */\nexport function is_load_error_element(name) {\n\treturn LOAD_ERROR_ELEMENTS.includes(name);\n}\n\nconst SVG_ELEMENTS = [\n\t'altGlyph',\n\t'altGlyphDef',\n\t'altGlyphItem',\n\t'animate',\n\t'animateColor',\n\t'animateMotion',\n\t'animateTransform',\n\t'circle',\n\t'clipPath',\n\t'color-profile',\n\t'cursor',\n\t'defs',\n\t'desc',\n\t'discard',\n\t'ellipse',\n\t'feBlend',\n\t'feColorMatrix',\n\t'feComponentTransfer',\n\t'feComposite',\n\t'feConvolveMatrix',\n\t'feDiffuseLighting',\n\t'feDisplacementMap',\n\t'feDistantLight',\n\t'feDropShadow',\n\t'feFlood',\n\t'feFuncA',\n\t'feFuncB',\n\t'feFuncG',\n\t'feFuncR',\n\t'feGaussianBlur',\n\t'feImage',\n\t'feMerge',\n\t'feMergeNode',\n\t'feMorphology',\n\t'feOffset',\n\t'fePointLight',\n\t'feSpecularLighting',\n\t'feSpotLight',\n\t'feTile',\n\t'feTurbulence',\n\t'filter',\n\t'font',\n\t'font-face',\n\t'font-face-format',\n\t'font-face-name',\n\t'font-face-src',\n\t'font-face-uri',\n\t'foreignObject',\n\t'g',\n\t'glyph',\n\t'glyphRef',\n\t'hatch',\n\t'hatchpath',\n\t'hkern',\n\t'image',\n\t'line',\n\t'linearGradient',\n\t'marker',\n\t'mask',\n\t'mesh',\n\t'meshgradient',\n\t'meshpatch',\n\t'meshrow',\n\t'metadata',\n\t'missing-glyph',\n\t'mpath',\n\t'path',\n\t'pattern',\n\t'polygon',\n\t'polyline',\n\t'radialGradient',\n\t'rect',\n\t'set',\n\t'solidcolor',\n\t'stop',\n\t'svg',\n\t'switch',\n\t'symbol',\n\t'text',\n\t'textPath',\n\t'tref',\n\t'tspan',\n\t'unknown',\n\t'use',\n\t'view',\n\t'vkern'\n];\n\n/** @param {string} name */\nexport function is_svg(name) {\n\treturn SVG_ELEMENTS.includes(name);\n}\n\nconst MATHML_ELEMENTS = [\n\t'annotation',\n\t'annotation-xml',\n\t'maction',\n\t'math',\n\t'merror',\n\t'mfrac',\n\t'mi',\n\t'mmultiscripts',\n\t'mn',\n\t'mo',\n\t'mover',\n\t'mpadded',\n\t'mphantom',\n\t'mprescripts',\n\t'mroot',\n\t'mrow',\n\t'ms',\n\t'mspace',\n\t'msqrt',\n\t'mstyle',\n\t'msub',\n\t'msubsup',\n\t'msup',\n\t'mtable',\n\t'mtd',\n\t'mtext',\n\t'mtr',\n\t'munder',\n\t'munderover',\n\t'semantics'\n];\n\n/** @param {string} name */\nexport function is_mathml(name) {\n\treturn MATHML_ELEMENTS.includes(name);\n}\n\nexport const STATE_CREATION_RUNES = /** @type {const} */ ([\n\t'$state',\n\t'$state.raw',\n\t'$derived',\n\t'$derived.by'\n]);\n\nconst RUNES = /** @type {const} */ ([\n\t...STATE_CREATION_RUNES,\n\t'$state.snapshot',\n\t'$props',\n\t'$props.id',\n\t'$bindable',\n\t'$effect',\n\t'$effect.pre',\n\t'$effect.tracking',\n\t'$effect.root',\n\t'$inspect',\n\t'$inspect().with',\n\t'$inspect.trace',\n\t'$host'\n]);\n\n/** @typedef {RUNES[number]} RuneName */\n\n/**\n * @param {string} name\n * @returns {name is RuneName}\n */\nexport function is_rune(name) {\n\treturn RUNES.includes(/** @type {RuneName} */ (name));\n}\n\n/** @typedef {STATE_CREATION_RUNES[number]} StateCreationRuneName */\n\n/**\n * @param {string} name\n * @returns {name is StateCreationRuneName}\n */\nexport function is_state_creation_rune(name) {\n\treturn STATE_CREATION_RUNES.includes(/** @type {StateCreationRuneName} */ (name));\n}\n\n/** List of elements that require raw contents and should not have SSR comments put in them */\nconst RAW_TEXT_ELEMENTS = /** @type {const} */ (['textarea', 'script', 'style', 'title']);\n\n/** @param {string} name */\nexport function is_raw_text_element(name) {\n\treturn RAW_TEXT_ELEMENTS.includes(/** @type {RAW_TEXT_ELEMENTS[number]} */ (name));\n}\n\n/**\n * Prevent devtools trying to make `location` a clickable link by inserting a zero-width space\n * @template {string | undefined} T\n * @param {T} location\n * @returns {T};\n */\nexport function sanitize_location(location) {\n\treturn /** @type {T} */ (location?.replace(/\\//g, '/\\u200b'));\n}\n","/** @import { ComponentContext, Effect, TemplateNode } from '#client' */\n/** @import { Component, ComponentType, SvelteComponent, MountOptions } from '../../index.js' */\nimport { DEV } from 'esm-env';\nimport {\n\tclear_text_content,\n\tcreate_text,\n\tget_first_child,\n\tget_next_sibling,\n\tinit_operations\n} from './dom/operations.js';\nimport { HYDRATION_END, HYDRATION_ERROR, HYDRATION_START } from '../../constants.js';\nimport { active_effect } from './runtime.js';\nimport { push, pop, component_context } from './context.js';\nimport { component_root, branch } from './reactivity/effects.js';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tset_hydrate_node,\n\tset_hydrating\n} from './dom/hydration.js';\nimport { array_from } from '../shared/utils.js';\nimport {\n\tall_registered_events,\n\thandle_event_propagation,\n\troot_event_handles\n} from './dom/elements/events.js';\nimport { reset_head_anchor } from './dom/blocks/svelte-head.js';\nimport * as w from './warnings.js';\nimport * as e from './errors.js';\nimport { assign_nodes } from './dom/template.js';\nimport { is_passive_event } from '../../utils.js';\nimport { COMMENT_NODE } from './constants.js';\n\n/**\n * This is normally true — block effects should run their intro transitions —\n * but is false during hydration (unless `options.intro` is `true`) and\n * when creating the children of a `<svelte:element>` that just changed tag\n */\nexport let should_intro = true;\n\n/** @param {boolean} value */\nexport function set_should_intro(value) {\n\tshould_intro = value;\n}\n\n/**\n * @param {Element} text\n * @param {string} value\n * @returns {void}\n */\nexport function set_text(text, value) {\n\t// For objects, we apply string coercion (which might make things like $state array references in the template reactive) before diffing\n\tvar str = value == null ? '' : typeof value === 'object' ? value + '' : value;\n\t// @ts-expect-error\n\tif (str !== (text.__t ??= text.nodeValue)) {\n\t\t// @ts-expect-error\n\t\ttext.__t = str;\n\t\ttext.nodeValue = str + '';\n\t}\n}\n\n/**\n * Mounts a component to the given target and returns the exports and potentially the props (if compiled with `accessors: true`) of the component.\n * Transitions will play during the initial render unless the `intro` option is set to `false`.\n *\n * @template {Record<string, any>} Props\n * @template {Record<string, any>} Exports\n * @param {ComponentType<SvelteComponent<Props>> | Component<Props, Exports, any>} component\n * @param {MountOptions<Props>} options\n * @returns {Exports}\n */\nexport function mount(component, options) {\n\treturn _mount(component, options);\n}\n\n/**\n * Hydrates a component on the given target and returns the exports and potentially the props (if compiled with `accessors: true`) of the component\n *\n * @template {Record<string, any>} Props\n * @template {Record<string, any>} Exports\n * @param {ComponentType<SvelteComponent<Props>> | Component<Props, Exports, any>} component\n * @param {{} extends Props ? {\n * \t\ttarget: Document | Element | ShadowRoot;\n * \t\tprops?: Props;\n * \t\tevents?: Record<string, (e: any) => any>;\n *  \tcontext?: Map<any, any>;\n * \t\tintro?: boolean;\n * \t\trecover?: boolean;\n * \t} : {\n * \t\ttarget: Document | Element | ShadowRoot;\n * \t\tprops: Props;\n * \t\tevents?: Record<string, (e: any) => any>;\n *  \tcontext?: Map<any, any>;\n * \t\tintro?: boolean;\n * \t\trecover?: boolean;\n * \t}} options\n * @returns {Exports}\n */\nexport function hydrate(component, options) {\n\tinit_operations();\n\toptions.intro = options.intro ?? false;\n\tconst target = options.target;\n\tconst was_hydrating = hydrating;\n\tconst previous_hydrate_node = hydrate_node;\n\n\ttry {\n\t\tvar anchor = /** @type {TemplateNode} */ (get_first_child(target));\n\t\twhile (\n\t\t\tanchor &&\n\t\t\t(anchor.nodeType !== COMMENT_NODE || /** @type {Comment} */ (anchor).data !== HYDRATION_START)\n\t\t) {\n\t\t\tanchor = /** @type {TemplateNode} */ (get_next_sibling(anchor));\n\t\t}\n\n\t\tif (!anchor) {\n\t\t\tthrow HYDRATION_ERROR;\n\t\t}\n\n\t\tset_hydrating(true);\n\t\tset_hydrate_node(/** @type {Comment} */ (anchor));\n\t\thydrate_next();\n\n\t\tconst instance = _mount(component, { ...options, anchor });\n\n\t\tif (\n\t\t\thydrate_node === null ||\n\t\t\thydrate_node.nodeType !== COMMENT_NODE ||\n\t\t\t/** @type {Comment} */ (hydrate_node).data !== HYDRATION_END\n\t\t) {\n\t\t\tw.hydration_mismatch();\n\t\t\tthrow HYDRATION_ERROR;\n\t\t}\n\n\t\tset_hydrating(false);\n\n\t\treturn /**  @type {Exports} */ (instance);\n\t} catch (error) {\n\t\tif (error === HYDRATION_ERROR) {\n\t\t\tif (options.recover === false) {\n\t\t\t\te.hydration_failed();\n\t\t\t}\n\n\t\t\t// If an error occured above, the operations might not yet have been initialised.\n\t\t\tinit_operations();\n\t\t\tclear_text_content(target);\n\n\t\t\tset_hydrating(false);\n\t\t\treturn mount(component, options);\n\t\t}\n\n\t\tthrow error;\n\t} finally {\n\t\tset_hydrating(was_hydrating);\n\t\tset_hydrate_node(previous_hydrate_node);\n\t\treset_head_anchor();\n\t}\n}\n\n/** @type {Map<string, number>} */\nconst document_listeners = new Map();\n\n/**\n * @template {Record<string, any>} Exports\n * @param {ComponentType<SvelteComponent<any>> | Component<any>} Component\n * @param {MountOptions} options\n * @returns {Exports}\n */\nfunction _mount(Component, { target, anchor, props = {}, events, context, intro = true }) {\n\tinit_operations();\n\n\tvar registered_events = new Set();\n\n\t/** @param {Array<string>} events */\n\tvar event_handle = (events) => {\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tvar event_name = events[i];\n\n\t\t\tif (registered_events.has(event_name)) continue;\n\t\t\tregistered_events.add(event_name);\n\n\t\t\tvar passive = is_passive_event(event_name);\n\n\t\t\t// Add the event listener to both the container and the document.\n\t\t\t// The container listener ensures we catch events from within in case\n\t\t\t// the outer content stops propagation of the event.\n\t\t\ttarget.addEventListener(event_name, handle_event_propagation, { passive });\n\n\t\t\tvar n = document_listeners.get(event_name);\n\n\t\t\tif (n === undefined) {\n\t\t\t\t// The document listener ensures we catch events that originate from elements that were\n\t\t\t\t// manually moved outside of the container (e.g. via manual portals).\n\t\t\t\tdocument.addEventListener(event_name, handle_event_propagation, { passive });\n\t\t\t\tdocument_listeners.set(event_name, 1);\n\t\t\t} else {\n\t\t\t\tdocument_listeners.set(event_name, n + 1);\n\t\t\t}\n\t\t}\n\t};\n\n\tevent_handle(array_from(all_registered_events));\n\troot_event_handles.add(event_handle);\n\n\t/** @type {Exports} */\n\t// @ts-expect-error will be defined because the render effect runs synchronously\n\tvar component = undefined;\n\n\tvar unmount = component_root(() => {\n\t\tvar anchor_node = anchor ?? target.appendChild(create_text());\n\n\t\tbranch(() => {\n\t\t\tif (context) {\n\t\t\t\tpush({});\n\t\t\t\tvar ctx = /** @type {ComponentContext} */ (component_context);\n\t\t\t\tctx.c = context;\n\t\t\t}\n\n\t\t\tif (events) {\n\t\t\t\t// We can't spread the object or else we'd lose the state proxy stuff, if it is one\n\t\t\t\t/** @type {any} */ (props).$$events = events;\n\t\t\t}\n\n\t\t\tif (hydrating) {\n\t\t\t\tassign_nodes(/** @type {TemplateNode} */ (anchor_node), null);\n\t\t\t}\n\n\t\t\tshould_intro = intro;\n\t\t\t// @ts-expect-error the public typings are not what the actual function looks like\n\t\t\tcomponent = Component(anchor_node, props) || {};\n\t\t\tshould_intro = true;\n\n\t\t\tif (hydrating) {\n\t\t\t\t/** @type {Effect} */ (active_effect).nodes_end = hydrate_node;\n\t\t\t}\n\n\t\t\tif (context) {\n\t\t\t\tpop();\n\t\t\t}\n\t\t});\n\n\t\treturn () => {\n\t\t\tfor (var event_name of registered_events) {\n\t\t\t\ttarget.removeEventListener(event_name, handle_event_propagation);\n\n\t\t\t\tvar n = /** @type {number} */ (document_listeners.get(event_name));\n\n\t\t\t\tif (--n === 0) {\n\t\t\t\t\tdocument.removeEventListener(event_name, handle_event_propagation);\n\t\t\t\t\tdocument_listeners.delete(event_name);\n\t\t\t\t} else {\n\t\t\t\t\tdocument_listeners.set(event_name, n);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\troot_event_handles.delete(event_handle);\n\n\t\t\tif (anchor_node !== anchor) {\n\t\t\t\tanchor_node.parentNode?.removeChild(anchor_node);\n\t\t\t}\n\t\t};\n\t});\n\n\tmounted_components.set(component, unmount);\n\treturn component;\n}\n\n/**\n * References of the components that were mounted or hydrated.\n * Uses a `WeakMap` to avoid memory leaks.\n */\nlet mounted_components = new WeakMap();\n\n/**\n * Unmounts a component that was previously mounted using `mount` or `hydrate`.\n *\n * Since 5.13.0, if `options.outro` is `true`, [transitions](https://svelte.dev/docs/svelte/transition) will play before the component is removed from the DOM.\n *\n * Returns a `Promise` that resolves after transitions have completed if `options.outro` is true, or immediately otherwise (prior to 5.13.0, returns `void`).\n *\n * ```js\n * import { mount, unmount } from 'svelte';\n * import App from './App.svelte';\n *\n * const app = mount(App, { target: document.body });\n *\n * // later...\n * unmount(app, { outro: true });\n * ```\n * @param {Record<string, any>} component\n * @param {{ outro?: boolean }} [options]\n * @returns {Promise<void>}\n */\nexport function unmount(component, options) {\n\tconst fn = mounted_components.get(component);\n\n\tif (fn) {\n\t\tmounted_components.delete(component);\n\t\treturn fn(options);\n\t}\n\n\tif (DEV) {\n\t\tw.lifecycle_double_unmount();\n\t}\n\n\treturn Promise.resolve();\n}\n","/** @import { ComponentContext, ComponentContextLegacy } from '#client' */\n/** @import { EventDispatcher } from './index.js' */\n/** @import { NotFunction } from './internal/types.js' */\nimport { active_reaction, untrack } from './internal/client/runtime.js';\nimport { is_array } from './internal/shared/utils.js';\nimport { user_effect } from './internal/client/index.js';\nimport * as e from './internal/client/errors.js';\nimport { lifecycle_outside_component } from './internal/shared/errors.js';\nimport { legacy_mode_flag } from './internal/flags/index.js';\nimport { component_context } from './internal/client/context.js';\nimport { DEV } from 'esm-env';\n\nif (DEV) {\n\t/**\n\t * @param {string} rune\n\t */\n\tfunction throw_rune_error(rune) {\n\t\tif (!(rune in globalThis)) {\n\t\t\t// TODO if people start adjusting the \"this can contain runes\" config through v-p-s more, adjust this message\n\t\t\t/** @type {any} */\n\t\t\tlet value; // let's hope noone modifies this global, but belts and braces\n\t\t\tObject.defineProperty(globalThis, rune, {\n\t\t\t\tconfigurable: true,\n\t\t\t\t// eslint-disable-next-line getter-return\n\t\t\t\tget: () => {\n\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\n\t\t\t\t\te.rune_outside_svelte(rune);\n\t\t\t\t},\n\t\t\t\tset: (v) => {\n\t\t\t\t\tvalue = v;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tthrow_rune_error('$state');\n\tthrow_rune_error('$effect');\n\tthrow_rune_error('$derived');\n\tthrow_rune_error('$inspect');\n\tthrow_rune_error('$props');\n\tthrow_rune_error('$bindable');\n}\n\n/**\n * Returns an [`AbortSignal`](https://developer.mozilla.org/en-US/docs/Web/API/AbortSignal) that aborts when the current [derived](https://svelte.dev/docs/svelte/$derived) or [effect](https://svelte.dev/docs/svelte/$effect) re-runs or is destroyed.\n *\n * Must be called while a derived or effect is running.\n *\n * ```svelte\n * <script>\n * \timport { getAbortSignal } from 'svelte';\n *\n * \tlet { id } = $props();\n *\n * \tasync function getData(id) {\n * \t\tconst response = await fetch(`/items/${id}`, {\n * \t\t\tsignal: getAbortSignal()\n * \t\t});\n *\n * \t\treturn await response.json();\n * \t}\n *\n * \tconst data = $derived(await getData(id));\n * </script>\n * ```\n */\nexport function getAbortSignal() {\n\tif (active_reaction === null) {\n\t\te.get_abort_signal_outside_reaction();\n\t}\n\n\treturn (active_reaction.ac ??= new AbortController()).signal;\n}\n\n/**\n * `onMount`, like [`$effect`](https://svelte.dev/docs/svelte/$effect), schedules a function to run as soon as the component has been mounted to the DOM.\n * Unlike `$effect`, the provided function only runs once.\n *\n * It must be called during the component's initialisation (but doesn't need to live _inside_ the component;\n * it can be called from an external module). If a function is returned _synchronously_ from `onMount`,\n * it will be called when the component is unmounted.\n *\n * `onMount` functions do not run during [server-side rendering](https://svelte.dev/docs/svelte/svelte-server#render).\n *\n * @template T\n * @param {() => NotFunction<T> | Promise<NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('onMount');\n\t}\n\n\tif (legacy_mode_flag && component_context.l !== null) {\n\t\tinit_update_callbacks(component_context).m.push(fn);\n\t} else {\n\t\tuser_effect(() => {\n\t\t\tconst cleanup = untrack(fn);\n\t\t\tif (typeof cleanup === 'function') return /** @type {() => void} */ (cleanup);\n\t\t});\n\t}\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('onDestroy');\n\t}\n\n\tonMount(() => () => untrack(fn));\n}\n\n/**\n * @template [T=any]\n * @param {string} type\n * @param {T} [detail]\n * @param {any}params_0\n * @returns {CustomEvent<T>}\n */\nfunction create_custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs/svelte/legacy-on#Component-events).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: null; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * @deprecated Use callback props and/or the `$host()` rune instead — see [migration guide](https://svelte.dev/docs/svelte/v5-migration-guide#Event-changes-Component-events)\n * @template {Record<string, any>} [EventMap = any]\n * @returns {EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst active_component_context = component_context;\n\tif (active_component_context === null) {\n\t\tlifecycle_outside_component('createEventDispatcher');\n\t}\n\n\treturn (type, detail, options) => {\n\t\tconst events = /** @type {Record<string, Function | Function[]>} */ (\n\t\t\tactive_component_context.s.$$events\n\t\t)?.[/** @type {any} */ (type)];\n\n\t\tif (events) {\n\t\t\tconst callbacks = is_array(events) ? events.slice() : [events];\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = create_custom_event(/** @type {string} */ (type), detail, options);\n\t\t\tfor (const fn of callbacks) {\n\t\t\t\tfn.call(active_component_context.x, event);\n\t\t\t}\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\n\t\treturn true;\n\t};\n}\n\n// TODO mark beforeUpdate and afterUpdate as deprecated in Svelte 6\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`.\n *\n * In runes mode use `$effect.pre` instead.\n *\n * @deprecated Use [`$effect.pre`](https://svelte.dev/docs/svelte/$effect#$effect.pre) instead\n * @param {() => void} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('beforeUpdate');\n\t}\n\n\tif (component_context.l === null) {\n\t\te.lifecycle_legacy_only('beforeUpdate');\n\t}\n\n\tinit_update_callbacks(component_context).b.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`.\n *\n * In runes mode use `$effect` instead.\n *\n * @deprecated Use [`$effect`](https://svelte.dev/docs/svelte/$effect) instead\n * @param {() => void} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tif (component_context === null) {\n\t\tlifecycle_outside_component('afterUpdate');\n\t}\n\n\tif (component_context.l === null) {\n\t\te.lifecycle_legacy_only('afterUpdate');\n\t}\n\n\tinit_update_callbacks(component_context).a.push(fn);\n}\n\n/**\n * Legacy-mode: Init callbacks object for onMount/beforeUpdate/afterUpdate\n * @param {ComponentContext} context\n */\nfunction init_update_callbacks(context) {\n\tvar l = /** @type {ComponentContextLegacy} */ (context).l;\n\treturn (l.u ??= { a: [], b: [], m: [] });\n}\n\nexport { flushSync } from './internal/client/runtime.js';\nexport { getContext, getAllContexts, hasContext, setContext } from './internal/client/context.js';\nexport { hydrate, mount, unmount } from './internal/client/render.js';\nexport { tick, untrack } from './internal/client/runtime.js';\nexport { createRawSnippet } from './internal/client/dom/blocks/snippet.js';\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { EFFECT_TRANSPARENT } from '#client/constants';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tread_hydration_instruction,\n\tremove_nodes,\n\tset_hydrate_node,\n\tset_hydrating\n} from '../hydration.js';\nimport { block, branch, pause_effect, resume_effect } from '../../reactivity/effects.js';\nimport { HYDRATION_START, HYDRATION_START_ELSE, UNINITIALIZED } from '../../../../constants.js';\n\n/**\n * @param {TemplateNode} node\n * @param {(branch: (fn: (anchor: Node, elseif?: [number,number]) => void, flag?: boolean) => void) => void} fn\n * @param {[number,number]} [elseif]\n * @returns {void}\n */\nexport function if_block(node, fn, [root_index, hydrate_index] = [0, 0]) {\n\tif (hydrating && root_index === 0) {\n\t\thydrate_next();\n\t}\n\n\tvar anchor = node;\n\n\t/** @type {Effect | null} */\n\tvar consequent_effect = null;\n\n\t/** @type {Effect | null} */\n\tvar alternate_effect = null;\n\n\t/** @type {UNINITIALIZED | boolean | null} */\n\tvar condition = UNINITIALIZED;\n\n\tvar flags = root_index > 0 ? EFFECT_TRANSPARENT : 0;\n\n\tvar has_branch = false;\n\n\tconst set_branch = (\n\t\t/** @type {(anchor: Node, elseif?: [number,number]) => void} */ fn,\n\t\tflag = true\n\t) => {\n\t\thas_branch = true;\n\t\tupdate_branch(flag, fn);\n\t};\n\n\tconst update_branch = (\n\t\t/** @type {boolean | null} */ new_condition,\n\t\t/** @type {null | ((anchor: Node, elseif?: [number,number]) => void)} */ fn\n\t) => {\n\t\tif (condition === (condition = new_condition)) return;\n\n\t\t/** Whether or not there was a hydration mismatch. Needs to be a `let` or else it isn't treeshaken out */\n\t\tlet mismatch = false;\n\n\t\tif (hydrating && hydrate_index !== -1) {\n\t\t\tif (root_index === 0) {\n\t\t\t\tconst data = read_hydration_instruction(anchor);\n\n\t\t\t\tif (data === HYDRATION_START) {\n\t\t\t\t\thydrate_index = 0;\n\t\t\t\t} else if (data === HYDRATION_START_ELSE) {\n\t\t\t\t\thydrate_index = Infinity;\n\t\t\t\t} else {\n\t\t\t\t\thydrate_index = parseInt(data.substring(1));\n\t\t\t\t\tif (hydrate_index !== hydrate_index) {\n\t\t\t\t\t\t// if hydrate_index is NaN\n\t\t\t\t\t\t// we set an invalid index to force mismatch\n\t\t\t\t\t\thydrate_index = condition ? Infinity : -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst is_else = hydrate_index > root_index;\n\n\t\t\tif (!!condition === is_else) {\n\t\t\t\t// Hydration mismatch: remove everything inside the anchor and start fresh.\n\t\t\t\t// This could happen with `{#if browser}...{/if}`, for example\n\t\t\t\tanchor = remove_nodes();\n\n\t\t\t\tset_hydrate_node(anchor);\n\t\t\t\tset_hydrating(false);\n\t\t\t\tmismatch = true;\n\t\t\t\thydrate_index = -1; // ignore hydration in next else if\n\t\t\t}\n\t\t}\n\n\t\tif (condition) {\n\t\t\tif (consequent_effect) {\n\t\t\t\tresume_effect(consequent_effect);\n\t\t\t} else if (fn) {\n\t\t\t\tconsequent_effect = branch(() => fn(anchor));\n\t\t\t}\n\n\t\t\tif (alternate_effect) {\n\t\t\t\tpause_effect(alternate_effect, () => {\n\t\t\t\t\talternate_effect = null;\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif (alternate_effect) {\n\t\t\t\tresume_effect(alternate_effect);\n\t\t\t} else if (fn) {\n\t\t\t\talternate_effect = branch(() => fn(anchor, [root_index + 1, hydrate_index]));\n\t\t\t}\n\n\t\t\tif (consequent_effect) {\n\t\t\t\tpause_effect(consequent_effect, () => {\n\t\t\t\t\tconsequent_effect = null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (mismatch) {\n\t\t\t// continue in hydration mode\n\t\t\tset_hydrating(true);\n\t\t}\n\t};\n\n\tblock(() => {\n\t\thas_branch = false;\n\t\tfn(set_branch);\n\t\tif (!has_branch) {\n\t\t\tupdate_branch(null, null);\n\t\t}\n\t}, flags);\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { UNINITIALIZED } from '../../../../constants.js';\nimport { block, branch, pause_effect } from '../../reactivity/effects.js';\nimport { not_equal, safe_not_equal } from '../../reactivity/equality.js';\nimport { is_runes } from '../../context.js';\nimport { hydrate_next, hydrate_node, hydrating } from '../hydration.js';\n\n/**\n * @template V\n * @param {TemplateNode} node\n * @param {() => V} get_key\n * @param {(anchor: Node) => TemplateNode | void} render_fn\n * @returns {void}\n */\nexport function key_block(node, get_key, render_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar anchor = node;\n\n\t/** @type {V | typeof UNINITIALIZED} */\n\tvar key = UNINITIALIZED;\n\n\t/** @type {Effect} */\n\tvar effect;\n\n\tvar changed = is_runes() ? not_equal : safe_not_equal;\n\n\tblock(() => {\n\t\tif (changed(key, (key = get_key()))) {\n\t\t\tif (effect) {\n\t\t\t\tpause_effect(effect);\n\t\t\t}\n\n\t\t\teffect = branch(() => render_fn(anchor));\n\t\t}\n\t});\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","/** @import { EachItem, EachState, Effect, MaybeSource, Source, TemplateNode, TransitionManager, Value } from '#client' */\nimport {\n\tEACH_INDEX_REACTIVE,\n\tEACH_IS_ANIMATED,\n\tEACH_IS_CONTROLLED,\n\tEACH_ITEM_IMMUTABLE,\n\tEACH_ITEM_REACTIVE,\n\tHYDRATION_END,\n\tHYDRATION_START_ELSE\n} from '../../../../constants.js';\nimport {\n\thydrate_next,\n\thydrate_node,\n\thydrating,\n\tread_hydration_instruction,\n\tremove_nodes,\n\tset_hydrate_node,\n\tset_hydrating\n} from '../hydration.js';\nimport {\n\tclear_text_content,\n\tcreate_text,\n\tget_first_child,\n\tget_next_sibling\n} from '../operations.js';\nimport {\n\tblock,\n\tbranch,\n\tdestroy_effect,\n\trun_out_transitions,\n\tpause_children,\n\tpause_effect,\n\tresume_effect\n} from '../../reactivity/effects.js';\nimport { source, mutable_source, internal_set } from '../../reactivity/sources.js';\nimport { array_from, is_array } from '../../../shared/utils.js';\nimport { COMMENT_NODE, INERT } from '#client/constants';\nimport { queue_micro_task } from '../task.js';\nimport { active_effect, get } from '../../runtime.js';\nimport { DEV } from 'esm-env';\nimport { derived_safe_equal } from '../../reactivity/deriveds.js';\n\n/**\n * The row of a keyed each block that is currently updating. We track this\n * so that `animate:` directives have something to attach themselves to\n * @type {EachItem | null}\n */\nexport let current_each_item = null;\n\n/** @param {EachItem | null} item */\nexport function set_current_each_item(item) {\n\tcurrent_each_item = item;\n}\n\n/**\n * @param {any} _\n * @param {number} i\n */\nexport function index(_, i) {\n\treturn i;\n}\n\n/**\n * Pause multiple effects simultaneously, and coordinate their\n * subsequent destruction. Used in each blocks\n * @param {EachState} state\n * @param {EachItem[]} items\n * @param {null | Node} controlled_anchor\n * @param {Map<any, EachItem>} items_map\n */\nfunction pause_effects(state, items, controlled_anchor, items_map) {\n\t/** @type {TransitionManager[]} */\n\tvar transitions = [];\n\tvar length = items.length;\n\n\tfor (var i = 0; i < length; i++) {\n\t\tpause_children(items[i].e, transitions, true);\n\t}\n\n\tvar is_controlled = length > 0 && transitions.length === 0 && controlled_anchor !== null;\n\t// If we have a controlled anchor, it means that the each block is inside a single\n\t// DOM element, so we can apply a fast-path for clearing the contents of the element.\n\tif (is_controlled) {\n\t\tvar parent_node = /** @type {Element} */ (\n\t\t\t/** @type {Element} */ (controlled_anchor).parentNode\n\t\t);\n\t\tclear_text_content(parent_node);\n\t\tparent_node.append(/** @type {Element} */ (controlled_anchor));\n\t\titems_map.clear();\n\t\tlink(state, items[0].prev, items[length - 1].next);\n\t}\n\n\trun_out_transitions(transitions, () => {\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tvar item = items[i];\n\t\t\tif (!is_controlled) {\n\t\t\t\titems_map.delete(item.k);\n\t\t\t\tlink(state, item.prev, item.next);\n\t\t\t}\n\t\t\tdestroy_effect(item.e, !is_controlled);\n\t\t}\n\t});\n}\n\n/**\n * @template V\n * @param {Element | Comment} node The next sibling node, or the parent node if this is a 'controlled' block\n * @param {number} flags\n * @param {() => V[]} get_collection\n * @param {(value: V, index: number) => any} get_key\n * @param {(anchor: Node, item: MaybeSource<V>, index: MaybeSource<number>) => void} render_fn\n * @param {null | ((anchor: Node) => void)} fallback_fn\n * @returns {void}\n */\nexport function each(node, flags, get_collection, get_key, render_fn, fallback_fn = null) {\n\tvar anchor = node;\n\n\t/** @type {EachState} */\n\tvar state = { flags, items: new Map(), first: null };\n\n\tvar is_controlled = (flags & EACH_IS_CONTROLLED) !== 0;\n\n\tif (is_controlled) {\n\t\tvar parent_node = /** @type {Element} */ (node);\n\n\t\tanchor = hydrating\n\t\t\t? set_hydrate_node(/** @type {Comment | Text} */ (get_first_child(parent_node)))\n\t\t\t: parent_node.appendChild(create_text());\n\t}\n\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\t/** @type {Effect | null} */\n\tvar fallback = null;\n\n\tvar was_empty = false;\n\n\t// TODO: ideally we could use derived for runes mode but because of the ability\n\t// to use a store which can be mutated, we can't do that here as mutating a store\n\t// will still result in the collection array being the same from the store\n\tvar each_array = derived_safe_equal(() => {\n\t\tvar collection = get_collection();\n\n\t\treturn is_array(collection) ? collection : collection == null ? [] : array_from(collection);\n\t});\n\n\tblock(() => {\n\t\tvar array = get(each_array);\n\t\tvar length = array.length;\n\n\t\tif (was_empty && length === 0) {\n\t\t\t// ignore updates if the array is empty,\n\t\t\t// and it already was empty on previous run\n\t\t\treturn;\n\t\t}\n\t\twas_empty = length === 0;\n\n\t\t/** `true` if there was a hydration mismatch. Needs to be a `let` or else it isn't treeshaken out */\n\t\tlet mismatch = false;\n\n\t\tif (hydrating) {\n\t\t\tvar is_else = read_hydration_instruction(anchor) === HYDRATION_START_ELSE;\n\n\t\t\tif (is_else !== (length === 0)) {\n\t\t\t\t// hydration mismatch — remove the server-rendered DOM and start over\n\t\t\t\tanchor = remove_nodes();\n\n\t\t\t\tset_hydrate_node(anchor);\n\t\t\t\tset_hydrating(false);\n\t\t\t\tmismatch = true;\n\t\t\t}\n\t\t}\n\n\t\t// this is separate to the previous block because `hydrating` might change\n\t\tif (hydrating) {\n\t\t\t/** @type {EachItem | null} */\n\t\t\tvar prev = null;\n\n\t\t\t/** @type {EachItem} */\n\t\t\tvar item;\n\n\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\tif (\n\t\t\t\t\thydrate_node.nodeType === COMMENT_NODE &&\n\t\t\t\t\t/** @type {Comment} */ (hydrate_node).data === HYDRATION_END\n\t\t\t\t) {\n\t\t\t\t\t// The server rendered fewer items than expected,\n\t\t\t\t\t// so break out and continue appending non-hydrated items\n\t\t\t\t\tanchor = /** @type {Comment} */ (hydrate_node);\n\t\t\t\t\tmismatch = true;\n\t\t\t\t\tset_hydrating(false);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tvar value = array[i];\n\t\t\t\tvar key = get_key(value, i);\n\t\t\t\titem = create_item(\n\t\t\t\t\thydrate_node,\n\t\t\t\t\tstate,\n\t\t\t\t\tprev,\n\t\t\t\t\tnull,\n\t\t\t\t\tvalue,\n\t\t\t\t\tkey,\n\t\t\t\t\ti,\n\t\t\t\t\trender_fn,\n\t\t\t\t\tflags,\n\t\t\t\t\tget_collection\n\t\t\t\t);\n\t\t\t\tstate.items.set(key, item);\n\n\t\t\t\tprev = item;\n\t\t\t}\n\n\t\t\t// remove excess nodes\n\t\t\tif (length > 0) {\n\t\t\t\tset_hydrate_node(remove_nodes());\n\t\t\t}\n\t\t}\n\n\t\tif (!hydrating) {\n\t\t\treconcile(array, state, anchor, render_fn, flags, get_key, get_collection);\n\t\t}\n\n\t\tif (fallback_fn !== null) {\n\t\t\tif (length === 0) {\n\t\t\t\tif (fallback) {\n\t\t\t\t\tresume_effect(fallback);\n\t\t\t\t} else {\n\t\t\t\t\tfallback = branch(() => fallback_fn(anchor));\n\t\t\t\t}\n\t\t\t} else if (fallback !== null) {\n\t\t\t\tpause_effect(fallback, () => {\n\t\t\t\t\tfallback = null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (mismatch) {\n\t\t\t// continue in hydration mode\n\t\t\tset_hydrating(true);\n\t\t}\n\n\t\t// When we mount the each block for the first time, the collection won't be\n\t\t// connected to this effect as the effect hasn't finished running yet and its deps\n\t\t// won't be assigned. However, it's possible that when reconciling the each block\n\t\t// that a mutation occurred and it's made the collection MAYBE_DIRTY, so reading the\n\t\t// collection again can provide consistency to the reactive graph again as the deriveds\n\t\t// will now be `CLEAN`.\n\t\tget(each_array);\n\t});\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n\n/**\n * Add, remove, or reorder items output by an each block as its input changes\n * @template V\n * @param {Array<V>} array\n * @param {EachState} state\n * @param {Element | Comment | Text} anchor\n * @param {(anchor: Node, item: MaybeSource<V>, index: number | Source<number>, collection: () => V[]) => void} render_fn\n * @param {number} flags\n * @param {(value: V, index: number) => any} get_key\n * @param {() => V[]} get_collection\n * @returns {void}\n */\nfunction reconcile(array, state, anchor, render_fn, flags, get_key, get_collection) {\n\tvar is_animated = (flags & EACH_IS_ANIMATED) !== 0;\n\tvar should_update = (flags & (EACH_ITEM_REACTIVE | EACH_INDEX_REACTIVE)) !== 0;\n\n\tvar length = array.length;\n\tvar items = state.items;\n\tvar first = state.first;\n\tvar current = first;\n\n\t/** @type {undefined | Set<EachItem>} */\n\tvar seen;\n\n\t/** @type {EachItem | null} */\n\tvar prev = null;\n\n\t/** @type {undefined | Set<EachItem>} */\n\tvar to_animate;\n\n\t/** @type {EachItem[]} */\n\tvar matched = [];\n\n\t/** @type {EachItem[]} */\n\tvar stashed = [];\n\n\t/** @type {V} */\n\tvar value;\n\n\t/** @type {any} */\n\tvar key;\n\n\t/** @type {EachItem | undefined} */\n\tvar item;\n\n\t/** @type {number} */\n\tvar i;\n\n\tif (is_animated) {\n\t\tfor (i = 0; i < length; i += 1) {\n\t\t\tvalue = array[i];\n\t\t\tkey = get_key(value, i);\n\t\t\titem = items.get(key);\n\n\t\t\tif (item !== undefined) {\n\t\t\t\titem.a?.measure();\n\t\t\t\t(to_animate ??= new Set()).add(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (i = 0; i < length; i += 1) {\n\t\tvalue = array[i];\n\t\tkey = get_key(value, i);\n\t\titem = items.get(key);\n\n\t\tif (item === undefined) {\n\t\t\tvar child_anchor = current ? /** @type {TemplateNode} */ (current.e.nodes_start) : anchor;\n\n\t\t\tprev = create_item(\n\t\t\t\tchild_anchor,\n\t\t\t\tstate,\n\t\t\t\tprev,\n\t\t\t\tprev === null ? state.first : prev.next,\n\t\t\t\tvalue,\n\t\t\t\tkey,\n\t\t\t\ti,\n\t\t\t\trender_fn,\n\t\t\t\tflags,\n\t\t\t\tget_collection\n\t\t\t);\n\n\t\t\titems.set(key, prev);\n\n\t\t\tmatched = [];\n\t\t\tstashed = [];\n\n\t\t\tcurrent = prev.next;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (should_update) {\n\t\t\tupdate_item(item, value, i, flags);\n\t\t}\n\n\t\tif ((item.e.f & INERT) !== 0) {\n\t\t\tresume_effect(item.e);\n\t\t\tif (is_animated) {\n\t\t\t\titem.a?.unfix();\n\t\t\t\t(to_animate ??= new Set()).delete(item);\n\t\t\t}\n\t\t}\n\n\t\tif (item !== current) {\n\t\t\tif (seen !== undefined && seen.has(item)) {\n\t\t\t\tif (matched.length < stashed.length) {\n\t\t\t\t\t// more efficient to move later items to the front\n\t\t\t\t\tvar start = stashed[0];\n\t\t\t\t\tvar j;\n\n\t\t\t\t\tprev = start.prev;\n\n\t\t\t\t\tvar a = matched[0];\n\t\t\t\t\tvar b = matched[matched.length - 1];\n\n\t\t\t\t\tfor (j = 0; j < matched.length; j += 1) {\n\t\t\t\t\t\tmove(matched[j], start, anchor);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (j = 0; j < stashed.length; j += 1) {\n\t\t\t\t\t\tseen.delete(stashed[j]);\n\t\t\t\t\t}\n\n\t\t\t\t\tlink(state, a.prev, b.next);\n\t\t\t\t\tlink(state, prev, a);\n\t\t\t\t\tlink(state, b, start);\n\n\t\t\t\t\tcurrent = start;\n\t\t\t\t\tprev = b;\n\t\t\t\t\ti -= 1;\n\n\t\t\t\t\tmatched = [];\n\t\t\t\t\tstashed = [];\n\t\t\t\t} else {\n\t\t\t\t\t// more efficient to move earlier items to the back\n\t\t\t\t\tseen.delete(item);\n\t\t\t\t\tmove(item, current, anchor);\n\n\t\t\t\t\tlink(state, item.prev, item.next);\n\t\t\t\t\tlink(state, item, prev === null ? state.first : prev.next);\n\t\t\t\t\tlink(state, prev, item);\n\n\t\t\t\t\tprev = item;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmatched = [];\n\t\t\tstashed = [];\n\n\t\t\twhile (current !== null && current.k !== key) {\n\t\t\t\t// If the each block isn't inert and an item has an effect that is already inert,\n\t\t\t\t// skip over adding it to our seen Set as the item is already being handled\n\t\t\t\tif ((current.e.f & INERT) === 0) {\n\t\t\t\t\t(seen ??= new Set()).add(current);\n\t\t\t\t}\n\t\t\t\tstashed.push(current);\n\t\t\t\tcurrent = current.next;\n\t\t\t}\n\n\t\t\tif (current === null) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\titem = current;\n\t\t}\n\n\t\tmatched.push(item);\n\t\tprev = item;\n\t\tcurrent = item.next;\n\t}\n\n\tif (current !== null || seen !== undefined) {\n\t\tvar to_destroy = seen === undefined ? [] : array_from(seen);\n\n\t\twhile (current !== null) {\n\t\t\t// If the each block isn't inert, then inert effects are currently outroing and will be removed once the transition is finished\n\t\t\tif ((current.e.f & INERT) === 0) {\n\t\t\t\tto_destroy.push(current);\n\t\t\t}\n\t\t\tcurrent = current.next;\n\t\t}\n\n\t\tvar destroy_length = to_destroy.length;\n\n\t\tif (destroy_length > 0) {\n\t\t\tvar controlled_anchor = (flags & EACH_IS_CONTROLLED) !== 0 && length === 0 ? anchor : null;\n\n\t\t\tif (is_animated) {\n\t\t\t\tfor (i = 0; i < destroy_length; i += 1) {\n\t\t\t\t\tto_destroy[i].a?.measure();\n\t\t\t\t}\n\n\t\t\t\tfor (i = 0; i < destroy_length; i += 1) {\n\t\t\t\t\tto_destroy[i].a?.fix();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpause_effects(state, to_destroy, controlled_anchor, items);\n\t\t}\n\t}\n\n\tif (is_animated) {\n\t\tqueue_micro_task(() => {\n\t\t\tif (to_animate === undefined) return;\n\t\t\tfor (item of to_animate) {\n\t\t\t\titem.a?.apply();\n\t\t\t}\n\t\t});\n\t}\n\n\t/** @type {Effect} */ (active_effect).first = state.first && state.first.e;\n\t/** @type {Effect} */ (active_effect).last = prev && prev.e;\n}\n\n/**\n * @param {EachItem} item\n * @param {any} value\n * @param {number} index\n * @param {number} type\n * @returns {void}\n */\nfunction update_item(item, value, index, type) {\n\tif ((type & EACH_ITEM_REACTIVE) !== 0) {\n\t\tinternal_set(item.v, value);\n\t}\n\n\tif ((type & EACH_INDEX_REACTIVE) !== 0) {\n\t\tinternal_set(/** @type {Value<number>} */ (item.i), index);\n\t} else {\n\t\titem.i = index;\n\t}\n}\n\n/**\n * @template V\n * @param {Node} anchor\n * @param {EachState} state\n * @param {EachItem | null} prev\n * @param {EachItem | null} next\n * @param {V} value\n * @param {unknown} key\n * @param {number} index\n * @param {(anchor: Node, item: V | Source<V>, index: number | Value<number>, collection: () => V[]) => void} render_fn\n * @param {number} flags\n * @param {() => V[]} get_collection\n * @returns {EachItem}\n */\nfunction create_item(\n\tanchor,\n\tstate,\n\tprev,\n\tnext,\n\tvalue,\n\tkey,\n\tindex,\n\trender_fn,\n\tflags,\n\tget_collection\n) {\n\tvar previous_each_item = current_each_item;\n\tvar reactive = (flags & EACH_ITEM_REACTIVE) !== 0;\n\tvar mutable = (flags & EACH_ITEM_IMMUTABLE) === 0;\n\n\tvar v = reactive ? (mutable ? mutable_source(value, false, false) : source(value)) : value;\n\tvar i = (flags & EACH_INDEX_REACTIVE) === 0 ? index : source(index);\n\n\tif (DEV && reactive) {\n\t\t// For tracing purposes, we need to link the source signal we create with the\n\t\t// collection + index so that tracing works as intended\n\t\t/** @type {Value} */ (v).trace = () => {\n\t\t\tvar collection_index = typeof i === 'number' ? index : i.v;\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-expressions\n\t\t\tget_collection()[collection_index];\n\t\t};\n\t}\n\n\t/** @type {EachItem} */\n\tvar item = {\n\t\ti,\n\t\tv,\n\t\tk: key,\n\t\ta: null,\n\t\t// @ts-expect-error\n\t\te: null,\n\t\tprev,\n\t\tnext\n\t};\n\n\tcurrent_each_item = item;\n\n\ttry {\n\t\titem.e = branch(() => render_fn(anchor, v, i, get_collection), hydrating);\n\n\t\titem.e.prev = prev && prev.e;\n\t\titem.e.next = next && next.e;\n\n\t\tif (prev === null) {\n\t\t\tstate.first = item;\n\t\t} else {\n\t\t\tprev.next = item;\n\t\t\tprev.e.next = item.e;\n\t\t}\n\n\t\tif (next !== null) {\n\t\t\tnext.prev = item;\n\t\t\tnext.e.prev = item.e;\n\t\t}\n\n\t\treturn item;\n\t} finally {\n\t\tcurrent_each_item = previous_each_item;\n\t}\n}\n\n/**\n * @param {EachItem} item\n * @param {EachItem | null} next\n * @param {Text | Element | Comment} anchor\n */\nfunction move(item, next, anchor) {\n\tvar end = item.next ? /** @type {TemplateNode} */ (item.next.e.nodes_start) : anchor;\n\n\tvar dest = next ? /** @type {TemplateNode} */ (next.e.nodes_start) : anchor;\n\tvar node = /** @type {TemplateNode} */ (item.e.nodes_start);\n\n\twhile (node !== end) {\n\t\tvar next_node = /** @type {TemplateNode} */ (get_next_sibling(node));\n\t\tdest.before(node);\n\t\tnode = next_node;\n\t}\n}\n\n/**\n * @param {EachState} state\n * @param {EachItem | null} prev\n * @param {EachItem | null} next\n */\nfunction link(state, prev, next) {\n\tif (prev === null) {\n\t\tstate.first = next;\n\t} else {\n\t\tprev.next = next;\n\t\tprev.e.next = next && next.e;\n\t}\n\n\tif (next !== null) {\n\t\tnext.prev = prev;\n\t\tnext.e.prev = prev && prev.e;\n\t}\n}\n","/** @import { Effect, TemplateNode } from '#client' */\nimport { FILENAME, HYDRATION_ERROR } from '../../../../constants.js';\nimport { remove_effect_dom, template_effect } from '../../reactivity/effects.js';\nimport { hydrate_next, hydrate_node, hydrating, set_hydrate_node } from '../hydration.js';\nimport { create_fragment_from_html } from '../reconciler.js';\nimport { assign_nodes } from '../template.js';\nimport * as w from '../../warnings.js';\nimport { hash, sanitize_location } from '../../../../utils.js';\nimport { DEV } from 'esm-env';\nimport { dev_current_component_function } from '../../context.js';\nimport { get_first_child, get_next_sibling } from '../operations.js';\nimport { active_effect } from '../../runtime.js';\nimport { COMMENT_NODE } from '#client/constants';\n\n/**\n * @param {Element} element\n * @param {string | null} server_hash\n * @param {string} value\n */\nfunction check_hash(element, server_hash, value) {\n\tif (!server_hash || server_hash === hash(String(value ?? ''))) return;\n\n\tlet location;\n\n\t// @ts-expect-error\n\tconst loc = element.__svelte_meta?.loc;\n\tif (loc) {\n\t\tlocation = `near ${loc.file}:${loc.line}:${loc.column}`;\n\t} else if (dev_current_component_function?.[FILENAME]) {\n\t\tlocation = `in ${dev_current_component_function[FILENAME]}`;\n\t}\n\n\tw.hydration_html_changed(sanitize_location(location));\n}\n\n/**\n * @param {Element | Text | Comment} node\n * @param {() => string} get_value\n * @param {boolean} [svg]\n * @param {boolean} [mathml]\n * @param {boolean} [skip_warning]\n * @returns {void}\n */\nexport function html(node, get_value, svg = false, mathml = false, skip_warning = false) {\n\tvar anchor = node;\n\n\tvar value = '';\n\n\ttemplate_effect(() => {\n\t\tvar effect = /** @type {Effect} */ (active_effect);\n\n\t\tif (value === (value = get_value() ?? '')) {\n\t\t\tif (hydrating) hydrate_next();\n\t\t\treturn;\n\t\t}\n\n\t\tif (effect.nodes_start !== null) {\n\t\t\tremove_effect_dom(effect.nodes_start, /** @type {TemplateNode} */ (effect.nodes_end));\n\t\t\teffect.nodes_start = effect.nodes_end = null;\n\t\t}\n\n\t\tif (value === '') return;\n\n\t\tif (hydrating) {\n\t\t\t// We're deliberately not trying to repair mismatches between server and client,\n\t\t\t// as it's costly and error-prone (and it's an edge case to have a mismatch anyway)\n\t\t\tvar hash = /** @type {Comment} */ (hydrate_node).data;\n\t\t\tvar next = hydrate_next();\n\t\t\tvar last = next;\n\n\t\t\twhile (\n\t\t\t\tnext !== null &&\n\t\t\t\t(next.nodeType !== COMMENT_NODE || /** @type {Comment} */ (next).data !== '')\n\t\t\t) {\n\t\t\t\tlast = next;\n\t\t\t\tnext = /** @type {TemplateNode} */ (get_next_sibling(next));\n\t\t\t}\n\n\t\t\tif (next === null) {\n\t\t\t\tw.hydration_mismatch();\n\t\t\t\tthrow HYDRATION_ERROR;\n\t\t\t}\n\n\t\t\tif (DEV && !skip_warning) {\n\t\t\t\tcheck_hash(/** @type {Element} */ (next.parentNode), hash, value);\n\t\t\t}\n\n\t\t\tassign_nodes(hydrate_node, last);\n\t\t\tanchor = set_hydrate_node(next);\n\t\t\treturn;\n\t\t}\n\n\t\tvar html = value + '';\n\t\tif (svg) html = `<svg>${html}</svg>`;\n\t\telse if (mathml) html = `<math>${html}</math>`;\n\n\t\t// Don't use create_fragment_with_script_from_html here because that would mean script tags are executed.\n\t\t// @html is basically `.innerHTML = ...` and that doesn't execute scripts either due to security reasons.\n\t\t/** @type {DocumentFragment | Element} */\n\t\tvar node = create_fragment_from_html(html);\n\n\t\tif (svg || mathml) {\n\t\t\tnode = /** @type {Element} */ (get_first_child(node));\n\t\t}\n\n\t\tassign_nodes(\n\t\t\t/** @type {TemplateNode} */ (get_first_child(node)),\n\t\t\t/** @type {TemplateNode} */ (node.lastChild)\n\t\t);\n\n\t\tif (svg || mathml) {\n\t\t\twhile (get_first_child(node)) {\n\t\t\t\tanchor.before(/** @type {Node} */ (get_first_child(node)));\n\t\t\t}\n\t\t} else {\n\t\t\tanchor.before(node);\n\t\t}\n\t});\n}\n","import { hydrate_next, hydrating } from '../hydration.js';\n\n/**\n * @param {Comment} anchor\n * @param {Record<string, any>} $$props\n * @param {string} name\n * @param {Record<string, unknown>} slot_props\n * @param {null | ((anchor: Comment) => void)} fallback_fn\n */\nexport function slot(anchor, $$props, name, slot_props, fallback_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar slot_fn = $$props.$$slots?.[name];\n\t// Interop: Can use snippets to fill slots\n\tvar is_interop = false;\n\tif (slot_fn === true) {\n\t\tslot_fn = $$props[name === 'default' ? 'children' : name];\n\t\tis_interop = true;\n\t}\n\n\tif (slot_fn === undefined) {\n\t\tif (fallback_fn !== null) {\n\t\t\tfallback_fn(anchor);\n\t\t}\n\t} else {\n\t\tslot_fn(anchor, is_interop ? () => slot_props : slot_props);\n\t}\n}\n\n/**\n * @param {Record<string, any>} props\n * @returns {Record<string, boolean>}\n */\nexport function sanitize_slots(props) {\n\t/** @type {Record<string, boolean>} */\n\tconst sanitized = {};\n\tif (props.children) sanitized.default = true;\n\tfor (const key in props.$$slots) {\n\t\tsanitized[key] = true;\n\t}\n\treturn sanitized;\n}\n","/** @import { TemplateNode, Dom, Effect } from '#client' */\nimport { EFFECT_TRANSPARENT } from '#client/constants';\nimport { block, branch, pause_effect } from '../../reactivity/effects.js';\nimport { hydrate_next, hydrate_node, hydrating } from '../hydration.js';\n\n/**\n * @template P\n * @template {(props: P) => void} C\n * @param {TemplateNode} node\n * @param {() => C} get_component\n * @param {(anchor: TemplateNode, component: C) => Dom | void} render_fn\n * @returns {void}\n */\nexport function component(node, get_component, render_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar anchor = node;\n\n\t/** @type {C} */\n\tvar component;\n\n\t/** @type {Effect | null} */\n\tvar effect;\n\n\tblock(() => {\n\t\tif (component === (component = get_component())) return;\n\n\t\tif (effect) {\n\t\t\tpause_effect(effect);\n\t\t\teffect = null;\n\t\t}\n\n\t\tif (component) {\n\t\t\teffect = branch(() => render_fn(anchor, component));\n\t\t}\n\t}, EFFECT_TRANSPARENT);\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n","/** @import { ActionPayload } from '#client' */\nimport { effect, render_effect } from '../../reactivity/effects.js';\nimport { safe_not_equal } from '../../reactivity/equality.js';\nimport { deep_read_state, untrack } from '../../runtime.js';\n\n/**\n * @template P\n * @param {Element} dom\n * @param {(dom: Element, value?: P) => ActionPayload<P>} action\n * @param {() => P} [get_value]\n * @returns {void}\n */\nexport function action(dom, action, get_value) {\n\teffect(() => {\n\t\tvar payload = untrack(() => action(dom, get_value?.()) || {});\n\n\t\tif (get_value && payload?.update) {\n\t\t\tvar inited = false;\n\t\t\t/** @type {P} */\n\t\t\tvar prev = /** @type {any} */ ({}); // initialize with something so it's never equal on first run\n\n\t\t\trender_effect(() => {\n\t\t\t\tvar value = get_value();\n\n\t\t\t\t// Action's update method is coarse-grained, i.e. when anything in the passed value changes, update.\n\t\t\t\t// This works in legacy mode because of mutable_source being updated as a whole, but when using $state\n\t\t\t\t// together with actions and mutation, it wouldn't notice the change without a deep read.\n\t\t\t\tdeep_read_state(value);\n\n\t\t\t\tif (inited && safe_not_equal(prev, value)) {\n\t\t\t\t\tprev = value;\n\t\t\t\t\t/** @type {Function} */ (payload.update)(value);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tinited = true;\n\t\t}\n\n\t\tif (payload?.destroy) {\n\t\t\treturn () => /** @type {Function} */ (payload.destroy)();\n\t\t}\n\t});\n}\n","/** @import { Effect } from '#client' */\nimport { block, branch, effect, destroy_effect } from '../../reactivity/effects.js';\n\n// TODO in 6.0 or 7.0, when we remove legacy mode, we can simplify this by\n// getting rid of the block/branch stuff and just letting the effect rip.\n// see https://github.com/sveltejs/svelte/pull/15962\n\n/**\n * @param {Element} node\n * @param {() => (node: Element) => void} get_fn\n */\nexport function attach(node, get_fn) {\n\t/** @type {false | undefined | ((node: Element) => void)} */\n\tvar fn = undefined;\n\n\t/** @type {Effect | null} */\n\tvar e;\n\n\tblock(() => {\n\t\tif (fn !== (fn = get_fn())) {\n\t\t\tif (e) {\n\t\t\t\tdestroy_effect(e);\n\t\t\t\te = null;\n\t\t\t}\n\n\t\t\tif (fn) {\n\t\t\t\te = branch(() => {\n\t\t\t\t\teffect(() => /** @type {(node: Element) => void} */ (fn)(node));\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n","function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","import { escape_html } from '../../escaping.js';\nimport { clsx as _clsx } from 'clsx';\n\n/**\n * `<div translate={false}>` should be rendered as `<div translate=\"no\">` and _not_\n * `<div translate=\"false\">`, which is equivalent to `<div translate=\"yes\">`. There\n * may be other odd cases that need to be added to this list in future\n * @type {Record<string, Map<any, string>>}\n */\nconst replacements = {\n\ttranslate: new Map([\n\t\t[true, 'yes'],\n\t\t[false, 'no']\n\t])\n};\n\n/**\n * @template V\n * @param {string} name\n * @param {V} value\n * @param {boolean} [is_boolean]\n * @returns {string}\n */\nexport function attr(name, value, is_boolean = false) {\n\tif (value == null || (!value && is_boolean)) return '';\n\tconst normalized = (name in replacements && replacements[name].get(value)) || value;\n\tconst assignment = is_boolean ? '' : `=\"${escape_html(normalized, true)}\"`;\n\treturn ` ${name}${assignment}`;\n}\n\n/**\n * Small wrapper around clsx to preserve Svelte's (weird) handling of falsy values.\n * TODO Svelte 6 revisit this, and likely turn all falsy values into the empty string (what clsx also does)\n * @param  {any} value\n */\nexport function clsx(value) {\n\tif (typeof value === 'object') {\n\t\treturn _clsx(value);\n\t} else {\n\t\treturn value ?? '';\n\t}\n}\n\nconst whitespace = [...' \\t\\n\\r\\f\\u00a0\\u000b\\ufeff'];\n\n/**\n * @param {any} value\n * @param {string | null} [hash]\n * @param {Record<string, boolean>} [directives]\n * @returns {string | null}\n */\nexport function to_class(value, hash, directives) {\n\tvar classname = value == null ? '' : '' + value;\n\n\tif (hash) {\n\t\tclassname = classname ? classname + ' ' + hash : hash;\n\t}\n\n\tif (directives) {\n\t\tfor (var key in directives) {\n\t\t\tif (directives[key]) {\n\t\t\t\tclassname = classname ? classname + ' ' + key : key;\n\t\t\t} else if (classname.length) {\n\t\t\t\tvar len = key.length;\n\t\t\t\tvar a = 0;\n\n\t\t\t\twhile ((a = classname.indexOf(key, a)) >= 0) {\n\t\t\t\t\tvar b = a + len;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(a === 0 || whitespace.includes(classname[a - 1])) &&\n\t\t\t\t\t\t(b === classname.length || whitespace.includes(classname[b]))\n\t\t\t\t\t) {\n\t\t\t\t\t\tclassname = (a === 0 ? '' : classname.substring(0, a)) + classname.substring(b + 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ta = b;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn classname === '' ? null : classname;\n}\n\n/**\n *\n * @param {Record<string,any>} styles\n * @param {boolean} important\n */\nfunction append_styles(styles, important = false) {\n\tvar separator = important ? ' !important;' : ';';\n\tvar css = '';\n\n\tfor (var key in styles) {\n\t\tvar value = styles[key];\n\t\tif (value != null && value !== '') {\n\t\t\tcss += ' ' + key + ': ' + value + separator;\n\t\t}\n\t}\n\n\treturn css;\n}\n\n/**\n * @param {string} name\n * @returns {string}\n */\nfunction to_css_name(name) {\n\tif (name[0] !== '-' || name[1] !== '-') {\n\t\treturn name.toLowerCase();\n\t}\n\treturn name;\n}\n\n/**\n * @param {any} value\n * @param {Record<string, any> | [Record<string, any>, Record<string, any>]} [styles]\n * @returns {string | null}\n */\nexport function to_style(value, styles) {\n\tif (styles) {\n\t\tvar new_style = '';\n\n\t\t/** @type {Record<string,any> | undefined} */\n\t\tvar normal_styles;\n\n\t\t/** @type {Record<string,any> | undefined} */\n\t\tvar important_styles;\n\n\t\tif (Array.isArray(styles)) {\n\t\t\tnormal_styles = styles[0];\n\t\t\timportant_styles = styles[1];\n\t\t} else {\n\t\t\tnormal_styles = styles;\n\t\t}\n\n\t\tif (value) {\n\t\t\tvalue = String(value)\n\t\t\t\t.replaceAll(/\\s*\\/\\*.*?\\*\\/\\s*/g, '')\n\t\t\t\t.trim();\n\n\t\t\t/** @type {boolean | '\"' | \"'\"} */\n\t\t\tvar in_str = false;\n\t\t\tvar in_apo = 0;\n\t\t\tvar in_comment = false;\n\n\t\t\tvar reserved_names = [];\n\n\t\t\tif (normal_styles) {\n\t\t\t\treserved_names.push(...Object.keys(normal_styles).map(to_css_name));\n\t\t\t}\n\t\t\tif (important_styles) {\n\t\t\t\treserved_names.push(...Object.keys(important_styles).map(to_css_name));\n\t\t\t}\n\n\t\t\tvar start_index = 0;\n\t\t\tvar name_index = -1;\n\n\t\t\tconst len = value.length;\n\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\tvar c = value[i];\n\n\t\t\t\tif (in_comment) {\n\t\t\t\t\tif (c === '/' && value[i - 1] === '*') {\n\t\t\t\t\t\tin_comment = false;\n\t\t\t\t\t}\n\t\t\t\t} else if (in_str) {\n\t\t\t\t\tif (in_str === c) {\n\t\t\t\t\t\tin_str = false;\n\t\t\t\t\t}\n\t\t\t\t} else if (c === '/' && value[i + 1] === '*') {\n\t\t\t\t\tin_comment = true;\n\t\t\t\t} else if (c === '\"' || c === \"'\") {\n\t\t\t\t\tin_str = c;\n\t\t\t\t} else if (c === '(') {\n\t\t\t\t\tin_apo++;\n\t\t\t\t} else if (c === ')') {\n\t\t\t\t\tin_apo--;\n\t\t\t\t}\n\n\t\t\t\tif (!in_comment && in_str === false && in_apo === 0) {\n\t\t\t\t\tif (c === ':' && name_index === -1) {\n\t\t\t\t\t\tname_index = i;\n\t\t\t\t\t} else if (c === ';' || i === len - 1) {\n\t\t\t\t\t\tif (name_index !== -1) {\n\t\t\t\t\t\t\tvar name = to_css_name(value.substring(start_index, name_index).trim());\n\n\t\t\t\t\t\t\tif (!reserved_names.includes(name)) {\n\t\t\t\t\t\t\t\tif (c !== ';') {\n\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvar property = value.substring(start_index, i).trim();\n\t\t\t\t\t\t\t\tnew_style += ' ' + property + ';';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstart_index = i + 1;\n\t\t\t\t\t\tname_index = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (normal_styles) {\n\t\t\tnew_style += append_styles(normal_styles);\n\t\t}\n\n\t\tif (important_styles) {\n\t\t\tnew_style += append_styles(important_styles, true);\n\t\t}\n\n\t\tnew_style = new_style.trim();\n\t\treturn new_style === '' ? null : new_style;\n\t}\n\n\treturn value == null ? null : String(value);\n}\n","import { to_class } from '../../../shared/attributes.js';\nimport { hydrating } from '../hydration.js';\n\n/**\n * @param {Element} dom\n * @param {boolean | number} is_html\n * @param {string | null} value\n * @param {string} [hash]\n * @param {Record<string, any>} [prev_classes]\n * @param {Record<string, any>} [next_classes]\n * @returns {Record<string, boolean> | undefined}\n */\nexport function set_class(dom, is_html, value, hash, prev_classes, next_classes) {\n\t// @ts-expect-error need to add __className to patched prototype\n\tvar prev = dom.__className;\n\n\tif (\n\t\thydrating ||\n\t\tprev !== value ||\n\t\tprev === undefined // for edge case of `class={undefined}`\n\t) {\n\t\tvar next_class_name = to_class(value, hash, next_classes);\n\n\t\tif (!hydrating || next_class_name !== dom.getAttribute('class')) {\n\t\t\t// Removing the attribute when the value is only an empty string causes\n\t\t\t// performance issues vs simply making the className an empty string. So\n\t\t\t// we should only remove the class if the value is nullish\n\t\t\t// and there no hash/directives :\n\t\t\tif (next_class_name == null) {\n\t\t\t\tdom.removeAttribute('class');\n\t\t\t} else if (is_html) {\n\t\t\t\tdom.className = next_class_name;\n\t\t\t} else {\n\t\t\t\tdom.setAttribute('class', next_class_name);\n\t\t\t}\n\t\t}\n\n\t\t// @ts-expect-error need to add __className to patched prototype\n\t\tdom.__className = value;\n\t} else if (next_classes && prev_classes !== next_classes) {\n\t\tfor (var key in next_classes) {\n\t\t\tvar is_present = !!next_classes[key];\n\n\t\t\tif (prev_classes == null || is_present !== !!prev_classes[key]) {\n\t\t\t\tdom.classList.toggle(key, is_present);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn next_classes;\n}\n","import { to_style } from '../../../shared/attributes.js';\nimport { hydrating } from '../hydration.js';\n\n/**\n * @param {Element & ElementCSSInlineStyle} dom\n * @param {Record<string, any>} prev\n * @param {Record<string, any>} next\n * @param {string} [priority]\n */\nfunction update_styles(dom, prev = {}, next, priority) {\n\tfor (var key in next) {\n\t\tvar value = next[key];\n\n\t\tif (prev[key] !== value) {\n\t\t\tif (next[key] == null) {\n\t\t\t\tdom.style.removeProperty(key);\n\t\t\t} else {\n\t\t\t\tdom.style.setProperty(key, value, priority);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} dom\n * @param {string | null} value\n * @param {Record<string, any> | [Record<string, any>, Record<string, any>]} [prev_styles]\n * @param {Record<string, any> | [Record<string, any>, Record<string, any>]} [next_styles]\n */\nexport function set_style(dom, value, prev_styles, next_styles) {\n\t// @ts-expect-error\n\tvar prev = dom.__style;\n\n\tif (hydrating || prev !== value) {\n\t\tvar next_style_attr = to_style(value, next_styles);\n\n\t\tif (!hydrating || next_style_attr !== dom.getAttribute('style')) {\n\t\t\tif (next_style_attr == null) {\n\t\t\t\tdom.removeAttribute('style');\n\t\t\t} else {\n\t\t\t\tdom.style.cssText = next_style_attr;\n\t\t\t}\n\t\t}\n\n\t\t// @ts-expect-error\n\t\tdom.__style = value;\n\t} else if (next_styles) {\n\t\tif (Array.isArray(next_styles)) {\n\t\t\tupdate_styles(dom, prev_styles?.[0], next_styles[0]);\n\t\t\tupdate_styles(dom, prev_styles?.[1], next_styles[1], 'important');\n\t\t} else {\n\t\t\tupdate_styles(dom, prev_styles, next_styles);\n\t\t}\n\t}\n\n\treturn next_styles;\n}\n","import { effect, teardown } from '../../../reactivity/effects.js';\nimport { listen_to_event_and_reset_event } from './shared.js';\nimport { is } from '../../../proxy.js';\nimport { is_array } from '../../../../shared/utils.js';\nimport * as w from '../../../warnings.js';\n\n/**\n * Selects the correct option(s) (depending on whether this is a multiple select)\n * @template V\n * @param {HTMLSelectElement} select\n * @param {V} value\n * @param {boolean} mounting\n */\nexport function select_option(select, value, mounting = false) {\n\tif (select.multiple) {\n\t\t// If value is null or undefined, keep the selection as is\n\t\tif (value == undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If not an array, warn and keep the selection as is\n\t\tif (!is_array(value)) {\n\t\t\treturn w.select_multiple_invalid_value();\n\t\t}\n\n\t\t// Otherwise, update the selection\n\t\tfor (var option of select.options) {\n\t\t\toption.selected = value.includes(get_option_value(option));\n\t\t}\n\n\t\treturn;\n\t}\n\n\tfor (option of select.options) {\n\t\tvar option_value = get_option_value(option);\n\t\tif (is(option_value, value)) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * Selects the correct option(s) if `value` is given,\n * and then sets up a mutation observer to sync the\n * current selection to the dom when it changes. Such\n * changes could for example occur when options are\n * inside an `#each` block.\n * @param {HTMLSelectElement} select\n */\nexport function init_select(select) {\n\tvar observer = new MutationObserver(() => {\n\t\t// @ts-ignore\n\t\tselect_option(select, select.__value);\n\t\t// Deliberately don't update the potential binding value,\n\t\t// the model should be preserved unless explicitly changed\n\t});\n\n\tobserver.observe(select, {\n\t\t// Listen to option element changes\n\t\tchildList: true,\n\t\tsubtree: true, // because of <optgroup>\n\t\t// Listen to option element value attribute changes\n\t\t// (doesn't get notified of select value changes,\n\t\t// because that property is not reflected as an attribute)\n\t\tattributes: true,\n\t\tattributeFilter: ['value']\n\t});\n\n\tteardown(() => {\n\t\tobserver.disconnect();\n\t});\n}\n\n/**\n * @param {HTMLSelectElement} select\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_select_value(select, get, set = get) {\n\tvar mounting = true;\n\n\tlisten_to_event_and_reset_event(select, 'change', (is_reset) => {\n\t\tvar query = is_reset ? '[selected]' : ':checked';\n\t\t/** @type {unknown} */\n\t\tvar value;\n\n\t\tif (select.multiple) {\n\t\t\tvalue = [].map.call(select.querySelectorAll(query), get_option_value);\n\t\t} else {\n\t\t\t/** @type {HTMLOptionElement | null} */\n\t\t\tvar selected_option =\n\t\t\t\tselect.querySelector(query) ??\n\t\t\t\t// will fall back to first non-disabled option if no option is selected\n\t\t\t\tselect.querySelector('option:not([disabled])');\n\t\t\tvalue = selected_option && get_option_value(selected_option);\n\t\t}\n\n\t\tset(value);\n\t});\n\n\t// Needs to be an effect, not a render_effect, so that in case of each loops the logic runs after the each block has updated\n\teffect(() => {\n\t\tvar value = get();\n\t\tselect_option(select, value, mounting);\n\n\t\t// Mounting and value undefined -> take selection from dom\n\t\tif (mounting && value === undefined) {\n\t\t\t/** @type {HTMLOptionElement | null} */\n\t\t\tvar selected_option = select.querySelector(':checked');\n\t\t\tif (selected_option !== null) {\n\t\t\t\tvalue = get_option_value(selected_option);\n\t\t\t\tset(value);\n\t\t\t}\n\t\t}\n\n\t\t// @ts-ignore\n\t\tselect.__value = value;\n\t\tmounting = false;\n\t});\n\n\tinit_select(select);\n}\n\n/** @param {HTMLOptionElement} option */\nfunction get_option_value(option) {\n\t// __value only exists if the <option> has a value attribute\n\tif ('__value' in option) {\n\t\treturn option.__value;\n\t} else {\n\t\treturn option.value;\n\t}\n}\n","/* This file is generated by scripts/process-messages/index.js. Do not edit! */\n\nimport { DEV } from 'esm-env';\n\nvar bold = 'font-weight: bold';\nvar normal = 'font-weight: normal';\n\n/**\n * Assignment to `%property%` property (%location%) will evaluate to the right-hand side, not the value of `%property%` following the assignment. This may result in unexpected behaviour.\n * @param {string} property\n * @param {string} location\n */\nexport function assignment_value_stale(property, location) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] assignment_value_stale\\n%cAssignment to \\`${property}\\` property (${location}) will evaluate to the right-hand side, not the value of \\`${property}\\` following the assignment. This may result in unexpected behaviour.\\nhttps://svelte.dev/e/assignment_value_stale`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/assignment_value_stale`);\n\t}\n}\n\n/**\n * `%binding%` (%location%) is binding to a non-reactive property\n * @param {string} binding\n * @param {string | undefined | null} [location]\n */\nexport function binding_property_non_reactive(binding, location) {\n\tif (DEV) {\n\t\tconsole.warn(\n\t\t\t`%c[svelte] binding_property_non_reactive\\n%c${location\n\t\t\t\t? `\\`${binding}\\` (${location}) is binding to a non-reactive property`\n\t\t\t\t: `\\`${binding}\\` is binding to a non-reactive property`}\\nhttps://svelte.dev/e/binding_property_non_reactive`,\n\t\t\tbold,\n\t\t\tnormal\n\t\t);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/binding_property_non_reactive`);\n\t}\n}\n\n/**\n * Your `console.%method%` contained `$state` proxies. Consider using `$inspect(...)` or `$state.snapshot(...)` instead\n * @param {string} method\n */\nexport function console_log_state(method) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] console_log_state\\n%cYour \\`console.${method}\\` contained \\`$state\\` proxies. Consider using \\`$inspect(...)\\` or \\`$state.snapshot(...)\\` instead\\nhttps://svelte.dev/e/console_log_state`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/console_log_state`);\n\t}\n}\n\n/**\n * %handler% should be a function. Did you mean to %suggestion%?\n * @param {string} handler\n * @param {string} suggestion\n */\nexport function event_handler_invalid(handler, suggestion) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] event_handler_invalid\\n%c${handler} should be a function. Did you mean to ${suggestion}?\\nhttps://svelte.dev/e/event_handler_invalid`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/event_handler_invalid`);\n\t}\n}\n\n/**\n * The `%attribute%` attribute on `%html%` changed its value between server and client renders. The client value, `%value%`, will be ignored in favour of the server value\n * @param {string} attribute\n * @param {string} html\n * @param {string} value\n */\nexport function hydration_attribute_changed(attribute, html, value) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] hydration_attribute_changed\\n%cThe \\`${attribute}\\` attribute on \\`${html}\\` changed its value between server and client renders. The client value, \\`${value}\\`, will be ignored in favour of the server value\\nhttps://svelte.dev/e/hydration_attribute_changed`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/hydration_attribute_changed`);\n\t}\n}\n\n/**\n * The value of an `{@html ...}` block %location% changed between server and client renders. The client value will be ignored in favour of the server value\n * @param {string | undefined | null} [location]\n */\nexport function hydration_html_changed(location) {\n\tif (DEV) {\n\t\tconsole.warn(\n\t\t\t`%c[svelte] hydration_html_changed\\n%c${location\n\t\t\t\t? `The value of an \\`{@html ...}\\` block ${location} changed between server and client renders. The client value will be ignored in favour of the server value`\n\t\t\t\t: 'The value of an `{@html ...}` block changed between server and client renders. The client value will be ignored in favour of the server value'}\\nhttps://svelte.dev/e/hydration_html_changed`,\n\t\t\tbold,\n\t\t\tnormal\n\t\t);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/hydration_html_changed`);\n\t}\n}\n\n/**\n * Hydration failed because the initial UI does not match what was rendered on the server. The error occurred near %location%\n * @param {string | undefined | null} [location]\n */\nexport function hydration_mismatch(location) {\n\tif (DEV) {\n\t\tconsole.warn(\n\t\t\t`%c[svelte] hydration_mismatch\\n%c${location\n\t\t\t\t? `Hydration failed because the initial UI does not match what was rendered on the server. The error occurred near ${location}`\n\t\t\t\t: 'Hydration failed because the initial UI does not match what was rendered on the server'}\\nhttps://svelte.dev/e/hydration_mismatch`,\n\t\t\tbold,\n\t\t\tnormal\n\t\t);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/hydration_mismatch`);\n\t}\n}\n\n/**\n * The `render` function passed to `createRawSnippet` should return HTML for a single element\n */\nexport function invalid_raw_snippet_render() {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] invalid_raw_snippet_render\\n%cThe \\`render\\` function passed to \\`createRawSnippet\\` should return HTML for a single element\\nhttps://svelte.dev/e/invalid_raw_snippet_render`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/invalid_raw_snippet_render`);\n\t}\n}\n\n/**\n * Detected a migrated `$:` reactive block in `%filename%` that both accesses and updates the same reactive value. This may cause recursive updates when converted to an `$effect`.\n * @param {string} filename\n */\nexport function legacy_recursive_reactive_block(filename) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] legacy_recursive_reactive_block\\n%cDetected a migrated \\`$:\\` reactive block in \\`${filename}\\` that both accesses and updates the same reactive value. This may cause recursive updates when converted to an \\`$effect\\`.\\nhttps://svelte.dev/e/legacy_recursive_reactive_block`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/legacy_recursive_reactive_block`);\n\t}\n}\n\n/**\n * Tried to unmount a component that was not mounted\n */\nexport function lifecycle_double_unmount() {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] lifecycle_double_unmount\\n%cTried to unmount a component that was not mounted\\nhttps://svelte.dev/e/lifecycle_double_unmount`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/lifecycle_double_unmount`);\n\t}\n}\n\n/**\n * %parent% passed property `%prop%` to %child% with `bind:`, but its parent component %owner% did not declare `%prop%` as a binding. Consider creating a binding between %owner% and %parent% (e.g. `bind:%prop%={...}` instead of `%prop%={...}`)\n * @param {string} parent\n * @param {string} prop\n * @param {string} child\n * @param {string} owner\n */\nexport function ownership_invalid_binding(parent, prop, child, owner) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] ownership_invalid_binding\\n%c${parent} passed property \\`${prop}\\` to ${child} with \\`bind:\\`, but its parent component ${owner} did not declare \\`${prop}\\` as a binding. Consider creating a binding between ${owner} and ${parent} (e.g. \\`bind:${prop}={...}\\` instead of \\`${prop}={...}\\`)\\nhttps://svelte.dev/e/ownership_invalid_binding`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/ownership_invalid_binding`);\n\t}\n}\n\n/**\n * Mutating unbound props (`%name%`, at %location%) is strongly discouraged. Consider using `bind:%prop%={...}` in %parent% (or using a callback) instead\n * @param {string} name\n * @param {string} location\n * @param {string} prop\n * @param {string} parent\n */\nexport function ownership_invalid_mutation(name, location, prop, parent) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] ownership_invalid_mutation\\n%cMutating unbound props (\\`${name}\\`, at ${location}) is strongly discouraged. Consider using \\`bind:${prop}={...}\\` in ${parent} (or using a callback) instead\\nhttps://svelte.dev/e/ownership_invalid_mutation`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/ownership_invalid_mutation`);\n\t}\n}\n\n/**\n * The `value` property of a `<select multiple>` element should be an array, but it received a non-array value. The selection will be kept as is.\n */\nexport function select_multiple_invalid_value() {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] select_multiple_invalid_value\\n%cThe \\`value\\` property of a \\`<select multiple>\\` element should be an array, but it received a non-array value. The selection will be kept as is.\\nhttps://svelte.dev/e/select_multiple_invalid_value`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/select_multiple_invalid_value`);\n\t}\n}\n\n/**\n * Reactive `$state(...)` proxies and the values they proxy have different identities. Because of this, comparisons with `%operator%` will produce unexpected results\n * @param {string} operator\n */\nexport function state_proxy_equality_mismatch(operator) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] state_proxy_equality_mismatch\\n%cReactive \\`$state(...)\\` proxies and the values they proxy have different identities. Because of this, comparisons with \\`${operator}\\` will produce unexpected results\\nhttps://svelte.dev/e/state_proxy_equality_mismatch`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/state_proxy_equality_mismatch`);\n\t}\n}\n\n/**\n * The `slide` transition does not work correctly for elements with `display: %value%`\n * @param {string} value\n */\nexport function transition_slide_display(value) {\n\tif (DEV) {\n\t\tconsole.warn(`%c[svelte] transition_slide_display\\n%cThe \\`slide\\` transition does not work correctly for elements with \\`display: ${value}\\`\\nhttps://svelte.dev/e/transition_slide_display`, bold, normal);\n\t} else {\n\t\tconsole.warn(`https://svelte.dev/e/transition_slide_display`);\n\t}\n}","/** @import { Effect } from '#client' */\nimport { DEV } from 'esm-env';\nimport { hydrating, set_hydrating } from '../hydration.js';\nimport { get_descriptors, get_prototype_of } from '../../../shared/utils.js';\nimport { create_event, delegate } from './events.js';\nimport { add_form_reset_listener, autofocus } from './misc.js';\nimport * as w from '../../warnings.js';\nimport { LOADING_ATTR_SYMBOL } from '#client/constants';\nimport { queue_idle_task } from '../task.js';\nimport { is_capture_event, is_delegated, normalize_attribute } from '../../../../utils.js';\nimport {\n\tactive_effect,\n\tactive_reaction,\n\tget,\n\tset_active_effect,\n\tset_active_reaction\n} from '../../runtime.js';\nimport { attach } from './attachments.js';\nimport { clsx } from '../../../shared/attributes.js';\nimport { set_class } from './class.js';\nimport { set_style } from './style.js';\nimport { ATTACHMENT_KEY, NAMESPACE_HTML } from '../../../../constants.js';\nimport { block, branch, destroy_effect, effect } from '../../reactivity/effects.js';\nimport { derived } from '../../reactivity/deriveds.js';\nimport { init_select, select_option } from './bindings/select.js';\n\nexport const CLASS = Symbol('class');\nexport const STYLE = Symbol('style');\n\nconst IS_CUSTOM_ELEMENT = Symbol('is custom element');\nconst IS_HTML = Symbol('is html');\n\n/**\n * The value/checked attribute in the template actually corresponds to the defaultValue property, so we need\n * to remove it upon hydration to avoid a bug when someone resets the form value.\n * @param {HTMLInputElement} input\n * @returns {void}\n */\nexport function remove_input_defaults(input) {\n\tif (!hydrating) return;\n\n\tvar already_removed = false;\n\n\t// We try and remove the default attributes later, rather than sync during hydration.\n\t// Doing it sync during hydration has a negative impact on performance, but deferring the\n\t// work in an idle task alleviates this greatly. If a form reset event comes in before\n\t// the idle callback, then we ensure the input defaults are cleared just before.\n\tvar remove_defaults = () => {\n\t\tif (already_removed) return;\n\t\talready_removed = true;\n\n\t\t// Remove the attributes but preserve the values\n\t\tif (input.hasAttribute('value')) {\n\t\t\tvar value = input.value;\n\t\t\tset_attribute(input, 'value', null);\n\t\t\tinput.value = value;\n\t\t}\n\n\t\tif (input.hasAttribute('checked')) {\n\t\t\tvar checked = input.checked;\n\t\t\tset_attribute(input, 'checked', null);\n\t\t\tinput.checked = checked;\n\t\t}\n\t};\n\n\t// @ts-expect-error\n\tinput.__on_r = remove_defaults;\n\tqueue_idle_task(remove_defaults);\n\tadd_form_reset_listener();\n}\n\n/**\n * @param {Element} element\n * @param {any} value\n */\nexport function set_value(element, value) {\n\tvar attributes = get_attributes(element);\n\n\tif (\n\t\tattributes.value ===\n\t\t\t(attributes.value =\n\t\t\t\t// treat null and undefined the same for the initial value\n\t\t\t\tvalue ?? undefined) ||\n\t\t// @ts-expect-error\n\t\t// `progress` elements always need their value set when it's `0`\n\t\t(element.value === value && (value !== 0 || element.nodeName !== 'PROGRESS'))\n\t) {\n\t\treturn;\n\t}\n\n\t// @ts-expect-error\n\telement.value = value ?? '';\n}\n\n/**\n * @param {Element} element\n * @param {boolean} checked\n */\nexport function set_checked(element, checked) {\n\tvar attributes = get_attributes(element);\n\n\tif (\n\t\tattributes.checked ===\n\t\t(attributes.checked =\n\t\t\t// treat null and undefined the same for the initial value\n\t\t\tchecked ?? undefined)\n\t) {\n\t\treturn;\n\t}\n\n\t// @ts-expect-error\n\telement.checked = checked;\n}\n\n/**\n * Sets the `selected` attribute on an `option` element.\n * Not set through the property because that doesn't reflect to the DOM,\n * which means it wouldn't be taken into account when a form is reset.\n * @param {HTMLOptionElement} element\n * @param {boolean} selected\n */\nexport function set_selected(element, selected) {\n\tif (selected) {\n\t\t// The selected option could've changed via user selection, and\n\t\t// setting the value without this check would set it back.\n\t\tif (!element.hasAttribute('selected')) {\n\t\t\telement.setAttribute('selected', '');\n\t\t}\n\t} else {\n\t\telement.removeAttribute('selected');\n\t}\n}\n\n/**\n * Applies the default checked property without influencing the current checked property.\n * @param {HTMLInputElement} element\n * @param {boolean} checked\n */\nexport function set_default_checked(element, checked) {\n\tconst existing_value = element.checked;\n\telement.defaultChecked = checked;\n\telement.checked = existing_value;\n}\n\n/**\n * Applies the default value property without influencing the current value property.\n * @param {HTMLInputElement | HTMLTextAreaElement} element\n * @param {string} value\n */\nexport function set_default_value(element, value) {\n\tconst existing_value = element.value;\n\telement.defaultValue = value;\n\telement.value = existing_value;\n}\n\n/**\n * @param {Element} element\n * @param {string} attribute\n * @param {string | null} value\n * @param {boolean} [skip_warning]\n */\nexport function set_attribute(element, attribute, value, skip_warning) {\n\tvar attributes = get_attributes(element);\n\n\tif (hydrating) {\n\t\tattributes[attribute] = element.getAttribute(attribute);\n\n\t\tif (\n\t\t\tattribute === 'src' ||\n\t\t\tattribute === 'srcset' ||\n\t\t\t(attribute === 'href' && element.nodeName === 'LINK')\n\t\t) {\n\t\t\tif (!skip_warning) {\n\t\t\t\tcheck_src_in_dev_hydration(element, attribute, value ?? '');\n\t\t\t}\n\n\t\t\t// If we reset these attributes, they would result in another network request, which we want to avoid.\n\t\t\t// We assume they are the same between client and server as checking if they are equal is expensive\n\t\t\t// (we can't just compare the strings as they can be different between client and server but result in the\n\t\t\t// same url, so we would need to create hidden anchor elements to compare them)\n\t\t\treturn;\n\t\t}\n\t}\n\n\tif (attributes[attribute] === (attributes[attribute] = value)) return;\n\n\tif (attribute === 'loading') {\n\t\t// @ts-expect-error\n\t\telement[LOADING_ATTR_SYMBOL] = value;\n\t}\n\n\tif (value == null) {\n\t\telement.removeAttribute(attribute);\n\t} else if (typeof value !== 'string' && get_setters(element).includes(attribute)) {\n\t\t// @ts-ignore\n\t\telement[attribute] = value;\n\t} else {\n\t\telement.setAttribute(attribute, value);\n\t}\n}\n\n/**\n * @param {Element} dom\n * @param {string} attribute\n * @param {string} value\n */\nexport function set_xlink_attribute(dom, attribute, value) {\n\tdom.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @param {string} prop\n * @param {any} value\n */\nexport function set_custom_element_data(node, prop, value) {\n\t// We need to ensure that setting custom element props, which can\n\t// invoke lifecycle methods on other custom elements, does not also\n\t// associate those lifecycle methods with the current active reaction\n\t// or effect\n\tvar previous_reaction = active_reaction;\n\tvar previous_effect = active_effect;\n\n\t// If we're hydrating but the custom element is from Svelte, and it already scaffolded,\n\t// then it might run block logic in hydration mode, which we have to prevent.\n\tlet was_hydrating = hydrating;\n\tif (hydrating) {\n\t\tset_hydrating(false);\n\t}\n\n\tset_active_reaction(null);\n\tset_active_effect(null);\n\n\ttry {\n\t\tif (\n\t\t\t// `style` should use `set_attribute` rather than the setter\n\t\t\tprop !== 'style' &&\n\t\t\t// Don't compute setters for custom elements while they aren't registered yet,\n\t\t\t// because during their upgrade/instantiation they might add more setters.\n\t\t\t// Instead, fall back to a simple \"an object, then set as property\" heuristic.\n\t\t\t(setters_cache.has(node.nodeName) ||\n\t\t\t// customElements may not be available in browser extension contexts\n\t\t\t!customElements ||\n\t\t\tcustomElements.get(node.tagName.toLowerCase())\n\t\t\t\t? get_setters(node).includes(prop)\n\t\t\t\t: value && typeof value === 'object')\n\t\t) {\n\t\t\t// @ts-expect-error\n\t\t\tnode[prop] = value;\n\t\t} else {\n\t\t\t// We did getters etc checks already, stringify before passing to set_attribute\n\t\t\t// to ensure it doesn't invoke the same logic again, and potentially populating\n\t\t\t// the setters cache too early.\n\t\t\tset_attribute(node, prop, value == null ? value : String(value));\n\t\t}\n\t} finally {\n\t\tset_active_reaction(previous_reaction);\n\t\tset_active_effect(previous_effect);\n\t\tif (was_hydrating) {\n\t\t\tset_hydrating(true);\n\t\t}\n\t}\n}\n\n/**\n * Spreads attributes onto a DOM element, taking into account the currently set attributes\n * @param {Element & ElementCSSInlineStyle} element\n * @param {Record<string | symbol, any> | undefined} prev\n * @param {Record<string | symbol, any>} next New attributes - this function mutates this object\n * @param {string} [css_hash]\n * @param {boolean} [skip_warning]\n * @returns {Record<string, any>}\n */\nexport function set_attributes(element, prev, next, css_hash, skip_warning = false) {\n\tvar attributes = get_attributes(element);\n\n\tvar is_custom_element = attributes[IS_CUSTOM_ELEMENT];\n\tvar preserve_attribute_case = !attributes[IS_HTML];\n\n\t// If we're hydrating but the custom element is from Svelte, and it already scaffolded,\n\t// then it might run block logic in hydration mode, which we have to prevent.\n\tlet is_hydrating_custom_element = hydrating && is_custom_element;\n\tif (is_hydrating_custom_element) {\n\t\tset_hydrating(false);\n\t}\n\n\tvar current = prev || {};\n\tvar is_option_element = element.tagName === 'OPTION';\n\n\tfor (var key in prev) {\n\t\tif (!(key in next)) {\n\t\t\tnext[key] = null;\n\t\t}\n\t}\n\n\tif (next.class) {\n\t\tnext.class = clsx(next.class);\n\t} else if (css_hash || next[CLASS]) {\n\t\tnext.class = null; /* force call to set_class() */\n\t}\n\n\tif (next[STYLE]) {\n\t\tnext.style ??= null; /* force call to set_style() */\n\t}\n\n\tvar setters = get_setters(element);\n\n\t// since key is captured we use const\n\tfor (const key in next) {\n\t\t// let instead of var because referenced in a closure\n\t\tlet value = next[key];\n\n\t\t// Up here because we want to do this for the initial value, too, even if it's undefined,\n\t\t// and this wouldn't be reached in case of undefined because of the equality check below\n\t\tif (is_option_element && key === 'value' && value == null) {\n\t\t\t// The <option> element is a special case because removing the value attribute means\n\t\t\t// the value is set to the text content of the option element, and setting the value\n\t\t\t// to null or undefined means the value is set to the string \"null\" or \"undefined\".\n\t\t\t// To align with how we handle this case in non-spread-scenarios, this logic is needed.\n\t\t\t// There's a super-edge-case bug here that is left in in favor of smaller code size:\n\t\t\t// Because of the \"set missing props to null\" logic above, we can't differentiate\n\t\t\t// between a missing value and an explicitly set value of null or undefined. That means\n\t\t\t// that once set, the value attribute of an <option> element can't be removed. This is\n\t\t\t// a very rare edge case, and removing the attribute altogether isn't possible either\n\t\t\t// for the <option value={undefined}> case, so we're not losing any functionality here.\n\t\t\t// @ts-ignore\n\t\t\telement.value = element.__value = '';\n\t\t\tcurrent[key] = value;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key === 'class') {\n\t\t\tvar is_html = element.namespaceURI === 'http://www.w3.org/1999/xhtml';\n\t\t\tset_class(element, is_html, value, css_hash, prev?.[CLASS], next[CLASS]);\n\t\t\tcurrent[key] = value;\n\t\t\tcurrent[CLASS] = next[CLASS];\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key === 'style') {\n\t\t\tset_style(element, value, prev?.[STYLE], next[STYLE]);\n\t\t\tcurrent[key] = value;\n\t\t\tcurrent[STYLE] = next[STYLE];\n\t\t\tcontinue;\n\t\t}\n\n\t\tvar prev_value = current[key];\n\n\t\t// Skip if value is unchanged, unless it's `undefined` and the element still has the attribute\n\t\tif (value === prev_value && !(value === undefined && element.hasAttribute(key))) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tcurrent[key] = value;\n\n\t\tvar prefix = key[0] + key[1]; // this is faster than key.slice(0, 2)\n\t\tif (prefix === '$$') continue;\n\n\t\tif (prefix === 'on') {\n\t\t\t/** @type {{ capture?: true }} */\n\t\t\tconst opts = {};\n\t\t\tconst event_handle_key = '$$' + key;\n\t\t\tlet event_name = key.slice(2);\n\t\t\tvar delegated = is_delegated(event_name);\n\n\t\t\tif (is_capture_event(event_name)) {\n\t\t\t\tevent_name = event_name.slice(0, -7);\n\t\t\t\topts.capture = true;\n\t\t\t}\n\n\t\t\tif (!delegated && prev_value) {\n\t\t\t\t// Listening to same event but different handler -> our handle function below takes care of this\n\t\t\t\t// If we were to remove and add listeners in this case, it could happen that the event is \"swallowed\"\n\t\t\t\t// (the browser seems to not know yet that a new one exists now) and doesn't reach the handler\n\t\t\t\t// https://github.com/sveltejs/svelte/issues/11903\n\t\t\t\tif (value != null) continue;\n\n\t\t\t\telement.removeEventListener(event_name, current[event_handle_key], opts);\n\t\t\t\tcurrent[event_handle_key] = null;\n\t\t\t}\n\n\t\t\tif (value != null) {\n\t\t\t\tif (!delegated) {\n\t\t\t\t\t/**\n\t\t\t\t\t * @this {any}\n\t\t\t\t\t * @param {Event} evt\n\t\t\t\t\t */\n\t\t\t\t\tfunction handle(evt) {\n\t\t\t\t\t\tcurrent[key].call(this, evt);\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent[event_handle_key] = create_event(event_name, element, handle, opts);\n\t\t\t\t} else {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\telement[`__${event_name}`] = value;\n\t\t\t\t\tdelegate([event_name]);\n\t\t\t\t}\n\t\t\t} else if (delegated) {\n\t\t\t\t// @ts-ignore\n\t\t\t\telement[`__${event_name}`] = undefined;\n\t\t\t}\n\t\t} else if (key === 'style') {\n\t\t\t// avoid using the setter\n\t\t\tset_attribute(element, key, value);\n\t\t} else if (key === 'autofocus') {\n\t\t\tautofocus(/** @type {HTMLElement} */ (element), Boolean(value));\n\t\t} else if (!is_custom_element && (key === '__value' || (key === 'value' && value != null))) {\n\t\t\t// @ts-ignore We're not running this for custom elements because __value is actually\n\t\t\t// how Lit stores the current value on the element, and messing with that would break things.\n\t\t\telement.value = element.__value = value;\n\t\t} else if (key === 'selected' && is_option_element) {\n\t\t\tset_selected(/** @type {HTMLOptionElement} */ (element), value);\n\t\t} else {\n\t\t\tvar name = key;\n\t\t\tif (!preserve_attribute_case) {\n\t\t\t\tname = normalize_attribute(name);\n\t\t\t}\n\n\t\t\tvar is_default = name === 'defaultValue' || name === 'defaultChecked';\n\n\t\t\tif (value == null && !is_custom_element && !is_default) {\n\t\t\t\tattributes[key] = null;\n\n\t\t\t\tif (name === 'value' || name === 'checked') {\n\t\t\t\t\t// removing value/checked also removes defaultValue/defaultChecked — preserve\n\t\t\t\t\tlet input = /** @type {HTMLInputElement} */ (element);\n\t\t\t\t\tconst use_default = prev === undefined;\n\t\t\t\t\tif (name === 'value') {\n\t\t\t\t\t\tlet previous = input.defaultValue;\n\t\t\t\t\t\tinput.removeAttribute(name);\n\t\t\t\t\t\tinput.defaultValue = previous;\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tinput.value = input.__value = use_default ? previous : null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet previous = input.defaultChecked;\n\t\t\t\t\t\tinput.removeAttribute(name);\n\t\t\t\t\t\tinput.defaultChecked = previous;\n\t\t\t\t\t\tinput.checked = use_default ? previous : false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\telement.removeAttribute(key);\n\t\t\t\t}\n\t\t\t} else if (\n\t\t\t\tis_default ||\n\t\t\t\t(setters.includes(name) && (is_custom_element || typeof value !== 'string'))\n\t\t\t) {\n\t\t\t\t// @ts-ignore\n\t\t\t\telement[name] = value;\n\t\t\t} else if (typeof value !== 'function') {\n\t\t\t\tset_attribute(element, name, value, skip_warning);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (is_hydrating_custom_element) {\n\t\tset_hydrating(true);\n\t}\n\n\treturn current;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} element\n * @param {(...expressions: any) => Record<string | symbol, any>} fn\n * @param {Array<() => any>} thunks\n * @param {string} [css_hash]\n * @param {boolean} [skip_warning]\n */\nexport function attribute_effect(\n\telement,\n\tfn,\n\tthunks = [],\n\tcss_hash,\n\tskip_warning = false,\n\td = derived\n) {\n\tconst deriveds = thunks.map(d);\n\n\t/** @type {Record<string | symbol, any> | undefined} */\n\tvar prev = undefined;\n\n\t/** @type {Record<symbol, Effect>} */\n\tvar effects = {};\n\n\tvar is_select = element.nodeName === 'SELECT';\n\tvar inited = false;\n\n\tblock(() => {\n\t\tvar next = fn(...deriveds.map(get));\n\t\t/** @type {Record<string | symbol, any>} */\n\t\tvar current = set_attributes(element, prev, next, css_hash, skip_warning);\n\n\t\tif (inited && is_select && 'value' in next) {\n\t\t\tselect_option(/** @type {HTMLSelectElement} */ (element), next.value);\n\t\t}\n\n\t\tfor (let symbol of Object.getOwnPropertySymbols(effects)) {\n\t\t\tif (!next[symbol]) destroy_effect(effects[symbol]);\n\t\t}\n\n\t\tfor (let symbol of Object.getOwnPropertySymbols(next)) {\n\t\t\tvar n = next[symbol];\n\n\t\t\tif (symbol.description === ATTACHMENT_KEY && (!prev || n !== prev[symbol])) {\n\t\t\t\tif (effects[symbol]) destroy_effect(effects[symbol]);\n\t\t\t\teffects[symbol] = branch(() => attach(element, () => n));\n\t\t\t}\n\n\t\t\tcurrent[symbol] = n;\n\t\t}\n\n\t\tprev = current;\n\t});\n\n\tif (is_select) {\n\t\tvar select = /** @type {HTMLSelectElement} */ (element);\n\n\t\teffect(() => {\n\t\t\tselect_option(select, /** @type {Record<string | symbol, any>} */ (prev).value, true);\n\t\t\tinit_select(select);\n\t\t});\n\t}\n\n\tinited = true;\n}\n\n/**\n *\n * @param {Element} element\n */\nfunction get_attributes(element) {\n\treturn /** @type {Record<string | symbol, unknown>} **/ (\n\t\t// @ts-expect-error\n\t\telement.__attributes ??= {\n\t\t\t[IS_CUSTOM_ELEMENT]: element.nodeName.includes('-'),\n\t\t\t[IS_HTML]: element.namespaceURI === NAMESPACE_HTML\n\t\t}\n\t);\n}\n\n/** @type {Map<string, string[]>} */\nvar setters_cache = new Map();\n\n/** @param {Element} element */\nfunction get_setters(element) {\n\tvar setters = setters_cache.get(element.nodeName);\n\tif (setters) return setters;\n\tsetters_cache.set(element.nodeName, (setters = []));\n\n\tvar descriptors;\n\tvar proto = element; // In the case of custom elements there might be setters on the instance\n\tvar element_proto = Element.prototype;\n\n\t// Stop at Element, from there on there's only unnecessary setters we're not interested in\n\t// Do not use contructor.name here as that's unreliable in some browser environments\n\twhile (element_proto !== proto) {\n\t\tdescriptors = get_descriptors(proto);\n\n\t\tfor (var key in descriptors) {\n\t\t\tif (descriptors[key].set) {\n\t\t\t\tsetters.push(key);\n\t\t\t}\n\t\t}\n\n\t\tproto = get_prototype_of(proto);\n\t}\n\n\treturn setters;\n}\n\n/**\n * @param {any} element\n * @param {string} attribute\n * @param {string} value\n */\nfunction check_src_in_dev_hydration(element, attribute, value) {\n\tif (!DEV) return;\n\tif (attribute === 'srcset' && srcset_url_equal(element, value)) return;\n\tif (src_url_equal(element.getAttribute(attribute) ?? '', value)) return;\n\n\tw.hydration_attribute_changed(\n\t\tattribute,\n\t\telement.outerHTML.replace(element.innerHTML, element.innerHTML && '...'),\n\t\tString(value)\n\t);\n}\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nfunction src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\treturn new URL(element_src, document.baseURI).href === new URL(url, document.baseURI).href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element\n * @param {string} srcset\n * @returns {boolean}\n */\nfunction srcset_url_equal(element, srcset) {\n\tvar element_urls = split_srcset(element.srcset);\n\tvar urls = split_srcset(srcset);\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n","import { DEV } from 'esm-env';\nimport { render_effect, teardown } from '../../../reactivity/effects.js';\nimport { listen_to_event_and_reset_event } from './shared.js';\nimport * as e from '../../../errors.js';\nimport { is } from '../../../proxy.js';\nimport { queue_micro_task } from '../../task.js';\nimport { hydrating } from '../../hydration.js';\nimport { untrack } from '../../../runtime.js';\nimport { is_runes } from '../../../context.js';\n\n/**\n * @param {HTMLInputElement} input\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_value(input, get, set = get) {\n\tvar runes = is_runes();\n\n\tlisten_to_event_and_reset_event(input, 'input', (is_reset) => {\n\t\tif (DEV && input.type === 'checkbox') {\n\t\t\t// TODO should this happen in prod too?\n\t\t\te.bind_invalid_checkbox_value();\n\t\t}\n\n\t\t/** @type {any} */\n\t\tvar value = is_reset ? input.defaultValue : input.value;\n\t\tvalue = is_numberlike_input(input) ? to_number(value) : value;\n\t\tset(value);\n\n\t\t// In runes mode, respect any validation in accessors (doesn't apply in legacy mode,\n\t\t// because we use mutable state which ensures the render effect always runs)\n\t\tif (runes && value !== (value = get())) {\n\t\t\tvar start = input.selectionStart;\n\t\t\tvar end = input.selectionEnd;\n\n\t\t\t// the value is coerced on assignment\n\t\t\tinput.value = value ?? '';\n\n\t\t\t// Restore selection\n\t\t\tif (end !== null) {\n\t\t\t\tinput.selectionStart = start;\n\t\t\t\tinput.selectionEnd = Math.min(end, input.value.length);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (\n\t\t// If we are hydrating and the value has since changed,\n\t\t// then use the updated value from the input instead.\n\t\t(hydrating && input.defaultValue !== input.value) ||\n\t\t// If defaultValue is set, then value == defaultValue\n\t\t// TODO Svelte 6: remove input.value check and set to empty string?\n\t\t(untrack(get) == null && input.value)\n\t) {\n\t\tset(is_numberlike_input(input) ? to_number(input.value) : input.value);\n\t}\n\n\trender_effect(() => {\n\t\tif (DEV && input.type === 'checkbox') {\n\t\t\t// TODO should this happen in prod too?\n\t\t\te.bind_invalid_checkbox_value();\n\t\t}\n\n\t\tvar value = get();\n\n\t\tif (is_numberlike_input(input) && value === to_number(input.value)) {\n\t\t\t// handles 0 vs 00 case (see https://github.com/sveltejs/svelte/issues/9959)\n\t\t\treturn;\n\t\t}\n\n\t\tif (input.type === 'date' && !value && !input.value) {\n\t\t\t// Handles the case where a temporarily invalid date is set (while typing, for example with a leading 0 for the day)\n\t\t\t// and prevents this state from clearing the other parts of the date input (see https://github.com/sveltejs/svelte/issues/7897)\n\t\t\treturn;\n\t\t}\n\n\t\t// don't set the value of the input if it's the same to allow\n\t\t// minlength to work properly\n\t\tif (value !== input.value) {\n\t\t\t// @ts-expect-error the value is coerced on assignment\n\t\t\tinput.value = value ?? '';\n\t\t}\n\t});\n}\n\n/** @type {Set<HTMLInputElement[]>} */\nconst pending = new Set();\n\n/**\n * @param {HTMLInputElement[]} inputs\n * @param {null | [number]} group_index\n * @param {HTMLInputElement} input\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_group(inputs, group_index, input, get, set = get) {\n\tvar is_checkbox = input.getAttribute('type') === 'checkbox';\n\tvar binding_group = inputs;\n\n\t// needs to be let or related code isn't treeshaken out if it's always false\n\tlet hydration_mismatch = false;\n\n\tif (group_index !== null) {\n\t\tfor (var index of group_index) {\n\t\t\t// @ts-expect-error\n\t\t\tbinding_group = binding_group[index] ??= [];\n\t\t}\n\t}\n\n\tbinding_group.push(input);\n\n\tlisten_to_event_and_reset_event(\n\t\tinput,\n\t\t'change',\n\t\t() => {\n\t\t\t// @ts-ignore\n\t\t\tvar value = input.__value;\n\n\t\t\tif (is_checkbox) {\n\t\t\t\tvalue = get_binding_group_value(binding_group, value, input.checked);\n\t\t\t}\n\n\t\t\tset(value);\n\t\t},\n\t\t// TODO better default value handling\n\t\t() => set(is_checkbox ? [] : null)\n\t);\n\n\trender_effect(() => {\n\t\tvar value = get();\n\n\t\t// If we are hydrating and the value has since changed, then use the update value\n\t\t// from the input instead.\n\t\tif (hydrating && input.defaultChecked !== input.checked) {\n\t\t\thydration_mismatch = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (is_checkbox) {\n\t\t\tvalue = value || [];\n\t\t\t// @ts-ignore\n\t\t\tinput.checked = value.includes(input.__value);\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\tinput.checked = is(input.__value, value);\n\t\t}\n\t});\n\n\tteardown(() => {\n\t\tvar index = binding_group.indexOf(input);\n\n\t\tif (index !== -1) {\n\t\t\tbinding_group.splice(index, 1);\n\t\t}\n\t});\n\n\tif (!pending.has(binding_group)) {\n\t\tpending.add(binding_group);\n\n\t\tqueue_micro_task(() => {\n\t\t\t// necessary to maintain binding group order in all insertion scenarios\n\t\t\tbinding_group.sort((a, b) => (a.compareDocumentPosition(b) === 4 ? -1 : 1));\n\t\t\tpending.delete(binding_group);\n\t\t});\n\t}\n\n\tqueue_micro_task(() => {\n\t\tif (hydration_mismatch) {\n\t\t\tvar value;\n\n\t\t\tif (is_checkbox) {\n\t\t\t\tvalue = get_binding_group_value(binding_group, value, input.checked);\n\t\t\t} else {\n\t\t\t\tvar hydration_input = binding_group.find((input) => input.checked);\n\t\t\t\t// @ts-ignore\n\t\t\t\tvalue = hydration_input?.__value;\n\t\t\t}\n\n\t\t\tset(value);\n\t\t}\n\t});\n}\n\n/**\n * @param {HTMLInputElement} input\n * @param {() => unknown} get\n * @param {(value: unknown) => void} set\n * @returns {void}\n */\nexport function bind_checked(input, get, set = get) {\n\tlisten_to_event_and_reset_event(input, 'change', (is_reset) => {\n\t\tvar value = is_reset ? input.defaultChecked : input.checked;\n\t\tset(value);\n\t});\n\n\tif (\n\t\t// If we are hydrating and the value has since changed,\n\t\t// then use the update value from the input instead.\n\t\t(hydrating && input.defaultChecked !== input.checked) ||\n\t\t// If defaultChecked is set, then checked == defaultChecked\n\t\tuntrack(get) == null\n\t) {\n\t\tset(input.checked);\n\t}\n\n\trender_effect(() => {\n\t\tvar value = get();\n\t\tinput.checked = Boolean(value);\n\t});\n}\n\n/**\n * @template V\n * @param {Array<HTMLInputElement>} group\n * @param {V} __value\n * @param {boolean} checked\n * @returns {V[]}\n */\nfunction get_binding_group_value(group, __value, checked) {\n\tvar value = new Set();\n\n\tfor (var i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) {\n\t\t\t// @ts-ignore\n\t\t\tvalue.add(group[i].__value);\n\t\t}\n\t}\n\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement} input\n */\nfunction is_numberlike_input(input) {\n\tvar type = input.type;\n\treturn type === 'number' || type === 'range';\n}\n\n/**\n * @param {string} value\n */\nfunction to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/**\n * @param {HTMLInputElement} input\n * @param {() => FileList | null} get\n * @param {(value: FileList | null) => void} set\n */\nexport function bind_files(input, get, set = get) {\n\tlisten_to_event_and_reset_event(input, 'change', () => {\n\t\tset(input.files);\n\t});\n\n\tif (\n\t\t// If we are hydrating and the value has since changed,\n\t\t// then use the updated value from the input instead.\n\t\thydrating &&\n\t\tinput.files\n\t) {\n\t\tset(input.files);\n\t}\n\n\trender_effect(() => {\n\t\tinput.files = get();\n\t});\n}\n","import { teardown } from '../../../reactivity/effects.js';\nimport { get_descriptor } from '../../../../shared/utils.js';\n\n/**\n * Makes an `export`ed (non-prop) variable available on the `$$props` object\n * so that consumers can do `bind:x` on the component.\n * @template V\n * @param {Record<string, unknown>} props\n * @param {string} prop\n * @param {V} value\n * @returns {void}\n */\nexport function bind_prop(props, prop, value) {\n\tvar desc = get_descriptor(props, prop);\n\n\tif (desc && desc.set) {\n\t\tprops[prop] = value;\n\t\tteardown(() => {\n\t\t\tprops[prop] = null;\n\t\t});\n\t}\n}\n","import { STATE_SYMBOL } from '#client/constants';\nimport { effect, render_effect } from '../../../reactivity/effects.js';\nimport { untrack } from '../../../runtime.js';\nimport { queue_micro_task } from '../../task.js';\n\n/**\n * @param {any} bound_value\n * @param {Element} element_or_component\n * @returns {boolean}\n */\nfunction is_bound_this(bound_value, element_or_component) {\n\treturn (\n\t\tbound_value === element_or_component || bound_value?.[STATE_SYMBOL] === element_or_component\n\t);\n}\n\n/**\n * @param {any} element_or_component\n * @param {(value: unknown, ...parts: unknown[]) => void} update\n * @param {(...parts: unknown[]) => unknown} get_value\n * @param {() => unknown[]} [get_parts] Set if the this binding is used inside an each block,\n * \t\t\t\t\t\t\t\t\t\treturns all the parts of the each block context that are used in the expression\n * @returns {void}\n */\nexport function bind_this(element_or_component = {}, update, get_value, get_parts) {\n\teffect(() => {\n\t\t/** @type {unknown[]} */\n\t\tvar old_parts;\n\n\t\t/** @type {unknown[]} */\n\t\tvar parts;\n\n\t\trender_effect(() => {\n\t\t\told_parts = parts;\n\t\t\t// We only track changes to the parts, not the value itself to avoid unnecessary reruns.\n\t\t\tparts = get_parts?.() || [];\n\n\t\t\tuntrack(() => {\n\t\t\t\tif (element_or_component !== get_value(...parts)) {\n\t\t\t\t\tupdate(element_or_component, ...parts);\n\t\t\t\t\t// If this is an effect rerun (cause: each block context changes), then nullfiy the binding at\n\t\t\t\t\t// the previous position if it isn't already taken over by a different effect.\n\t\t\t\t\tif (old_parts && is_bound_this(get_value(...old_parts), element_or_component)) {\n\t\t\t\t\t\tupdate(null, ...old_parts);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn () => {\n\t\t\t// We cannot use effects in the teardown phase, we we use a microtask instead.\n\t\t\tqueue_micro_task(() => {\n\t\t\t\tif (parts && is_bound_this(get_value(...parts), element_or_component)) {\n\t\t\t\t\tupdate(null, ...parts);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t});\n\n\treturn element_or_component;\n}\n","import { noop } from '../../../shared/utils.js';\nimport { user_pre_effect } from '../../reactivity/effects.js';\nimport { on } from '../elements/events.js';\n\n/**\n * Substitute for the `trusted` event modifier\n * @deprecated\n * @param {(event: Event, ...args: Array<unknown>) => void} fn\n * @returns {(event: Event, ...args: unknown[]) => void}\n */\nexport function trusted(fn) {\n\treturn function (...args) {\n\t\tvar event = /** @type {Event} */ (args[0]);\n\t\tif (event.isTrusted) {\n\t\t\t// @ts-ignore\n\t\t\tfn?.apply(this, args);\n\t\t}\n\t};\n}\n\n/**\n * Substitute for the `self` event modifier\n * @deprecated\n * @param {(event: Event, ...args: Array<unknown>) => void} fn\n * @returns {(event: Event, ...args: unknown[]) => void}\n */\nexport function self(fn) {\n\treturn function (...args) {\n\t\tvar event = /** @type {Event} */ (args[0]);\n\t\t// @ts-ignore\n\t\tif (event.target === this) {\n\t\t\t// @ts-ignore\n\t\t\tfn?.apply(this, args);\n\t\t}\n\t};\n}\n\n/**\n * Substitute for the `stopPropagation` event modifier\n * @deprecated\n * @param {(event: Event, ...args: Array<unknown>) => void} fn\n * @returns {(event: Event, ...args: unknown[]) => void}\n */\nexport function stopPropagation(fn) {\n\treturn function (...args) {\n\t\tvar event = /** @type {Event} */ (args[0]);\n\t\tevent.stopPropagation();\n\t\t// @ts-ignore\n\t\treturn fn?.apply(this, args);\n\t};\n}\n\n/**\n * Substitute for the `once` event modifier\n * @deprecated\n * @param {(event: Event, ...args: Array<unknown>) => void} fn\n * @returns {(event: Event, ...args: unknown[]) => void}\n */\nexport function once(fn) {\n\tvar ran = false;\n\n\treturn function (...args) {\n\t\tif (ran) return;\n\t\tran = true;\n\n\t\t// @ts-ignore\n\t\treturn fn?.apply(this, args);\n\t};\n}\n\n/**\n * Substitute for the `stopImmediatePropagation` event modifier\n * @deprecated\n * @param {(event: Event, ...args: Array<unknown>) => void} fn\n * @returns {(event: Event, ...args: unknown[]) => void}\n */\nexport function stopImmediatePropagation(fn) {\n\treturn function (...args) {\n\t\tvar event = /** @type {Event} */ (args[0]);\n\t\tevent.stopImmediatePropagation();\n\t\t// @ts-ignore\n\t\treturn fn?.apply(this, args);\n\t};\n}\n\n/**\n * Substitute for the `preventDefault` event modifier\n * @deprecated\n * @param {(event: Event, ...args: Array<unknown>) => void} fn\n * @returns {(event: Event, ...args: unknown[]) => void}\n */\nexport function preventDefault(fn) {\n\treturn function (...args) {\n\t\tvar event = /** @type {Event} */ (args[0]);\n\t\tevent.preventDefault();\n\t\t// @ts-ignore\n\t\treturn fn?.apply(this, args);\n\t};\n}\n\n/**\n * Substitute for the `passive` event modifier, implemented as an action\n * @deprecated\n * @param {HTMLElement} node\n * @param {[event: string, handler: () => EventListener]} options\n */\nexport function passive(node, [event, handler]) {\n\tuser_pre_effect(() => {\n\t\treturn on(node, event, handler() ?? noop, {\n\t\t\tpassive: true\n\t\t});\n\t});\n}\n\n/**\n * Substitute for the `nonpassive` event modifier, implemented as an action\n * @deprecated\n * @param {HTMLElement} node\n * @param {[event: string, handler: () => EventListener]} options\n */\nexport function nonpassive(node, [event, handler]) {\n\tuser_pre_effect(() => {\n\t\treturn on(node, event, handler() ?? noop, {\n\t\t\tpassive: false\n\t\t});\n\t});\n}\n","/** @import { ComponentContextLegacy } from '#client' */\nimport { run, run_all } from '../../../shared/utils.js';\nimport { component_context } from '../../context.js';\nimport { derived } from '../../reactivity/deriveds.js';\nimport { user_pre_effect, user_effect } from '../../reactivity/effects.js';\nimport { deep_read_state, get, untrack } from '../../runtime.js';\n\n/**\n * Legacy-mode only: Call `onMount` callbacks and set up `beforeUpdate`/`afterUpdate` effects\n * @param {boolean} [immutable]\n */\nexport function init(immutable = false) {\n\tconst context = /** @type {ComponentContextLegacy} */ (component_context);\n\n\tconst callbacks = context.l.u;\n\tif (!callbacks) return;\n\n\tlet props = () => deep_read_state(context.s);\n\n\tif (immutable) {\n\t\tlet version = 0;\n\t\tlet prev = /** @type {Record<string, any>} */ ({});\n\n\t\t// In legacy immutable mode, before/afterUpdate only fire if the object identity of a prop changes\n\t\tconst d = derived(() => {\n\t\t\tlet changed = false;\n\t\t\tconst props = context.s;\n\t\t\tfor (const key in props) {\n\t\t\t\tif (props[key] !== prev[key]) {\n\t\t\t\t\tprev[key] = props[key];\n\t\t\t\t\tchanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (changed) version++;\n\t\t\treturn version;\n\t\t});\n\n\t\tprops = () => get(d);\n\t}\n\n\t// beforeUpdate\n\tif (callbacks.b.length) {\n\t\tuser_pre_effect(() => {\n\t\t\tobserve_all(context, props);\n\t\t\trun_all(callbacks.b);\n\t\t});\n\t}\n\n\t// onMount (must run before afterUpdate)\n\tuser_effect(() => {\n\t\tconst fns = untrack(() => callbacks.m.map(run));\n\t\treturn () => {\n\t\t\tfor (const fn of fns) {\n\t\t\t\tif (typeof fn === 'function') {\n\t\t\t\t\tfn();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t});\n\n\t// afterUpdate\n\tif (callbacks.a.length) {\n\t\tuser_effect(() => {\n\t\t\tobserve_all(context, props);\n\t\t\trun_all(callbacks.a);\n\t\t});\n\t}\n}\n\n/**\n * Invoke the getter of all signals associated with a component\n * so they can be registered to the effect this function is called in.\n * @param {ComponentContextLegacy} context\n * @param {(() => void)} props\n */\nfunction observe_all(context, props) {\n\tif (context.l.s) {\n\t\tfor (const signal of context.l.s) get(signal);\n\t}\n\n\tprops();\n}\n","import { set, source } from '../../reactivity/sources.js';\nimport { get } from '../../runtime.js';\nimport { is_array } from '../../../shared/utils.js';\n\n/**\n * Under some circumstances, imports may be reactive in legacy mode. In that case,\n * they should be using `reactive_import` as part of the transformation\n * @param {() => any} fn\n */\nexport function reactive_import(fn) {\n\tvar s = source(0);\n\n\treturn function () {\n\t\tif (arguments.length === 1) {\n\t\t\tset(s, get(s) + 1);\n\t\t\treturn arguments[0];\n\t\t} else {\n\t\t\tget(s);\n\t\t\treturn fn();\n\t\t}\n\t};\n}\n\n/**\n * @this {any}\n * @param {Record<string, unknown>} $$props\n * @param {Event} event\n * @returns {void}\n */\nexport function bubble_event($$props, event) {\n\tvar events = /** @type {Record<string, Function[] | Function>} */ ($$props.$$events)?.[\n\t\tevent.type\n\t];\n\n\tvar callbacks = is_array(events) ? events.slice() : events == null ? [] : [events];\n\n\tfor (var fn of callbacks) {\n\t\t// Preserve \"this\" context\n\t\tfn.call(this, event);\n\t}\n}\n\n/**\n * Used to simulate `$on` on a component instance when `compatibility.componentApi === 4`\n * @param {Record<string, any>} $$props\n * @param {string} event_name\n * @param {Function} event_callback\n */\nexport function add_legacy_event_listener($$props, event_name, event_callback) {\n\t$$props.$$events ||= {};\n\t$$props.$$events[event_name] ||= [];\n\t$$props.$$events[event_name].push(event_callback);\n}\n\n/**\n * Used to simulate `$set` on a component instance when `compatibility.componentApi === 4`.\n * Needs component accessors so that it can call the setter of the prop. Therefore doesn't\n * work for updating props in `$$props` or `$$restProps`.\n * @this {Record<string, any>}\n * @param {Record<string, any>} $$new_props\n */\nexport function update_legacy_props($$new_props) {\n\tfor (var key in $$new_props) {\n\t\tif (key in this) {\n\t\t\tthis[key] = $$new_props[key];\n\t\t}\n\t}\n}\n","/** @import { StoreReferencesContainer } from '#client' */\n/** @import { Store } from '#shared' */\nimport { subscribe_to_store } from '../../../store/utils.js';\nimport { get as get_store } from '../../../store/shared/index.js';\nimport { define_property, noop } from '../../shared/utils.js';\nimport { get } from '../runtime.js';\nimport { teardown } from './effects.js';\nimport { mutable_source, set } from './sources.js';\n\n/**\n * Whether or not the prop currently being read is a store binding, as in\n * `<Child bind:x={$y} />`. If it is, we treat the prop as mutable even in\n * runes mode, and skip `binding_property_non_reactive` validation\n */\nlet is_store_binding = false;\n\nlet IS_UNMOUNTED = Symbol();\n\n/**\n * Gets the current value of a store. If the store isn't subscribed to yet, it will create a proxy\n * signal that will be updated when the store is. The store references container is needed to\n * track reassignments to stores and to track the correct component context.\n * @template V\n * @param {Store<V> | null | undefined} store\n * @param {string} store_name\n * @param {StoreReferencesContainer} stores\n * @returns {V}\n */\nexport function store_get(store, store_name, stores) {\n\tconst entry = (stores[store_name] ??= {\n\t\tstore: null,\n\t\tsource: mutable_source(undefined),\n\t\tunsubscribe: noop\n\t});\n\n\t// if the component that setup this is already unmounted we don't want to register a subscription\n\tif (entry.store !== store && !(IS_UNMOUNTED in stores)) {\n\t\tentry.unsubscribe();\n\t\tentry.store = store ?? null;\n\n\t\tif (store == null) {\n\t\t\tentry.source.v = undefined; // see synchronous callback comment below\n\t\t\tentry.unsubscribe = noop;\n\t\t} else {\n\t\t\tvar is_synchronous_callback = true;\n\n\t\t\tentry.unsubscribe = subscribe_to_store(store, (v) => {\n\t\t\t\tif (is_synchronous_callback) {\n\t\t\t\t\t// If the first updates to the store value (possibly multiple of them) are synchronously\n\t\t\t\t\t// inside a derived, we will hit the `state_unsafe_mutation` error if we `set` the value\n\t\t\t\t\tentry.source.v = v;\n\t\t\t\t} else {\n\t\t\t\t\tset(entry.source, v);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tis_synchronous_callback = false;\n\t\t}\n\t}\n\n\t// if the component that setup this stores is already unmounted the source will be out of sync\n\t// so we just use the `get` for the stores, less performant but it avoids to create a memory leak\n\t// and it will keep the value consistent\n\tif (store && IS_UNMOUNTED in stores) {\n\t\treturn get_store(store);\n\t}\n\n\treturn get(entry.source);\n}\n\n/**\n * Unsubscribe from a store if it's not the same as the one in the store references container.\n * We need this in addition to `store_get` because someone could unsubscribe from a store but\n * then never subscribe to the new one (if any), causing the subscription to stay open wrongfully.\n * @param {Store<any> | null | undefined} store\n * @param {string} store_name\n * @param {StoreReferencesContainer} stores\n */\nexport function store_unsub(store, store_name, stores) {\n\t/** @type {StoreReferencesContainer[''] | undefined} */\n\tlet entry = stores[store_name];\n\n\tif (entry && entry.store !== store) {\n\t\t// Don't reset store yet, so that store_get above can resubscribe to new store if necessary\n\t\tentry.unsubscribe();\n\t\tentry.unsubscribe = noop;\n\t}\n\n\treturn store;\n}\n\n/**\n * Sets the new value of a store and returns that value.\n * @template V\n * @param {Store<V>} store\n * @param {V} value\n * @returns {V}\n */\nexport function store_set(store, value) {\n\tstore.set(value);\n\treturn value;\n}\n\n/**\n * @param {StoreReferencesContainer} stores\n * @param {string} store_name\n */\nexport function invalidate_store(stores, store_name) {\n\tvar entry = stores[store_name];\n\tif (entry.store !== null) {\n\t\tstore_set(entry.store, entry.source.v);\n\t}\n}\n\n/**\n * Unsubscribes from all auto-subscribed stores on destroy\n * @returns {[StoreReferencesContainer, ()=>void]}\n */\nexport function setup_stores() {\n\t/** @type {StoreReferencesContainer} */\n\tconst stores = {};\n\n\tfunction cleanup() {\n\t\tteardown(() => {\n\t\t\tfor (var store_name in stores) {\n\t\t\t\tconst ref = stores[store_name];\n\t\t\t\tref.unsubscribe();\n\t\t\t}\n\t\t\tdefine_property(stores, IS_UNMOUNTED, {\n\t\t\t\tenumerable: false,\n\t\t\t\tvalue: true\n\t\t\t});\n\t\t});\n\t}\n\n\treturn [stores, cleanup];\n}\n\n/**\n * Updates a store with a new value.\n * @param {Store<V>} store  the store to update\n * @param {any} expression  the expression that mutates the store\n * @param {V} new_value  the new store value\n * @template V\n */\nexport function store_mutate(store, expression, new_value) {\n\tstore.set(new_value);\n\treturn expression;\n}\n\n/**\n * @param {Store<number>} store\n * @param {number} store_value\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_store(store, store_value, d = 1) {\n\tstore.set(store_value + d);\n\treturn store_value;\n}\n\n/**\n * @param {Store<number>} store\n * @param {number} store_value\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_pre_store(store, store_value, d = 1) {\n\tconst value = store_value + d;\n\tstore.set(value);\n\treturn value;\n}\n\n/**\n * Called inside prop getters to communicate that the prop is a store binding\n */\nexport function mark_store_binding() {\n\tis_store_binding = true;\n}\n\n/**\n * Returns a tuple that indicates whether `fn()` reads a prop that is a store binding.\n * Used to prevent `binding_property_non_reactive` validation false positives and\n * ensure that these props are treated as mutable even in runes mode\n * @template T\n * @param {() => T} fn\n * @returns {[T, boolean]}\n */\nexport function capture_store_binding(fn) {\n\tvar previous_is_store_binding = is_store_binding;\n\n\ttry {\n\t\tis_store_binding = false;\n\t\treturn [fn(), is_store_binding];\n\t} finally {\n\t\tis_store_binding = previous_is_store_binding;\n\t}\n}\n","/** @import { ComponentContext } from '#client' */\n/** @import { Derived, Effect, Source } from './types.js' */\nimport { DEV } from 'esm-env';\nimport {\n\tPROPS_IS_BINDABLE,\n\tPROPS_IS_IMMUTABLE,\n\tPROPS_IS_LAZY_INITIAL,\n\tPROPS_IS_RUNES,\n\tPROPS_IS_UPDATED,\n\tUNINITIALIZED\n} from '../../../constants.js';\nimport { get_descriptor, is_function } from '../../shared/utils.js';\nimport { set, source, update } from './sources.js';\nimport { derived, derived_safe_equal } from './deriveds.js';\nimport {\n\tactive_effect,\n\tget,\n\tis_destroying_effect,\n\tset_active_effect,\n\tuntrack\n} from '../runtime.js';\nimport * as e from '../errors.js';\nimport { DESTROYED, LEGACY_PROPS, STATE_SYMBOL } from '#client/constants';\nimport { proxy } from '../proxy.js';\nimport { capture_store_binding } from './store.js';\nimport { legacy_mode_flag } from '../../flags/index.js';\n\n/**\n * @param {((value?: number) => number)} fn\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_prop(fn, d = 1) {\n\tconst value = fn();\n\tfn(value + d);\n\treturn value;\n}\n\n/**\n * @param {((value?: number) => number)} fn\n * @param {1 | -1} [d]\n * @returns {number}\n */\nexport function update_pre_prop(fn, d = 1) {\n\tconst value = fn() + d;\n\tfn(value);\n\treturn value;\n}\n\n/**\n * The proxy handler for rest props (i.e. `const { x, ...rest } = $props()`).\n * Is passed the full `$$props` object and excludes the named props.\n * @type {ProxyHandler<{ props: Record<string | symbol, unknown>, exclude: Array<string | symbol>, name?: string }>}}\n */\nconst rest_props_handler = {\n\tget(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\treturn target.props[key];\n\t},\n\tset(target, key) {\n\t\tif (DEV) {\n\t\t\t// TODO should this happen in prod too?\n\t\t\te.props_rest_readonly(`${target.name}.${String(key)}`);\n\t\t}\n\n\t\treturn false;\n\t},\n\tgetOwnPropertyDescriptor(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\tif (key in target.props) {\n\t\t\treturn {\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: target.props[key]\n\t\t\t};\n\t\t}\n\t},\n\thas(target, key) {\n\t\tif (target.exclude.includes(key)) return false;\n\t\treturn key in target.props;\n\t},\n\townKeys(target) {\n\t\treturn Reflect.ownKeys(target.props).filter((key) => !target.exclude.includes(key));\n\t}\n};\n\n/**\n * @param {Record<string, unknown>} props\n * @param {string[]} exclude\n * @param {string} [name]\n * @returns {Record<string, unknown>}\n */\n/*#__NO_SIDE_EFFECTS__*/\nexport function rest_props(props, exclude, name) {\n\treturn new Proxy(\n\t\tDEV ? { props, exclude, name, other: {}, to_proxy: [] } : { props, exclude },\n\t\trest_props_handler\n\t);\n}\n\n/**\n * The proxy handler for legacy $$restProps and $$props\n * @type {ProxyHandler<{ props: Record<string | symbol, unknown>, exclude: Array<string | symbol>, special: Record<string | symbol, (v?: unknown) => unknown>, version: Source<number>, parent_effect: Effect }>}}\n */\nconst legacy_rest_props_handler = {\n\tget(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\tget(target.version);\n\t\treturn key in target.special ? target.special[key]() : target.props[key];\n\t},\n\tset(target, key, value) {\n\t\tif (!(key in target.special)) {\n\t\t\tvar previous_effect = active_effect;\n\n\t\t\ttry {\n\t\t\t\tset_active_effect(target.parent_effect);\n\n\t\t\t\t// Handle props that can temporarily get out of sync with the parent\n\t\t\t\t/** @type {Record<string, (v?: unknown) => unknown>} */\n\t\t\t\ttarget.special[key] = prop(\n\t\t\t\t\t{\n\t\t\t\t\t\tget [key]() {\n\t\t\t\t\t\t\treturn target.props[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t/** @type {string} */ (key),\n\t\t\t\t\tPROPS_IS_UPDATED\n\t\t\t\t);\n\t\t\t} finally {\n\t\t\t\tset_active_effect(previous_effect);\n\t\t\t}\n\t\t}\n\n\t\ttarget.special[key](value);\n\t\tupdate(target.version); // $$props is coarse-grained: when $$props.x is updated, usages of $$props.y etc are also rerun\n\t\treturn true;\n\t},\n\tgetOwnPropertyDescriptor(target, key) {\n\t\tif (target.exclude.includes(key)) return;\n\t\tif (key in target.props) {\n\t\t\treturn {\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: target.props[key]\n\t\t\t};\n\t\t}\n\t},\n\tdeleteProperty(target, key) {\n\t\t// Svelte 4 allowed for deletions on $$restProps\n\t\tif (target.exclude.includes(key)) return true;\n\t\ttarget.exclude.push(key);\n\t\tupdate(target.version);\n\t\treturn true;\n\t},\n\thas(target, key) {\n\t\tif (target.exclude.includes(key)) return false;\n\t\treturn key in target.props;\n\t},\n\townKeys(target) {\n\t\treturn Reflect.ownKeys(target.props).filter((key) => !target.exclude.includes(key));\n\t}\n};\n\n/**\n * @param {Record<string, unknown>} props\n * @param {string[]} exclude\n * @returns {Record<string, unknown>}\n */\nexport function legacy_rest_props(props, exclude) {\n\treturn new Proxy(\n\t\t{\n\t\t\tprops,\n\t\t\texclude,\n\t\t\tspecial: {},\n\t\t\tversion: source(0),\n\t\t\t// TODO this is only necessary because we need to track component\n\t\t\t// destruction inside `prop`, because of `bind:this`, but it\n\t\t\t// seems likely that we can simplify `bind:this` instead\n\t\t\tparent_effect: /** @type {Effect} */ (active_effect)\n\t\t},\n\t\tlegacy_rest_props_handler\n\t);\n}\n\n/**\n * The proxy handler for spread props. Handles the incoming array of props\n * that looks like `() => { dynamic: props }, { static: prop }, ..` and wraps\n * them so that the whole thing is passed to the component as the `$$props` argument.\n * @template {Record<string | symbol, unknown>} T\n * @type {ProxyHandler<{ props: Array<T | (() => T)> }>}}\n */\nconst spread_props_handler = {\n\tget(target, key) {\n\t\tlet i = target.props.length;\n\t\twhile (i--) {\n\t\t\tlet p = target.props[i];\n\t\t\tif (is_function(p)) p = p();\n\t\t\tif (typeof p === 'object' && p !== null && key in p) return p[key];\n\t\t}\n\t},\n\tset(target, key, value) {\n\t\tlet i = target.props.length;\n\t\twhile (i--) {\n\t\t\tlet p = target.props[i];\n\t\t\tif (is_function(p)) p = p();\n\t\t\tconst desc = get_descriptor(p, key);\n\t\t\tif (desc && desc.set) {\n\t\t\t\tdesc.set(value);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\tgetOwnPropertyDescriptor(target, key) {\n\t\tlet i = target.props.length;\n\t\twhile (i--) {\n\t\t\tlet p = target.props[i];\n\t\t\tif (is_function(p)) p = p();\n\t\t\tif (typeof p === 'object' && p !== null && key in p) {\n\t\t\t\tconst descriptor = get_descriptor(p, key);\n\t\t\t\tif (descriptor && !descriptor.configurable) {\n\t\t\t\t\t// Prevent a \"Non-configurability Report Error\": The target is an array, it does\n\t\t\t\t\t// not actually contain this property. If it is now described as non-configurable,\n\t\t\t\t\t// the proxy throws a validation error. Setting it to true avoids that.\n\t\t\t\t\tdescriptor.configurable = true;\n\t\t\t\t}\n\t\t\t\treturn descriptor;\n\t\t\t}\n\t\t}\n\t},\n\thas(target, key) {\n\t\t// To prevent a false positive `is_entry_props` in the `prop` function\n\t\tif (key === STATE_SYMBOL || key === LEGACY_PROPS) return false;\n\n\t\tfor (let p of target.props) {\n\t\t\tif (is_function(p)) p = p();\n\t\t\tif (p != null && key in p) return true;\n\t\t}\n\n\t\treturn false;\n\t},\n\townKeys(target) {\n\t\t/** @type {Array<string | symbol>} */\n\t\tconst keys = [];\n\n\t\tfor (let p of target.props) {\n\t\t\tif (is_function(p)) p = p();\n\t\t\tif (!p) continue;\n\n\t\t\tfor (const key in p) {\n\t\t\t\tif (!keys.includes(key)) keys.push(key);\n\t\t\t}\n\n\t\t\tfor (const key of Object.getOwnPropertySymbols(p)) {\n\t\t\t\tif (!keys.includes(key)) keys.push(key);\n\t\t\t}\n\t\t}\n\n\t\treturn keys;\n\t}\n};\n\n/**\n * @param {Array<Record<string, unknown> | (() => Record<string, unknown>)>} props\n * @returns {any}\n */\nexport function spread_props(...props) {\n\treturn new Proxy({ props }, spread_props_handler);\n}\n\n/**\n * This function is responsible for synchronizing a possibly bound prop with the inner component state.\n * It is used whenever the compiler sees that the component writes to the prop, or when it has a default prop_value.\n * @template V\n * @param {Record<string, unknown>} props\n * @param {string} key\n * @param {number} flags\n * @param {V | (() => V)} [fallback]\n * @returns {(() => V | ((arg: V) => V) | ((arg: V, mutation: boolean) => V))}\n */\nexport function prop(props, key, flags, fallback) {\n\tvar runes = !legacy_mode_flag || (flags & PROPS_IS_RUNES) !== 0;\n\tvar bindable = (flags & PROPS_IS_BINDABLE) !== 0;\n\tvar lazy = (flags & PROPS_IS_LAZY_INITIAL) !== 0;\n\n\tvar fallback_value = /** @type {V} */ (fallback);\n\tvar fallback_dirty = true;\n\n\tvar get_fallback = () => {\n\t\tif (fallback_dirty) {\n\t\t\tfallback_dirty = false;\n\n\t\t\tfallback_value = lazy\n\t\t\t\t? untrack(/** @type {() => V} */ (fallback))\n\t\t\t\t: /** @type {V} */ (fallback);\n\t\t}\n\n\t\treturn fallback_value;\n\t};\n\n\t/** @type {((v: V) => void) | undefined} */\n\tvar setter;\n\n\tif (bindable) {\n\t\t// Can be the case when someone does `mount(Component, props)` with `let props = $state({...})`\n\t\t// or `createClassComponent(Component, props)`\n\t\tvar is_entry_props = STATE_SYMBOL in props || LEGACY_PROPS in props;\n\n\t\tsetter =\n\t\t\tget_descriptor(props, key)?.set ??\n\t\t\t(is_entry_props && key in props ? (v) => (props[key] = v) : undefined);\n\t}\n\n\tvar initial_value;\n\tvar is_store_sub = false;\n\n\tif (bindable) {\n\t\t[initial_value, is_store_sub] = capture_store_binding(() => /** @type {V} */ (props[key]));\n\t} else {\n\t\tinitial_value = /** @type {V} */ (props[key]);\n\t}\n\n\tif (initial_value === undefined && fallback !== undefined) {\n\t\tinitial_value = get_fallback();\n\n\t\tif (setter) {\n\t\t\tif (runes) e.props_invalid_value(key);\n\t\t\tsetter(initial_value);\n\t\t}\n\t}\n\n\t/** @type {() => V} */\n\tvar getter;\n\n\tif (runes) {\n\t\tgetter = () => {\n\t\t\tvar value = /** @type {V} */ (props[key]);\n\t\t\tif (value === undefined) return get_fallback();\n\t\t\tfallback_dirty = true;\n\t\t\treturn value;\n\t\t};\n\t} else {\n\t\tgetter = () => {\n\t\t\tvar value = /** @type {V} */ (props[key]);\n\n\t\t\tif (value !== undefined) {\n\t\t\t\t// in legacy mode, we don't revert to the fallback value\n\t\t\t\t// if the prop goes from defined to undefined. The easiest\n\t\t\t\t// way to model this is to make the fallback undefined\n\t\t\t\t// as soon as the prop has a value\n\t\t\t\tfallback_value = /** @type {V} */ (undefined);\n\t\t\t}\n\n\t\t\treturn value === undefined ? fallback_value : value;\n\t\t};\n\t}\n\n\t// prop is never written to — we only need a getter\n\tif (runes && (flags & PROPS_IS_UPDATED) === 0) {\n\t\treturn getter;\n\t}\n\n\t// prop is written to, but the parent component had `bind:foo` which\n\t// means we can just call `$$props.foo = value` directly\n\tif (setter) {\n\t\tvar legacy_parent = props.$$legacy;\n\n\t\treturn function (/** @type {any} */ value, /** @type {boolean} */ mutation) {\n\t\t\tif (arguments.length > 0) {\n\t\t\t\t// We don't want to notify if the value was mutated and the parent is in runes mode.\n\t\t\t\t// In that case the state proxy (if it exists) should take care of the notification.\n\t\t\t\t// If the parent is not in runes mode, we need to notify on mutation, too, that the prop\n\t\t\t\t// has changed because the parent will not be able to detect the change otherwise.\n\t\t\t\tif (!runes || !mutation || legacy_parent || is_store_sub) {\n\t\t\t\t\t/** @type {Function} */ (setter)(mutation ? getter() : value);\n\t\t\t\t}\n\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\treturn getter();\n\t\t};\n\t}\n\n\t// Either prop is written to, but there's no binding, which means we\n\t// create a derived that we can write to locally.\n\t// Or we are in legacy mode where we always create a derived to replicate that\n\t// Svelte 4 did not trigger updates when a primitive value was updated to the same value.\n\tvar overridden = false;\n\n\tvar d = ((flags & PROPS_IS_IMMUTABLE) !== 0 ? derived : derived_safe_equal)(() => {\n\t\toverridden = false;\n\t\treturn getter();\n\t});\n\n\t// Capture the initial value if it's bindable\n\tif (bindable) get(d);\n\n\tvar parent_effect = /** @type {Effect} */ (active_effect);\n\n\treturn function (/** @type {any} */ value, /** @type {boolean} */ mutation) {\n\t\tif (arguments.length > 0) {\n\t\t\tconst new_value = mutation ? get(d) : runes && bindable ? proxy(value) : value;\n\n\t\t\tset(d, new_value);\n\t\t\toverridden = true;\n\n\t\t\tif (fallback_value !== undefined) {\n\t\t\t\tfallback_value = new_value;\n\t\t\t}\n\n\t\t\treturn value;\n\t\t}\n\n\t\t// special case — avoid recalculating the derived if we're in a\n\t\t// teardown function and the prop was overridden locally, or the\n\t\t// component was already destroyed (this latter part is necessary\n\t\t// because `bind:this` can read props after the component has\n\t\t// been destroyed. TODO simplify `bind:this`\n\t\tif ((is_destroying_effect && overridden) || (parent_effect.f & DESTROYED) !== 0) {\n\t\t\treturn d.v;\n\t\t}\n\n\t\treturn get(d);\n\t};\n}\n","/**\n * Create a lightweight debug function to log output into the browser console.\n *\n * Inspired by https://github.com/visionmedia/debug (some code is copied below)\n *\n * Usage:\n *\n *     import { createDebug } from './debug.js'\n *\n *     const debug = createDebug('my:namespace')\n *\n *     debug('testing:', 2 + 2)\n *\n * By default, logging is only enabled when a property DEBUG is set in the\n * localStorage of your browser:\n *\n *     localStorage['debug'] = '*'\n *     localStorage['debug'] = 'jsoneditor:*'\n *     localStorage['debug'] = 'jsoneditor:TreeMode'\n *\n * The actual value of 'debug' is used to filter the debug messages.\n * The value can end with a '*' wild card to match any remaining text.\n *\n * By providing a value for `enabled`, you can choose conditions to\n * enable/disable debugging if you want, for example some flag determining\n * whether in development or production.\n */\nexport function createDebug(\n  namespace: string,\n  enabled = enableDebug(namespace)\n): (...args: unknown[]) => void {\n  if (!enabled) {\n    return noop\n  }\n\n  const color = selectColor(namespace)\n\n  return function debug(...args) {\n    console.log(`%c${namespace}`, `color:${color}`, ...args)\n  }\n}\n\nfunction enableDebug(namespace: string) {\n  const debug = tryReadLocalStorage('debug')\n\n  return debug?.endsWith('*') ? namespace.startsWith(debug.slice(0, -1)) : namespace === debug\n}\n\nfunction noop() {\n  // no operation\n}\n\n/**\n * Try read a specific key from localStorage\n */\nfunction tryReadLocalStorage(key: string): string | undefined {\n  try {\n    if (typeof window !== 'undefined' && typeof window.localStorage !== 'undefined') {\n      // reading local storage can fail for example because of security restrictions\n      return window.localStorage[key]\n    }\n  } catch {\n    // we do nothing with the error, not needed in this specific case\n  }\n\n  return undefined\n}\n\n/**\n * Selects a color for a debug namespace\n *\n * Code is copied from the following source: https://github.com/visionmedia/debug\n *\n * @param namespace The namespace string for the debug instance to be colored\n * @return An ANSI color code for the given namespace\n */\nfunction selectColor(namespace: string): string {\n  let hash = 0\n\n  for (let i = 0; i < namespace.length; i++) {\n    hash = (hash << 5) - hash + namespace.charCodeAt(i)\n    hash |= 0 // Convert to 32bit integer\n  }\n\n  return colors[Math.abs(hash) % colors.length]\n}\n\nconst colors = [\n  '#0000CC',\n  '#0099FF',\n  '#009400',\n  '#8dd200',\n  '#CCCC00',\n  '#CC9933',\n  '#ae04e7',\n  '#ff35d7',\n  '#FF3333',\n  '#FF6600',\n  '#FF9933',\n  '#FFCC33'\n]\n","let id = 0\n\nexport function uniqueId(): number {\n  id++\n  return id\n}\n","export function int(value: string): number {\n  return parseInt(value, 10)\n}\n\nexport function isDigit(char: string): boolean {\n  return DIGIT_REGEX.test(char)\n}\n\nconst DIGIT_REGEX = /^[0-9]$/\n\n// TODO: unit test\nexport function containsNumber(value: string): boolean {\n  return NUMBER_REGEX.test(value)\n}\n\nconst NUMBER_REGEX = /^-?(?:0|[1-9]\\d*)(?:\\.\\d+)?(?:[eE][+-]?\\d+)?$/\n","// TODO: unit test typeUtils.js\n\nimport { containsNumber } from './numberUtils.js'\nimport type { JSONParser } from '../types.js'\n\n/**\n * Test whether a value is an Object (and not an Array or Class)\n */\nexport function isObject(value: unknown): value is Record<string, unknown> {\n  // note that we check constructor.name, not constructor === Object,\n  // so we can use objects created in a different JS realm like an iframe.\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    (value.constructor === undefined || value.constructor.name === 'Object')\n  )\n}\n\n/**\n * Test whether a value is an Object or an Array (and not a Class)\n */\nexport function isObjectOrArray(value: unknown): value is object | Array<unknown> {\n  // Note that we check constructor.name, not constructor === Object,\n  // so we can use objects created in a different JS realm like an iframe.\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    (value.constructor === undefined ||\n      value.constructor.name === 'Object' ||\n      value.constructor.name === 'Array')\n  )\n}\n\n/**\n * Test whether a value is a boolean\n *\n * @param {*} value\n * @return {boolean}\n */\nexport function isBoolean(value: unknown): value is boolean {\n  return value === true || value === false\n}\n\n/**\n * Test whether a value is a timestamp in milliseconds after the year 2000.\n */\nexport function isTimestamp(value: unknown): boolean {\n  const YEAR_2000 = 946684800000\n\n  if (typeof value === 'number') {\n    return (\n      value > YEAR_2000 &&\n      isFinite(value) &&\n      Math.floor(value) === value &&\n      !isNaN(new Date(value).valueOf())\n    )\n  }\n\n  if (typeof value === 'bigint') {\n    return isTimestamp(Number(value))\n  }\n\n  // try getting the primitive value if that is different. For example when having a LosslessNumber\n  try {\n    const valueOf = value ? value.valueOf() : value\n    if (valueOf !== value) {\n      return isTimestamp(valueOf)\n    }\n  } catch {\n    return false\n  }\n\n  return false\n}\n\n/**\n * Get the applied color given a color name or code\n * Returns the color if the input is a valid color, and returns null otherwise.\n *\n * Example output:\n *\n *     'rgba(255,0,0,0.7)' or 'rgb(255,0,0)'\n *\n * Source: https://stackoverflow.com/questions/6386090/validating-css-color-names/33184805\n */\nexport function getColorCSS(color: string): string | undefined {\n  colorTestDiv = colorTestDiv || window.document.createElement('div')\n\n  colorTestDiv.style.color = ''\n  colorTestDiv.style.color = color\n\n  const applied = colorTestDiv.style.color\n  return applied !== '' ? applied.replace(/\\s+/g, '').toLowerCase() : undefined\n}\nlet colorTestDiv: HTMLDivElement | undefined = undefined\n\n/**\n * Test if a string contains a valid color name or code.\n * Returns true if a valid color, false otherwise\n */\nexport function isColor(value: unknown): boolean {\n  const maxColorLength = 99\n  return typeof value === 'string' && value.length < maxColorLength && !!getColorCSS(value)\n}\n\n/**\n * Get the type of the value\n */\nexport function valueType(value: unknown, parser: JSONParser): string {\n  // primitive types\n  if (\n    typeof value === 'number' ||\n    typeof value === 'string' ||\n    typeof value === 'boolean' ||\n    typeof value === 'undefined'\n  ) {\n    return typeof value\n  }\n  if (typeof value === 'bigint') {\n    return 'number' // we return number here, not bigint: all numeric types should return the same name\n  }\n  if (value === null) {\n    return 'null'\n  }\n\n  if (Array.isArray(value)) {\n    return 'array'\n  }\n  if (isObject(value)) {\n    // plain object only\n    return 'object'\n  }\n\n  // unknown type (like a LosslessNumber). Try out what stringfying results in\n  const valueStr = parser.stringify(value)\n  if (valueStr && containsNumber(valueStr)) {\n    return 'number'\n  }\n  if (valueStr === 'true' || valueStr === 'false') {\n    return 'boolean'\n  }\n  if (valueStr === 'null') {\n    return 'null'\n  }\n\n  return 'unknown'\n}\n\n/**\n * Test whether a text contains a url (matches when a string starts\n * with 'http://*' or 'https://*' and has no whitespace characters)\n */\nconst isUrlRegex = /^https?:\\/\\/\\S+$/\nexport function isUrl(text: unknown): boolean {\n  return typeof text === 'string' && isUrlRegex.test(text)\n}\n\n/**\n * Convert contents of a string to the correct JSON type. This can be a string,\n * a number, a boolean, etc\n */\nexport function stringConvert(str: string, parser: JSONParser): unknown {\n  if (str === '') {\n    return ''\n  }\n\n  const strTrim = str.trim()\n\n  if (strTrim === 'null') {\n    return null\n  }\n\n  if (strTrim === 'true') {\n    return true\n  }\n\n  if (strTrim === 'false') {\n    return false\n  }\n\n  if (containsNumber(strTrim)) {\n    return parser.parse(strTrim)\n  }\n\n  return str\n}\n\n/**\n * Test whether a string contains a numeric, boolean, or null value.\n * Returns true when the string contains a number, boolean, or null.\n */\nexport function isStringContainingPrimitiveValue(str: unknown): boolean {\n  // note that we can safely use JSON parser here instead of the configured JSONParser,\n  // since we do not actually use the parsed number, just want to check that it is not a string\n  return typeof str === 'string' && typeof stringConvert(str, JSON) !== 'string'\n}\n\n/**\n * Test whether a string contains an integer number\n */\nexport function isInteger(value: string): boolean {\n  return INTEGER_REGEX.test(value)\n}\n\nconst INTEGER_REGEX = /^-?[0-9]+$/\n","import { isObject } from './typeUtils.js'\nimport type { JSONPath } from 'immutable-json-patch'\nimport { compileJSONPointer, parseJSONPointer } from 'immutable-json-patch'\nimport { isEqual } from 'lodash-es'\n\nconst MAX_ITEM_PATHS_COLLECTION = 10000\nconst ROOT_PATH: JSONPath = []\n\n/**\n * Comparator to sort an array in ascending order\n *\n * Usage:\n *     [4,2,5].sort(compareAsc)    // [2,4,5]\n */\nexport function compareAsc<T>(a: T, b: T): number {\n  return a > b ? 1 : a < b ? -1 : 0\n}\n\n/**\n * Comparator to sort an array in ascending order\n *\n * Usage:\n *     [4,2,5].sort(compareDesc)   // [5,4,2]\n */\nexport function compareDesc<T>(a: T, b: T): number {\n  return a > b ? -1 : a < b ? 1 : 0\n}\n\n/**\n * Test whether all items of an array are strictly equal\n */\nexport function strictShallowEqual<T>(a: Array<T>, b: Array<T>): boolean {\n  if (a.length !== b.length) {\n    return false\n  }\n\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n\nexport function compareArrays<T>(a: Array<T>, b: Array<T>): number {\n  const minLength = Math.min(a.length, b.length)\n\n  for (let i = 0; i < minLength; i++) {\n    if (a[i] < b[i]) {\n      return -1\n    }\n\n    if (a[i] > b[i]) {\n      return 1\n    }\n  }\n\n  return a.length - b.length\n}\n\n/**\n * Get the paths of all nested properties in the items of an array\n * @param array\n * @param includeObjects If true, object and array paths are returned as well\n */\nexport function getNestedPaths(array: unknown, includeObjects = false): JSONPath[] {\n  const pointersMap: Record<string, boolean> = {}\n\n  if (!Array.isArray(array)) {\n    throw new TypeError('Array expected')\n  }\n\n  function recurseNestedPaths(obj: unknown, path: JSONPath) {\n    const isValue = !Array.isArray(obj) && !isObject(obj)\n\n    if (isValue || (includeObjects && path.length > 0)) {\n      pointersMap[compileJSONPointer(path)] = true\n    }\n\n    if (isObject(obj)) {\n      Object.keys(obj).forEach((key) => {\n        recurseNestedPaths(obj[key], path.concat(key))\n      })\n    }\n  }\n\n  const max = Math.min(array.length, MAX_ITEM_PATHS_COLLECTION)\n  for (let i = 0; i < max; i++) {\n    const item = array[i]\n    recurseNestedPaths(item, ROOT_PATH)\n  }\n\n  const pathsArray = Object.keys(pointersMap).sort()\n\n  return pathsArray.map(parseJSONPointer)\n}\n\n/**\n * Invoke the callback with\n * @param start   Included start index\n * @param end       Excluded end index. End must be larger or equal to start\n * @param iteratee\n */\n// TODO: write tests\nexport function forEachIndex(start: number, end: number, iteratee: (index: number) => void) {\n  if (end <= start) {\n    return\n  }\n\n  for (let index = start; index < end; index++) {\n    iteratee(index)\n  }\n}\n\n/**\n * Limit the number of items in an array\n */\n// TODO: write unit test\nexport function limit<T>(array: Array<T>, max: number): Array<T> {\n  return array.length > max ? array.slice(0, max) : array\n}\n\n/**\n * Convert an array into an object having the array indices as keys\n */\nexport function arrayToObject<T>(array: Array<T>): Record<number, T> {\n  return {\n    ...array\n  }\n}\n\n/**\n * Get the values of an object as an array\n */\nexport function objectToArray<T>(object: Record<string, T>): Array<T> {\n  return Object.values(object)\n}\n\n/**\n * Test whether an array starts with a sub array\n */\nexport function arrayStartsWith<T>(\n  array: T[],\n  searchArray: T[],\n  equal: (a: T, b: T) => boolean = isEqual\n): boolean {\n  for (let i = 0; i < searchArray.length; i++) {\n    if (!equal(array[i], searchArray[i])) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Move a set of items inside an array\n */\nexport function moveItems<T>(array: T[], index: number, count: number, offset: number): T[] {\n  // TODO: check boundaries: index+offset >= 0, index+offset+count<array.length, index+count<array.length, etc\n  const copy = array.slice(0)\n  const moving: T[] = copy.splice(index, count)\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  copy.splice.apply(copy, [index + offset, 0, ...moving])\n  return copy\n}\n\n/**\n * Take samples out of a large array, equally spread from start till end\n */\nexport function forEachSample<T>(\n  array: T[],\n  maxSampleCount: number,\n  callback: (item: T, index: number, array: T[]) => void\n) {\n  if (array.length < maxSampleCount) {\n    array.forEach(callback)\n  } else {\n    const step = maxSampleCount > 1 ? (array.length - 1) / (maxSampleCount - 1) : array.length\n    for (let i = 0; i < maxSampleCount; i++) {\n      const index = Math.floor(i * step)\n      callback(array[index], index, array)\n    }\n  }\n}\n\nexport function insertItemsAt<T>(array: T[], index: number, items: T[]): T[] {\n  return array.slice(0, index).concat(items).concat(array.slice(index))\n}\n","import type { JSONPath } from 'immutable-json-patch'\nimport { compileJSONPointer } from 'immutable-json-patch'\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport jsonSourceMap from 'json-source-map'\nimport { jsonrepair } from 'jsonrepair'\nimport { isObject, isObjectOrArray, valueType } from './typeUtils.js'\nimport { arrayToObject, objectToArray } from './arrayUtils.js'\nimport type {\n  Content,\n  JSONContent,\n  JSONParser,\n  ParseError,\n  TextContent,\n  TextLocation\n} from '../types'\nimport { int } from './numberUtils.js'\n\n/**\n * Parse the JSON. if this fails, try to repair and parse.\n * Throws an exception when the JSON is invalid and could not be parsed.\n */\nexport function parseAndRepair(jsonText: string, parser: JSONParser): unknown {\n  try {\n    return parser.parse(jsonText)\n  } catch {\n    // this can also throw\n    return parser.parse(jsonrepair(jsonText))\n  }\n}\n\n/**\n * Parse the JSON and if needed repair it.\n * When not valid, undefined is returned.\n */\nexport function parseAndRepairOrUndefined(\n  partialJson: string,\n  parser: JSONParser\n): unknown | undefined {\n  try {\n    return parseAndRepair(partialJson, parser)\n  } catch {\n    return undefined\n  }\n}\n\n// TODO: deduplicate the logic in repairPartialJson and parseAndRepairPartialJson ?\nexport function parsePartialJson(partialJson: string, parse: (text: string) => unknown): unknown {\n  // for now: dumb brute force approach: simply try out a few things...\n\n  // remove trailing comma\n  partialJson = partialJson.replace(END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX, '')\n\n  try {\n    return parse(partialJson)\n  } catch {\n    // we ignore the error on purpose\n  }\n\n  try {\n    return parse('{' + partialJson + '}')\n  } catch {\n    // we ignore the error on purpose\n  }\n\n  try {\n    return parse('[' + partialJson + ']')\n  } catch {\n    // we ignore the error on purpose\n  }\n\n  throw new Error('Failed to parse partial JSON')\n}\n\n/**\n * Repair partial JSON\n */\nexport function repairPartialJson(partialJson: string): string {\n  // for now: dumb brute force approach: simply try out a few things...\n\n  // remove trailing comma\n  partialJson = partialJson.replace(END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX, '')\n\n  try {\n    return jsonrepair(partialJson)\n  } catch {\n    // we ignore the error on purpose\n  }\n\n  try {\n    const repaired = jsonrepair('[' + partialJson + ']')\n    return repaired.substring(1, repaired.length - 1) // remove the outer [...] again\n  } catch {\n    // we ignore the error on purpose\n  }\n\n  try {\n    const repaired = jsonrepair('{' + partialJson + '}')\n    return repaired.substring(1, repaired.length - 1) // remove the outer {...} again\n  } catch {\n    // we ignore the error on purpose\n  }\n\n  throw new Error('Failed to repair partial JSON')\n}\n\n// test whether a string ends with a comma, followed by zero or more white space characters\nconst END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX = /,\\s*$/\n\n/**\n * Normalize a parse error message like\n *     \"Unexpected token i in JSON at position 4\"\n * or\n *     \"JSON.parse: expected property name or '}' at line 2 column 3 of the JSON data\"\n * and return the line and column numbers in an object\n *\n * Note that the returned line and column number in the object are zero-based,\n * and in the message are one based (human-readable)\n */\nexport function normalizeJsonParseError(jsonText: string, parseErrorMessage: string): ParseError {\n  const positionMatch = POSITION_REGEX.exec(parseErrorMessage)\n\n  if (positionMatch) {\n    // a message from Chrome, like \"Unexpected token i in JSON at line 2 column 3\"\n    const position = int(positionMatch[2])\n\n    const line = countCharacterOccurrences(jsonText, '\\n', 0, position)\n    const lastIndex = jsonText.lastIndexOf('\\n', position)\n    const column = position - lastIndex - 1\n\n    return {\n      position,\n      line,\n      column,\n      message: parseErrorMessage.replace(POSITION_REGEX, () => {\n        return `line ${line + 1} column ${column + 1}`\n      })\n    }\n  } else {\n    // a message from Firefox, like \"JSON.parse: expected property name or '}' at line 2 column 3 of the JSON data\"\n    const lineMatch = LINE_REGEX.exec(parseErrorMessage)\n    const lineOneBased = lineMatch ? int(lineMatch[1]) : undefined\n    const line = lineOneBased !== undefined ? lineOneBased - 1 : undefined\n\n    const columnMatch = COLUMN_REGEX.exec(parseErrorMessage)\n    const columnOneBased = columnMatch ? int(columnMatch[1]) : undefined\n    const column = columnOneBased !== undefined ? columnOneBased - 1 : undefined\n\n    const position =\n      line !== undefined && column !== undefined\n        ? calculatePosition(jsonText, line, column)\n        : undefined\n\n    // line and column are one based in the message\n    return {\n      position,\n      line,\n      column,\n      message: parseErrorMessage.replace(/^JSON.parse: /, '').replace(/ of the JSON data$/, '')\n    }\n  }\n}\n\n/**\n * Calculate the position in the text based on a line and column number\n * @param text\n * @param line     Zero-based line number\n * @param column   Zero-based column number\n */\nexport function calculatePosition(text: string, line: number, column: number): number | undefined {\n  let index = text.indexOf('\\n')\n  let i = 1\n\n  while (i < line && index !== -1) {\n    index = text.indexOf('\\n', index + 1)\n    i++\n  }\n\n  return index !== -1\n    ? index + column + 1 // +1 for the return character itself\n    : undefined\n}\n\nexport function countCharacterOccurrences(\n  text: string,\n  character: string,\n  start = 0,\n  end = text.length\n) {\n  let count = 0\n\n  for (let i = start; i < end; i++) {\n    if (text.charAt(i) === character) {\n      count++\n    }\n  }\n\n  return count\n}\n\n/**\n * Find the text location of a JSON path\n */\n// TODO: write unit tests\nexport function findTextLocation(text: string, path: JSONPath): TextLocation {\n  try {\n    const jsmap = jsonSourceMap.parse(text)\n\n    const pointerName = compileJSONPointer(path)\n    const pointer = jsmap.pointers[pointerName]\n    if (pointer) {\n      return {\n        path,\n        line: pointer.key ? pointer.key.line : pointer.value ? pointer.value.line : 0,\n        column: pointer.key ? pointer.key.column : pointer.value ? pointer.value.column : 0,\n        from: pointer.key ? pointer.key.pos : pointer.value ? pointer.value.pos : 0,\n        to: pointer.keyEnd ? pointer.keyEnd.pos : pointer.valueEnd ? pointer.valueEnd.pos : 0\n      }\n    }\n  } catch (err) {\n    console.error(err)\n  }\n\n  return {\n    path,\n    line: 0,\n    column: 0,\n    from: 0,\n    to: 0\n  }\n}\n\n/**\n * Convert a JSON object, array, or value to another type\n * If it cannot be converted, an error is thrown\n */\nexport function convertValue(\n  value: unknown,\n  type: 'value' | 'object' | 'array',\n  parser: JSONParser\n): unknown {\n  // FIXME: improve the TypeScript here, there are a couple of conversions\n  if (type === 'array') {\n    if (Array.isArray(value)) {\n      // nothing to do\n      return value\n    }\n\n    if (isObject(value)) {\n      return objectToArray(value)\n    }\n\n    if (typeof value === 'string') {\n      try {\n        const parsedValue = parser.parse(value)\n\n        if (Array.isArray(parsedValue)) {\n          return parsedValue\n        }\n\n        if (isObject(parsedValue)) {\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          return objectToArray(parsedValue)\n        }\n      } catch {\n        //we could not parse the string, so we return the string as the first key of the array\n        return [value]\n      }\n    }\n\n    //all other cases, we return the value as the first key of the array, same as the parsing error under the string case\n    return [value]\n  }\n\n  if (type === 'object') {\n    if (Array.isArray(value)) {\n      return arrayToObject(value)\n    }\n\n    if (isObject(value)) {\n      // nothing to do\n      return value\n    }\n\n    if (typeof value === 'string') {\n      try {\n        const parsedValue = parser.parse(value)\n\n        if (isObject(parsedValue)) {\n          return parsedValue\n        }\n\n        if (Array.isArray(parsedValue)) {\n          return arrayToObject(parsedValue)\n        }\n      } catch {\n        //we could not parse the string, so we return the string as the first value of the object with key 'value'\n        return { value: value }\n      }\n    }\n\n    //all other cases, we return the value keyed under \"value\", same as the parsing error under the string case\n    return { value: value }\n  }\n\n  if (type === 'value') {\n    if (isObjectOrArray(value)) {\n      return parser.stringify(value)\n    }\n\n    // nothing to do\n    return value\n  }\n\n  throw new Error(`Cannot convert ${valueType(value, parser)} to ${type}`)\n}\n\n/**\n * Check whether provided value is valid a content type for JSONEditor\n * Returns a string with validation error message when there is an issue,\n * or null otherwise\n */\nexport function validateContentType(content: unknown): string | undefined {\n  if (!isObject(content)) {\n    return 'Content must be an object'\n  }\n\n  if (content.json !== undefined) {\n    if (content.text !== undefined) {\n      return 'Content must contain either a property \"json\" or a property \"text\" but not both'\n    } else {\n      return undefined\n    }\n  } else {\n    if (content.text === undefined) {\n      return 'Content must contain either a property \"json\" or a property \"text\"'\n    } else if (typeof content.text !== 'string') {\n      return (\n        'Content \"text\" property must be a string containing a JSON document. ' +\n        'Did you mean to use the \"json\" property instead?'\n      )\n    } else {\n      return undefined\n    }\n  }\n}\n\n/**\n * Check whether a value is Content (TextContent or JSONContent)\n */\nexport function isContent(content: unknown): content is Content {\n  return (\n    isObject(content) && (typeof content.json !== 'undefined' || typeof content.text === 'string')\n  )\n}\n\n/**\n * Check whether content contains text (and not JSON)\n */\nexport function isTextContent(content: unknown): content is TextContent {\n  return isObject(content) && typeof content.text === 'string'\n}\n\n/**\n * Check whether content contains json\n */\nexport function isJSONContent(content: unknown): content is JSONContent {\n  return isObject(content) && typeof content.json !== 'undefined'\n}\n\n/**\n * Convert Content into TextContent if it is JSONContent, else leave it as is\n */\nexport function toTextContent(\n  content: Content,\n  indentation: number | string | undefined = undefined,\n  parser: JSONParser = JSON\n): TextContent {\n  return isTextContent(content)\n    ? content\n    : { text: parser.stringify(content.json, null, indentation) as string }\n}\n\n/**\n * Convert Content into TextContent if it is JSONContent, else leave it as is\n * @throws {SyntaxError} Will throw a parse error when the text contents does not contain valid JSON\n */\nexport function toJSONContent(content: Content, parser: JSONParser = JSON): JSONContent {\n  return isJSONContent(content) ? content : { json: parser.parse(content.text) }\n}\n\n/**\n * Get the contents as Text. If the contents is JSON, the JSON will be parsed.\n */\nexport function getText(content: Content, indentation: number | string, parser: JSONParser) {\n  return toTextContent(content, indentation, parser).text\n}\n\n/**\n * Returns true when the (estimated) size of the contents exceeds the\n * provided maxSize.\n * @param content\n * @param maxSize  Maximum content size in bytes\n */\nexport function isLargeContent(content: Content, maxSize: number): boolean {\n  return estimateSerializedSize(content, maxSize) > maxSize\n}\n\n/**\n * A rough, fast estimation on whether a document is larger than given size\n * when serialized.\n *\n * maxSize is an optional max size in bytes. When reached, size estimation will\n * be cancelled. This is useful when you're only interested in knowing whether\n * the size exceeds a certain maximum size.\n */\nexport function estimateSerializedSize(content: Content, maxSize = Infinity): number {\n  if (isTextContent(content)) {\n    return content.text.length\n  }\n\n  const json = content.json\n\n  let estimatedSize = 0\n\n  function recurse(json: unknown) {\n    if (Array.isArray(json)) {\n      // open and close bracket, commas between items\n      estimatedSize += 2 + (json.length - 1)\n\n      if (estimatedSize > maxSize) {\n        return\n      }\n\n      for (let i = 0; i < json.length; i++) {\n        const item = json[i]\n\n        recurse(item)\n\n        if (estimatedSize > maxSize) {\n          return\n        }\n      }\n    } else if (isObject(json)) {\n      const keys = Object.keys(json)\n\n      // open and close brackets, separators between all keys and values, comma's between key/value pairs\n      estimatedSize += 2 + keys.length + (keys.length - 1)\n\n      for (let k = 0; k < keys.length; k++) {\n        const key = keys[k]\n        const value = json[key]\n\n        // key length and double quotes around it\n        estimatedSize += key.length + 2\n\n        recurse(value)\n      }\n    } else if (typeof json === 'string') {\n      estimatedSize += json.length + 2 // string length plus two for the double quote characters\n    } else {\n      // true, false, null, number\n      estimatedSize += String(json).length\n    }\n  }\n\n  recurse(json)\n\n  return estimatedSize\n}\n\nconst POSITION_REGEX = /(position|char) (\\d+)/\nconst LINE_REGEX = /line (\\d+)/\nconst COLUMN_REGEX = /column (\\d+)/\n\n/**\n * Check whether the actual functions of parse and stringify are strictly equal.\n * The object holding the functions may be a differing instance.\n */\nexport function isEqualParser(a: JSONParser, b: JSONParser): boolean {\n  return a.parse === b.parse && a.stringify === b.stringify\n}\n\n/**\n * Apply a fast and cheap heuristic to determine whether the content needs formatting (i.e. is compact).\n */\nexport function needsFormatting(jsonText: string): boolean {\n  const maxLength = 999\n  const head = jsonText.substring(0, maxLength).trim()\n  return !head.includes('\\n') && DELIMITER_WITHOUT_SPACING_REGEX.test(head)\n}\n\n// This regex matches cases of a comma or colon NOT followed by a whitespace\nconst DELIMITER_WITHOUT_SPACING_REGEX = /[,:]\\S/\n","import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\nimport type { Component, SvelteComponent } from 'svelte'\nimport type { IconDefinition } from '@fortawesome/free-solid-svg-icons'\nimport type { Action } from 'svelte/action'\n\nexport type TextContent = { text: string }\n\nexport type JSONContent = { json: unknown }\n\nexport type Content = JSONContent | TextContent\n\n// The `JSONParser` interface is compatible with `JSON`,\n// except that JSON.stringify is wrongly defined to return a string whilst it can return a string or undefined\n// see: https://stackoverflow.com/questions/74461780/is-the-official-type-definition-for-json-stringify-wrong\nexport interface JSONParser {\n  parse(\n    text: string,\n    reviver?: ((this: unknown, key: string, value: unknown) => unknown) | null\n  ): unknown\n\n  stringify(\n    value: unknown,\n    replacer?:\n      | ((this: unknown, key: string, value: unknown) => unknown)\n      | Array<number | string>\n      | null,\n    space?: string | number\n  ): string | undefined\n}\n\nexport interface JSONPathParser {\n  parse: (pathStr: string) => JSONPath\n  stringify: (path: JSONPath) => string\n}\n\nexport interface VisibleSection {\n  start: number\n  end: number\n}\n\nexport enum Mode {\n  text = 'text',\n  tree = 'tree',\n  table = 'table'\n}\n\nexport enum SelectionType {\n  after = 'after',\n  inside = 'inside',\n  key = 'key',\n  value = 'value',\n  multi = 'multi',\n  text = 'text' // in text mode\n}\n\nexport enum CaretType {\n  after = 'after',\n  key = 'key',\n  value = 'value',\n  inside = 'inside'\n}\n\nexport interface PathOption {\n  value: JSONPath\n  label: string\n}\n\nexport interface NumberOption {\n  value: 1 | -1\n  label: string\n}\n\nexport interface CaretPosition {\n  path: JSONPath\n  type: CaretType // TODO: refactor this to use SelectionType here, then we can simplify the util functions to turn this into a selection\n}\n\nexport interface ObjectRecursiveState {\n  type: 'object'\n  properties: Record<string, RecursiveState | undefined>\n}\n\nexport interface ArrayRecursiveState {\n  type: 'array'\n  items: Array<RecursiveState | undefined>\n}\n\nexport interface ValueRecursiveState {\n  type: 'value'\n}\n\nexport type RecursiveState = ObjectRecursiveState | ArrayRecursiveState | ValueRecursiveState\n\nexport interface RecursiveStateFactory {\n  createObjectDocumentState: () => ObjectRecursiveState\n  createArrayDocumentState: () => ArrayRecursiveState\n  createValueDocumentState: () => ValueRecursiveState\n}\n\nexport interface ObjectDocumentState extends ObjectRecursiveState {\n  type: 'object'\n  properties: Record<string, DocumentState | undefined>\n  expanded: boolean\n}\n\nexport interface ArrayDocumentState extends ArrayRecursiveState {\n  type: 'array'\n  items: Array<DocumentState | undefined>\n  expanded: boolean\n  visibleSections: VisibleSection[]\n}\n\nexport interface ValueDocumentState extends ValueRecursiveState {\n  type: 'value'\n  enforceString?: boolean\n}\n\nexport type DocumentState = ObjectDocumentState | ArrayDocumentState | ValueDocumentState\n\nexport interface ObjectSearchResults extends ObjectRecursiveState {\n  type: 'object'\n  properties: Record<string, SearchResults | undefined>\n  searchResults?: ExtendedSearchResultItem[]\n}\n\nexport interface ArraySearchResults extends ArrayRecursiveState {\n  type: 'array'\n  items: Array<SearchResults | undefined>\n  searchResults?: ExtendedSearchResultItem[]\n}\n\nexport interface ValueSearchResults extends ValueRecursiveState {\n  type: 'value'\n  searchResults?: ExtendedSearchResultItem[]\n}\n\nexport type SearchResults = ObjectSearchResults | ArraySearchResults | ValueSearchResults\n\nexport type WithSearchResults = SearchResults & {\n  searchResults: ExtendedSearchResultItem[]\n}\n\nexport interface ObjectValidationErrors extends ObjectRecursiveState {\n  type: 'object'\n  properties: Record<string, ValidationErrors | undefined>\n  validationError?: NestedValidationError\n}\n\nexport interface ArrayValidationErrors extends ArrayRecursiveState {\n  type: 'array'\n  items: Array<ValidationErrors | undefined>\n  validationError?: NestedValidationError\n}\n\nexport interface ValueValidationErrors extends ValueRecursiveState {\n  type: 'value'\n  validationError?: NestedValidationError\n}\n\nexport type ValidationErrors =\n  | ObjectValidationErrors\n  | ArrayValidationErrors\n  | ValueValidationErrors\n\nexport interface JSONPatchResult {\n  json: unknown\n  previousJson: unknown\n  undo: JSONPatchDocument\n  redo: JSONPatchDocument\n}\n\nexport type AfterPatchCallback = (\n  patchedJson: unknown,\n  patchedState: DocumentState | undefined,\n  patchedSelection: JSONSelection | undefined\n) =>\n  | {\n      json?: unknown\n      state?: DocumentState | undefined\n      selection?: JSONSelection | undefined\n      sortedColumn?: SortedColumn | undefined\n    }\n  | undefined\n\nexport interface MultiSelection {\n  type: SelectionType.multi\n  anchorPath: JSONPath\n  focusPath: JSONPath\n}\n\nexport interface AfterSelection {\n  type: SelectionType.after\n  path: JSONPath\n}\n\nexport interface InsideSelection {\n  type: SelectionType.inside\n  path: JSONPath\n}\n\nexport interface KeySelection {\n  type: SelectionType.key\n  path: JSONPath\n}\n\nexport interface EditKeySelection extends KeySelection {\n  type: SelectionType.key\n  path: JSONPath\n  edit: true\n  initialValue?: string\n}\n\nexport type ValueSelection = {\n  type: SelectionType.value\n  path: JSONPath\n}\n\nexport interface EditValueSelection extends ValueSelection {\n  type: SelectionType.value\n  path: JSONPath\n  edit: true\n  initialValue?: string\n}\n\nexport type JSONSelection =\n  | MultiSelection\n  | AfterSelection\n  | InsideSelection\n  | KeySelection\n  | EditKeySelection\n  | ValueSelection\n  | EditValueSelection\n\n// TextSelection is the result of EditorSelection.toJSON() from CodeMirror,\n// with an additional `type` property\nexport interface TextSelection {\n  type: SelectionType.text\n  ranges: { anchor: number; head: number }[]\n  main: number\n}\n\nexport type JSONEditorSelection = JSONSelection | TextSelection\n\nexport interface ScrollToOptions {\n  scrollToWhenVisible?: boolean\n  element?: Element\n}\n\nexport type ClipboardValues = Array<{ key: string; value: unknown }>\n\nexport interface MenuButton {\n  type: 'button'\n  onClick: (event: MouseEvent) => void\n  icon?: IconDefinition\n  text?: string\n  title?: string\n  className?: string\n  disabled?: boolean\n}\n\nexport interface MenuDropDownButton {\n  type: 'dropdown-button'\n  main: MenuButton\n  width?: string\n  items: MenuButton[]\n}\n\nexport interface MenuLabel {\n  type: 'label'\n  text: string\n}\n\nexport interface MenuSeparator {\n  type: 'separator'\n}\n\nexport interface MenuSpace {\n  type: 'space'\n}\n\nexport type MenuItem = MenuButton | MenuSeparator | MenuSpace\n\nexport interface ContextMenuColumn {\n  type: 'column'\n  items: Array<MenuButton | MenuDropDownButton | MenuLabel | MenuSeparator>\n}\nexport interface ContextMenuRow {\n  type: 'row'\n  items: Array<MenuButton | MenuDropDownButton | ContextMenuColumn>\n}\nexport type ContextMenuItem = MenuButton | MenuDropDownButton | MenuSeparator | ContextMenuRow\n\nexport interface MessageAction {\n  text: string\n  title: string\n  icon?: IconDefinition\n  onClick?: () => void\n  onMouseDown?: () => void\n  disabled?: boolean\n}\n\nexport enum ValidationSeverity {\n  info = 'info',\n  warning = 'warning',\n  error = 'error'\n}\n\nexport interface ValidationError {\n  path: JSONPath\n  message: string\n  severity: ValidationSeverity\n}\n\nexport interface NestedValidationError extends ValidationError {\n  isChildError?: boolean\n}\n\nexport type Validator = (json: unknown) => ValidationError[]\n\nexport interface ParseError {\n  position: number | undefined\n  line: number | undefined\n  column: number | undefined\n  message: string\n}\n\nexport interface ContentParseError {\n  parseError: ParseError\n  isRepairable: boolean\n}\n\nexport interface ContentValidationErrors {\n  validationErrors: ValidationError[]\n}\n\nexport type ContentErrors = ContentParseError | ContentValidationErrors\n\nexport interface RichValidationError extends ValidationError {\n  line: number | undefined\n  column: number | undefined\n  from: number | undefined\n  to: number | undefined\n  actions: Array<{ name: string; apply: () => void }> | undefined\n}\n\nexport interface TextLocation {\n  path: JSONPath\n  line: number\n  column: number\n  from: number\n  to: number\n}\n\nexport interface Section {\n  start: number // start included\n  end: number // end excluded\n}\n\nexport interface QueryLanguage {\n  id: string\n  name: string\n  description: string\n  createQuery: (json: unknown, queryOptions: QueryLanguageOptions) => string\n  executeQuery: (json: unknown, query: string, parser: JSONParser) => unknown\n}\n\nexport interface QueryLanguageOptions {\n  filter?: {\n    path?: JSONPath\n    relation?: '==' | '!=' | '<' | '<=' | '>' | '>='\n    value?: string\n  }\n  sort?: {\n    path?: JSONPath\n    direction?: 'asc' | 'desc'\n  }\n  projection?: {\n    paths?: JSONPath[]\n  }\n}\n\nexport type OnChangeQueryLanguage = (queryLanguageId: string) => void\nexport interface OnChangeStatus {\n  contentErrors: ContentErrors | undefined\n  patchResult: JSONPatchResult | undefined\n}\nexport type OnChange =\n  | ((content: Content, previousContent: Content, status: OnChangeStatus) => void)\n  | undefined\nexport type OnJSONSelect = (selection: JSONSelection) => void\nexport type OnSelect = (selection: JSONEditorSelection | undefined) => void\nexport type OnUndo = (item: HistoryItem | undefined) => void\nexport type OnRedo = (item: HistoryItem | undefined) => void\nexport type OnPatch = (\n  operations: JSONPatchDocument,\n  afterPatch?: AfterPatchCallback\n) => JSONPatchResult\nexport type OnChangeText = (updatedText: string, afterPatch?: AfterPatchCallback) => void\nexport type OnSort = (params: {\n  operations: JSONPatchDocument\n  rootPath: JSONPath\n  itemPath: JSONPath\n  direction: 1 | -1\n}) => void\nexport type OnFind = (findAndReplace: boolean) => void\nexport type OnPaste = (pastedText: string) => void\nexport type OnPasteJson = (pastedJson: PastedJson) => void\nexport type OnExpand = (relativePath: JSONPath) => boolean\nexport type OnRenderValue = (props: RenderValueProps) => RenderValueComponentDescription[]\nexport type OnClassName = (path: JSONPath, value: unknown) => string | undefined\nexport type OnChangeMode = (mode: Mode) => void\nexport type OnContextMenu = (contextMenuProps: AbsolutePopupOptions) => void\nexport type RenderMenuContext = {\n  mode: Mode\n  modal: boolean\n  readOnly: boolean\n}\nexport type OnRenderMenu = (items: MenuItem[], context: RenderMenuContext) => MenuItem[] | undefined\nexport type OnRenderMenuInternal = (items: MenuItem[]) => MenuItem[] | undefined\nexport type RenderContextMenuContext = RenderMenuContext & {\n  selection: JSONEditorSelection | undefined\n}\nexport type OnRenderContextMenu = (\n  items: ContextMenuItem[],\n  context: RenderContextMenuContext\n) => ContextMenuItem[] | false | undefined\nexport type OnRenderContextMenuInternal = (\n  items: ContextMenuItem[]\n) => ContextMenuItem[] | false | undefined\nexport type OnError = (error: Error) => void\nexport type OnFocus = () => void\nexport type OnBlur = () => void\nexport type OnSortModal = (props: SortModalCallback) => void\nexport type OnTransformModal = (props: TransformModalCallback) => void\nexport type OnJSONEditorModal = (props: JSONEditorModalCallback) => void\nexport type FindNextInside = (path: JSONPath) => JSONSelection | undefined\n\nexport interface SearchResultDetails {\n  items: ExtendedSearchResultItem[]\n  activeItem: ExtendedSearchResultItem | undefined\n  activeIndex: number | -1\n}\n\nexport enum SearchField {\n  key = 'key',\n  value = 'value'\n}\n\nexport interface SearchOptions {\n  maxResults?: number\n  columns?: JSONPath[]\n}\n\nexport interface SearchResultItem {\n  path: JSONPath\n  field: SearchField\n  fieldIndex: number\n  start: number\n  end: number\n}\n\nexport interface ExtendedSearchResultItem extends SearchResultItem {\n  resultIndex: number\n  active: boolean\n}\n\nexport type EscapeValue = (value: unknown) => string\n\nexport type UnescapeValue = (escapedValue: string) => string\n\nexport interface ValueNormalization {\n  escapeValue: EscapeValue\n  unescapeValue: UnescapeValue\n}\n\nexport type PastedJson = {\n  path: JSONPath\n  contents: unknown\n  onPasteAsJson: () => void\n}\n\nexport interface DragInsideProps {\n  json: unknown\n  selection: JSONSelection\n  deltaY: number\n  items: Array<{ path: JSONPath; height: number }>\n}\n\nexport type DragInsideAction =\n  | { beforePath: JSONPath; offset: number }\n  | { append: true; offset: number }\n\nexport interface RenderedItem {\n  path: JSONPath\n  height: number\n}\n\nexport interface TreeHistoryItem {\n  type: 'tree'\n  undo: {\n    patch: JSONPatchDocument | undefined\n    json: unknown | undefined\n    text: string | undefined\n    documentState: DocumentState | undefined\n    selection: JSONSelection | undefined\n    sortedColumn: SortedColumn | undefined\n    textIsRepaired: boolean\n  }\n  redo: {\n    patch: JSONPatchDocument | undefined\n    json: unknown | undefined\n    text: string | undefined\n    documentState: DocumentState | undefined\n    selection: JSONSelection | undefined\n    sortedColumn: SortedColumn | undefined\n    textIsRepaired: boolean\n  }\n}\n\nexport type TextChanges = Array<number | [number, ...string[]]>\n\nexport interface TextHistoryItem {\n  type: 'text'\n  undo: {\n    changes: TextChanges\n    selection: TextSelection\n  }\n  redo: {\n    changes: TextChanges\n    selection: TextSelection\n  }\n}\n\nexport interface ModeHistoryItem {\n  type: 'mode'\n  undo: {\n    mode: Mode\n    selection: undefined // selection can be restored used the corresponding sibling HistoryItem\n  }\n  redo: {\n    mode: Mode\n    selection: undefined // selection can be restored used the corresponding sibling HistoryItem\n  }\n}\n\nexport type HistoryItem = TreeHistoryItem | TextHistoryItem | ModeHistoryItem\n\nexport interface HistoryInstance<T> {\n  get: () => History<T>\n}\n\nexport interface History<T> {\n  canUndo: boolean\n  canRedo: boolean\n  items: () => T[]\n  add: (item: T) => void\n  clear: () => void\n  undo: () => T | undefined\n  redo: () => T | undefined\n}\n\nexport type ConvertType = 'value' | 'object' | 'array'\nexport type InsertType = ConvertType | 'structure'\n\nexport interface PopupEntry {\n  id: number\n  component: typeof SvelteComponent<Record<string, unknown>>\n  props: Record<string, unknown>\n  options: AbsolutePopupOptions\n}\n\nexport interface AbsolutePopupOptions {\n  anchor?: Element\n  position?: 'top' | 'left'\n  left?: number\n  top?: number\n  width?: number\n  height?: number\n  offsetTop?: number\n  offsetLeft?: number\n  showTip?: boolean\n  closeOnOuterClick?: boolean\n  onClose?: () => void\n}\n\nexport interface AbsolutePopupContext {\n  openAbsolutePopup: (\n    component: typeof SvelteComponent<Record<string, unknown>>,\n    props: Record<string, unknown>,\n    options: AbsolutePopupOptions\n  ) => number\n  closeAbsolutePopup: (popupId: number | undefined) => void\n}\n\nexport interface JSONEditorPropsOptional {\n  content?: Content\n  selection?: JSONEditorSelection\n  readOnly?: boolean\n  indentation?: number | string\n  tabSize?: number\n  truncateTextSize?: number\n  mode?: Mode\n  mainMenuBar?: boolean\n  navigationBar?: boolean\n  statusBar?: boolean\n  askToFormat?: boolean\n  escapeControlCharacters?: boolean\n  escapeUnicodeCharacters?: boolean\n  flattenColumns?: boolean\n  parser?: JSONParser\n  validator?: Validator | undefined\n  validationParser?: JSONParser\n  pathParser?: JSONPathParser\n\n  queryLanguages?: QueryLanguage[]\n  queryLanguageId?: string\n\n  onChangeQueryLanguage?: OnChangeQueryLanguage\n  onChange?: OnChange\n  onRenderValue?: OnRenderValue\n  onClassName?: OnClassName\n  onRenderMenu?: OnRenderMenu\n  onRenderContextMenu?: OnRenderContextMenu\n  onChangeMode?: OnChangeMode\n  onSelect?: OnSelect\n  onError?: OnError\n  onFocus?: OnFocus\n  onBlur?: OnBlur\n}\n\nexport interface JSONEditorModalProps {\n  content: Content\n  path: JSONPath\n  onPatch: OnPatch\n\n  readOnly: boolean\n  indentation: number | string\n  tabSize: number\n  truncateTextSize: number\n  mainMenuBar: boolean\n  navigationBar: boolean\n  statusBar: boolean\n  askToFormat: boolean\n  escapeControlCharacters: boolean\n  escapeUnicodeCharacters: boolean\n  flattenColumns: boolean\n  parser: JSONParser\n  validator: Validator | undefined\n  validationParser: JSONParser\n  pathParser: JSONPathParser\n\n  onRenderValue: OnRenderValue\n  onClassName: OnClassName\n  onRenderMenu: OnRenderMenu\n  onRenderContextMenu: OnRenderContextMenu\n  onSortModal: (props: SortModalCallback) => void\n  onTransformModal: (props: TransformModalCallback) => void\n  onClose: () => void\n}\n\nexport interface JSONEditorContext {\n  mode: Mode\n  readOnly: boolean\n  truncateTextSize: number\n  parser: JSONParser\n  normalization: ValueNormalization\n  getJson: () => unknown | undefined\n  getDocumentState: () => DocumentState | undefined\n  findElement: (path: JSONPath) => Element | undefined\n  findNextInside: FindNextInside\n  focus: () => void\n  onPatch: OnPatch\n  onSelect: OnJSONSelect\n  onFind: OnFind\n  onPasteJson: (newPastedJson: PastedJson) => void\n  onRenderValue: OnRenderValue\n}\n\nexport interface TreeModeContext extends JSONEditorContext {\n  getJson: () => unknown | undefined\n  getDocumentState: () => DocumentState | undefined\n  getSelection: () => JSONSelection | undefined\n  findElement: (path: JSONPath) => Element | undefined\n  onInsert: (type: InsertType) => void\n  onExpand: (path: JSONPath, expanded: boolean, recursive?: boolean) => void\n  onExpandSection: (path: JSONPath, section: Section) => void\n  onContextMenu: OnContextMenu\n  onClassName: OnClassName\n  onDrag: (event: MouseEvent) => void\n  onDragEnd: () => void\n}\n\nexport interface RenderValueProps extends Record<string, unknown> {\n  path: JSONPath\n  value: unknown\n  mode: Mode\n  truncateTextSize: number\n  readOnly: boolean\n  enforceString: boolean\n  selection: JSONSelection | undefined\n  searchResultItems: ExtendedSearchResultItem[] | undefined\n  isEditing: boolean\n  parser: JSONParser\n  normalization: ValueNormalization\n  onPatch: OnPatch\n  onPasteJson: OnPasteJson\n  onSelect: OnJSONSelect\n  onFind: OnFind\n  findNextInside: FindNextInside\n  focus: () => void\n}\n\nexport type RenderValuePropsOptional = Partial<RenderValueProps>\n\nexport interface DraggingState {\n  initialTarget: Element\n  initialClientY: number\n  initialContentTop: number\n  selectionStartIndex: number\n  selectionItemsCount: number\n  items: RenderedItem[]\n  offset: number\n  didMoveItems: boolean\n}\n\nexport type RenderValueComponentDescription = SvelteComponentRenderer | SvelteActionRenderer\n\nexport interface SvelteComponentRenderer {\n  component:\n    | typeof SvelteComponent<RenderValuePropsOptional> // Classic Svelte component\n    | Component<RenderValueProps> // Runes\n  props: RenderValueProps\n}\n\nexport interface SvelteActionRenderer {\n  action: Action<HTMLElement, Record<string, unknown>>\n  props: Record<string, unknown>\n}\n\nexport interface TransformModalOptions {\n  id?: string\n  rootPath?: JSONPath\n  onTransform?: (state: {\n    operations: JSONPatchDocument\n    json: unknown\n    transformedJson: unknown\n  }) => void\n  onClose?: () => void\n}\n\nexport interface TransformModalCallback {\n  id: string\n  json: unknown\n  rootPath: JSONPath\n  onTransform: (operations: JSONPatchDocument) => void\n  onClose: () => void\n}\n\nexport interface TransformModalProps extends TransformModalCallback {\n  id: string\n  json: unknown\n  rootPath: JSONPath\n  indentation: number | string\n  truncateTextSize: number\n  escapeControlCharacters: boolean\n  escapeUnicodeCharacters: boolean\n  parser: JSONParser\n  parseMemoizeOne: JSONParser['parse']\n  validationParser: JSONParser\n  pathParser: JSONPathParser\n\n  queryLanguages: QueryLanguage[]\n  queryLanguageId: string\n  onChangeQueryLanguage: OnChangeQueryLanguage\n\n  onRenderValue: OnRenderValue\n  onRenderMenu: OnRenderMenuInternal\n  onRenderContextMenu: OnRenderContextMenuInternal\n  onClassName: OnClassName\n\n  onTransform: (operations: JSONPatchDocument) => void\n  onClose: () => void\n}\n\nexport interface SortModalCallback {\n  id: string\n  json: unknown\n  rootPath: JSONPath\n  onSort: OnSort\n  onClose: () => void\n}\n\nexport interface JSONRepairModalProps {\n  text: string\n  onParse: (text: string) => void\n  onRepair: (text: string) => string\n  onApply: (repairedText: string) => void\n  onClose: () => void\n}\n\nexport interface JSONEditorModalCallback {\n  content: Content\n  path: JSONPath\n  onPatch: OnPatch\n  onClose: () => void\n}\n\nexport enum SortDirection {\n  asc = 'asc',\n  desc = 'desc'\n}\n\nexport enum UpdateSelectionAfterChange {\n  no = 'no',\n  self = 'self',\n  nextInside = 'nextInside'\n}\n\nexport interface TableCellIndex {\n  rowIndex: number\n  columnIndex: number\n}\n\nexport interface SortedColumn {\n  path: JSONPath\n  sortDirection: SortDirection\n}\n\n// TODO: work out the JSONSchema type in detail.\n//  Ideally, we use use Schema from Ajv, but this interface isn't worked out either\nexport type JSONSchema = Record<string, unknown>\nexport type JSONSchemaDefinitions = Record<string, JSONSchema>\nexport type JSONSchemaEnum = Array<unknown>\n","import type { ValueNormalization } from '$lib/types.js'\nimport { SelectionType } from '$lib/types.js'\nimport type { JSONPath } from 'immutable-json-patch'\nimport { compileJSONPointer, parseJSONPointer } from 'immutable-json-patch'\nimport { map, minBy } from 'lodash-es'\n\n/**\n * Create serialization functions to escape and stringify text,\n * and the other way around: to parse and unescape text.\n */\nexport function createNormalizationFunctions({\n  escapeControlCharacters,\n  escapeUnicodeCharacters\n}: {\n  escapeControlCharacters: boolean\n  escapeUnicodeCharacters: boolean\n}): ValueNormalization {\n  if (escapeControlCharacters) {\n    if (escapeUnicodeCharacters) {\n      return normalizeControlAndUnicode\n    } else {\n      return normalizeControl\n    }\n  } else {\n    if (escapeUnicodeCharacters) {\n      return normalizeUnicode\n    } else {\n      return normalizeNothing\n    }\n  }\n}\n\nconst normalizeControlAndUnicode = {\n  escapeValue: (value: unknown) => jsonEscapeUnicode(jsonEscapeControl(String(value))),\n  unescapeValue: (value: string) => jsonUnescapeControl(jsonUnescapeUnicode(value))\n}\n\nconst normalizeControl = {\n  escapeValue: (value: unknown) => jsonEscapeControl(String(value)),\n  unescapeValue: (value: string) => jsonUnescapeControl(value)\n}\n\nconst normalizeUnicode = {\n  escapeValue: (value: unknown) => jsonEscapeUnicode(String(value)),\n  unescapeValue: (value: string) => jsonUnescapeUnicode(value)\n}\n\nconst normalizeNothing = {\n  escapeValue: (value: unknown) => String(value),\n  unescapeValue: (value: string) => value\n}\n\n/**\n * Source:  https://stackoverflow.com/questions/12271547/shouldnt-json-stringify-escape-unicode-characters\n */\nexport function jsonEscapeUnicode(value: string): string {\n  return value.replace(/[^\\x20-\\x7F]/g, (x) => {\n    if (x === '\\b' || x === '\\f' || x === '\\n' || x === '\\r' || x === '\\t') {\n      return x\n    }\n\n    return '\\\\u' + ('000' + x.codePointAt(0)?.toString(16)).slice(-4)\n  })\n}\n\nexport function jsonUnescapeUnicode(value: string): string {\n  return value.replace(/\\\\u[a-fA-F0-9]{4}/g, (x) => {\n    try {\n      const unescaped: string = JSON.parse('\"' + x + '\"')\n      // the resolved character can be a control character like \" or \\n,\n      // that would result in invalid JSON, so we need to keep that escaped\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return controlCharacters[unescaped] || unescaped\n    } catch {\n      return x\n    }\n  })\n}\n\nconst controlCharacters = {\n  '\"': '\\\\\"',\n  '\\\\': '\\\\\\\\',\n  // escaped forward slash '\\/' is the same as '/', we can't escape/unescape it\n  '\\b': '\\\\b',\n  '\\f': '\\\\f',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\t': '\\\\t'\n  // unicode is handled separately\n}\n\nconst escapedControlCharacters = {\n  '\\\\\"': '\"',\n  '\\\\\\\\': '\\\\',\n  // escaped forward slash '\\/' is the same as '/', we can't escape/unescape it\n  '\\\\/': '/',\n  '\\\\b': '\\b',\n  '\\\\f': '\\f',\n  '\\\\n': '\\n',\n  '\\\\r': '\\r',\n  '\\\\t': '\\t'\n  // unicode is handled separately\n}\n\nexport function jsonEscapeControl(value: string): string {\n  return value.replace(/[\"\\b\\f\\n\\r\\t\\\\]/g, (x) => {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    return controlCharacters[x] || x\n  })\n}\n\nexport function jsonUnescapeControl(value: string): string {\n  return value.replace(/\\\\[\"bfnrt\\\\]/g, (x) => {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    return escapedControlCharacters[x] || x\n  })\n}\n\nexport function addNewLineSuffix(value: unknown): string {\n  if (typeof value !== 'string') {\n    return String(value)\n  }\n\n  if (value.endsWith('\\n')) {\n    // DOM innerText strips the last \\n, therefore we add an extra \\n here\n    return value + '\\n'\n  }\n\n  return value\n}\n\n/**\n * Remove a newline suffix from text returned by element.innerText, it adds\n * one return too much.\n */\nexport function removeNewLineSuffix(text: string): string {\n  return text.replace(/\\n$/, '')\n}\n\n// regular expression matching one or multiple return characters with all their\n// enclosing white spaces\nexport function removeReturnsAndSurroundingWhitespace(text: string): string {\n  return text.replace(/(\\b|^)\\s*(\\b|$)/g, (match) => {\n    return /\\n/.exec(match) ? '' : match\n  })\n}\n\nexport function isChildOfNodeName(element: Element, nodeName: string): boolean {\n  return isChildOf(element, (e) => e.nodeName.toUpperCase() === nodeName.toUpperCase())\n}\n\nexport function isChildOfAttribute(element: Element, name: string, value: string): boolean {\n  return isChildOf(element, (e) => hasAttribute(e, name, value))\n}\n\n// test whether a DOM element is a content editable div\nexport function isContentEditableDiv(element: HTMLElement): boolean {\n  return element.nodeName === 'DIV' && element.contentEditable === 'true'\n}\n\n// test whether a DOM element is an \"input\" with type \"text\"\nexport function isTextInput(element: HTMLInputElement): boolean {\n  return (\n    element.nodeName === 'INPUT' &&\n    element.type !== undefined &&\n    element.type.toLowerCase() === 'text'\n  )\n}\n\nfunction hasAttribute(element: Element, name: string, value: string): boolean {\n  return typeof element.getAttribute === 'function' && element.getAttribute(name) === value\n}\n\n/**\n * Test if the element or one of its parents has a certain predicate\n * Can be use for example to check whether the element or it's parent has\n * a specific attribute or nodeName.\n */\nexport function isChildOf(element: Element, predicate: (element: Element) => boolean): boolean {\n  return !!findParent(element, predicate)\n}\n\n/**\n * Test if the element or one of its parents has a certain predicate\n * Can be use for example to check whether the element or it's parent has\n * a specific attribute or nodeName.\n * @param {HTMLElement} element\n * @param {function (element: HTMLElement) : boolean} predicate\n * @returns {HTMLElement | undefined}\n */\nexport function findParent(\n  element: Element,\n  predicate: (element: Element) => boolean\n): Element | undefined {\n  let e: Element | undefined = element\n\n  while (e && !predicate(e)) {\n    e = e.parentNode as Element\n  }\n\n  return e\n}\n\n/**\n * Set the cursor to the end of a content editable div\n * Source: https://stackoverflow.com/questions/13513329/set-cursor-to-the-end-of-contenteditable-div\n * @param {HTMLElement} element\n */\nexport function setCursorToEnd(element: HTMLElement) {\n  if (element.firstChild == null) {\n    element.focus()\n    return\n  }\n\n  const range = document.createRange()\n  const selection = window.getSelection()\n  range.setStart(element, 1)\n  range.collapse(true)\n  selection?.removeAllRanges()\n  selection?.addRange(range)\n}\n\n/**\n * Gets a DOM element's Window.  This is normally just the global `window`\n * variable, but if we opened a child window, it may be different.\n */\nexport function getWindow(element: Element): Window | undefined {\n  return element?.ownerDocument?.defaultView ?? undefined\n}\n\nexport function activeElementIsChildOf(element: Element) {\n  const window = getWindow(element)\n  const activeElement = window?.document.activeElement\n  return activeElement ? isChildOf(activeElement, (e) => e === element) : false\n}\n\n/**\n * Traverse over the parents of the element until a node is found with the\n * searched for node name. If the element itself contains the nodeName, the\n * element itself will be returned\n */\nexport function findParentWithNodeName(element: Element, nodeName: string): Element | undefined {\n  return findParent(element, (e) => e.nodeName === nodeName)\n}\n\nexport function getSelectionTypeFromTarget(target: Element): SelectionType {\n  if (isChildOfAttribute(target, 'data-type', 'selectable-key')) {\n    return SelectionType.key\n  }\n\n  if (isChildOfAttribute(target, 'data-type', 'selectable-value')) {\n    return SelectionType.value\n  }\n\n  if (isChildOfAttribute(target, 'data-type', 'insert-selection-area-inside')) {\n    return SelectionType.inside\n  }\n\n  if (isChildOfAttribute(target, 'data-type', 'insert-selection-area-after')) {\n    return SelectionType.after\n  }\n\n  return SelectionType.multi\n}\n\n/**\n * Encode a path into a string that can be used as attribute in HTML\n */\nexport function encodeDataPath(path: JSONPath): string {\n  return encodeURIComponent(compileJSONPointer(path))\n}\n\n/**\n * Decode a path that was stringified for use as an HTML attribute\n */\nexport function decodeDataPath(pathStr: string): JSONPath {\n  return parseJSONPointer(decodeURIComponent(pathStr))\n}\n\n/**\n * Find the data path of the given element. Traverses the parent nodes until find\n */\nexport function getDataPathFromTarget(target: Element): JSONPath | undefined {\n  const parent = findParent(target, (element) => {\n    return element?.hasAttribute ? element.hasAttribute('data-path') : false\n  })\n\n  const dataPath = parent?.getAttribute('data-path') ?? undefined\n  return dataPath ? decodeDataPath(dataPath) : undefined\n}\n\n/**\n * Find the nearest element in a given context menu with buttons or inputs\n */\n// TODO: unit test\nexport function findNearestElement<T extends Element>({\n  allElements,\n  currentElement,\n  direction,\n  hasPrio = () => true,\n  margin = 10\n}: {\n  allElements: T[]\n  currentElement: T\n  direction: 'Up' | 'Down' | 'Left' | 'Right'\n  margin?: number\n  hasPrio?: (element: T) => boolean\n}): T | undefined {\n  const all = map(allElements.filter(isVisible), calculateCenter)\n  const current = calculateCenter(currentElement)\n\n  interface CenterLocation {\n    x: number\n    y: number\n    rect: DOMRect\n    element: T\n  }\n\n  function isVisible(element: T): boolean {\n    const rect = element.getBoundingClientRect()\n    return rect.width > 0 && rect.height > 0\n  }\n\n  function calculateCenter(element: T): CenterLocation {\n    const rect = element.getBoundingClientRect()\n    return {\n      x: rect.left + rect.width / 2,\n      y: rect.top + rect.height / 2,\n      rect,\n      element\n    }\n  }\n\n  const isOnSameRow = (a: CenterLocation, b: CenterLocation) => Math.abs(a.y - b.y) < margin\n  const isLeft = (a: CenterLocation, b: CenterLocation) => a.rect.left + margin < b.rect.left\n  const isRight = (a: CenterLocation, b: CenterLocation) => a.rect.right > b.rect.right + margin\n  const isAbove = (a: CenterLocation, b: CenterLocation) => a.y + margin < b.y\n  const isBelow = (a: CenterLocation, b: CenterLocation) => a.y > b.y + margin\n\n  function distance(a: CenterLocation, b: CenterLocation, weightY = 1): number {\n    const diffX = a.x - b.x\n    const diffY = (a.y - b.y) * weightY\n    return Math.sqrt(diffX * diffX + diffY * diffY)\n  }\n  const distanceToCurrent = (candidate: CenterLocation) => distance(candidate, current)\n  const distanceToCurrentWeighted = (candidate: CenterLocation) => distance(candidate, current, 10)\n\n  if (direction === 'Left' || direction === 'Right') {\n    // First we find the first button left from the current button on the same row\n    // if not found, search the closest button left/right from current button\n    const candidatesLeft =\n      direction === 'Left'\n        ? all.filter((button) => isLeft(button, current))\n        : all.filter((button) => isRight(button, current))\n    const candidatesLeftOnRow = candidatesLeft.filter((button) => isOnSameRow(button, current))\n    const nearest =\n      minBy(candidatesLeftOnRow, distanceToCurrent) ||\n      minBy(candidatesLeft, distanceToCurrentWeighted)\n\n    return nearest?.element\n  }\n\n  if (direction === 'Up' || direction === 'Down') {\n    // first we only search through the prio buttons\n    // if there were no matching prio buttons, search all matching buttons\n    const candidates =\n      direction === 'Up'\n        ? all.filter((button) => isAbove(button, current))\n        : all.filter((button) => isBelow(button, current))\n    const prioCandidates = candidates.filter((button) => hasPrio(button.element))\n    const nearest = minBy(prioCandidates, distanceToCurrent) || minBy(candidates, distanceToCurrent)\n\n    return nearest?.element\n  }\n\n  return undefined\n}\n","declare global {\n  // extend with the userAgentData: NavigatorUAData property (currently experimental)\n  // see https://developer.mozilla.org/en-US/docs/Web/API/Navigator/userAgentData\n  interface Navigator {\n    userAgentData?: {\n      platform: string\n    }\n  }\n}\n\nexport function isMacDevice() {\n  return (\n    typeof navigator !== 'undefined' &&\n    (navigator?.platform?.toUpperCase().includes('MAC') ??\n      navigator?.userAgentData?.platform?.toUpperCase().includes('MAC') ??\n      false)\n  )\n}\n","// inspiration: https://github.com/andrepolischuk/keycomb\n\nimport { isMacDevice } from './navigatorUtils.js'\n\n// KeyComboEvent is a subset of KeyboardEvent\nexport interface KeyComboEvent {\n  ctrlKey: boolean\n  metaKey: boolean\n  altKey: boolean\n  shiftKey: boolean\n  key: string\n}\n\n/**\n * Get the active key combination from a keyboard event.\n * For example returns \"Ctrl+Shift+ArrowUp\" or \"Ctrl+A\"\n *\n * Returns the same output on both Windows and Mac:\n * meta keys \"Ctrl\" (\"Command\" on Mac), and \"Alt\" (\"Alt\" or \"Option\" on Mac)\n * So pressing \"Command\" and \"A\"on Mac will return \"Ctrl+A\"\n */\nexport function keyComboFromEvent(\n  event: KeyComboEvent,\n  separator = '+',\n  isMac = isMacDevice\n): string {\n  const combi = []\n\n  if (isCtrlKeyDown(event, isMac)) {\n    // on Mac this is called Command or Cmd\n    combi.push('Ctrl')\n  }\n  if (event.altKey) {\n    // on Mac this is called Option\n    combi.push('Alt')\n  }\n  if (event.shiftKey) {\n    combi.push('Shift')\n  }\n\n  const keyName = event.key.length === 1 ? event.key.toUpperCase() : event.key\n  if (!(keyName in metaKeys)) {\n    // prevent output like 'Ctrl+Ctrl'\n    combi.push(keyName)\n  }\n\n  return combi.join(separator)\n}\n\n/**\n * Test whether the Ctrl key (windows, linux) or Command key (mac) is down\n */\nexport function isCtrlKeyDown(\n  event: { ctrlKey: boolean; metaKey: boolean },\n  isMac = isMacDevice\n): boolean {\n  // metaKey is the Command key ⌘ on a Mac (but the Windows Key ⊞ on Windows)\n  return event.ctrlKey || (event.metaKey && isMac())\n}\n\nconst metaKeys = {\n  Ctrl: true,\n  Command: true,\n  Control: true,\n  Alt: true,\n  Option: true,\n  Shift: true\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","<script lang=\"ts\">\n  import type { AbsolutePopupOptions, PopupEntry } from '$lib/types.js'\n  import { onMount } from 'svelte'\n  import { isChildOf } from '$lib/utils/domUtils.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n\n  export let popup: PopupEntry\n  export let closeAbsolutePopup: (popupId: number) => void\n\n  let refRootPopup: HTMLDivElement\n  let refHiddenInput: HTMLInputElement\n\n  onMount(focus)\n\n  function closeWhenOutside(event: Event) {\n    if (\n      popup.options &&\n      popup.options.closeOnOuterClick &&\n      !isChildOf(event.target as HTMLElement, (e) => e === refRootPopup)\n    ) {\n      closeAbsolutePopup(popup.id)\n    }\n  }\n\n  function handleWindowMouseDown(event: Event) {\n    closeWhenOutside(event)\n  }\n\n  function handleMouseDownInside(event: Event) {\n    event.stopPropagation()\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    if (combo === 'Escape') {\n      event.preventDefault()\n      event.stopPropagation()\n      closeAbsolutePopup(popup.id)\n    }\n  }\n\n  function handleScrollWheel(event: Event) {\n    closeWhenOutside(event)\n  }\n\n  function calculateStyle(refRootPopup: HTMLDivElement, options: AbsolutePopupOptions) {\n    function calculatePosition() {\n      if (options.anchor) {\n        const { anchor, width = 0, height = 0, offsetTop = 0, offsetLeft = 0, position } = options\n        const { left, top, bottom, right } = anchor.getBoundingClientRect()\n\n        const positionAbove =\n          position === 'top' || (top + height > window.innerHeight && top > height)\n        const positionLeft =\n          position === 'left' || (left + width > window.innerWidth && left > width)\n\n        return {\n          left: positionLeft ? right - offsetLeft : left + offsetLeft,\n          top: positionAbove ? top - offsetTop : bottom + offsetTop,\n          positionAbove,\n          positionLeft\n        }\n      } else if (typeof options.left === 'number' && typeof options.top === 'number') {\n        const { left, top, width = 0, height = 0 } = options\n\n        const positionAbove = top + height > window.innerHeight && top > height\n        const positionLeft = left + width > window.innerWidth && left > width\n\n        return {\n          left,\n          top,\n          positionAbove,\n          positionLeft\n        }\n      } else {\n        throw new Error('Invalid config: pass either \"left\" and \"top\", or pass \"anchor\"')\n      }\n    }\n\n    const rootRect = refRootPopup.getBoundingClientRect()\n    const { left, top, positionAbove, positionLeft } = calculatePosition()\n\n    const verticalStyling = positionAbove\n      ? `bottom: ${rootRect.top - top}px;`\n      : `top: ${top - rootRect.top}px;`\n\n    const horizontalStyling = positionLeft\n      ? `right: ${rootRect.left - left}px;`\n      : `left: ${left - rootRect.left}px;`\n\n    return verticalStyling + horizontalStyling\n  }\n\n  function focus() {\n    if (refHiddenInput) {\n      refHiddenInput.focus()\n    }\n  }\n</script>\n\n<svelte:window\n  on:mousedown|capture={handleWindowMouseDown}\n  on:keydown|capture={handleKeyDown}\n  on:wheel|capture={handleScrollWheel}\n/>\n\n<div\n  role=\"none\"\n  bind:this={refRootPopup}\n  class=\"jse-absolute-popup\"\n  on:mousedown={handleMouseDownInside}\n  on:keydown={handleKeyDown}\n>\n  {#if refRootPopup}\n    <div class=\"jse-absolute-popup-content\" style={calculateStyle(refRootPopup, popup.options)}>\n      <input\n        type=\"text\"\n        readonly\n        tabindex=\"-1\"\n        class=\"jse-hidden-input\"\n        bind:this={refHiddenInput}\n      />\n      <svelte:component this={popup.component} {...popup.props} />\n    </div>\n  {/if}\n</div>\n\n<style src=\"./AbsolutePopupEntry.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { createDebug } from '$lib/utils/debug.js'\n  import { setContext, type SvelteComponent } from 'svelte'\n  import type { AbsolutePopupOptions, PopupEntry, AbsolutePopupContext } from '$lib/types'\n  import { uniqueId } from '$lib/utils/uniqueId.js'\n  import AbsolutePopupEntry from './AbsolutePopupEntry.svelte'\n\n  const debug = createDebug('jsoneditor:AbsolutePopup')\n\n  let popups: PopupEntry[] = []\n\n  function openAbsolutePopup(\n    component: typeof SvelteComponent<Record<string, unknown>>,\n    props: Record<string, unknown>,\n    options: AbsolutePopupOptions\n  ): number {\n    debug('open...', props, options)\n\n    const popup: PopupEntry = {\n      id: uniqueId(),\n      component: component,\n      props: props || {},\n      options: options || {}\n    }\n\n    popups = [...popups, popup]\n\n    return popup.id\n  }\n\n  function closeAbsolutePopup(popupId: number | undefined) {\n    const popupIndex = popups.findIndex((popup) => popup.id === popupId)\n\n    if (popupIndex !== -1) {\n      const popup = popups[popupIndex]\n      if (popup.options.onClose) {\n        popup.options.onClose()\n      }\n\n      popups = popups.filter((popup) => popup.id !== popupId)\n    }\n  }\n\n  $: debug('popups', popups)\n\n  setContext<AbsolutePopupContext>('absolute-popup', { openAbsolutePopup, closeAbsolutePopup })\n</script>\n\n{#each popups as popup}\n  <AbsolutePopupEntry {popup} {closeAbsolutePopup} />\n{/each}\n\n<slot />\n","/**\n * Find a unique name. Suffix the name with ' (copy)', '(copy 2)', etc\n * until a unique name is found\n * @param name    Proposed name\n * @param keys    Array with existing keys\n */\nexport function findUniqueName(name: string, keys: string[]): string {\n  const keysSet = new Set(keys)\n\n  // remove any \" (copy)\" or \" (copy 2)\" suffix from the name\n  const nameWithoutCopySuffix = name.replace(/ \\(copy( \\d+)?\\)$/, '')\n\n  let validName = name\n  let i = 1\n\n  while (keysSet.has(validName)) {\n    const copy = 'copy' + (i > 1 ? ' ' + i : '')\n    validName = `${nameWithoutCopySuffix} (${copy})`\n    i++\n  }\n\n  return validName\n}\n\n/**\n * Transform a text into lower case with the first character upper case\n */\nexport function toCapital(text: string): string {\n  return text && text.length > 0 ? text[0].toUpperCase() + text.substring(1).toLowerCase() : text\n}\n\nexport function compareStrings(a: string, b: string): -1 | 0 | 1 {\n  return a < b ? -1 : a > b ? 1 : 0\n}\n\n/**\n * Duplicate a piece of text\n */\nexport function duplicateInText(text: string, anchorOffset: number, focusOffset: number): string {\n  const startOffset = Math.min(anchorOffset, focusOffset)\n  const endOffset = Math.max(anchorOffset, focusOffset)\n\n  return (\n    text.slice(0, endOffset) +\n    text.slice(startOffset, endOffset) + // the duplicated piece of the text\n    text.slice(endOffset)\n  )\n}\n\n/**\n * Truncate a text to a maximum length.\n * When truncated, the text will pe appended with ellipsis '...'\n * @param text Text to be truncated\n * @param maxLength Maximum allowed length for the text including ellipsis\n */\nexport function truncate(text: string, maxLength: number): string {\n  const ellipsis = '...'\n  const maxTextLength = maxLength - ellipsis.length\n\n  return text.length > maxLength ? text.substring(0, maxTextLength) + ellipsis : text\n}\n\n/**\n * Cast contents of a string to the correct type.\n * This can be a string, a number, a boolean, null, undefined, etc\n * @param str\n * @return parsed string\n */\nexport function parseString(str: string): string | number | boolean | null | undefined {\n  if (str === '') {\n    return ''\n  }\n\n  const lower = str.toLowerCase()\n  if (lower === 'null') {\n    return null\n  }\n  if (lower === 'true') {\n    return true\n  }\n  if (lower === 'false') {\n    return false\n  }\n  if (lower === 'undefined') {\n    return undefined\n  }\n\n  const num = Number(str) // will nicely fail with '123ab'\n  const numFloat = parseFloat(str) // will nicely fail with '  '\n  if (!isNaN(num) && !isNaN(numFloat)) {\n    return num\n  }\n\n  return str\n}\n","import { jsonquery, type JSONQuery, parse, stringify } from '@jsonquerylang/jsonquery'\nimport { parseString } from '$lib/utils/stringUtils.js'\nimport type { JSONParser, QueryLanguage, QueryLanguageOptions } from '$lib/types.js'\nimport type { JSONPath } from 'immutable-json-patch'\nimport { isEqualParser } from '$lib/utils/jsonUtils'\n\nconst description = `\n<p>\n  Enter a <a href=\"https://jsonquerylang.org\" target=\"_blank\" \n  rel=\"noopener noreferrer\">JSON Query</a> function to filter, sort, or transform the data.\n  You can use functions like <code>get</code>, <code>filter</code>,\n  <code>sort</code>, <code>pick</code>, <code>groupBy</code>, <code>uniq</code>, etcetera. \n  Example query: <code>filter(.age >= 18)</code>\n</p>\n`\n\nexport const jsonQueryLanguage: QueryLanguage = {\n  id: 'jsonquery',\n  name: 'JSONQuery',\n  description,\n  createQuery,\n  executeQuery\n}\n\nfunction createQuery(_json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { filter, sort, projection } = queryOptions\n  const queryFunctions: JSONQuery[] = []\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    queryFunctions.push([\n      'filter',\n      [\n        getOperatorName(filter.relation),\n        getter(filter.path),\n        parseString(filter.value) as JSONQuery\n      ]\n    ])\n  }\n\n  if (sort && sort.path && sort.direction) {\n    queryFunctions.push(['sort', getter(sort.path), sort.direction === 'desc' ? 'desc' : 'asc'])\n  }\n\n  if (projection && projection.paths) {\n    if (projection.paths.length > 1) {\n      queryFunctions.push(['pick', ...projection.paths.map(getter)])\n    } else {\n      queryFunctions.push(['map', getter(projection.paths[0])])\n    }\n  }\n\n  return stringify(['pipe', ...queryFunctions])\n}\n\nfunction getter(path: JSONPath): ['get', ...path: JSONPath] {\n  return ['get', ...path]\n}\n\nfunction executeQuery(json: unknown, query: string, parser: JSONParser): unknown {\n  function stringifyAndParse(json: unknown) {\n    const text = parser.stringify(json)\n    return text !== undefined ? JSON.parse(text) : undefined\n  }\n\n  const preprocessedJson = isEqualParser(parser, JSON) ? json : stringifyAndParse(json)\n\n  return query.trim() !== '' ? jsonquery(preprocessedJson, query) : preprocessedJson\n}\n\nfunction getOperatorName(operator: string): string {\n  // a trick to get the name of the operator by parsing the operator in a temporary query\n  return (parse(`1 ${operator} 1`) as [string, number, number])[0]\n}\n","<g>\n  {@html raw}\n</g>\n\n<script lang=\"ts\">\n  import type { IconData } from '../Icon.svelte';\n\n  let cursor = 0xd4937;\n  function getId() {\n    cursor += 1;\n    return `fa-${cursor.toString(16)}`;\n  }\n\n  let raw = '';\n\n  export let data: IconData;\n\n  function getRaw(data: IconData) {\n    if (!data || !data.raw) {\n      return '';\n    }\n    let rawData = data.raw;\n    const ids: Record<string, string> = {};\n    rawData = rawData.replace(/\\s(?:xml:)?id=[\"']?([^\"')\\s]+)/g, (match, id) => {\n      const uniqueId = getId();\n      ids[id] = uniqueId;\n      return ` id=\"${uniqueId}\"`;\n    });\n\n    rawData = rawData.replace(\n      /#(?:([^'\")\\s]+)|xpointer\\(id\\((['\"]?)([^')]+)\\2\\)\\))/g,\n      (match, rawId, _, pointerId) => {\n        const id = rawId || pointerId;\n        if (!id || !ids[id]) {\n          return match;\n        }\n        return `#${ids[id]}`;\n      }\n    );\n    return rawData;\n  }\n\n  $: raw = getRaw(data);\n</script>\n","<Svg\n  {label}\n  {width}\n  {height}\n  {box}\n  style={combinedStyle}\n  {spin}\n  {flip}\n  {inverse}\n  {pulse}\n  class={className}\n  {...$$restProps}\n>\n  <slot>\n    {#each iconData?.paths || [] as path}\n      <path {...path} />\n    {/each}\n    {#each iconData?.polygons || [] as polygon}\n      <polygon {...polygon} />\n    {/each}\n    {#if iconData?.raw}\n      <Raw bind:data={iconData} />\n    {/if}\n  </slot>\n</Svg>\n\n<script context=\"module\" lang=\"ts\">\n  export interface FaIconDefinition {\n    prefix: string;\n    iconName: string;\n    icon: [\n      number, // width\n      number, // height\n      string[], // ligatures\n      string, // unicode\n      string | string[] // svgPathData\n    ];\n  }\n\n  export interface IconPath {\n    id?: string;\n    d: string;\n    style?: string;\n    stroke?: string;\n  }\n\n  export interface IconPolygon {\n    points: string;\n    style?: string;\n  }\n\n  export interface IconData {\n    width: number;\n    height: number;\n    paths?: IconPath[];\n    polygons?: IconPolygon[];\n    raw?: string;\n  }\n\n  export type IconType = Record<string, IconData> | FaIconDefinition;\n</script>\n\n<script lang=\"ts\">\n  import Raw from './svg/Raw.svelte';\n  import Svg from './svg/Svg.svelte';\n\n  let className = '';\n\n  export let data: IconType;\n  let iconData: IconData | undefined;\n  export let scale = 1;\n  export let spin = false;\n  export let inverse = false;\n  export let pulse = false;\n  export let flip: 'horizontal' | 'vertical' | undefined = undefined;\n  export let label: string = '';\n  export let style: string = '';\n  export { className as class };\n\n  // internal\n  let childrenHeight = 0;\n  let childrenWidth = 0;\n  let outerScale = 1;\n\n  let width: number = 10;\n  let height: number = 10;\n  let combinedStyle: string;\n  let box: string;\n\n  function normaliseData(data: IconType): IconData | undefined {\n    let name: string;\n    let iconData: IconData;\n    if (!data) {\n      return undefined;\n    } else if ('definition' in data) {\n      console.error(\n        \"`import faIconName from '@fortawesome/package-name/faIconName` not supported - Please use `import { faIconName } from '@fortawesome/package-name/faIconName'` instead\"\n      );\n      return undefined;\n    } else if ('iconName' in data && 'icon' in data) {\n      name = data.iconName as string;\n      // fontawesome v5/6 icon imported with:\n      // import { iconName } from '@fortawesome/packagename/iconName';\n      // import { iconName } from '@fortawesome/packagename';\n      const [width, height, , , path] = data.icon as Exclude<IconType['icon'], IconData>;\n      const paths = Array.isArray(path) ? path : [path];\n      iconData = {\n        width,\n        height,\n        paths: paths.map((path) => {\n          return { d: path };\n        })\n      };\n    } else {\n      // inbuilt icons\n      name = Object.keys(data)[0];\n      iconData = data[name];\n    }\n    return iconData;\n  }\n\n  function normalisedScale() {\n    let numScale = 1;\n    if (typeof scale !== 'undefined') {\n      numScale = Number(scale);\n    }\n    if (isNaN(numScale) || numScale <= 0) {\n      console.warn('Invalid prop: prop \"scale\" should be a number over 0.');\n      return outerScale;\n    }\n    return numScale * outerScale;\n  }\n\n  function calculateBox() {\n    if (iconData) {\n      return `0 0 ${iconData.width} ${iconData.height}`;\n    }\n    return `0 0 ${width} ${height}`;\n  }\n\n  function calculateRatio() {\n    if (!iconData) {\n      return 1;\n    }\n    return Math.max(iconData.width, iconData.height) / 16;\n  }\n\n  function calculateWidth() {\n    if (childrenWidth) {\n      return childrenWidth;\n    }\n    if (iconData) {\n      return (iconData.width / calculateRatio()) * normalisedScale();\n    }\n    return 0;\n  }\n\n  function calculateHeight() {\n    if (childrenHeight) {\n      return childrenHeight;\n    }\n    if (iconData) {\n      return (iconData.height / calculateRatio()) * normalisedScale();\n    }\n    return 0;\n  }\n\n  function calculateStyle() {\n    let combined = '';\n    if (style !== null) {\n      combined += style;\n    }\n    let size = normalisedScale();\n    if (size === 1) {\n      if (combined.length === 0) {\n        return '';\n      }\n      return combined;\n    }\n    if (combined !== '' && !combined.endsWith(';')) {\n      combined += '; ';\n    }\n    return `${combined}font-size: ${size}em`;\n  }\n\n  $: {\n    iconData = normaliseData(data);\n    style;\n    scale;\n    width = calculateWidth();\n    height = calculateHeight();\n    combinedStyle = calculateStyle();\n    box = calculateBox();\n  }\n</script>\n\n<svelte:options namespace=\"svg\" />\n","<svg\n  version=\"1.1\"\n  class=\"fa-icon {className}\"\n  class:fa-spin={spin}\n  class:fa-pulse={pulse}\n  class:fa-inverse={inverse}\n  class:fa-flip-horizontal={flip === 'horizontal'}\n  class:fa-flip-vertical={flip === 'vertical'}\n  {width}\n  {height}\n  aria-label={label}\n  role={label ? 'img' : 'presentation'}\n  viewBox={box}\n  {style}\n  {...$$restProps}\n>\n  <slot />\n</svg>\n\n<style>\n  .fa-icon {\n    display: inline-block;\n    fill: currentColor;\n  }\n  .fa-flip-horizontal {\n    transform: scale(-1, 1);\n  }\n  .fa-flip-vertical {\n    transform: scale(1, -1);\n  }\n  .fa-spin {\n    animation: fa-spin 1s 0s infinite linear;\n  }\n  .fa-inverse {\n    color: #fff;\n  }\n  .fa-pulse {\n    animation: fa-spin 1s infinite steps(8);\n  }\n  @keyframes fa-spin {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n</style>\n\n<script lang=\"ts\">\n  let className: string = '';\n\n  export { className as class };\n\n  export let width: number;\n  export let height: number;\n  export let box: string = '0 0 0 0';\n\n  export let spin = false;\n  export let inverse = false;\n  export let pulse = false;\n  export let flip: string = 'none';\n\n  // optionals\n  export let style: string = '';\n  export let label: string = '';\n</script>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { faCheckSquare, faSquare } from '@fortawesome/free-regular-svg-icons'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import Icon from 'svelte-awesome'\n  import type { OnPatch } from '$lib/types.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let readOnly: boolean\n  export let onPatch: OnPatch\n  export let focus: () => void\n\n  function toggleBooleanValue(event: MouseEvent) {\n    event.stopPropagation()\n\n    if (readOnly) {\n      return\n    }\n\n    onPatch([\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: !value\n      }\n    ])\n\n    focus()\n  }\n</script>\n\n<div\n  role=\"checkbox\"\n  tabindex=\"-1\"\n  aria-checked={value === true}\n  class=\"jse-boolean-toggle\"\n  class:jse-readonly={readOnly}\n  on:mousedown={toggleBooleanValue}\n  title={!readOnly ? 'Click to toggle this boolean value' : `Boolean value ${value}`}\n>\n  <Icon data={value === true ? faCheckSquare : faSquare} />\n</div>\n\n<style src=\"./BooleanToggle.scss\"></style>\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n\n  export let color: string\n  export let onChange: (newColor: string) => void\n  export let showOnTop: boolean\n\n  let ref: HTMLElement | undefined\n  let destroyColorPicker = () => {}\n\n  onMount(async () => {\n    // Dynamically import VanillaPicker, because it requires `document` to be defined,\n    // and that is not supported server side\n    const VanillaPicker = (await import('vanilla-picker'))?.default\n\n    const colorPicker = new VanillaPicker({\n      parent: ref,\n      color,\n      popup: showOnTop ? 'top' : 'bottom',\n      onDone: function (color) {\n        const alpha = color.rgba[3]\n        const hex =\n          alpha === 1\n            ? color.hex.substring(0, 7) // return #RRGGBB\n            : color.hex // return #RRGGBBAA\n        onChange(hex)\n      }\n    })\n\n    colorPicker.show()\n\n    destroyColorPicker = () => {\n      colorPicker.destroy()\n    }\n  })\n\n  onDestroy(() => {\n    destroyColorPicker()\n  })\n</script>\n\n<div class=\"jse-color-picker-popup\" bind:this={ref}></div>\n\n<style src=\"./ColorPickerPopup.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getColorCSS } from '$lib/utils/typeUtils.js'\n  import { getWindow } from '$lib/utils/domUtils.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import { getContext } from 'svelte'\n  import ColorPickerPopup from '../../../components/controls/ColorPickerPopup.svelte'\n  import type { AbsolutePopupContext, OnPatch } from '$lib/types.js'\n\n  const { openAbsolutePopup } = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let path: JSONPath\n  export let value: string\n  export let readOnly: boolean\n  export let onPatch: OnPatch\n  export let focus: () => void\n\n  $: color = getColorCSS(value)\n  $: title = !readOnly ? 'Click to open a color picker' : `Color ${value}`\n\n  function onChange(color: string) {\n    onPatch([\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: color\n      }\n    ])\n\n    onClose()\n  }\n\n  function onClose() {\n    focus()\n  }\n\n  function openColorPicker(event: MouseEvent) {\n    if (readOnly) {\n      return\n    }\n\n    // estimate of the color picker height\n    // we'll render the color picker on top\n    // when there is not enough space below, and there is enough space above\n    const height = 300\n\n    const target = event.target as Element\n    const top = target.getBoundingClientRect().top\n    const windowHeight = getWindow(target)?.innerHeight ?? 0\n    const showOnTop = windowHeight - top < height && top > height\n\n    const props = {\n      color: value,\n      onChange,\n      showOnTop\n    }\n\n    openAbsolutePopup(ColorPickerPopup, props, {\n      anchor: target,\n      closeOnOuterClick: true,\n      onClose,\n      offsetTop: 18,\n      offsetLeft: -8,\n      height\n    })\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-color-picker-button\"\n  class:jse-readonly={readOnly}\n  style=\"background: {color}\"\n  {title}\n  aria-label={title}\n  on:click={openColorPicker}\n></button>\n\n<style src=\"./ColorPicker.scss\"></style>\n","import type { Section } from './types'\nimport { SortDirection } from './types.js'\n\nexport const SCROLL_DURATION = 300 // ms\nexport const DEBOUNCE_DELAY = 300 // ms\nexport const TEXT_MODE_ONCHANGE_DELAY = 300 // ms\nexport const AUTO_SCROLL_INTERVAL = 50 // ms\nexport const AUTO_SCROLL_SPEED_SLOW = 200 // pixels per second\nexport const AUTO_SCROLL_SPEED_NORMAL = 400 // pixels per second\nexport const AUTO_SCROLL_SPEED_FAST = 1200 // pixels per second\nexport const MAX_SEARCH_RESULTS = 1000\nexport const ARRAY_SECTION_SIZE = 100\nexport const MAX_VALIDATION_ERRORS = 100\nexport const MAX_CHARACTERS_TEXT_PREVIEW = 20000\nexport const MAX_INLINE_OBJECT_CHARS = 50\nexport const MAX_HEADER_NAME_CHARACTERS = 50\nexport const DEFAULT_VISIBLE_SECTIONS: Section[] = [{ start: 0, end: ARRAY_SECTION_SIZE }]\nexport const MAX_VALIDATABLE_SIZE = 100 * 1024 * 1024 // 1 MB\nexport const MAX_AUTO_REPAIRABLE_SIZE = 1024 * 1024 // 1 MB\nexport const MAX_MULTILINE_PASTE_SIZE = 1024 * 1024 // 1 MB\nexport const MAX_DOCUMENT_SIZE_TEXT_MODE = 10 * 1024 * 1024 // 10 MB\nexport const MAX_DOCUMENT_SIZE_EXPAND_ALL = 10 * 1024 // 10 KB\n\nexport const INSERT_EXPLANATION =\n  'Insert or paste contents, ' +\n  'enter [ insert a new array, ' +\n  'enter { to insert a new object, ' +\n  'or start typing to insert a new value'\n\nexport const CONTEXT_MENU_EXPLANATION =\n  'Open context menu ' +\n  '(Click here, ' +\n  'right click on the selection, ' +\n  'or use the context menu button or Ctrl+Q)'\n\nexport const HOVER_INSERT_INSIDE = 'hover-insert-inside'\nexport const HOVER_INSERT_AFTER = 'hover-insert-after'\nexport const HOVER_COLLECTION = 'hover-collection'\n\nexport const JSON_STATUS_VALID = 'valid'\nexport const JSON_STATUS_REPAIRABLE = 'repairable'\nexport const JSON_STATUS_INVALID = 'invalid'\n\n// TODO: can we dynamically calculate the size?\nexport const CONTEXT_MENU_HEIGHT = (40 + 2) * 8 // px\nexport const CONTEXT_MENU_WIDTH = 260 // px\nexport const SEARCH_BOX_HEIGHT = 100 // px for search and replace\n\nexport const SORT_DIRECTION_NAMES = {\n  [SortDirection.asc]: 'ascending',\n  [SortDirection.desc]: 'descending'\n}\n","import { sortBy } from 'lodash-es'\nimport { ARRAY_SECTION_SIZE } from '../constants.js'\nimport type { Section } from '$lib/types.js'\n\n/**\n * Create sections that can be expanded.\n * Used to display a button like \"Show items 100-200\"\n */\nexport function getExpandItemsSections(startIndex: number, endIndex: number): Section[] {\n  // expand the start of the section\n  const section1 = {\n    start: startIndex,\n    end: Math.min(nextRoundNumber(startIndex), endIndex)\n  }\n\n  // expand the middle of the section\n  const start2 = Math.max(currentRoundNumber((startIndex + endIndex) / 2), startIndex)\n  const section2 = {\n    start: start2,\n    end: Math.min(nextRoundNumber(start2), endIndex)\n  }\n\n  // expand the end of the section\n  const currentIndex = currentRoundNumber(endIndex)\n  const previousIndex = currentIndex === endIndex ? currentIndex - ARRAY_SECTION_SIZE : currentIndex\n  const section3 = {\n    start: Math.max(previousIndex, startIndex),\n    end: endIndex\n  }\n\n  const sections = [section1]\n\n  const showSection2 = section2.start >= section1.end && section2.end <= section3.start\n  if (showSection2) {\n    sections.push(section2)\n  }\n\n  const showSection3 = section3.start >= (showSection2 ? section2.end : section1.end)\n  if (showSection3) {\n    sections.push(section3)\n  }\n\n  return sections\n}\n\n/**\n * Sort and merge a list with sections\n */\nexport function mergeSections(sections: Section[]): Section[] {\n  const sortedSections = sortBy(sections, (section) => section.start)\n\n  const mergedSections = [sortedSections[0]]\n\n  for (let sortedIndex = 0; sortedIndex < sortedSections.length; sortedIndex++) {\n    const mergedIndex = mergedSections.length - 1\n    const previous = mergedSections[mergedIndex]\n    const current = sortedSections[sortedIndex]\n\n    if (current.start <= previous.end) {\n      // there is overlap -> replace the previous item\n      mergedSections[mergedIndex] = {\n        start: Math.min(previous.start, current.start),\n        end: Math.max(previous.end, current.end)\n      }\n    } else {\n      // no overlap, just add the item\n      mergedSections.push(current)\n    }\n  }\n\n  return mergedSections\n}\n\n// TODO: write unit test\nexport function inVisibleSection(sections: Section[], index: number): boolean {\n  return sections.some((section) => {\n    return index >= section.start && index < section.end\n  })\n}\n\nexport function nextRoundNumber(index: number): number {\n  return currentRoundNumber(index) + ARRAY_SECTION_SIZE\n}\n\nexport function currentRoundNumber(index: number): number {\n  return Math.floor(index / ARRAY_SECTION_SIZE) * ARRAY_SECTION_SIZE\n}\n","import type {\n  ContentParseError,\n  ContentValidationErrors,\n  ContextMenuColumn,\n  ContextMenuRow,\n  MenuButton,\n  MenuDropDownButton,\n  MenuLabel,\n  MenuSeparator,\n  MenuSpace,\n  ValidationError,\n  NestedValidationError,\n  SvelteActionRenderer,\n  SvelteComponentRenderer,\n  RecursiveState,\n  ArrayRecursiveState,\n  ObjectRecursiveState,\n  ValueRecursiveState,\n  SearchResults,\n  WithSearchResults,\n  TreeHistoryItem,\n  HistoryItem,\n  TextHistoryItem,\n  ModeHistoryItem\n} from './types.js'\nimport { isObject } from '$lib/utils/typeUtils.js'\n\nexport function isMenuSpace(item: unknown): item is MenuSpace {\n  // checking the .space property is for backward compatibility\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'space' || item['space'] === true : false\n}\n\nexport function isMenuSeparator(item: unknown): item is MenuSeparator {\n  // checking the .separator property is for backward compatibility\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'separator' || item['separator'] === true : false\n}\n\nexport function isMenuLabel(item: unknown): item is MenuLabel {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'label' && typeof item['text'] === 'string' : false\n}\n\nexport function isMenuButton(item: unknown): item is MenuButton {\n  // for backward compatibility, we only check .onClick here and not item['type'] === 'button'\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? typeof item['onClick'] === 'function' : false\n}\n\nexport function isMenuDropDownButton(item: unknown): item is MenuDropDownButton {\n  return item\n    ? // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      item['type'] === 'dropdown-button' &&\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        isMenuButton(item['main']) &&\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        Array.isArray(item['items'])\n    : false\n}\n\nexport function isContextMenuRow(item: unknown): item is ContextMenuRow {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'row' && Array.isArray(item['items']) : false\n}\n\nexport function isContextMenuColumn(item: unknown): item is ContextMenuColumn {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return item ? item['type'] === 'column' && Array.isArray(item['items']) : false\n}\n\nexport function isContentParseError(contentErrors: unknown): contentErrors is ContentParseError {\n  return isObject(contentErrors) && isObject(contentErrors['parseError'])\n}\n\nexport function isContentValidationErrors(\n  contentErrors: unknown\n): contentErrors is ContentValidationErrors {\n  return isObject(contentErrors) && Array.isArray(contentErrors['validationErrors'])\n}\n\nexport function isValidationError(value: unknown): value is ValidationError {\n  return (\n    isObject(value) &&\n    Array.isArray(value.path) &&\n    typeof value.message === 'string' &&\n    'severity' in value\n  )\n}\n\nexport function isNestedValidationError(value: unknown): value is NestedValidationError {\n  return isObject(value) && isValidationError(value) && typeof value.isChildError === 'boolean'\n}\n\nexport function isSvelteComponentRenderer(value: unknown): value is SvelteComponentRenderer {\n  return isObject(value) && 'component' in value && isObject(value.props)\n}\n\nexport function isSvelteActionRenderer(value: unknown): value is SvelteActionRenderer {\n  return isObject(value) && typeof value.action === 'function' && isObject(value.props)\n}\n\nexport function isObjectRecursiveState(\n  state: RecursiveState | undefined\n): state is ObjectRecursiveState {\n  return state !== undefined && state.type === 'object'\n}\n\nexport function isArrayRecursiveState(\n  state: RecursiveState | undefined\n): state is ArrayRecursiveState {\n  return state !== undefined && state.type === 'array'\n}\n\nexport function isValueRecursiveState(\n  state: RecursiveState | undefined\n): state is ValueRecursiveState {\n  return state !== undefined && state.type === 'value'\n}\n\nexport function isExpandableState(\n  state: RecursiveState | undefined\n): state is ObjectRecursiveState | ArrayRecursiveState {\n  return isObjectRecursiveState(state) || isArrayRecursiveState(state)\n}\n\nexport function hasSearchResults(state: SearchResults | undefined): state is WithSearchResults {\n  return (\n    state !== undefined &&\n    Array.isArray((state as unknown as Record<string, unknown>).searchResults)\n  )\n}\n\nexport function isTreeHistoryItem(\n  historyItem: HistoryItem | undefined\n): historyItem is TreeHistoryItem {\n  return historyItem ? historyItem.type === 'tree' : false\n}\n\nexport function isTextHistoryItem(\n  historyItem: HistoryItem | undefined\n): historyItem is TextHistoryItem {\n  return historyItem ? historyItem.type === 'text' : false\n}\n\nexport function isModeHistoryItem(\n  historyItem: HistoryItem | undefined\n): historyItem is ModeHistoryItem {\n  return historyItem ? historyItem.type === 'mode' : false\n}\n","import {\n  compileJSONPointer,\n  deleteIn,\n  existsIn,\n  getIn,\n  immutableJSONPatch,\n  isJSONArray,\n  isJSONObject,\n  isJSONPatchAdd,\n  isJSONPatchCopy,\n  isJSONPatchMove,\n  isJSONPatchRemove,\n  isJSONPatchReplace,\n  type JSONPatchAdd,\n  type JSONPatchCopy,\n  type JSONPatchDocument,\n  type JSONPatchMove,\n  type JSONPatchOperation,\n  type JSONPatchRemove,\n  type JSONPath,\n  parsePath,\n  setIn,\n  updateIn\n} from 'immutable-json-patch'\nimport { initial, last } from 'lodash-es'\nimport { DEFAULT_VISIBLE_SECTIONS, MAX_DOCUMENT_SIZE_EXPAND_ALL } from '../constants.js'\nimport { forEachIndex, insertItemsAt, strictShallowEqual } from '../utils/arrayUtils.js'\nimport { isObject, isStringContainingPrimitiveValue } from '../utils/typeUtils.js'\nimport {\n  currentRoundNumber,\n  inVisibleSection,\n  mergeSections,\n  nextRoundNumber\n} from './expandItemsSections.js'\nimport type {\n  ArrayDocumentState,\n  CaretPosition,\n  DocumentState,\n  ObjectDocumentState,\n  OnExpand,\n  ArrayRecursiveState,\n  RecursiveState,\n  RecursiveStateFactory,\n  Section,\n  ValueDocumentState,\n  VisibleSection\n} from '$lib/types'\nimport { CaretType } from '$lib/types.js'\nimport { int } from '../utils/numberUtils.js'\nimport { isLargeContent } from '$lib/utils/jsonUtils.js'\nimport {\n  isArrayRecursiveState,\n  isExpandableState,\n  isObjectRecursiveState,\n  isValueRecursiveState\n} from '$lib/typeguards.js'\n\nexport type CreateRecursiveStateProps = {\n  json: unknown | undefined\n  factory: RecursiveStateFactory\n}\n\nexport function createRecursiveState({\n  json,\n  factory\n}: CreateRecursiveStateProps): RecursiveState | undefined {\n  return Array.isArray(json)\n    ? factory.createArrayDocumentState()\n    : isObject(json)\n      ? factory.createObjectDocumentState()\n      : json !== undefined\n        ? factory.createValueDocumentState()\n        : undefined\n}\n\nexport type CreateDocumentStateProps = {\n  json: unknown | undefined\n  expand?: OnExpand\n}\n\nexport function createDocumentState({\n  json,\n  expand\n}: CreateDocumentStateProps): DocumentState | undefined {\n  const documentState: DocumentState | undefined = createRecursiveState({\n    json,\n    factory: documentStateFactory\n  }) as DocumentState\n\n  return expand && documentState ? expandPath(json, documentState, [], expand) : documentState\n}\n\nexport function createArrayDocumentState({ expanded } = { expanded: false }): ArrayDocumentState {\n  return { type: 'array', expanded, visibleSections: DEFAULT_VISIBLE_SECTIONS, items: [] }\n}\n\nexport function createObjectDocumentState({ expanded } = { expanded: false }): ObjectDocumentState {\n  return { type: 'object', expanded, properties: {} }\n}\n\nexport function createValueDocumentState(): ValueDocumentState {\n  return { type: 'value' }\n}\n\nexport const documentStateFactory: RecursiveStateFactory = {\n  createObjectDocumentState,\n  createArrayDocumentState,\n  createValueDocumentState\n}\n\nexport function ensureRecursiveState<T extends RecursiveState>(\n  json: unknown,\n  documentState: T | undefined,\n  path: JSONPath,\n  {\n    createObjectDocumentState,\n    createArrayDocumentState,\n    createValueDocumentState\n  }: RecursiveStateFactory\n): T {\n  function recurse(value: unknown, state: T | undefined, path: JSONPath): T {\n    if (Array.isArray(value)) {\n      const arrayState: ArrayRecursiveState = isArrayRecursiveState(state)\n        ? state\n        : createArrayDocumentState()\n      if (path.length === 0) {\n        return arrayState as T\n      }\n\n      const index = int(path[0])\n      const itemState = recurse(value[index], arrayState.items[index] as T, path.slice(1))\n      return setIn(arrayState, ['items', path[0]], itemState)\n    }\n\n    if (isObject(value)) {\n      const objectState = isObjectRecursiveState(state) ? state : createObjectDocumentState()\n      if (path.length === 0) {\n        return objectState as T\n      }\n\n      const key = path[0]\n      const itemState = recurse(value[key], objectState.properties[key] as T, path.slice(1))\n      return setIn(objectState, ['properties', key], itemState)\n    }\n\n    return isValueRecursiveState(state) ? state : (createValueDocumentState() as T)\n  }\n\n  return recurse(json, documentState, path)\n}\n\nexport function syncDocumentState(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath = []\n): DocumentState | undefined {\n  return _transformDocumentState(\n    json,\n    documentState,\n    path,\n    (nestedJson, nestedState) => {\n      if (nestedJson === undefined || nestedState === undefined) {\n        return undefined\n      }\n\n      if (Array.isArray(nestedJson)) {\n        if (isArrayRecursiveState(nestedState)) {\n          return nestedState\n        }\n\n        const expanded = isExpandableState(nestedState) ? nestedState.expanded : false\n        return createArrayDocumentState({ expanded })\n      }\n\n      if (isObject(nestedJson)) {\n        if (isObjectRecursiveState(nestedState)) {\n          return nestedState\n        }\n\n        const expanded = isExpandableState(nestedState) ? nestedState.expanded : false\n        return createObjectDocumentState({ expanded })\n      }\n\n      // json is of type value\n      if (isValueRecursiveState(nestedState)) {\n        return nestedState\n      }\n\n      // type of state does not match the actual type of the json\n      return undefined\n    },\n    () => true\n  )\n}\n\nfunction _transformDocumentState(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath,\n  callback: (\n    nestedJson: unknown,\n    nestedState: DocumentState | undefined,\n    path: JSONPath\n  ) => DocumentState | undefined,\n  recurse: (nestedState: DocumentState | undefined) => boolean\n): DocumentState | undefined {\n  const updatedState = callback(json, documentState, path)\n\n  if (Array.isArray(json) && isArrayRecursiveState(updatedState) && recurse(updatedState)) {\n    const items: (DocumentState | undefined)[] = []\n\n    forEachVisibleIndex(json, updatedState.visibleSections, (index) => {\n      const itemPath = path.concat(String(index))\n      const value = json[index]\n      const item = updatedState.items[index]\n      const updatedItem = _transformDocumentState(value, item, itemPath, callback, recurse)\n      if (updatedItem !== undefined) {\n        items[index] = updatedItem\n      }\n    })\n\n    const changed = !strictShallowEqual(items, updatedState.items)\n\n    return changed ? { ...updatedState, items } : updatedState\n  }\n\n  if (isObject(json) && isObjectRecursiveState(updatedState) && recurse(updatedState)) {\n    const properties: ObjectDocumentState['properties'] = {}\n    Object.keys(json).forEach((key) => {\n      const propPath = path.concat(key)\n      const value = json[key]\n      const prop = updatedState.properties[key]\n      const updatedProp = _transformDocumentState(value, prop, propPath, callback, recurse)\n      if (updatedProp !== undefined) {\n        properties[key] = updatedProp\n      }\n    })\n\n    const changed = !strictShallowEqual(\n      Object.values(properties),\n      Object.values(updatedState.properties)\n    )\n\n    return changed ? { ...updatedState, properties } : updatedState\n  }\n\n  return updatedState\n}\n\n/**\n * Invoke a callback function for every visible item in the array\n */\nexport function forEachVisibleIndex(\n  jsonArray: Array<unknown>,\n  visibleSections: VisibleSection[],\n  callback: (index: number) => void\n) {\n  visibleSections.forEach(({ start, end }) => {\n    forEachIndex(start, Math.min(jsonArray.length, end), callback)\n  })\n}\n\nexport function expandVisibleSection(state: ArrayDocumentState, index: number): ArrayDocumentState {\n  if (inVisibleSection(state.visibleSections, index)) {\n    return state\n  }\n\n  const start = currentRoundNumber(index)\n  const end = nextRoundNumber(start)\n  const newVisibleSection = { start, end }\n\n  return {\n    ...state,\n    visibleSections: mergeSections(state.visibleSections.concat(newVisibleSection))\n  }\n}\n\nexport function toRecursiveStatePath(json: unknown, path: JSONPath): JSONPath {\n  let value = json\n  const recursiveStatePath: JSONPath = []\n\n  let i = 0\n  while (i < path.length) {\n    if (Array.isArray(value)) {\n      const index = path[i]\n      recursiveStatePath.push('items', index)\n      value = value[int(index)]\n    } else if (isObject(value)) {\n      const key = path[i]\n      recursiveStatePath.push('properties', key)\n      value = (value as Record<string, unknown>)[key]\n    } else {\n      throw new Error(`Cannot convert path: Object or Array expected at index ${i}`)\n    }\n\n    i++\n  }\n\n  return recursiveStatePath\n}\n\n/**\n * Expand all nodes along the given path, and expand invisible array sections if needed.\n * Then, optionally expand child nodes according to the provided callback.\n */\nexport function expandPath(\n  json: unknown | undefined,\n  documentState: DocumentState | undefined,\n  path: JSONPath,\n  callback: OnExpand\n): DocumentState | undefined {\n  let updatedState = documentState\n\n  // Step 1: expand all nodes along the path, and update visibleSections if needed\n  for (let i = 0; i < path.length; i++) {\n    const partialPath = path.slice(0, i)\n\n    updatedState = updateInDocumentState(json, updatedState, partialPath, (_, nestedState) => {\n      const updatedState =\n        isExpandableState(nestedState) && !nestedState.expanded\n          ? { ...nestedState, expanded: true }\n          : nestedState\n\n      if (isArrayRecursiveState(updatedState)) {\n        const index = int(path[i])\n        return expandVisibleSection(updatedState, index)\n      }\n\n      return updatedState\n    })\n  }\n\n  // Step 2: recursively expand child nodes tested with the callback\n  return updateInDocumentState(json, updatedState, path, (nestedValue, nestedState) => {\n    const relativePath: JSONPath = []\n    return _expandRecursively(nestedValue, nestedState, relativePath, callback)\n  })\n}\n\nfunction _expandRecursively(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath,\n  callback: OnExpand\n): DocumentState | undefined {\n  return _transformDocumentState(\n    json,\n    documentState,\n    path,\n    (nestedJson, nestedState, nestedPath) => {\n      if (Array.isArray(nestedJson) && callback(nestedPath)) {\n        return isArrayRecursiveState(nestedState)\n          ? nestedState.expanded\n            ? nestedState\n            : { ...nestedState, expanded: true }\n          : createArrayDocumentState({ expanded: true })\n      }\n\n      if (isObject(nestedJson) && callback(nestedPath)) {\n        return isObjectRecursiveState(nestedState)\n          ? nestedState.expanded\n            ? nestedState\n            : { ...nestedState, expanded: true }\n          : createObjectDocumentState({ expanded: true })\n      }\n\n      return nestedState\n    },\n    (nestedState) => isExpandableState(nestedState) && nestedState.expanded\n  )\n}\n\nexport function collapsePath(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath,\n  recursive: boolean\n): DocumentState | undefined {\n  return updateInDocumentState(json, documentState, path, (nestedJson, nestedState) => {\n    return recursive ? _collapseRecursively(nestedJson, nestedState, path) : _collapse(nestedState)\n  })\n}\n\nfunction _collapse<T extends DocumentState | undefined>(documentState: T): T {\n  if (isArrayRecursiveState(documentState) && documentState.expanded) {\n    return { ...documentState, expanded: false, visibleSections: DEFAULT_VISIBLE_SECTIONS }\n  }\n\n  if (isObjectRecursiveState(documentState) && documentState.expanded) {\n    return { ...documentState, expanded: false }\n  }\n\n  return documentState\n}\n\nfunction _collapseRecursively(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath\n): DocumentState | undefined {\n  return _transformDocumentState(\n    json,\n    documentState,\n    path,\n    (_, nestedState) => _collapse(nestedState),\n    () => true\n  )\n}\n\n/**\n * Expand a section of items in an array\n */\nexport function expandSection(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath,\n  section: Section\n): DocumentState | undefined {\n  return updateInDocumentState(json, documentState, path, (_value, state) => {\n    if (!isArrayRecursiveState(state)) {\n      return state\n    }\n\n    const visibleSections = mergeSections(state.visibleSections.concat(section))\n\n    return { ...state, visibleSections }\n  })\n}\n\nexport function syncKeys(actualKeys: string[], prevKeys?: string[]): string[] {\n  if (!prevKeys) {\n    return actualKeys\n  }\n\n  // copy the keys that still exist\n  const actualKeysSet = new Set(actualKeys)\n  const keys = prevKeys.filter((key) => actualKeysSet.has(key))\n\n  // add new keys\n  const keysSet = new Set(keys)\n  actualKeys.filter((key) => !keysSet.has(key)).forEach((key) => keys.push(key))\n\n  return keys\n}\n\n/**\n * Apply patch operations to both json and state\n */\nexport function documentStatePatch(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  operations: JSONPatchDocument\n): { json: unknown; documentState: DocumentState | undefined } {\n  const initial = { json, documentState }\n\n  const result = operations.reduce((current, operation) => {\n    return {\n      json: immutableJSONPatch(current.json, [operation]),\n      documentState: _documentStatePatch(current.json, current.documentState, operation)\n    }\n  }, initial)\n\n  return {\n    json: result.json,\n    documentState: syncDocumentState(result.json, result.documentState) // sync to clean up leftover state\n  }\n}\n\nfunction _documentStatePatch(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  operation: JSONPatchOperation\n): DocumentState | undefined {\n  if (isJSONPatchAdd(operation)) {\n    return documentStateAdd(json, documentState, operation, undefined)\n  }\n\n  if (isJSONPatchRemove(operation)) {\n    return documentStateRemove(json, documentState, operation)\n  }\n\n  if (isJSONPatchReplace(operation)) {\n    const path = parsePath(json, operation.path)\n    const enforceString = getEnforceString(json, documentState, path)\n    if (enforceString) {\n      // ensure the enforceString setting is not lost when for example changing \"123\"\n      // into \"abc\" and later back to \"123\", so we now make it explicit.\n      return setInDocumentState(json, documentState, path, { type: 'value', enforceString })\n    }\n\n    // nothing special to do (all is handled by syncDocumentState)\n    return documentState\n  }\n\n  if (isJSONPatchCopy(operation) || isJSONPatchMove(operation)) {\n    return documentStateMoveOrCopy(json, documentState, operation)\n  }\n\n  return documentState\n}\n\nexport function getInRecursiveState<T extends RecursiveState>(\n  json: unknown,\n  documentState: T | undefined,\n  path: JSONPath\n): T | undefined {\n  try {\n    return getIn(documentState, toRecursiveStatePath(json, path))\n  } catch {\n    return undefined\n  }\n}\n\nexport function setInRecursiveState<T extends RecursiveState>(\n  json: unknown,\n  recursiveState: T | undefined,\n  path: JSONPath,\n  value: unknown,\n  factory: RecursiveStateFactory\n): T | undefined {\n  const ensuredState = ensureRecursiveState(json, recursiveState, path, factory)\n  return setIn(ensuredState, toRecursiveStatePath(json, path), value)\n}\n\nexport function updateInRecursiveState<T extends RecursiveState>(\n  json: unknown,\n  documentState: T | undefined,\n  path: JSONPath,\n  transform: (value: unknown, state: T) => T | undefined,\n  factory: RecursiveStateFactory\n): T {\n  const ensuredState: T = ensureRecursiveState(json, documentState, path, factory)\n  return updateIn(ensuredState, toRecursiveStatePath(json, path), (nestedState: T) => {\n    const value = getIn(json, path)\n    return transform(value, nestedState)\n  })\n}\n\nexport function setInDocumentState<T extends RecursiveState>(\n  json: unknown | undefined,\n  documentState: T | undefined,\n  path: JSONPath,\n  value: unknown\n): T | undefined {\n  return setInRecursiveState(json, documentState, path, value, documentStateFactory)\n}\n\nexport function updateInDocumentState<T extends RecursiveState>(\n  json: unknown | undefined,\n  documentState: T | undefined,\n  path: JSONPath,\n  transform: (value: unknown, state: T) => T | undefined\n): T {\n  return updateInRecursiveState(json, documentState, path, transform, documentStateFactory)\n}\n\nexport function deleteInDocumentState<T extends RecursiveState>(\n  json: unknown | undefined,\n  documentState: T | undefined,\n  path: JSONPath\n): T | undefined {\n  const recursivePath = toRecursiveStatePath(json, path)\n\n  return existsIn(documentState, recursivePath)\n    ? deleteIn(documentState, toRecursiveStatePath(json, path))\n    : documentState\n}\n\nexport function documentStateAdd(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  operation: JSONPatchAdd,\n  stateValue: DocumentState | undefined\n): DocumentState | undefined {\n  const path = parsePath(json, operation.path)\n  const parentPath = initial(path)\n\n  let updatedState = documentState\n\n  updatedState = updateInDocumentState(json, updatedState, parentPath, (_parent, arrayState) => {\n    if (!isArrayRecursiveState(arrayState)) {\n      return arrayState\n    }\n\n    const index = int(last(path) as string)\n    const { items, visibleSections } = arrayState\n    return {\n      ...arrayState,\n      items:\n        index < items.length\n          ? insertItemsAt(items, index, stateValue !== undefined ? [stateValue] : Array(1))\n          : items,\n      visibleSections: shiftVisibleSections(visibleSections, index, 1)\n    }\n  })\n\n  // object property added, nothing to do\n  return setInDocumentState(json, updatedState, path, stateValue)\n}\n\nexport function documentStateRemove(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  operation: JSONPatchRemove\n): DocumentState | undefined {\n  const path = parsePath(json, operation.path)\n  const parentPath = initial(path)\n  const parent = getIn(json, parentPath)\n\n  if (Array.isArray(parent)) {\n    return updateInDocumentState(json, documentState, parentPath, (_parent, arrayState) => {\n      if (!isArrayRecursiveState(arrayState)) {\n        return arrayState\n      }\n\n      const index = int(last(path) as string)\n      const { items, visibleSections } = arrayState\n\n      return {\n        ...arrayState,\n        items: items.slice(0, index).concat(items.slice(index + 1)),\n        visibleSections: shiftVisibleSections(visibleSections, index, -1)\n      }\n    })\n  }\n\n  return deleteInDocumentState(json, documentState, path)\n}\n\nexport function documentStateMoveOrCopy(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  operation: JSONPatchCopy | JSONPatchMove\n): DocumentState | undefined {\n  if (isJSONPatchMove(operation) && operation.from === operation.path) {\n    // nothing to do\n    return documentState\n  }\n\n  let updatedState = documentState\n\n  // get the state that we will move or copy\n  const from = parsePath(json, operation.from)\n  const stateValue = getInRecursiveState(json, updatedState, from)\n\n  if (isJSONPatchMove(operation)) {\n    updatedState = documentStateRemove(json, updatedState, {\n      op: 'remove',\n      path: operation.from\n    })\n  }\n\n  updatedState = documentStateAdd(\n    json,\n    updatedState,\n    {\n      op: 'add',\n      path: operation.path,\n      value: null // note that the value is not actually used, so we just use null instead of getting the actual value from the json\n    },\n    stateValue\n  )\n\n  return updatedState\n}\n\n/**\n * Shift visible sections in an Array with a specified offset\n */\nexport function shiftVisibleSections(\n  visibleSections: VisibleSection[],\n  index: number,\n  offset: number\n): VisibleSection[] {\n  const shiftedSections = visibleSections.map((section) => {\n    return {\n      start: section.start > index ? section.start + offset : section.start,\n      end: section.end > index ? section.end + offset : section.end\n    }\n  })\n\n  return mergeAdjacentSections(shiftedSections)\n}\n\n// merge adjacent sections like [{start:0, end:100}, {start:100, end:200}] into [{start:0, end:200}]\nfunction mergeAdjacentSections(visibleSections: VisibleSection[]): VisibleSection[] {\n  const merged = visibleSections.slice(0)\n\n  let i = 1\n  while (i < merged.length) {\n    if (merged[i - 1].end === merged[i].start) {\n      merged[i - 1] = {\n        start: merged[i - 1].start,\n        end: merged[i].end\n      }\n      merged.splice(i)\n    }\n    i++\n  }\n\n  return merged\n}\n\nexport function getEnforceString(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath\n): boolean {\n  const value = getIn(json, path)\n  const nestedState = getInRecursiveState(json, documentState, path)\n  const enforceString = isValueRecursiveState(nestedState) ? nestedState.enforceString : undefined\n\n  if (typeof enforceString === 'boolean') {\n    return enforceString\n  }\n\n  return isStringContainingPrimitiveValue(value)\n}\n\nexport function getNextKeys(keys: string[], key: string, includeKey = false): string[] {\n  const index = keys.indexOf(key)\n  if (index !== -1) {\n    return includeKey ? keys.slice(index) : keys.slice(index + 1)\n  } else {\n    // a new key, that doesn't have next keys\n    return []\n  }\n}\n\n/**\n * Get all paths which are visible and rendered\n */\n// TODO: create memoized version of getVisiblePaths which remembers just the previous result if json and state are the same\nexport function getVisiblePaths(\n  json: unknown,\n  documentState: DocumentState | undefined\n): JSONPath[] {\n  const paths: JSONPath[] = []\n\n  function _recurse(value: unknown, state: DocumentState | undefined, path: JSONPath) {\n    paths.push(path)\n\n    if (isJSONArray(value) && isArrayRecursiveState(state) && state.expanded) {\n      forEachVisibleIndex(value, state.visibleSections, (index) => {\n        _recurse(value[index], state.items[index], path.concat(String(index)))\n      })\n    }\n\n    if (isJSONObject(value) && isObjectRecursiveState(state) && state.expanded) {\n      Object.keys(value).forEach((key) => {\n        _recurse(value[key], state.properties[key], path.concat(key))\n      })\n    }\n  }\n\n  _recurse(json, documentState, [])\n\n  return paths\n}\n\n/**\n * Get all caret position which are visible and rendered:\n * before a node, at a key, at a value, appending an object/array\n */\n// TODO: create memoized version of getVisibleCaretPositions which remembers just the previous result if json and state are the same\nexport function getVisibleCaretPositions(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  includeInside = true\n): CaretPosition[] {\n  const paths: CaretPosition[] = []\n\n  function _recurse(value: unknown, path: JSONPath) {\n    paths.push({ path, type: CaretType.value })\n\n    const valueState = getInRecursiveState(json, documentState, path)\n    if (value && isExpandableState(valueState) && valueState.expanded) {\n      if (includeInside) {\n        paths.push({ path, type: CaretType.inside })\n      }\n\n      if (isJSONArray(value)) {\n        const visibleSections = isArrayRecursiveState(valueState)\n          ? valueState.visibleSections\n          : DEFAULT_VISIBLE_SECTIONS\n        forEachVisibleIndex(value, visibleSections, (index) => {\n          const itemPath = path.concat(String(index))\n\n          _recurse(value[index], itemPath)\n\n          if (includeInside) {\n            paths.push({ path: itemPath, type: CaretType.after })\n          }\n        })\n      }\n\n      if (isJSONObject(value)) {\n        const keys = Object.keys(value)\n        keys.forEach((key) => {\n          const propertyPath = path.concat(key)\n\n          paths.push({ path: propertyPath, type: CaretType.key })\n\n          _recurse(value[key], propertyPath)\n\n          if (includeInside) {\n            paths.push({ path: propertyPath, type: CaretType.after })\n          }\n        })\n      }\n    }\n  }\n\n  _recurse(json, [])\n\n  return paths\n}\n\n/**\n * Find the previous visible path.\n * This can be the last child of the previous object or array, or the parent of a first entry.\n */\n// TODO: write tests for getPreviousVisiblePath\nexport function getPreviousVisiblePath(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath\n): JSONPath | undefined {\n  const visiblePaths = getVisiblePaths(json, documentState)\n  const visiblePathPointers = visiblePaths.map(compileJSONPointer)\n  const pathPointer = compileJSONPointer(path)\n  const index = visiblePathPointers.indexOf(pathPointer)\n\n  if (index !== -1 && index > 0) {\n    return visiblePaths[index - 1]\n  }\n\n  return undefined\n}\n\n/**\n * Find the next visible path.\n * This can be the next parent entry.\n */\n// TODO: write tests for getNextVisiblePath\nexport function getNextVisiblePath(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath\n): JSONPath | undefined {\n  const visiblePaths = getVisiblePaths(json, documentState)\n  const visiblePathPointers = visiblePaths.map(compileJSONPointer)\n  const index = visiblePathPointers.indexOf(compileJSONPointer(path))\n\n  if (index !== -1 && index < visiblePaths.length - 1) {\n    return visiblePaths[index + 1]\n  }\n\n  return undefined\n}\n\n/**\n * Expand recursively when the expanded contents is small enough,\n * else expand in a minimalistic way\n */\nexport function expandSmart(\n  json: unknown | undefined,\n  documentState: DocumentState | undefined,\n  path: JSONPath,\n  maxSize: number = MAX_DOCUMENT_SIZE_EXPAND_ALL\n): DocumentState | undefined {\n  const nestedJson = getIn(json, path)\n  const callback = isLargeContent({ json: nestedJson }, maxSize) ? expandMinimal : expandAll\n\n  return expandPath(json, documentState, path, callback)\n}\n\nexport function expandSmartIfCollapsed(\n  json: unknown | undefined,\n  documentState: DocumentState | undefined,\n  path: JSONPath\n) {\n  const nestedState = getInRecursiveState(json, documentState, path)\n  const isExpanded = isExpandableState(nestedState) ? nestedState.expanded : false\n\n  return isExpanded ? documentState : expandSmart(json, documentState, path)\n}\n\n/**\n * Expand the root array or object, and in case of an array, expand the first array item\n */\nexport function expandMinimal(relativePath: JSONPath): boolean {\n  // first item of an array\n  return relativePath.length === 0 ? true : relativePath.length === 1 && relativePath[0] === '0'\n}\n\n/**\n * Expand the root array or object\n */\nexport function expandSelf(relativePath: JSONPath): boolean {\n  return relativePath.length === 0\n}\n\nexport function expandAll(): boolean {\n  return true\n}\n\nexport function expandNone(): boolean {\n  return false\n}\n","import {\n  getIn,\n  isJSONArray,\n  isJSONObject,\n  isJSONPatchCopy,\n  isJSONPatchMove,\n  type JSONPatchDocument,\n  type JSONPatchOperation,\n  type JSONPath,\n  parsePath\n} from 'immutable-json-patch'\nimport { first, initial, isEmpty, isEqual, last } from 'lodash-es'\nimport { isObjectOrArray } from '$lib/utils/typeUtils.js'\nimport {\n  collapsePath,\n  getNextVisiblePath,\n  getPreviousVisiblePath,\n  getVisibleCaretPositions,\n  getVisiblePaths\n} from './documentState.js'\nimport type {\n  AfterSelection,\n  CaretPosition,\n  DocumentState,\n  EditKeySelection,\n  EditValueSelection,\n  InsideSelection,\n  JSONEditorSelection,\n  JSONParser,\n  JSONSelection,\n  KeySelection,\n  MultiSelection,\n  TextSelection,\n  ValueSelection\n} from '../types.js'\nimport { CaretType, SelectionType } from '$lib/types.js'\nimport { int } from '$lib/utils/numberUtils.js'\n\nexport function isAfterSelection(\n  selection: JSONEditorSelection | undefined\n): selection is AfterSelection {\n  return (selection && selection.type === SelectionType.after) || false\n}\n\nexport function isInsideSelection(\n  selection: JSONEditorSelection | undefined\n): selection is InsideSelection {\n  return (selection && selection.type === SelectionType.inside) || false\n}\n\nexport function isKeySelection(\n  selection: JSONEditorSelection | undefined\n): selection is KeySelection {\n  return (selection && selection.type === SelectionType.key) || false\n}\n\nexport function isValueSelection(\n  selection: JSONEditorSelection | undefined\n): selection is ValueSelection {\n  return (selection && selection.type === SelectionType.value) || false\n}\n\nexport function isMultiSelection(\n  selection: JSONEditorSelection | undefined\n): selection is MultiSelection {\n  return (selection && selection.type === SelectionType.multi) || false\n}\n\nexport function isMultiSelectionWithOneItem(\n  selection: JSONEditorSelection | undefined\n): selection is MultiSelection {\n  return isMultiSelection(selection) && isEqual(selection.focusPath, selection.anchorPath)\n}\n\nexport function isJSONSelection(\n  selection: JSONEditorSelection | undefined\n): selection is JSONSelection {\n  return (\n    isMultiSelection(selection) ||\n    isAfterSelection(selection) ||\n    isInsideSelection(selection) ||\n    isKeySelection(selection) ||\n    isValueSelection(selection)\n  )\n}\n\nexport function isTextSelection(\n  selection: JSONEditorSelection | undefined\n): selection is TextSelection {\n  return (selection && selection.type === SelectionType.text) || false\n}\n\n/**\n * Expand a selection start and end into an array containing all paths\n * between (and including) start and end\n */\nexport function getSelectionPaths(json: unknown, selection: JSONSelection): JSONPath[] {\n  const paths: JSONPath[] = []\n\n  iterateOverSelection(json, selection, (path) => {\n    paths.push(path)\n  })\n\n  return paths\n}\n\n/**\n * Expand a selection start and end into an array containing all paths\n * between (and including) start and end.\n *\n * The function iterates always from start to end, independent of the order\n * of focusPath and anchorPath.\n *\n * When the callback returns something other than undefined, the iteration is\n * canceled and the value returned by the callback is returned by iterateOverSelection.\n */\nexport function iterateOverSelection<T>(\n  json: unknown | undefined,\n  selection: JSONSelection | undefined,\n  callback: (path: JSONPath) => void | undefined | T\n): void | undefined | T {\n  if (!selection) {\n    return undefined\n  }\n\n  const anchorPath = getAnchorPath(selection)\n  const focusPath = getFocusPath(selection)\n\n  if (isEqual(anchorPath, focusPath)) {\n    // just a single node\n    return callback(anchorPath)\n  } else {\n    // multiple nodes\n    if (json === undefined) {\n      return undefined\n    }\n\n    const sharedPath = findSharedPath(anchorPath, focusPath)\n\n    if (anchorPath.length === sharedPath.length || focusPath.length === sharedPath.length) {\n      // a parent and a child, like ['arr', 1] and ['arr']\n      return callback(sharedPath)\n    }\n\n    const selection = createMultiSelection(anchorPath, focusPath)\n    const startPath = getStartPath(json, selection)\n    const endPath = getEndPath(json, selection)\n\n    const startIndex = getChildIndex(json, selection, startPath)\n    const endIndex = getChildIndex(json, selection, endPath)\n\n    if (startIndex === -1 || endIndex === -1) {\n      return undefined\n    }\n\n    const value = getIn(json, sharedPath)\n\n    if (isJSONObject(value)) {\n      const keys = Object.keys(value)\n\n      for (let i = startIndex; i <= endIndex; i++) {\n        const value = callback(sharedPath.concat(keys[i]))\n        if (value !== undefined) {\n          return value\n        }\n      }\n\n      return undefined\n    }\n\n    if (isJSONArray(value)) {\n      for (let i = startIndex; i <= endIndex; i++) {\n        const value = callback(sharedPath.concat(String(i)))\n        if (value !== undefined) {\n          return value\n        }\n      }\n\n      return undefined\n    }\n  }\n\n  throw new Error('Failed to create selection')\n}\n\nexport function getParentPath(selection: JSONSelection): JSONPath {\n  if (isInsideSelection(selection)) {\n    return selection.path\n  } else {\n    return initial(getFocusPath(selection))\n  }\n}\n\nexport function getStartPath(json: unknown, selection: JSONSelection): JSONPath {\n  if (!isMultiSelection(selection)) {\n    return selection.path\n  }\n\n  const anchorIndex = getChildIndex(json, selection, selection.anchorPath)\n  const focusIndex = getChildIndex(json, selection, selection.focusPath)\n\n  return focusIndex < anchorIndex ? selection.focusPath : selection.anchorPath\n}\n\nexport function getEndPath(json: unknown, selection: JSONSelection): JSONPath {\n  if (!isMultiSelection(selection)) {\n    return selection.path\n  }\n\n  const anchorIndex = getChildIndex(json, selection, selection.anchorPath)\n  const focusIndex = getChildIndex(json, selection, selection.focusPath)\n\n  return focusIndex > anchorIndex ? selection.focusPath : selection.anchorPath\n}\n\n// TODO: write unit test\nexport function isSelectionInsidePath(selection: JSONSelection, path: JSONPath): boolean {\n  return (\n    pathStartsWith(getFocusPath(selection), path) &&\n    (getFocusPath(selection).length > path.length || isInsideSelection(selection))\n  )\n}\n\nexport function getSelectionUp(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  selection: JSONSelection | undefined,\n  keepAnchorPath = false\n): JSONSelection | undefined {\n  if (!selection) {\n    return undefined\n  }\n\n  const focusPath = keepAnchorPath ? getFocusPath(selection) : getStartPath(json, selection)\n  const previousPath = getPreviousVisiblePath(json, documentState, focusPath)\n\n  if (keepAnchorPath) {\n    // create a multi-selection with multiple nodes\n    if (isInsideSelection(selection) || isAfterSelection(selection)) {\n      return previousPath !== undefined ? createMultiSelection(focusPath, focusPath) : undefined\n    }\n\n    return previousPath !== undefined\n      ? createMultiSelection(getAnchorPath(selection), previousPath)\n      : undefined\n  }\n\n  if (isAfterSelection(selection)) {\n    // select the node itself, not the previous node,\n    // FIXME: when after an expanded object/array, should go to the last item inside the object/array\n    return createValueSelection(focusPath)\n  }\n\n  if (isInsideSelection(selection)) {\n    // select the node itself, not the previous node,\n    return createValueSelection(focusPath)\n  }\n\n  if (isKeySelection(selection)) {\n    if (previousPath === undefined || previousPath.length === 0) {\n      return undefined\n    }\n\n    const parentPath = initial(previousPath)\n    const parent = getIn(json, parentPath)\n    if (Array.isArray(parent) || isEmpty(previousPath)) {\n      // switch to value selection: array has no keys, and root object also not\n      return createValueSelection(previousPath)\n    } else {\n      return createKeySelection(previousPath)\n    }\n  }\n\n  if (isValueSelection(selection)) {\n    return previousPath !== undefined ? createValueSelection(previousPath) : undefined\n  }\n\n  if (previousPath !== undefined) {\n    return createValueSelection(previousPath)\n  }\n\n  return undefined\n}\n\nexport function getSelectionDown(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  selection: JSONSelection | undefined,\n  keepAnchorPath = false\n): JSONSelection | undefined {\n  if (!selection) {\n    return undefined\n  }\n  const focusPath = keepAnchorPath ? getFocusPath(selection) : getEndPath(json, selection)\n\n  // if the focusPath is an Array or object, we must not step into it but\n  // over it, we pass state with this array/object collapsed\n  const collapsedState = isObjectOrArray(getIn(json, focusPath))\n    ? collapsePath(json, documentState, focusPath, true)\n    : documentState\n\n  const nextPath = getNextVisiblePath(json, documentState, focusPath)\n  const nextPathAfter = getNextVisiblePath(json, collapsedState, focusPath)\n\n  if (keepAnchorPath) {\n    // create a multi-selection with multiple nodes\n    if (isInsideSelection(selection)) {\n      return nextPath !== undefined ? createMultiSelection(nextPath, nextPath) : undefined\n    }\n\n    if (isAfterSelection(selection)) {\n      return nextPathAfter !== undefined\n        ? createMultiSelection(nextPathAfter, nextPathAfter)\n        : undefined\n    }\n\n    return nextPathAfter !== undefined\n      ? createMultiSelection(getAnchorPath(selection), nextPathAfter)\n      : undefined\n  }\n\n  if (isAfterSelection(selection)) {\n    return nextPathAfter !== undefined ? createValueSelection(nextPathAfter) : undefined\n  }\n\n  if (isInsideSelection(selection)) {\n    return nextPath !== undefined ? createValueSelection(nextPath) : undefined\n  }\n\n  if (isValueSelection(selection)) {\n    return nextPath !== undefined ? createValueSelection(nextPath) : undefined\n  }\n\n  if (isKeySelection(selection)) {\n    if (nextPath === undefined || nextPath.length === 0) {\n      return undefined\n    }\n\n    const parentPath = initial(nextPath) // not nextPathAfter!\n    const parent = getIn(json, parentPath)\n    if (Array.isArray(parent)) {\n      // switch to value selection: array has no keys\n      return createValueSelection(nextPath)\n    } else {\n      return createKeySelection(nextPath)\n    }\n  }\n\n  if (isMultiSelection(selection)) {\n    return nextPathAfter !== undefined\n      ? createValueSelection(nextPathAfter)\n      : nextPath !== undefined\n        ? createValueSelection(nextPath)\n        : undefined\n  }\n\n  return undefined\n}\n\n/**\n * Get the next selection for a value inside the current object/array\n * If there is no next value, select AFTER.\n * Only applicable for ValueSelection\n */\nexport function getSelectionNextInside(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  path: JSONPath\n): JSONSelection | undefined {\n  // TODO: write unit tests for getSelectionNextInside\n  const parentPath = initial(path)\n  const childPath = [last(path) as string]\n\n  const parent: unknown | undefined = getIn(json, parentPath)\n  const nextPathInside = parent ? getNextVisiblePath(parent, documentState, childPath) : undefined\n\n  if (nextPathInside) {\n    return createValueSelection(parentPath.concat(nextPathInside))\n  } else {\n    return createAfterSelection(path)\n  }\n}\n\n/**\n * Find the caret position and its siblings for a given selection\n */\n// TODO: unit test\nexport function findCaretAndSiblings(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  selection: JSONSelection | undefined,\n  includeInside: boolean\n): {\n  next: CaretPosition | undefined\n  caret: CaretPosition | undefined\n  previous: CaretPosition | undefined\n} {\n  if (!selection) {\n    return { caret: undefined, previous: undefined, next: undefined }\n  }\n  const visibleCaretPositions = getVisibleCaretPositions(json, documentState, includeInside)\n\n  const index = visibleCaretPositions.findIndex((caret) => {\n    return (\n      isEqual(caret.path, getFocusPath(selection)) && String(caret.type) === String(selection.type)\n    )\n  })\n\n  return {\n    caret: index !== -1 ? visibleCaretPositions[index] : undefined,\n\n    previous: index !== -1 && index > 0 ? visibleCaretPositions[index - 1] : undefined,\n\n    next:\n      index !== -1 && index < visibleCaretPositions.length - 1\n        ? visibleCaretPositions[index + 1]\n        : undefined\n  }\n}\n\nexport function getSelectionLeft(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  selection: JSONSelection | undefined,\n  keepAnchorPath = false,\n  includeInside = true\n): JSONSelection | undefined {\n  if (!selection) {\n    return undefined\n  }\n\n  const { caret, previous } = findCaretAndSiblings(json, documentState, selection, includeInside)\n\n  if (keepAnchorPath) {\n    if (!isMultiSelection(selection)) {\n      return createMultiSelection(selection.path, selection.path)\n    }\n\n    return undefined\n  }\n\n  if (caret && previous) {\n    return fromCaretPosition(previous)\n  }\n\n  const parentPath = initial(getFocusPath(selection))\n  const parent = getIn(json, parentPath)\n\n  if (isValueSelection(selection) && Array.isArray(parent)) {\n    return createMultiSelection(selection.path, selection.path)\n  }\n\n  if (isMultiSelection(selection) && !Array.isArray(parent)) {\n    return createKeySelection(selection.focusPath)\n  }\n\n  return undefined\n}\n\nexport function getSelectionRight(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  selection: JSONSelection | undefined,\n  keepAnchorPath = false,\n  includeInside = true\n): JSONSelection | undefined {\n  if (!selection) {\n    return undefined\n  }\n\n  const { caret, next } = findCaretAndSiblings(json, documentState, selection, includeInside)\n\n  if (keepAnchorPath) {\n    if (!isMultiSelection(selection)) {\n      return createMultiSelection(selection.path, selection.path)\n    }\n\n    return undefined\n  }\n\n  if (caret && next) {\n    return fromCaretPosition(next)\n  }\n\n  if (isMultiSelection(selection)) {\n    return createValueSelection(selection.focusPath)\n  }\n\n  return undefined\n}\n\n/**\n * Get a proper initial selection based on what is visible\n */\nexport function getInitialSelection(\n  json: unknown,\n  documentState: DocumentState | undefined\n): JSONSelection {\n  const visiblePaths = getVisiblePaths(json, documentState)\n\n  // find the first, deepest nested entry (normally a value, not an Object/Array)\n  let index = 0\n  while (\n    index < visiblePaths.length - 1 &&\n    visiblePaths[index + 1].length > visiblePaths[index].length\n  ) {\n    index++\n  }\n\n  const path = visiblePaths[index]\n  return path === undefined || path.length === 0 || Array.isArray(getIn(json, initial(path)))\n    ? createValueSelection(path) // Array items and root object/array do not have a key, so select value in that case\n    : createKeySelection(path)\n}\n\nexport function createSelectionFromOperations(\n  json: unknown,\n  operations: JSONPatchDocument\n): JSONSelection | undefined {\n  if (operations.length === 1) {\n    const operation = first(operations) as JSONPatchOperation\n    if (operation.op === 'replace') {\n      // a replaced value\n      const path = parsePath(json, operation.path)\n\n      return createValueSelection(path)\n    }\n  }\n\n  if (!isEmpty(operations) && operations.every((operation) => operation.op === 'move')) {\n    const firstOp = first(operations)\n    const otherOps = operations.slice(1)\n\n    if (\n      (isJSONPatchCopy(firstOp) || isJSONPatchMove(firstOp)) &&\n      firstOp.from !== firstOp.path &&\n      otherOps.every((op) => (isJSONPatchCopy(op) || isJSONPatchMove(op)) && op.from === op.path)\n    ) {\n      // a renamed key\n      const path = parsePath(json, firstOp.path)\n\n      return createKeySelection(path)\n    }\n  }\n\n  const paths = operations\n    .filter((operation) => {\n      return (\n        operation.op !== 'test' &&\n        operation.op !== 'remove' &&\n        (operation.op !== 'move' || operation.from !== operation.path) &&\n        typeof operation.path === 'string'\n      )\n    })\n    .map((operation) => parsePath(json, operation.path))\n\n  if (isEmpty(paths)) {\n    return undefined\n  }\n\n  // TODO: make this function robust against operations which do not have consecutive paths or have wrongly ordered paths\n\n  return {\n    type: SelectionType.multi,\n    anchorPath: first(paths) as JSONPath,\n    focusPath: last(paths) as JSONPath\n  }\n}\n\n/**\n * Find the common path of two paths.\n * For example findCommonRoot(['arr', '1', 'name'], ['arr', '1', 'address', 'contact']) returns ['arr', '1']\n */\n// TODO: write unit tests for findSharedPath\nexport function findSharedPath(path1: JSONPath, path2: JSONPath): JSONPath {\n  let i = 0\n  while (i < path1.length && i < path2.length && path1[i] === path2[i]) {\n    i++\n  }\n\n  return path1.slice(0, i)\n}\n\nexport function singleItemSelected(selection: JSONSelection | undefined): boolean {\n  return (\n    isKeySelection(selection) ||\n    isValueSelection(selection) ||\n    isMultiSelectionWithOneItem(selection)\n  )\n}\n\nexport function findRootPath(json: unknown, selection: JSONSelection): JSONPath {\n  return singleItemSelected(selection) && isObjectOrArray(getIn(json, getFocusPath(selection)))\n    ? getFocusPath(selection)\n    : initial(getFocusPath(selection)) // the parent path of the paths\n}\n\nexport function pathStartsWith(path: JSONPath, parentPath: JSONPath): boolean {\n  if (path.length < parentPath.length) {\n    return false\n  }\n\n  for (let i = 0; i < parentPath.length; i++) {\n    if (path[i] !== parentPath[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n\n// TODO: write unit tests\nexport function removeEditModeFromSelection(\n  selection: JSONSelection | undefined\n): JSONSelection | undefined {\n  if (isEditingSelection(selection)) {\n    const { type, path } = selection\n    return { type, path } as KeySelection | ValueSelection\n  }\n\n  return selection\n}\n\nexport function createKeySelection(path: JSONPath): KeySelection {\n  return { type: SelectionType.key, path }\n}\n\nexport function createEditKeySelection(path: JSONPath, initialValue?: string): EditKeySelection {\n  return { type: SelectionType.key, path, edit: true, initialValue }\n}\n\nexport function createValueSelection(path: JSONPath): ValueSelection {\n  return { type: SelectionType.value, path }\n}\n\nexport function createEditValueSelection(\n  path: JSONPath,\n  initialValue?: string\n): EditValueSelection {\n  return { type: SelectionType.value, path, edit: true, initialValue }\n}\n\nexport function createInsideSelection(path: JSONPath): InsideSelection {\n  return {\n    type: SelectionType.inside,\n    path\n  }\n}\n\nexport function createAfterSelection(path: JSONPath): AfterSelection {\n  return {\n    type: SelectionType.after,\n    path\n  }\n}\n\nexport function createMultiSelection(anchorPath: JSONPath, focusPath: JSONPath): MultiSelection {\n  // normalize the paths to both be a child of a shared parent\n  const sharedPath = findSharedPath(anchorPath, focusPath)\n  const isParent = anchorPath.length > sharedPath.length && focusPath.length > sharedPath.length\n\n  return {\n    type: SelectionType.multi,\n    anchorPath: isParent ? sharedPath.concat(anchorPath[sharedPath.length]) : sharedPath,\n    focusPath: isParent ? sharedPath.concat(focusPath[sharedPath.length]) : sharedPath\n  }\n}\n\n/**\n * Turn selected contents into plain text partial JSON, usable for copying to\n * clipboard for example.\n */\nexport function selectionToPartialJson(\n  json: unknown,\n  selection: JSONSelection | undefined,\n  indentation: number | string | undefined,\n  parser: JSONParser\n): string | undefined {\n  if (isKeySelection(selection)) {\n    return String(last(selection.path))\n  }\n\n  if (isValueSelection(selection)) {\n    const value = getIn(json, selection.path)\n    return typeof value === 'string' ? value : parser.stringify(value, null, indentation) // TODO: customizable indentation?\n  }\n\n  if (isMultiSelection(selection)) {\n    if (isEmpty(selection.focusPath)) {\n      // root object -> does not have a parent key/index\n      return parser.stringify(json, null, indentation)\n    }\n\n    const parentPath = getParentPath(selection)\n    const parent = getIn(json, parentPath)\n    if (Array.isArray(parent)) {\n      if (isMultiSelectionWithOneItem(selection)) {\n        // do not suffix a single selected array item with a comma\n        const item = getIn(json, selection.focusPath)\n        return parser.stringify(item, null, indentation)\n      } else {\n        return getSelectionPaths(json, selection)\n          .map((path) => {\n            const item = getIn(json, path)\n            return `${parser.stringify(item, null, indentation)},`\n          })\n          .join('\\n')\n      }\n    } else {\n      // parent is Object\n      return getSelectionPaths(json, selection)\n        .map((path) => {\n          const key = last(path)\n          const value = getIn(json, path)\n          return `${parser.stringify(key)}: ${parser.stringify(value, null, indentation)},`\n        })\n        .join('\\n')\n    }\n  }\n\n  return undefined\n}\n\nexport function isEditingSelection(\n  selection: JSONSelection | undefined\n): selection is EditKeySelection | EditValueSelection {\n  return (\n    (isKeySelection(selection) || isValueSelection(selection)) &&\n    (selection as Record<string, unknown>).edit === true\n  )\n}\n\n/**\n * Create a selection which selects the root of the document\n */\n// TODO: write unit tests\nexport function selectAll(): JSONSelection {\n  return createValueSelection([])\n}\n\n// TODO: write unit tests\nexport function hasSelectionContents(selection: JSONSelection | undefined): boolean {\n  return isKeySelection(selection) || isValueSelection(selection) || isMultiSelection(selection)\n}\n\n/**\n * Test whether the current selection can be converted.\n * That is the case when the selection is a key/value, or a multi selection with only one path\n */\nexport function canConvert(selection: JSONSelection | undefined): boolean {\n  return (\n    isKeySelection(selection) ||\n    isValueSelection(selection) ||\n    isMultiSelectionWithOneItem(selection)\n  )\n}\n\n// TODO: unit test\n// eslint-disable-next-line consistent-return\nexport function fromCaretPosition(caretPosition: CaretPosition): JSONSelection {\n  switch (caretPosition.type) {\n    case CaretType.key:\n      return createKeySelection(caretPosition.path)\n    case CaretType.value:\n      return createValueSelection(caretPosition.path)\n    case CaretType.after:\n      return createAfterSelection(caretPosition.path)\n    case CaretType.inside:\n      return createInsideSelection(caretPosition.path)\n  }\n}\n\n// TODO: unit test\n// eslint-disable-next-line consistent-return\nexport function fromSelectionType(selectionType: SelectionType, path: JSONPath): JSONSelection {\n  switch (selectionType) {\n    case SelectionType.key:\n      return createKeySelection(path)\n    case SelectionType.value:\n      return createValueSelection(path)\n    case SelectionType.after:\n      return createAfterSelection(path)\n    case SelectionType.inside:\n      return createInsideSelection(path)\n    case SelectionType.multi:\n    case SelectionType.text: // type `text` is not applicable, but we need to handle all types\n      return createMultiSelection(path, path)\n  }\n}\n\nexport function selectionIfOverlapping(\n  json: unknown | undefined,\n  selection: JSONSelection | undefined,\n  path: JSONPath\n): JSONSelection | undefined {\n  if (!selection) {\n    return undefined\n  }\n\n  if (pathInSelection(json, selection, path)) {\n    return selection\n  }\n\n  const sharedPath = isMultiSelection(selection) ? initial(selection.focusPath) : selection.path\n  if (pathStartsWith(sharedPath, path)) {\n    return selection\n  }\n\n  return undefined\n}\n\nexport function pathInSelection(\n  json: unknown | undefined,\n  selection: JSONSelection | undefined,\n  path: JSONPath\n): boolean {\n  if (json === undefined || !selection) {\n    return false\n  }\n\n  if (isKeySelection(selection) || isInsideSelection(selection) || isAfterSelection(selection)) {\n    return isEqual(selection.path, path)\n  }\n\n  if (isValueSelection(selection)) {\n    return pathStartsWith(path, selection.path)\n  }\n\n  if (isMultiSelection(selection)) {\n    const startPath = getStartPath(json, selection)\n    const endPath = getEndPath(json, selection)\n    const parentPath = initial(selection.focusPath)\n\n    if (!pathStartsWith(path, parentPath) || path.length <= parentPath.length) {\n      return false\n    }\n\n    const startIndex = getChildIndex(json, selection, startPath)\n    const endIndex = getChildIndex(json, selection, endPath)\n    const pathIndex = getChildIndex(json, selection, path)\n    return pathIndex !== -1 && pathIndex >= startIndex && pathIndex <= endIndex\n  }\n\n  return false\n}\n\nfunction getChildIndex(json: unknown, selection: MultiSelection, path: JSONPath): number {\n  const parentPath = initial(selection.focusPath)\n  if (!pathStartsWith(path, parentPath) || path.length <= parentPath.length) {\n    return -1\n  }\n\n  const key = path[parentPath.length]\n  const parent = getIn(json, parentPath)\n\n  if (isJSONObject(parent)) {\n    const keys = Object.keys(parent)\n    return keys.indexOf(key)\n  }\n\n  if (isJSONArray(parent)) {\n    const index = int(key)\n    if (index < parent.length) {\n      return index\n    }\n  }\n\n  return -1\n}\n\n// TODO: write some unit tests\nexport function getFocusPath(selection: JSONSelection): JSONPath {\n  return isMultiSelection(selection) ? selection.focusPath : selection.path\n}\n\n// TODO: write some unit tests\nexport function getAnchorPath(selection: JSONSelection): JSONPath {\n  return isMultiSelection(selection) ? selection.anchorPath : selection.path\n}\n","/**\n * A simplified version of https://github.com/JedWatson/classnames\n *\n * Example usage:\n *\n *     classnames('primary-button', { selected: true }, 'left')\n *\n */\nexport function classnames(...args: Array<string | Record<string, boolean> | undefined>): string {\n  const classes = []\n\n  for (const arg of args) {\n    if (typeof arg === 'string') {\n      classes.push(arg)\n    }\n\n    if (arg && typeof arg === 'object') {\n      for (const key in arg) {\n        if (Object.hasOwnProperty.call(arg, key) && arg[key]) {\n          classes.push(key)\n        }\n      }\n    }\n  }\n\n  return classes.join(' ')\n}\n","import { isUrl, valueType } from '$lib/utils/typeUtils.js'\nimport { type JSONParser, Mode } from '$lib/types.js'\nimport { classnames } from '$lib/utils/cssUtils.js'\n\nexport function getValueClass(value: unknown, mode: Mode, parser: JSONParser): string {\n  const type = valueType(value, parser)\n\n  return classnames('jse-value', 'jse-' + type, {\n    'jse-url': isUrl(value),\n    'jse-empty': typeof value === 'string' && value.length === 0,\n    'jse-table-cell': mode === Mode.table\n  })\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import { addNewLineSuffix, removeNewLineSuffix, setCursorToEnd } from '$lib/utils/domUtils.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { noop } from 'lodash-es'\n  import type { OnFind, OnPaste } from '$lib/types'\n  import { UpdateSelectionAfterChange } from '$lib/types'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  const debug = createDebug('jsoneditor:EditableDiv')\n\n  export let value: string\n  export let initialValue: string | undefined\n  export let shortText = false\n  export let label: string\n  export let onChange: (newValue: string, updateSelection: UpdateSelectionAfterChange) => void\n  export let onCancel: () => void\n  export let onFind: OnFind\n  export let onPaste: OnPaste = noop\n  export let onValueClass: (value: string) => string = () => ''\n\n  let domValue: HTMLDivElement | undefined\n  let valueClass: string\n  $: valueClass = onValueClass(value)\n  let closed = false\n\n  onMount(() => {\n    debug('onMount', { value, initialValue })\n    setDomValue(initialValue !== undefined ? initialValue : value)\n\n    // focus\n    if (domValue) {\n      setCursorToEnd(domValue)\n    }\n  })\n\n  onDestroy(() => {\n    const newValue = getDomValue()\n\n    debug('onDestroy', { closed, value, newValue })\n\n    if (!closed && newValue !== value) {\n      onChange(newValue, UpdateSelectionAfterChange.no)\n    }\n  })\n\n  function getDomValue(): string {\n    if (!domValue) {\n      return ''\n    }\n    return removeNewLineSuffix(domValue.innerText)\n  }\n\n  function setDomValue(updatedValue: string) {\n    if (!domValue) {\n      return\n    }\n    domValue.innerText = addNewLineSuffix(updatedValue)\n  }\n\n  function handleValueInput() {\n    const newValue = getDomValue()\n\n    if (newValue === '') {\n      // immediately update to clean up any left over <br/>\n      setDomValue('')\n    }\n\n    // update class\n    valueClass = onValueClass(newValue)\n  }\n\n  function handleCancel() {\n    // cancel changes (needed to prevent triggering a change onDestroy)\n    closed = true\n\n    onCancel()\n  }\n\n  function handleValueKeyDown(event: KeyboardEvent) {\n    event.stopPropagation()\n\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Escape') {\n      event.preventDefault()\n\n      handleCancel()\n    }\n\n    if (combo === 'Enter' || combo === 'Tab') {\n      // apply changes\n      event.preventDefault()\n\n      closed = true\n\n      const newValue = getDomValue()\n      onChange(newValue, UpdateSelectionAfterChange.nextInside)\n    }\n\n    if (combo === 'Ctrl+F') {\n      event.preventDefault()\n      onFind(false)\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      onFind(true)\n    }\n  }\n\n  function handleValuePaste(event: ClipboardEvent) {\n    event.stopPropagation()\n\n    if (!onPaste || !event.clipboardData) {\n      return\n    }\n\n    const clipboardText = event.clipboardData.getData('text/plain')\n    onPaste(clipboardText)\n  }\n\n  function handleBlur() {\n    const hasFocus = document.hasFocus()\n    const newValue = getDomValue()\n\n    debug('handleBlur', { hasFocus, closed, value, newValue })\n\n    // we only want to close the editable div when the focus did go to another\n    // element on the same page, but not when the user switches to another\n    // application or browser tab to copy/paste something whilst still editing\n    // the value, hence the check for document.hasFocus()\n    if (document.hasFocus() && !closed) {\n      closed = true\n      if (newValue !== value) {\n        onChange(newValue, UpdateSelectionAfterChange.self)\n      } else {\n        // Note that we do not fire an onCancel here: a blur action\n        // is caused by the user clicking somewhere else. If we apply\n        // onCancel now, we would override the selection that the user\n        // wants by clicking somewhere else in the editor (since `blur`\n        // is occurring *after* `mousedown`).\n      }\n    }\n  }\n</script>\n\n<div\n  role=\"textbox\"\n  aria-label={label}\n  tabindex=\"0\"\n  class={classnames('jse-editable-div', valueClass, { 'jse-short-text': shortText })}\n  contenteditable=\"true\"\n  spellcheck=\"false\"\n  on:input={handleValueInput}\n  on:keydown={handleValueKeyDown}\n  on:paste={handleValuePaste}\n  on:blur={handleBlur}\n  bind:this={domValue}\n></div>\n\n<style src=\"./EditableDiv.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import { isObjectOrArray, stringConvert } from '$lib/utils/typeUtils.js'\n  import { createValueSelection, getFocusPath, isEditingSelection } from '$lib/logic/selection.js'\n  import { getValueClass } from '$lib/plugins/value/components/utils/getValueClass.js'\n  import EditableDiv from '../../../components/controls/EditableDiv.svelte'\n  import {\n    type FindNextInside,\n    type JSONParser,\n    type JSONSelection,\n    Mode,\n    type OnFind,\n    type OnJSONSelect,\n    type OnPasteJson,\n    type OnPatch,\n    UpdateSelectionAfterChange,\n    type ValueNormalization\n  } from '$lib/types.js'\n  import { isEqual } from 'lodash-es'\n  import { expandSmart } from '$lib/logic/documentState'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let selection: JSONSelection | undefined\n  export let mode: Mode\n  export let parser: JSONParser\n  export let normalization: ValueNormalization\n  export let enforceString: boolean\n  export let onPatch: OnPatch\n  export let onPasteJson: OnPasteJson\n  export let onSelect: OnJSONSelect\n  export let onFind: OnFind\n  export let focus: () => void\n  export let findNextInside: FindNextInside\n\n  function convert(value: string): unknown {\n    return enforceString ? value : stringConvert(value, parser)\n  }\n\n  function handleChangeValue(newValue: string, updateSelection: UpdateSelectionAfterChange) {\n    onPatch(\n      [\n        {\n          op: 'replace',\n          path: compileJSONPointer(path),\n          value: convert(normalization.unescapeValue(newValue))\n        }\n      ],\n      (_, patchedState, patchedSelection) => {\n        // Leave the selection as is when it is no longer the path that we were editing here\n        // This happens for example when the user clicks or double-clicks on another value\n        // whilst editing a value\n        if (patchedSelection && !isEqual(path, getFocusPath(patchedSelection))) {\n          return undefined\n        }\n\n        const selection =\n          updateSelection === UpdateSelectionAfterChange.nextInside\n            ? findNextInside(path)\n            : createValueSelection(path)\n\n        return {\n          state: patchedState,\n          selection\n        }\n      }\n    )\n\n    focus()\n  }\n\n  function handleCancelChange() {\n    onSelect(createValueSelection(path))\n    focus()\n  }\n\n  function handlePaste(pastedText: string): void {\n    try {\n      const pastedJson = parser.parse(pastedText)\n      if (isObjectOrArray(pastedJson)) {\n        onPasteJson({\n          path,\n          contents: pastedJson,\n          onPasteAsJson: () => {\n            // exit edit mode\n            handleCancelChange()\n\n            // replace the value with the JSON object/array\n            const operations: JSONPatchDocument = [\n              {\n                op: 'replace',\n                path: compileJSONPointer(path),\n                value: pastedJson\n              }\n            ]\n\n            onPatch(operations, (patchedJson, patchedState) => ({\n              state: expandSmart(patchedJson, patchedState, path)\n            }))\n          }\n        })\n      }\n    } catch {\n      // silently ignore: thee pasted text is no valid JSON object or array,\n      // no need to do anything\n    }\n  }\n\n  function handleOnValueClass(value: string): string {\n    return getValueClass(convert(normalization.unescapeValue(value)), mode, parser)\n  }\n</script>\n\n<EditableDiv\n  value={normalization.escapeValue(value)}\n  initialValue={isEditingSelection(selection) ? selection.initialValue : undefined}\n  label=\"Edit value\"\n  onChange={handleChangeValue}\n  onCancel={handleCancelChange}\n  onPaste={handlePaste}\n  {onFind}\n  onValueClass={handleOnValueClass}\n/>\n","import { cloneDeepWith, first, initial, isEmpty, isEqual, last, times } from 'lodash-es'\nimport {\n  compileJSONPointer,\n  existsIn,\n  getIn,\n  isJSONArray,\n  isJSONObject,\n  isJSONPatchMove,\n  isJSONPatchRemove,\n  isJSONPatchReplace,\n  type JSONPatchAdd,\n  type JSONPatchCopy,\n  type JSONPatchDocument,\n  type JSONPatchMove,\n  type JSONPatchOperation,\n  type JSONPath,\n  parseJSONPointer,\n  revertJSONPatch\n} from 'immutable-json-patch'\nimport { parseAndRepair, parseAndRepairOrUndefined, parsePartialJson } from '../utils/jsonUtils.js'\nimport { findUniqueName } from '../utils/stringUtils.js'\nimport { isObject, isObjectOrArray } from '../utils/typeUtils.js'\nimport { getNextKeys } from './documentState.js'\nimport {\n  createAfterSelection,\n  createInsideSelection,\n  createSelectionFromOperations,\n  createValueSelection,\n  getEndPath,\n  getFocusPath,\n  getParentPath,\n  getSelectionPaths,\n  getStartPath,\n  isAfterSelection,\n  isInsideSelection,\n  isKeySelection,\n  isMultiSelection,\n  isValueSelection,\n  pathStartsWith\n} from './selection.js'\nimport type { ClipboardValues, DragInsideAction, JSONParser, JSONSelection } from '$lib/types'\nimport { int } from '../utils/numberUtils.js'\n\n/**\n * Create a JSONPatch for an insert operation.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the inserted node in case of duplicating\n * and object property\n */\n// TODO: write tests\nexport function insertBefore(\n  json: unknown,\n  path: JSONPath,\n  values: ClipboardValues\n): JSONPatchDocument {\n  const parentPath = initial(path)\n  const parent = getIn(json, parentPath)\n\n  if (isJSONArray(parent)) {\n    // the path is parsed from a JSONPatch operation,\n    // so array indices are a string which we have to parse into a number\n    const offset = int(last(path) as string)\n    return values.map((entry, index) => ({\n      op: 'add',\n      path: compileJSONPointer(parentPath.concat(String(offset + index))),\n      value: entry.value\n    }))\n  } else if (isJSONObject(parent)) {\n    // 'object'\n    const afterKey = last(path)\n    const keys = Object.keys(parent)\n    const nextKeys = afterKey !== undefined ? getNextKeys(keys, afterKey, true) : []\n\n    return [\n      // insert new values\n      ...values.map((entry) => {\n        const newProp = findUniqueName(entry.key, keys)\n        return {\n          op: 'add',\n          path: compileJSONPointer(parentPath.concat(newProp)),\n          value: entry.value\n        } as JSONPatchAdd\n      }),\n\n      // move all lower down keys so the inserted key will maintain its position\n      ...nextKeys.map((key) => moveDown(parentPath, key))\n    ]\n  } else {\n    throw new Error('Cannot create insert operations: parent must be an Object or Array')\n  }\n}\n\n/**\n * Create a JSONPatch for an append operation. The values will be appended\n * to the end of the array or object.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the inserted node in case of duplicating\n * and object property\n */\nexport function append(json: unknown, path: JSONPath, values: ClipboardValues): JSONPatchDocument {\n  const parent = getIn(json, path)\n\n  if (Array.isArray(parent)) {\n    const offset = parent.length\n    return values.map((entry, index) => ({\n      op: 'add',\n      path: compileJSONPointer(path.concat(String(offset + index))),\n      value: entry.value\n    }))\n  } else {\n    // 'object'\n    return values.map((entry) => {\n      const newProp = findUniqueName(entry.key, Object.keys(parent as Record<string, unknown>))\n      return {\n        op: 'add',\n        path: compileJSONPointer(path.concat(newProp)),\n        value: entry.value\n      }\n    })\n  }\n}\n\n/**\n * Rename an object key\n * Not applicable to arrays\n */\nexport function rename(\n  parentPath: JSONPath,\n  keys: string[],\n  oldKey: string,\n  newKey: string\n): JSONPatchDocument {\n  const filteredKeys = keys.filter((key) => key !== oldKey)\n  const newKeyUnique = findUniqueName(newKey, filteredKeys)\n  const nextKeys = getNextKeys(keys, oldKey, false)\n\n  return [\n    // rename a key\n    {\n      op: 'move',\n      from: compileJSONPointer(parentPath.concat(oldKey)),\n      path: compileJSONPointer(parentPath.concat(newKeyUnique))\n    },\n\n    // move all lower down keys so the renamed key will maintain it's position\n    ...nextKeys.map((key) => moveDown(parentPath, key))\n  ]\n}\n\n/**\n * Create a JSONPatch for an insert operation.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the inserted node in case of duplicating\n * and object property\n */\nexport function replace(\n  json: unknown,\n  paths: JSONPath[],\n  values: ClipboardValues\n): JSONPatchDocument {\n  const firstPath = first(paths)\n  const parentPath = initial(firstPath)\n  const parent = getIn(json, parentPath)\n\n  if (isJSONArray(parent)) {\n    const firstPath = first(paths)\n    const offset = firstPath ? int(last(firstPath) as string) : 0\n\n    return [\n      // remove operations\n      ...removeAll(paths),\n\n      // insert operations\n      ...values.map((entry, index) => {\n        const operation: JSONPatchOperation = {\n          op: 'add',\n          path: compileJSONPointer(parentPath.concat(String(index + offset))),\n          value: entry.value\n        }\n\n        return operation\n      })\n    ]\n  } else if (isJSONObject(parent)) {\n    // parent is Object\n    // if we're going to replace an existing object with key \"a\" with a new\n    // key \"a\", we must not create a new unique name \"a (copy)\".\n    const lastPath = last(paths)\n    const parentPath = initial(lastPath)\n    const beforeKey = last(lastPath)\n    const keys: string[] = Object.keys(parent)\n    const nextKeys = beforeKey !== undefined ? getNextKeys(keys, beforeKey, false) : []\n    const removeKeys = new Set(paths.map((path) => last(path)))\n    const filteredKeys = keys.filter((key) => !removeKeys.has(key))\n\n    return [\n      // remove operations\n      ...removeAll(paths),\n\n      // insert operations\n      ...values.map((entry) => {\n        const newProp = findUniqueName(entry.key, filteredKeys)\n        return {\n          op: 'add',\n          path: compileJSONPointer(parentPath.concat(newProp)),\n          value: entry.value\n        } as JSONPatchAdd\n      }),\n\n      // move down operations\n      // move all lower down keys so the renamed key will maintain its position\n      ...nextKeys.map((key) => moveDown(parentPath, key))\n    ]\n  } else {\n    throw new Error('Cannot create replace operations: parent must be an Object or Array')\n  }\n}\n\n/**\n * Create a JSONPatch for a duplicate action.\n *\n * This function needs the current data in order to be able to determine\n * a unique property name for the duplicated node in case of duplicating\n * and object property\n */\nexport function duplicate(json: unknown, paths: JSONPath[]): JSONPatchDocument {\n  // FIXME: here we assume paths is sorted correctly, that's a dangerous assumption\n  const lastPath = last(paths)\n\n  if (isEmpty(lastPath)) {\n    throw new Error('Cannot duplicate root object')\n  }\n\n  const parentPath = initial(lastPath)\n  const beforeKey = last(lastPath)\n  const parent = getIn(json, parentPath)\n\n  if (isJSONArray(parent)) {\n    const lastPath = last(paths)\n    const offset = lastPath ? int(last(lastPath) as string) + 1 : 0\n\n    return [\n      // copy operations\n      ...paths.map((path, index) => {\n        const operation: JSONPatchOperation = {\n          op: 'copy',\n          from: compileJSONPointer(path),\n          path: compileJSONPointer(parentPath.concat(String(index + offset)))\n        }\n\n        return operation\n      })\n    ]\n  } else if (isJSONObject(parent)) {\n    // 'object'\n    const keys = Object.keys(parent)\n    const nextKeys = beforeKey !== undefined ? getNextKeys(keys, beforeKey, false) : []\n\n    return [\n      // copy operations\n      ...paths.map((path) => {\n        const prop = last(path) as string\n        const newProp = findUniqueName(prop, keys)\n\n        return {\n          op: 'copy',\n          from: compileJSONPointer(path),\n          path: compileJSONPointer(parentPath.concat(newProp))\n        } as JSONPatchCopy\n      }),\n\n      // move down operations\n      // move all lower down keys so the renamed key will maintain it's position\n      ...nextKeys.map((key) => moveDown(parentPath, key))\n    ]\n  } else {\n    throw new Error('Cannot create duplicate operations: parent must be an Object or Array')\n  }\n}\n\n/**\n * Create a JSONPatch for an extract action.\n */\n// TODO: write unit tests\nexport function extract(json: unknown, selection: JSONSelection): JSONPatchDocument {\n  if (isValueSelection(selection)) {\n    return [\n      {\n        op: 'move',\n        from: compileJSONPointer(selection.path),\n        path: ''\n      }\n    ]\n  }\n\n  if (isMultiSelection(selection)) {\n    const parentPath = initial(selection.focusPath)\n    const parent = getIn(json, parentPath)\n\n    if (isJSONArray(parent)) {\n      const value = getSelectionPaths(json, selection).map((path) => {\n        const index = int(last(path) as string)\n        return parent[index]\n      })\n\n      return [\n        {\n          op: 'replace',\n          path: '',\n          value\n        }\n      ]\n    } else if (isJSONObject(parent)) {\n      // object\n      const value: Record<string, unknown> = {}\n      getSelectionPaths(json, selection).forEach((path) => {\n        const key = String(last(path))\n        value[key] = parent[key]\n      })\n\n      return [\n        {\n          op: 'replace',\n          path: '',\n          value\n        }\n      ]\n    }\n  } else {\n    throw new Error('Cannot create extract operations: parent must be an Object or Array')\n  }\n\n  // this should never happen\n  throw new Error('Cannot extract: unsupported type of selection ' + JSON.stringify(selection))\n}\n\n// TODO: write unit tests\nexport function insert(\n  json: unknown,\n  selection: JSONSelection | undefined,\n  clipboardText: string,\n  parser: JSONParser\n): JSONPatchDocument {\n  if (isKeySelection(selection)) {\n    // rename key\n    const clipboard = parseAndRepairOrUndefined(clipboardText, parser)\n    const parentPath = initial(selection.path)\n    const parent = getIn(json, parentPath)\n    const keys = Object.keys(parent as Record<string, unknown>)\n    const oldKey = last(selection.path) as string\n    const newKey = typeof clipboard === 'string' ? clipboard : clipboardText\n\n    return rename(parentPath, keys, oldKey, newKey)\n  }\n\n  if (\n    isValueSelection(selection) ||\n    (isMultiSelection(selection) && isEmpty(selection.focusPath)) // root selected\n  ) {\n    // replace selected value (new value can be primitive or an array/object with contents)\n    try {\n      return [\n        {\n          op: 'replace',\n          path: compileJSONPointer(getFocusPath(selection)),\n          value: parsePartialJson(clipboardText, (text) => parseAndRepair(text, parser))\n        }\n      ]\n    } catch {\n      // parsing failed -> just paste the raw text as value\n      return [\n        {\n          op: 'replace',\n          path: compileJSONPointer(getFocusPath(selection)),\n          value: clipboardText\n        }\n      ]\n    }\n  }\n\n  if (isMultiSelection(selection)) {\n    const newValues = clipboardToValues(clipboardText, parser)\n\n    return replace(json, getSelectionPaths(json, selection), newValues)\n  }\n\n  if (isAfterSelection(selection)) {\n    const newValues = clipboardToValues(clipboardText, parser)\n    const path = selection.path\n    const parentPath = initial(path)\n    const parent = getIn(json, parentPath)\n\n    if (isJSONArray(parent)) {\n      const index = int(last(path) as string)\n      const nextItemPath = parentPath.concat(String(index + 1))\n\n      return insertBefore(json, nextItemPath, newValues)\n    } else if (isJSONObject(parent)) {\n      // value is an Object\n      const key = String(last(path))\n      const keys: string[] = Object.keys(parent)\n      if (isEmpty(keys) || last(keys) === key) {\n        return append(json, parentPath, newValues)\n      } else {\n        const index = keys.indexOf(key)\n        const nextKey = keys[index + 1]\n        const nextKeyPath = parentPath.concat(nextKey)\n\n        return insertBefore(json, nextKeyPath, newValues)\n      }\n    } else {\n      throw new Error('Cannot create insert operations: parent must be an Object or Array')\n    }\n  }\n\n  if (isInsideSelection(selection)) {\n    const newValues = clipboardToValues(clipboardText, parser)\n    const path = selection.path\n    const value = getIn(json, path)\n\n    if (isJSONArray(value)) {\n      const firstItemPath = path.concat('0')\n      return insertBefore(json, firstItemPath, newValues)\n    } else if (isJSONObject(value)) {\n      // value is an Object\n      const keys = Object.keys(value)\n      if (isEmpty(keys)) {\n        return append(json, path, newValues)\n      } else {\n        const firstKey = first(keys) as string\n        const firstKeyPath = path.concat(firstKey)\n\n        return insertBefore(json, firstKeyPath, newValues)\n      }\n    } else {\n      throw new Error('Cannot create insert operations: parent must be an Object or Array')\n    }\n  }\n\n  // this should never happen\n  throw new Error('Cannot insert: unsupported type of selection ' + JSON.stringify(selection))\n}\n\nexport function moveInsideParent(\n  json: unknown,\n  selection: JSONSelection | undefined,\n  dragInsideAction: DragInsideAction\n): JSONPatchDocument {\n  if (!selection) {\n    return []\n  }\n\n  const beforePath = 'beforePath' in dragInsideAction ? dragInsideAction['beforePath'] : undefined\n  const append = 'append' in dragInsideAction ? dragInsideAction['append'] : undefined\n\n  const parentPath = initial(getFocusPath(selection))\n  const parent = getIn(json, parentPath)\n\n  if (\n    !append &&\n    !(beforePath && pathStartsWith(beforePath, parentPath) && beforePath.length > parentPath.length)\n  ) {\n    return []\n  }\n\n  const startPath = getStartPath(json, selection)\n  const endPath = getEndPath(json, selection)\n  const startKey = last(startPath) as string\n  const endKey = last(endPath) as string\n  const toKey: string | undefined = beforePath ? beforePath[parentPath.length] : undefined\n\n  if (isJSONObject(parent)) {\n    const keys = Object.keys(parent)\n    const startIndex = keys.indexOf(startKey)\n    const endIndex = keys.indexOf(endKey)\n    const toIndex = append ? keys.length : toKey !== undefined ? keys.indexOf(toKey) : -1\n\n    if (startIndex !== -1 && endIndex !== -1 && toIndex !== -1) {\n      if (toIndex > startIndex) {\n        // moving down\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return [...keys.slice(startIndex, endIndex + 1), ...keys.slice(toIndex, keys.length)].map(\n          (key) => moveDown(parentPath, key)\n        )\n      } else {\n        // moving up\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return [...keys.slice(toIndex, startIndex), ...keys.slice(endIndex + 1, keys.length)].map(\n          (key) => moveDown(parentPath, key)\n        )\n      }\n    }\n  } else if (isJSONArray(parent)) {\n    // array\n    const startIndex = int(startKey)\n    const endIndex = int(endKey)\n    const toIndex = toKey !== undefined ? int(toKey) : parent.length\n    const count = endIndex - startIndex + 1\n\n    if (toIndex < startIndex) {\n      // move up\n      return times(count, (offset) => {\n        return {\n          op: 'move',\n          from: compileJSONPointer(parentPath.concat(String(startIndex + offset))),\n          path: compileJSONPointer(parentPath.concat(String(toIndex + offset)))\n        }\n      })\n    } else {\n      // move down\n      return times(count, () => {\n        return {\n          op: 'move',\n          from: compileJSONPointer(parentPath.concat(String(startIndex))),\n          path: compileJSONPointer(parentPath.concat(String(toIndex)))\n        }\n      })\n    }\n  } else {\n    throw new Error('Cannot create move operations: parent must be an Object or Array')\n  }\n\n  return []\n}\n\nexport function createNewValue(\n  json: unknown | undefined,\n  selection: JSONSelection | undefined,\n  valueType: 'object' | 'array' | 'structure' | 'value'\n): unknown {\n  if (valueType === 'object') {\n    return {}\n  }\n\n  if (valueType === 'array') {\n    return []\n  }\n\n  if (valueType === 'structure' && json !== undefined) {\n    const parentPath = selection ? getParentPath(selection) : []\n    const parent = getIn(json, parentPath)\n\n    if (Array.isArray(parent) && !isEmpty(parent)) {\n      const jsonExample = first(parent)\n      if (isObjectOrArray(jsonExample)) {\n        return cloneDeepWith(jsonExample, (value) => {\n          return Array.isArray(value)\n            ? []\n            : isObject(value)\n              ? undefined // leave object as is, will recurse into it\n              : ''\n        })\n      } else {\n        // just a primitive value\n        return ''\n      }\n    }\n  }\n\n  // type === value,\n  // or type === structure but the parent is no array or an array containing\n  // primitive values (and no objects having any structure).\n  return ''\n}\n\n/**\n * Create a JSONPatch for a remove operation\n */\nexport function remove(path: JSONPath): JSONPatchDocument {\n  return [\n    {\n      op: 'remove',\n      path: compileJSONPointer(path)\n    }\n  ]\n}\n\n/**\n * Create a JSONPatch for a multiple remove operation\n */\nexport function removeAll(paths: JSONPath[]): JSONPatchDocument {\n  return paths\n    .map((path) => {\n      const operation: JSONPatchOperation = {\n        op: 'remove',\n        path: compileJSONPointer(path)\n      }\n\n      return operation\n    })\n    .reverse() // reverse is needed for arrays: delete the last index first\n}\n\n// helper function to move a key down in an object,\n// so another key can get positioned before the moved down keys\nfunction moveDown(parentPath: JSONPath, key: string): JSONPatchOperation {\n  return {\n    op: 'move',\n    from: compileJSONPointer(parentPath.concat(key)),\n    path: compileJSONPointer(parentPath.concat(key))\n  }\n}\n\nexport function clipboardToValues(clipboardText: string, parser: JSONParser): ClipboardValues {\n  const textIsObject = /^\\s*{/.test(clipboardText)\n  const textIsArray = /^\\s*\\[/.test(clipboardText)\n\n  const clipboardOriginal = parseAndRepairOrUndefined(clipboardText, parser)\n  const clipboardRepaired =\n    clipboardOriginal !== undefined\n      ? clipboardOriginal\n      : parsePartialJson(clipboardText, (text) => parseAndRepair(text, parser))\n\n  if (\n    (textIsObject && isObject(clipboardRepaired)) ||\n    (textIsArray && Array.isArray(clipboardRepaired))\n  ) {\n    return [{ key: 'New item', value: clipboardRepaired }]\n  }\n\n  if (Array.isArray(clipboardRepaired)) {\n    return clipboardRepaired.map((value, index) => {\n      return { key: 'New item ' + index, value }\n    })\n  }\n\n  if (isObject(clipboardRepaired)) {\n    return Object.keys(clipboardRepaired).map((key) => {\n      return { key, value: clipboardRepaired[key] }\n    })\n  }\n\n  // regular value\n  return [{ key: 'New item', value: clipboardRepaired }]\n}\n\n// TODO: write unit tests\nexport function createRemoveOperations(\n  json: unknown,\n  selection: JSONSelection\n): { newSelection: JSONSelection | undefined; operations: JSONPatchDocument } {\n  if (isKeySelection(selection)) {\n    // FIXME: DOESN'T work yet\n    const parentPath = initial(selection.path)\n    const parent = getIn(json, parentPath)\n    const keys = Object.keys(parent as Record<string, unknown>)\n    const oldKey = last(selection.path) as string\n    const newKey = ''\n\n    const operations = rename(parentPath, keys, oldKey, newKey)\n    const newSelection = createSelectionFromOperations(json, operations)\n\n    return { operations, newSelection }\n  }\n\n  if (isValueSelection(selection)) {\n    const operations: JSONPatchDocument = [\n      {\n        op: 'replace',\n        path: compileJSONPointer(selection.path),\n        value: ''\n      }\n    ]\n\n    return { operations, newSelection: selection }\n  }\n\n  if (isMultiSelection(selection)) {\n    const paths = getSelectionPaths(json, selection)\n    const operations = removeAll(paths)\n    const lastPath = last(paths)\n\n    if (isEmpty(lastPath)) {\n      // there is no parent, this is the root document\n      const operations: JSONPatchDocument = [{ op: 'replace', path: '', value: '' }]\n\n      const newSelection = createValueSelection([])\n\n      return { operations, newSelection }\n    }\n\n    const parentPath = initial(lastPath)\n    const parent = getIn(json, parentPath)\n\n    if (isJSONArray(parent)) {\n      const firstPath = first(paths)\n      const index = int(last(firstPath) as string)\n      const newSelection =\n        index === 0\n          ? createInsideSelection(parentPath)\n          : createAfterSelection(parentPath.concat(String(index - 1)))\n\n      return { operations, newSelection }\n    } else if (isJSONObject(parent)) {\n      // parent is object\n      const keys = Object.keys(parent)\n      const firstPath = first(paths)\n      const key = last(firstPath) as string\n      const index = keys.indexOf(key)\n      const previousKey = keys[index - 1]\n      const newSelection =\n        index === 0\n          ? createInsideSelection(parentPath)\n          : createAfterSelection(parentPath.concat(previousKey))\n\n      return { operations, newSelection }\n    } else {\n      throw new Error('Cannot create remove operations: parent must be an Object or Array')\n    }\n  }\n\n  // this should never happen\n  throw new Error('Cannot remove: unsupported type of selection ' + JSON.stringify(selection))\n}\n\nexport function revertJSONPatchWithMoveOperations(\n  json: unknown,\n  operations: JSONPatchDocument\n): JSONPatchDocument {\n  // first, we merge series of move operations inside an object. These move operations are used\n  // to ensure a specific ordering of the keys in the object. Reverting those move events one by\n  // one would explode the amount of move operations in the revert operations and contain mostly\n  // duplicates.\n  const filteredOperations = _filterRedundantMoveOperations(json, operations)\n\n  return revertJSONPatch(json, filteredOperations, {\n    before: (json, operation, revertOperations) => {\n      if (isJSONPatchRemove(operation)) {\n        // we must restore the key order when reverting removing of an object key\n        const path = parseJSONPointer(operation.path)\n        return {\n          revertOperations: [...revertOperations, ...createRevertMoveOperations(json, path)]\n        }\n      }\n\n      if (isJSONPatchMove(operation)) {\n        const from = parseJSONPointer(operation.from)\n        return {\n          revertOperations:\n            operation.from === operation.path\n              ? [operation, ...createRevertMoveOperations(json, from)] // move in-place (just for re-ordering object keys)\n              : [...revertOperations, ...createRevertMoveOperations(json, from)]\n        }\n      }\n\n      return { document: json }\n    }\n  })\n}\n\n/**\n * Filter move operations which are redundant when creating the reverse patch operations.\n *\n * This is a preprocessing step for creating the revert patch operations. For example, having\n * json {b:2, a:1, c:3} and the following move operations (this will reorder the keys):\n *\n *     [\n *       { op: 'move', from: '/a', path: '/a' },\n *       { op: 'move', from: '/b', path: '/b' },\n *       { op: 'move', from: '/c', path: '/c' }\n *     ]\n *\n * This function will return only moving of b, since that is the first of all the moved keys:\n *\n *     [\n *       { op: 'move', from: '/b', path: '/b' }\n *     ]\n *\n * So, when creating the reverse operations, this single operation is enough to create the needed\n * move operations for all lower down keys to restore the original order of the keys.\n */\nfunction _filterRedundantMoveOperations(\n  json: unknown,\n  operations: JSONPatchOperation[]\n): JSONPatchOperation[] {\n  // check whether this is a set of move operations (cheap check)\n  if (isEmpty(operations) || !operations.every(isJSONPatchMove)) {\n    return operations\n  }\n\n  // parse the JSON pointers once and split them in parent paths and keys\n  const processedOps: ProcessedOperation[] = []\n  for (const operation of operations) {\n    const from = splitParentKey(parseJSONPointer(operation.from))\n    const path = splitParentKey(parseJSONPointer(operation.path))\n    if (!from || !path) {\n      return operations\n    }\n    processedOps.push({ from, path, operation })\n  }\n\n  // check whether the first movement is inside an object (and not an array)\n  const parentPath = processedOps[0].path.parent\n  const parent = getIn(json, parentPath)\n  if (!isJSONObject(parent)) {\n    return operations\n  }\n\n  // check whether all movements are within the same parent object\n  if (!processedOps.every((op) => _equalParentPath(op, parentPath))) {\n    return operations\n  }\n\n  const firstKey = _findKeyWithLowestKeyIndex(processedOps, json)\n  const getOperation = (op: ProcessedOperation) => op.operation\n\n  // only return the operation moving the firstKey back, and all rename operations\n  const renameOps = processedOps.filter((op) => op.operation.from !== op.operation.path)\n  return renameOps.some((op) => op.path.key === firstKey)\n    ? renameOps.map(getOperation) // no need to add the firstKey move operation\n    : [moveDown(parentPath, firstKey), ...renameOps.map(getOperation)]\n}\n\ninterface ParentKey {\n  parent: string[]\n  key: string\n}\n\ninterface ProcessedOperation {\n  from: ParentKey\n  path: ParentKey\n  operation: JSONPatchMove\n}\n\nfunction splitParentKey(path: JSONPath): ParentKey | undefined {\n  return path.length > 0 ? { parent: initial(path), key: last(path) as string } : undefined\n}\n\n/**\n * Test whether a move operation has a specific parent path for both `from` and `path`\n */\nfunction _equalParentPath(\n  operation: ProcessedOperation,\n  parentPath: JSONPath | undefined\n): boolean {\n  return isEqual(operation.from.parent, parentPath) && isEqual(operation.path.parent, parentPath)\n}\n\nfunction _findKeyWithLowestKeyIndex(processedOps: ProcessedOperation[], json: unknown): string {\n  const keys = Object.keys(json as Record<string, unknown>)\n  const movedKeys = keys.slice()\n\n  // first execute all move operations on the list with keys\n  // here we assume all move operations have the same parent and are keys in an object\n  for (const op of processedOps) {\n    const index = movedKeys.indexOf(op.from.key)\n    if (index !== -1) {\n      movedKeys.splice(index, 1)\n      movedKeys.push(op.path.key)\n    }\n  }\n\n  // find the first changed key\n  let i = 0\n  while (i < keys.length && keys[i] === movedKeys[i]) {\n    i++\n  }\n\n  return movedKeys[i]\n}\n\nfunction createRevertMoveOperations(json: unknown, path: JSONPath): JSONPatchOperation[] {\n  const parentPath = initial(path)\n  const afterKey = last(path) as string\n  const parent = getIn(json, parentPath)\n  if (isJSONObject(parent)) {\n    const keys = Object.keys(parent)\n    const nextKeys = getNextKeys(keys, afterKey, false)\n\n    // move all lower down keys so the inserted key will maintain its position\n    return nextKeys.map((key) => moveDown(parentPath, key))\n  }\n\n  return []\n}\n\n/**\n * Add operations to create parent objects when missing before replacing a nested value\n */\nexport function createNestedValueOperations(operations: JSONPatchOperation[], json: unknown) {\n  return operations.flatMap((operation) => {\n    if (isJSONPatchReplace(operation)) {\n      const path = parseJSONPointer(operation.path)\n      if (path.length > 0) {\n        const extendedOperations: JSONPatchOperation[] = [operation]\n\n        let parentPath = initial(path)\n        while (parentPath.length > 0 && !existsIn(json, parentPath)) {\n          extendedOperations.unshift({\n            op: 'add',\n            path: compileJSONPointer(parentPath),\n            value: {}\n          })\n\n          parentPath = initial(parentPath)\n        }\n\n        return extendedOperations\n      }\n    }\n\n    return operation\n  })\n}\n","import type { JSONPatchDocument, JSONPatchOperation, JSONPath } from 'immutable-json-patch'\nimport { compileJSONPointer, getIn, isJSONArray, isJSONObject } from 'immutable-json-patch'\nimport { forEachRight, initial, isEqual, last } from 'lodash-es'\nimport { getEnforceString, updateInRecursiveState } from './documentState.js'\nimport { createSelectionFromOperations } from './selection.js'\nimport { rename } from './operations.js'\nimport { stringConvert } from '../utils/typeUtils.js'\nimport type {\n  DocumentState,\n  ExtendedSearchResultItem,\n  JSONParser,\n  JSONSelection,\n  RecursiveStateFactory,\n  SearchOptions,\n  SearchResultDetails,\n  SearchResultItem,\n  SearchResults\n} from '$lib/types'\nimport { SearchField } from '$lib/types.js'\nimport {\n  hasSearchResults,\n  isArrayRecursiveState,\n  isObjectRecursiveState\n} from 'svelte-jsoneditor/typeguards.js'\n\n// TODO: comment\n// TODO: unit test\nexport function updateSearchResult(\n  newResultItems: SearchResultItem[],\n  previousResult: SearchResultDetails | undefined\n): SearchResultDetails {\n  const activePath = previousResult?.activeItem\n    ? getSearchResultPath(previousResult.activeItem)\n    : undefined\n\n  const matchingActiveIndex = newResultItems.findIndex((item) => {\n    return isEqual(activePath, getSearchResultPath(item))\n  })\n\n  const activeIndex =\n    matchingActiveIndex !== -1\n      ? matchingActiveIndex\n      : previousResult?.activeIndex !== undefined &&\n          previousResult?.activeIndex < newResultItems.length\n        ? previousResult?.activeIndex\n        : newResultItems.length > 0\n          ? 0\n          : -1\n\n  const items: ExtendedSearchResultItem[] = newResultItems.map((item, resultIndex) => {\n    return { resultIndex, ...item, active: resultIndex === activeIndex }\n  })\n\n  const activeItem = items[activeIndex]\n\n  return {\n    items,\n    activeItem,\n    activeIndex\n  }\n}\n\n// TODO: unit test\nexport function searchNext(searchResult: SearchResultDetails): SearchResultDetails {\n  const nextActiveIndex =\n    searchResult.activeIndex < searchResult.items.length - 1\n      ? searchResult.activeIndex + 1\n      : searchResult.items.length > 0\n        ? 0\n        : -1\n\n  const nextActiveItem = searchResult.items[nextActiveIndex]\n\n  const items: ExtendedSearchResultItem[] = searchResult.items.map((item, index) => {\n    return { ...item, active: index === nextActiveIndex }\n  })\n\n  return {\n    ...searchResult,\n    items,\n    activeItem: nextActiveItem,\n    activeIndex: nextActiveIndex\n  }\n}\n\n// TODO: unit test\nexport function searchPrevious(searchResult: SearchResultDetails): SearchResultDetails {\n  const previousActiveIndex =\n    searchResult.activeIndex > 0 ? searchResult.activeIndex - 1 : searchResult.items.length - 1\n\n  const previousActiveItem = searchResult.items[previousActiveIndex]\n\n  const items: ExtendedSearchResultItem[] = searchResult.items.map((item, index) => {\n    return { ...item, active: index === previousActiveIndex }\n  })\n\n  return {\n    ...searchResult,\n    items,\n    activeItem: previousActiveItem,\n    activeIndex: previousActiveIndex\n  }\n}\n\n// TODO: comment\nexport function search(\n  searchText: string,\n  json: unknown,\n  options: SearchOptions = {}\n): SearchResultItem[] {\n  const searchTextLowerCase = searchText.toLowerCase()\n  const maxResults = options?.maxResults ?? Infinity\n  const columns = options?.columns\n  const results: SearchResultItem[] = []\n  const path: JSONPath = [] // we reuse the same Array recursively, this is *much* faster than creating a new path every time\n\n  function onMatch(match: SearchResultItem) {\n    if (results.length >= maxResults) {\n      return\n    }\n\n    results.push(match)\n  }\n\n  function searchRecursive(searchTextLowerCase: string, value: unknown) {\n    if (isJSONArray(value)) {\n      const level = path.length\n      path.push('0')\n\n      for (let i = 0; i < value.length; i++) {\n        path[level] = String(i)\n\n        searchRecursive(searchTextLowerCase, value[i])\n\n        if (results.length >= maxResults) {\n          return\n        }\n      }\n\n      path.pop()\n    } else if (isJSONObject(value)) {\n      const keys = Object.keys(value)\n      const level = path.length\n\n      path.push('')\n\n      for (const key of keys) {\n        path[level] = key\n\n        findCaseInsensitiveMatches(key, searchTextLowerCase, path, SearchField.key, onMatch)\n\n        searchRecursive(searchTextLowerCase, value[key])\n\n        if (results.length >= maxResults) {\n          return\n        }\n      }\n\n      path.pop()\n    } else {\n      // type is a value\n      findCaseInsensitiveMatches(\n        String(value),\n        searchTextLowerCase,\n        path,\n        SearchField.value,\n        onMatch\n      )\n    }\n  }\n\n  if (searchText === '') {\n    return []\n  } else if (columns) {\n    if (!Array.isArray(json)) {\n      throw new Error('json must be an Array when option columns is defined')\n    }\n\n    for (let i = 0; i < json.length; i++) {\n      path[0] = String(i)\n\n      const item = json[i]\n\n      for (let c = 0; c < columns.length; c++) {\n        const column = columns[c]\n\n        if (column.length === 1) {\n          path[1] = column[0]\n        } else {\n          for (let p = 0; p < column.length; p++) {\n            path[p + 1] = column[p]\n          }\n        }\n        while (path.length > column.length + 1) {\n          path.pop()\n        }\n\n        const value = getIn(item, column)\n\n        searchRecursive(searchTextLowerCase, value)\n      }\n\n      if (results.length >= maxResults) {\n        break\n      }\n    }\n\n    return results\n  } else {\n    searchRecursive(searchTextLowerCase, json)\n    return results\n  }\n}\n\n/**\n * Do a case-insensitive search for a search text in a text\n */\nexport function findCaseInsensitiveMatches(\n  text: string,\n  searchTextLowerCase: string,\n  path: JSONPath,\n  field: SearchField,\n  onMatch: (searchResultItem: SearchResultItem) => void\n): void {\n  const textLower = text.toLowerCase()\n\n  let fieldIndex = 0\n  let position = -1\n  let index = -1\n\n  do {\n    index = textLower.indexOf(searchTextLowerCase, position)\n\n    if (index !== -1) {\n      position = index + searchTextLowerCase.length\n\n      onMatch({\n        path: path.slice(0), // path may be mutated in a later stage, therefore we store a copy\n        field,\n        fieldIndex,\n        start: index,\n        end: position\n      })\n\n      fieldIndex++\n    }\n  } while (index !== -1)\n}\n\n/**\n * Replace a search result item with a replacement text\n */\nexport function replaceText(text: string, replacementText: string, start: number, end: number) {\n  return text.substring(0, start) + replacementText + text.substring(end)\n}\n\n/**\n * Replace all matches with a replacement text\n */\nexport function replaceAllText(\n  text: string,\n  replacementText: string,\n  occurrences: Array<{ start: number; end: number }>\n): string {\n  let updatedText = text\n\n  forEachRight(occurrences, (occurrence) => {\n    updatedText = replaceText(updatedText, replacementText, occurrence.start, occurrence.end)\n  })\n\n  return updatedText\n}\n\nexport function createSearchAndReplaceOperations(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  replacementText: string,\n  searchResultItem: SearchResultItem,\n  parser: JSONParser\n): { newSelection: JSONSelection | undefined; operations: JSONPatchDocument } {\n  const { field, path, start, end } = searchResultItem\n\n  if (field === SearchField.key) {\n    // replace a key\n    const parentPath = initial(path)\n    const parent = getIn(json, parentPath)\n    const oldKey = last(path) as string\n    const keys = Object.keys(parent as Record<string, unknown>)\n    const newKey = replaceText(oldKey, replacementText, start, end)\n\n    const operations = rename(parentPath, keys, oldKey, newKey)\n    const newSelection = createSelectionFromOperations(json, operations)\n\n    return {\n      newSelection,\n      operations\n    }\n  } else if (field === SearchField.value) {\n    // replace a value\n    const currentValue: unknown | undefined = getIn(json, path)\n    if (currentValue === undefined) {\n      throw new Error(`Cannot replace: path not found ${compileJSONPointer(path)}`)\n    }\n    const currentValueText = typeof currentValue === 'string' ? currentValue : String(currentValue)\n\n    const enforceString = getEnforceString(json, documentState, path)\n    const value = replaceText(currentValueText, replacementText, start, end)\n\n    const operations: JSONPatchOperation[] = [\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: enforceString ? value : stringConvert(value, parser)\n      }\n    ]\n\n    const newSelection = createSelectionFromOperations(json, operations)\n\n    return {\n      newSelection,\n      operations\n    }\n  } else {\n    throw new Error(`Cannot replace: unknown type of search result field ${field}`)\n  }\n}\n\nexport function createSearchAndReplaceAllOperations(\n  json: unknown,\n  documentState: DocumentState | undefined,\n  searchText: string,\n  replacementText: string,\n  parser: JSONParser\n): { newSelection: JSONSelection | undefined; operations: JSONPatchDocument } {\n  // TODO: to improve performance, we could reuse existing search results (except when hitting a maxResult limit)\n  const searchResultItems = search(searchText, json, { maxResults: Infinity })\n\n  interface Match {\n    path: JSONPath\n    field: string\n    items: SearchResultItem[]\n  }\n\n  // step 1: deduplicate matches inside the same field/value\n  // (filter, map, and group)\n  const deduplicatedMatches: Match[] = []\n  for (let i = 0; i < searchResultItems.length; i++) {\n    const previousItem = searchResultItems[i - 1]\n    const item = searchResultItems[i]\n    if (i === 0 || item.field !== previousItem.field || !isEqual(item.path, previousItem.path)) {\n      deduplicatedMatches.push({\n        path: item.path,\n        field: item.field,\n        items: [item]\n      })\n    } else {\n      ;(last(deduplicatedMatches) as Match).items.push(item)\n    }\n  }\n\n  // step 2: sort from deepest nested to least nested\n  // this is needed to replace in that order because paths may change\n  // if there are replacements in keys\n  deduplicatedMatches.sort((a, b) => {\n    // sort values first, properties next\n    if (a.field !== b.field) {\n      if (a.field === SearchField.key) {\n        return 1\n      } else {\n        return -1\n      }\n    }\n\n    // sort longest paths first, shortest last\n    return b.path.length - a.path.length\n  })\n\n  // step 3: call createSearchAndReplaceOperations for each of the matches\n  let allOperations: JSONPatchDocument = []\n  let lastNewSelection: JSONSelection | undefined\n  deduplicatedMatches.forEach((match) => {\n    // TODO: there is overlap with the logic of createSearchAndReplaceOperations. Can we extract and reuse this logic?\n    const { field, path, items } = match\n\n    if (field === SearchField.key) {\n      // replace a key\n      const parentPath = initial(path)\n      const parent = getIn(json, parentPath)\n      const oldKey = last(path) as string\n      const keys = Object.keys(parent as Record<string, unknown>)\n      const newKey = replaceAllText(oldKey, replacementText, items)\n\n      const operations = rename(parentPath, keys, oldKey, newKey)\n      allOperations = allOperations.concat(operations)\n\n      lastNewSelection = createSelectionFromOperations(json, operations)\n    } else if (field === SearchField.value) {\n      // replace a value\n      const currentValue: unknown | undefined = getIn(json, path)\n      if (currentValue === undefined) {\n        throw new Error(`Cannot replace: path not found ${compileJSONPointer(path)}`)\n      }\n      const currentValueText =\n        typeof currentValue === 'string' ? currentValue : String(currentValue)\n      const enforceString = getEnforceString(json, documentState, path)\n      const value = replaceAllText(currentValueText, replacementText, items)\n\n      const operations: JSONPatchOperation[] = [\n        {\n          op: 'replace',\n          path: compileJSONPointer(path),\n          value: enforceString ? value : stringConvert(value, parser)\n        }\n      ]\n      allOperations = allOperations.concat(operations)\n\n      lastNewSelection = createSelectionFromOperations(json, operations)\n    } else {\n      throw new Error(`Cannot replace: unknown type of search result field ${field}`)\n    }\n  })\n\n  return {\n    operations: allOperations,\n    newSelection: lastNewSelection\n  }\n}\n\nexport interface SplitValuePart {\n  text: string\n  type: 'normal' | 'highlight'\n  resultIndex: number | undefined\n  active: boolean\n}\n\n/**\n * Split the text into separate parts for each search result and the text\n * in between.\n */\nexport function splitValue(text: string, matches: ExtendedSearchResultItem[]): SplitValuePart[] {\n  const parts: SplitValuePart[] = []\n\n  let previousEnd = 0\n\n  for (const match of matches) {\n    const precedingText = text.slice(previousEnd, match.start)\n    if (precedingText !== '') {\n      parts.push({\n        resultIndex: undefined,\n        type: 'normal',\n        text: precedingText,\n        active: false\n      })\n    }\n\n    const matchingText = text.slice(match.start, match.end)\n    parts.push({\n      resultIndex: match.resultIndex,\n      type: 'highlight',\n      text: matchingText,\n      active: match.active\n    })\n\n    previousEnd = match.end\n  }\n\n  const lastMatch = last(matches)\n  if (lastMatch && lastMatch.end < text.length) {\n    parts.push({\n      type: 'normal',\n      text: text.slice(lastMatch.end),\n      resultIndex: undefined,\n      active: false\n    })\n  }\n\n  return parts\n}\n\n/**\n * Get the path of the search result property on a nested search result\n */\nfunction getSearchResultPath(searchResultItem: SearchResultItem): JSONPath {\n  return searchResultItem.path.concat(searchResultItem.field, String(searchResultItem.fieldIndex))\n}\n\n/**\n * Filter key search results.\n * Returns a non-empty array, or undefined if there are no key search results\n */\nexport function filterKeySearchResults(\n  searchResult: SearchResults | undefined\n): ExtendedSearchResultItem[] | undefined {\n  const filtered = hasSearchResults(searchResult)\n    ? searchResult.searchResults.filter((result) => result.field === SearchField.key)\n    : undefined\n\n  return filtered && filtered.length > 0 ? filtered : undefined\n}\n\n/**\n * Filter value search results.\n * Returns a non-empty array, or undefined if there are no value search results\n */\nexport function filterValueSearchResults(\n  searchResult: SearchResults | undefined\n): ExtendedSearchResultItem[] | undefined {\n  const filtered = hasSearchResults(searchResult)\n    ? searchResult.searchResults.filter((result) => result.field === SearchField.value)\n    : undefined\n\n  return filtered && filtered.length > 0 ? filtered : undefined\n}\n\nexport const searchResultsFactory: RecursiveStateFactory = {\n  createObjectDocumentState: () => ({ type: 'object', properties: {} }),\n  createArrayDocumentState: () => ({ type: 'array', items: [] }),\n  createValueDocumentState: () => ({ type: 'value' })\n}\n\nexport function updateInSearchResults(\n  json: unknown,\n  searchResults: SearchResults | undefined,\n  path: JSONPath,\n  transform: (value: unknown, state: SearchResults) => SearchResults\n): SearchResults {\n  return updateInRecursiveState(json, searchResults, path, transform, searchResultsFactory)\n}\n\nexport function toRecursiveSearchResults(\n  json: unknown,\n  searchResultItems: ExtendedSearchResultItem[]\n): SearchResults | undefined {\n  return searchResultItems.reduce(\n    (recursiveState, searchResult) => {\n      return updateInSearchResults(json, recursiveState, searchResult.path, (_, nestedState) => ({\n        ...nestedState,\n        searchResults: nestedState.searchResults\n          ? nestedState.searchResults.concat(searchResult)\n          : [searchResult]\n      }))\n    },\n    undefined as SearchResults | undefined\n  )\n}\n\nexport function flattenSearchResults(node: SearchResults | undefined): ExtendedSearchResultItem[] {\n  const self = node?.searchResults ?? []\n\n  const nested = isObjectRecursiveState(node)\n    ? Object.values(node.properties).flatMap(flattenSearchResults)\n    : isArrayRecursiveState(node)\n      ? node.items.flatMap(flattenSearchResults)\n      : []\n\n  return self.concat(nested)\n}\n","<script lang=\"ts\">\n  import { splitValue } from '$lib/logic/search.js'\n  import { addNewLineSuffix } from '$lib/utils/domUtils.js'\n  import type { ExtendedSearchResultItem } from '$lib/types'\n\n  export let text: string\n  export let searchResultItems: ExtendedSearchResultItem[]\n\n  $: parts = splitValue(String(text), searchResultItems)\n</script>\n\n{#each parts as part}\n  {#if part.type === 'normal'}\n    {part.text}\n  {:else}\n    <span\n      class=\"jse-highlight\"\n      class:jse-active={part.active}\n      data-search-result-index={String(part.resultIndex)}>{addNewLineSuffix(part.text)}</span\n    >\n  {/if}\n{/each}\n\n<style src=\"./SearchResultHighlighter.scss\"></style>\n","/**\n * Return a human-readable document size\n * For example formatSize(7570718) outputs '7.6 MB'\n * This function uses 1000 for kilo (not 1024)\n * @param size\n * @return Returns a human-readable size\n */\nexport function formatSize(size: number): string {\n  const kilo = 1000\n  const factor = 0.9\n\n  if (size < factor * kilo) {\n    return size.toFixed() + ' B'\n  }\n\n  const KB = size / kilo\n  if (KB < factor * kilo) {\n    return KB.toFixed(1) + ' KB'\n  }\n\n  const MB = KB / kilo\n  if (MB < factor * kilo) {\n    return MB.toFixed(1) + ' MB'\n  }\n\n  const GB = MB / kilo\n  if (GB < factor * kilo) {\n    return GB.toFixed(1) + ' GB'\n  }\n\n  const TB = GB / kilo\n  return TB.toFixed(1) + ' TB'\n}\n","<script lang=\"ts\">\n  import type { Snippet } from 'svelte'\n\n  interface Props {\n    onclick?: () => void\n    children?: Snippet\n  }\n\n  const { onclick, children }: Props = $props()\n\n  const handleClick = $derived.by(() => {\n    return onclick\n      ? (event: MouseEvent) => {\n          event.preventDefault()\n          event.stopPropagation()\n          onclick()\n        }\n      : undefined\n  })\n</script>\n\n<button type=\"button\" class=\"jse-tag\" class:disabled={!onclick} onclick={handleClick}>\n  {@render children?.()}\n</button>\n\n<style lang=\"scss\">\n  @use '../../styles';\n  @use '../../themes/defaults';\n\n  .jse-tag {\n    border: none;\n    font-size: 80%;\n    font-family: defaults.$font-family;\n    color: defaults.$tag-color;\n    background: defaults.$tag-background;\n    border-radius: 2px;\n    cursor: pointer;\n    display: inline-block;\n    padding: 0 4px;\n    line-height: normal;\n    margin: 1px 0;\n\n    &:hover {\n      opacity: 0.8;\n    }\n\n    &.disabled {\n      opacity: 0.7;\n      cursor: inherit;\n    }\n  }\n</style>\n","/** @import { Snippet } from 'svelte' */\n/** @import { Effect, TemplateNode } from '#client' */\n/** @import { Getters } from '#shared' */\nimport { EFFECT_TRANSPARENT, ELEMENT_NODE } from '#client/constants';\nimport { branch, block, destroy_effect, teardown } from '../../reactivity/effects.js';\nimport {\n\tdev_current_component_function,\n\tset_dev_current_component_function\n} from '../../context.js';\nimport { hydrate_next, hydrate_node, hydrating } from '../hydration.js';\nimport { create_fragment_from_html } from '../reconciler.js';\nimport { assign_nodes } from '../template.js';\nimport * as w from '../../warnings.js';\nimport * as e from '../../errors.js';\nimport { DEV } from 'esm-env';\nimport { get_first_child, get_next_sibling } from '../operations.js';\nimport { noop } from '../../../shared/utils.js';\nimport { prevent_snippet_stringification } from '../../../shared/validate.js';\n\n/**\n * @template {(node: TemplateNode, ...args: any[]) => void} SnippetFn\n * @param {TemplateNode} node\n * @param {() => SnippetFn | null | undefined} get_snippet\n * @param {(() => any)[]} args\n * @returns {void}\n */\nexport function snippet(node, get_snippet, ...args) {\n\tvar anchor = node;\n\n\t/** @type {SnippetFn | null | undefined} */\n\t// @ts-ignore\n\tvar snippet = noop;\n\n\t/** @type {Effect | null} */\n\tvar snippet_effect;\n\n\tblock(() => {\n\t\tif (snippet === (snippet = get_snippet())) return;\n\n\t\tif (snippet_effect) {\n\t\t\tdestroy_effect(snippet_effect);\n\t\t\tsnippet_effect = null;\n\t\t}\n\n\t\tif (DEV && snippet == null) {\n\t\t\te.invalid_snippet();\n\t\t}\n\n\t\tsnippet_effect = branch(() => /** @type {SnippetFn} */ (snippet)(anchor, ...args));\n\t}, EFFECT_TRANSPARENT);\n\n\tif (hydrating) {\n\t\tanchor = hydrate_node;\n\t}\n}\n\n/**\n * In development, wrap the snippet function so that it passes validation, and so that the\n * correct component context is set for ownership checks\n * @param {any} component\n * @param {(node: TemplateNode, ...args: any[]) => void} fn\n */\nexport function wrap_snippet(component, fn) {\n\tconst snippet = (/** @type {TemplateNode} */ node, /** @type {any[]} */ ...args) => {\n\t\tvar previous_component_function = dev_current_component_function;\n\t\tset_dev_current_component_function(component);\n\n\t\ttry {\n\t\t\treturn fn(node, ...args);\n\t\t} finally {\n\t\t\tset_dev_current_component_function(previous_component_function);\n\t\t}\n\t};\n\n\tprevent_snippet_stringification(snippet);\n\n\treturn snippet;\n}\n\n/**\n * Create a snippet programmatically\n * @template {unknown[]} Params\n * @param {(...params: Getters<Params>) => {\n *   render: () => string\n *   setup?: (element: Element) => void | (() => void)\n * }} fn\n * @returns {Snippet<Params>}\n */\nexport function createRawSnippet(fn) {\n\t// @ts-expect-error the types are a lie\n\treturn (/** @type {TemplateNode} */ anchor, /** @type {Getters<Params>} */ ...params) => {\n\t\tvar snippet = fn(...params);\n\n\t\t/** @type {Element} */\n\t\tvar element;\n\n\t\tif (hydrating) {\n\t\t\telement = /** @type {Element} */ (hydrate_node);\n\t\t\thydrate_next();\n\t\t} else {\n\t\t\tvar html = snippet.render().trim();\n\t\t\tvar fragment = create_fragment_from_html(html);\n\t\t\telement = /** @type {Element} */ (get_first_child(fragment));\n\n\t\t\tif (DEV && (get_next_sibling(element) !== null || element.nodeType !== ELEMENT_NODE)) {\n\t\t\t\tw.invalid_raw_snippet_render();\n\t\t\t}\n\n\t\t\tanchor.before(element);\n\t\t}\n\n\t\tconst result = snippet.setup?.(element);\n\t\tassign_nodes(element, element);\n\n\t\tif (typeof result === 'function') {\n\t\t\tteardown(result);\n\t\t}\n\t};\n}\n","<script lang=\"ts\">\n  import { isUrl } from '$lib/utils/typeUtils.js'\n  import { createEditValueSelection } from '$lib/logic/selection.js'\n  import SearchResultHighlighter from '../../../components/modes/treemode/highlight/SearchResultHighlighter.svelte'\n  import { getValueClass } from './utils/getValueClass.js'\n  import { addNewLineSuffix } from '$lib/utils/domUtils.js'\n  import { type RenderValueProps } from '$lib/types.js'\n  import { isCtrlKeyDown } from 'svelte-jsoneditor/utils/keyBindings'\n  import { formatSize } from '$lib/utils/fileUtils'\n  import Tag from '../../../components/controls/Tag.svelte'\n\n  const {\n    path,\n    value,\n    mode,\n    truncateTextSize,\n    readOnly,\n    normalization,\n    parser,\n    onSelect,\n    searchResultItems\n  }: RenderValueProps = $props()\n\n  let doTruncate = $state(true)\n  const isTruncated = $derived(\n    doTruncate &&\n      typeof value === 'string' &&\n      value.length > truncateTextSize &&\n      (!searchResultItems ||\n        !searchResultItems.some((item) => item.active && item.end > truncateTextSize))\n  )\n  const truncatedValue = $derived(\n    isTruncated && typeof value === 'string' ? value.substring(0, truncateTextSize).trim() : value\n  )\n  const valueIsUrl = $derived(isUrl(value))\n\n  function handleValueClick(event: MouseEvent) {\n    if (typeof value === 'string' && valueIsUrl && isCtrlKeyDown(event)) {\n      event.preventDefault()\n      event.stopPropagation()\n\n      window.open(value, '_blank')\n    }\n  }\n\n  function handleValueDoubleClick(event: MouseEvent) {\n    if (!readOnly) {\n      event.preventDefault()\n      onSelect(createEditValueSelection(path))\n    }\n  }\n\n  function handleShowMore() {\n    doTruncate = false\n  }\n</script>\n\n<!-- svelte-ignore a11y_click_events_have_key_events -->\n<div\n  role=\"button\"\n  tabindex=\"-1\"\n  data-type=\"selectable-value\"\n  class={getValueClass(value, mode, parser)}\n  onclick={handleValueClick}\n  ondblclick={handleValueDoubleClick}\n  title={valueIsUrl ? 'Ctrl+Click or Ctrl+Enter to open url in new window' : undefined}\n>\n  {#if searchResultItems}\n    <SearchResultHighlighter text={normalization.escapeValue(truncatedValue)} {searchResultItems} />\n  {:else}\n    {addNewLineSuffix(normalization.escapeValue(truncatedValue))}\n  {/if}\n  {#if isTruncated && typeof value === 'string'}\n    <Tag onclick={handleShowMore}>\n      Show more ({formatSize(value.length)})\n    </Tag>\n  {/if}\n</div>\n\n<style src=\"./ReadonlyValue.scss\"></style>\n","<script lang=\"ts\">\n  export let text: string\n</script>\n\n<div class=\"jse-tooltip\">\n  {text}\n</div>\n\n<style src=\"./Tooltip.scss\"></style>\n","import Tooltip from './Tooltip.svelte'\nimport type { SvelteComponent } from 'svelte'\nimport type { AbsolutePopupOptions } from '$lib/types'\n\nexport interface TooltipOptions {\n  text: string\n  openAbsolutePopup: (\n    component: typeof SvelteComponent<Record<string, unknown>>,\n    props: Record<string, unknown>,\n    options: AbsolutePopupOptions\n  ) => number\n  closeAbsolutePopup: (popupId: number | undefined) => void\n}\n\nexport function tooltip(\n  node: Element,\n  { text, openAbsolutePopup, closeAbsolutePopup }: TooltipOptions\n) {\n  let popupId: number | undefined\n\n  function handleMouseEnter() {\n    const props = {\n      text\n    }\n\n    // opening popup will fail if there is already a popup open\n    popupId = openAbsolutePopup(Tooltip, props, {\n      position: 'top',\n      width: 10 * text.length, // rough estimate of the width of the message\n      offsetTop: 3,\n      anchor: node,\n      closeOnOuterClick: true\n    })\n  }\n\n  function handleMouseLeave() {\n    closeAbsolutePopup(popupId)\n  }\n\n  node.addEventListener('mouseenter', handleMouseEnter)\n  node.addEventListener('mouseleave', handleMouseLeave)\n\n  return {\n    destroy() {\n      node.removeEventListener('mouseenter', handleMouseEnter)\n      node.removeEventListener('mouseleave', handleMouseLeave)\n    }\n  }\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faClock } from '@fortawesome/free-regular-svg-icons'\n  import { getContext } from 'svelte'\n  import { tooltip } from '$lib/components/controls/tooltip/tooltip.js'\n  import type { AbsolutePopupContext } from '$lib/types'\n\n  const absolutePopupContext = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let value: number\n\n  $: text = `Time: ${new Date(value).toString()}`\n</script>\n\n<div class=\"jse-timestamp\" use:tooltip={{ text, ...absolutePopupContext }}>\n  <Icon data={faClock} />\n</div>\n\n<style src=\"./TimestampTag.scss\"></style>\n","import { isBoolean, isColor, isTimestamp } from '$lib/utils/typeUtils.js'\nimport type { RenderValueComponentDescription, RenderValueProps } from '$lib/types'\nimport BooleanToggle from './components/BooleanToggle.svelte'\nimport ColorPicker from './components/ColorPicker.svelte'\nimport EditableValue from './components/EditableValue.svelte'\nimport ReadonlyValue from './components/ReadonlyValue.svelte'\nimport TimestampTag from './components/TimestampTag.svelte'\n\nexport function renderValue(props: RenderValueProps): RenderValueComponentDescription[] {\n  const renderers: RenderValueComponentDescription[] = []\n\n  if (!props.isEditing && isBoolean(props.value)) {\n    renderers.push({ component: BooleanToggle, props })\n  }\n\n  if (!props.isEditing && isColor(props.value)) {\n    renderers.push({ component: ColorPicker, props })\n  }\n\n  if (props.isEditing) {\n    renderers.push({ component: EditableValue, props })\n  }\n\n  if (!props.isEditing) {\n    renderers.push({ component: ReadonlyValue, props })\n  }\n\n  if (!props.isEditing && isTimestamp(props.value)) {\n    renderers.push({ component: TimestampTag, props })\n  }\n\n  return renderers\n}\n","import { isEmpty } from 'lodash-es'\nimport type { JSONPath } from 'immutable-json-patch'\nimport type { PathOption } from '$lib/types.js'\n\n/**\n **\n * Stringify an array with a path like ['items', '3', 'name'] into string like 'items[3].name'\n * Note that we allow all characters in a property name, like \"item with spaces[3].name\",\n * so this path is not usable as-is in JavaScript.\n */\nexport function stringifyJSONPath(path: JSONPath): string {\n  return path\n    .map((p, index) => {\n      return integerNumberRegex.test(p)\n        ? '[' + p + ']'\n        : /[.[\\]]/.test(p) || p === '' // match any character . or [ or ] and handle an empty string\n          ? '[\"' + escapeQuotes(p) + '\"]'\n          : (index > 0 ? '.' : '') + p\n    })\n    .join('')\n}\n\nfunction escapeQuotes(prop: string): string {\n  return prop.replace(/\"/g, '\\\\\"')\n}\n\n/**\n * Parse a JSON path like 'items[3].name' into a path like ['items', '3', 'name']\n */\nexport function parseJSONPath(pathStr: string): JSONPath {\n  const path: JSONPath = []\n  let i = 0\n\n  while (i < pathStr.length) {\n    if (pathStr[i] === '.') {\n      i++\n    }\n\n    if (pathStr[i] === '[') {\n      i++\n\n      if (pathStr[i] === '\"') {\n        i++\n        path.push(parseProp((c) => c === '\"', true))\n        eatCharacter('\"')\n      } else {\n        path.push(parseProp((c) => c === ']'))\n      }\n\n      eatCharacter(']')\n    } else {\n      path.push(parseProp((c) => c === '.' || c === '['))\n    }\n  }\n\n  function parseProp(isEnd: (char: string) => boolean, unescape = false) {\n    let prop = ''\n\n    while (i < pathStr.length && !isEnd(pathStr[i])) {\n      if (unescape && pathStr[i] === '\\\\' && pathStr[i + 1] === '\"') {\n        // escaped double quote\n        prop += '\"'\n        i += 2\n      } else {\n        prop += pathStr[i]\n        i++\n      }\n    }\n\n    return prop\n  }\n\n  function eatCharacter(char: string) {\n    if (pathStr[i] !== char) {\n      throw new SyntaxError(`Invalid JSON path: ${char} expected at position ${i}`)\n    }\n    i++\n  }\n\n  return path\n}\n\n/**\n * Convert a JSONPath into an option for use in a select box\n */\nexport function pathToOption(path: JSONPath): PathOption {\n  return {\n    value: path,\n    label: isEmpty(path) ? '(item root)' : stringifyJSONPath(path)\n  }\n}\n\n/**\n * Stringify a JSON path into a lodash path like:\n *\n *     [\"data\", 2, \"nested property\", \"name\"]\n *\n * into a lodash path like:\n *\n *     \"data[2].nested.name\"\n *\n */\nexport function createLodashPropertySelector(path: JSONPath): string {\n  return path.length === 0\n    ? ''\n    : path.every((prop) => integerNumberRegex.test(prop) || javaScriptPropertyRegex.test(prop))\n      ? \"'\" + path.map(stringifyLodashProperty).join('').replace(/^\\./, '') + \"'\"\n      : JSON.stringify(path)\n}\n\n/**\n * Stringify a single property of a JSON path. See also createLodashPropertySelector\n */\nfunction stringifyLodashProperty(prop: string): string {\n  if (integerNumberRegex.test(prop)) {\n    return '[' + prop + ']'\n  } else if (javaScriptPropertyRegex.test(prop)) {\n    return '.' + prop\n  } else {\n    const propStr = JSON.stringify(prop)\n    // remove enclosing double quotes, and unescape escaped double quotes \\\"\n    const jsonPathStr = propStr.substring(1, propStr.length - 1).replace(/\\\\\"/g, '\"')\n    return \"['\" + jsonPathStr + \"']\"\n  }\n}\n\n/**\n * Create a JavaScript property selector\n *\n * Turn a paths like:\n *\n *   ['location', 'latitude']\n *   ['address', 'full name']\n *\n * into a JavaScript selector (string) like:\n *\n *   '?.location?.latitude'\n *   '?.address?.[\"full name\"]'\n */\nexport function createPropertySelector(path: JSONPath): string {\n  return path\n    .map((prop) => {\n      if (integerNumberRegex.test(prop)) {\n        // an index\n        return `?.[${prop}]`\n      } else if (javaScriptPropertyRegex.test(prop)) {\n        // a key without special characters\n        return `?.${prop}`\n      } else {\n        // a key that may have special characters (like spaces or so)\n        return `?.[${JSON.stringify(prop)}]`\n      }\n    })\n    .join('')\n}\n\n// https://developer.mozilla.org/en-US/docs/Glossary/Identifier\n// Note: We can extend this regex to allow unicode characters too.\n// I'm too lazy to figure that out right now\nconst javaScriptPropertyRegex = /^[a-zA-Z$_][a-zA-Z$_\\d]*$/\nconst integerNumberRegex = /^\\d+$/\n","import type { QueryLanguageOptions } from '$lib/types.js'\n\nexport interface TransformModalState {\n  queryLanguageId: string\n  queryOptions: QueryLanguageOptions\n  query: string\n  isManual: boolean\n}\n\nexport const transformModalStates: Record<string, TransformModalState> = {}\n\nexport interface TransformModalStateShared {\n  showWizard: boolean\n  showOriginal: boolean\n}\n\nexport const transformModalStateShared: TransformModalStateShared = {\n  showWizard: true,\n  showOriginal: true\n}\n","/**\n * Custom positioning reference element.\n * @see https://floating-ui.com/docs/virtual-elements\n */\n\nconst sides = ['top', 'right', 'bottom', 'left'];\nconst alignments = ['start', 'end'];\nconst placements = /*#__PURE__*/sides.reduce((acc, side) => acc.concat(side, side + \"-\" + alignments[0], side + \"-\" + alignments[1]), []);\nconst min = Math.min;\nconst max = Math.max;\nconst round = Math.round;\nconst floor = Math.floor;\nconst createCoords = v => ({\n  x: v,\n  y: v\n});\nconst oppositeSideMap = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nconst oppositeAlignmentMap = {\n  start: 'end',\n  end: 'start'\n};\nfunction clamp(start, value, end) {\n  return max(start, min(value, end));\n}\nfunction evaluate(value, param) {\n  return typeof value === 'function' ? value(param) : value;\n}\nfunction getSide(placement) {\n  return placement.split('-')[0];\n}\nfunction getAlignment(placement) {\n  return placement.split('-')[1];\n}\nfunction getOppositeAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\nfunction getAxisLength(axis) {\n  return axis === 'y' ? 'height' : 'width';\n}\nconst yAxisSides = /*#__PURE__*/new Set(['top', 'bottom']);\nfunction getSideAxis(placement) {\n  return yAxisSides.has(getSide(placement)) ? 'y' : 'x';\n}\nfunction getAlignmentAxis(placement) {\n  return getOppositeAxis(getSideAxis(placement));\n}\nfunction getAlignmentSides(placement, rects, rtl) {\n  if (rtl === void 0) {\n    rtl = false;\n  }\n  const alignment = getAlignment(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const length = getAxisLength(alignmentAxis);\n  let mainAlignmentSide = alignmentAxis === 'x' ? alignment === (rtl ? 'end' : 'start') ? 'right' : 'left' : alignment === 'start' ? 'bottom' : 'top';\n  if (rects.reference[length] > rects.floating[length]) {\n    mainAlignmentSide = getOppositePlacement(mainAlignmentSide);\n  }\n  return [mainAlignmentSide, getOppositePlacement(mainAlignmentSide)];\n}\nfunction getExpandedPlacements(placement) {\n  const oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeAlignmentPlacement(placement), oppositePlacement, getOppositeAlignmentPlacement(oppositePlacement)];\n}\nfunction getOppositeAlignmentPlacement(placement) {\n  return placement.replace(/start|end/g, alignment => oppositeAlignmentMap[alignment]);\n}\nconst lrPlacement = ['left', 'right'];\nconst rlPlacement = ['right', 'left'];\nconst tbPlacement = ['top', 'bottom'];\nconst btPlacement = ['bottom', 'top'];\nfunction getSideList(side, isStart, rtl) {\n  switch (side) {\n    case 'top':\n    case 'bottom':\n      if (rtl) return isStart ? rlPlacement : lrPlacement;\n      return isStart ? lrPlacement : rlPlacement;\n    case 'left':\n    case 'right':\n      return isStart ? tbPlacement : btPlacement;\n    default:\n      return [];\n  }\n}\nfunction getOppositeAxisPlacements(placement, flipAlignment, direction, rtl) {\n  const alignment = getAlignment(placement);\n  let list = getSideList(getSide(placement), direction === 'start', rtl);\n  if (alignment) {\n    list = list.map(side => side + \"-\" + alignment);\n    if (flipAlignment) {\n      list = list.concat(list.map(getOppositeAlignmentPlacement));\n    }\n  }\n  return list;\n}\nfunction getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, side => oppositeSideMap[side]);\n}\nfunction expandPaddingObject(padding) {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    ...padding\n  };\n}\nfunction getPaddingObject(padding) {\n  return typeof padding !== 'number' ? expandPaddingObject(padding) : {\n    top: padding,\n    right: padding,\n    bottom: padding,\n    left: padding\n  };\n}\nfunction rectToClientRect(rect) {\n  const {\n    x,\n    y,\n    width,\n    height\n  } = rect;\n  return {\n    width,\n    height,\n    top: y,\n    left: x,\n    right: x + width,\n    bottom: y + height,\n    x,\n    y\n  };\n}\n\nexport { alignments, clamp, createCoords, evaluate, expandPaddingObject, floor, getAlignment, getAlignmentAxis, getAlignmentSides, getAxisLength, getExpandedPlacements, getOppositeAlignmentPlacement, getOppositeAxis, getOppositeAxisPlacements, getOppositePlacement, getPaddingObject, getSide, getSideAxis, max, min, placements, rectToClientRect, round, sides };\n","import { getSideAxis, getAlignmentAxis, getAxisLength, getSide, getAlignment, evaluate, getPaddingObject, rectToClientRect, min, clamp, placements, getAlignmentSides, getOppositeAlignmentPlacement, getOppositePlacement, getExpandedPlacements, getOppositeAxisPlacements, sides, max, getOppositeAxis } from '@floating-ui/utils';\nexport { rectToClientRect } from '@floating-ui/utils';\n\nfunction computeCoordsFromPlacement(_ref, placement, rtl) {\n  let {\n    reference,\n    floating\n  } = _ref;\n  const sideAxis = getSideAxis(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const alignLength = getAxisLength(alignmentAxis);\n  const side = getSide(placement);\n  const isVertical = sideAxis === 'y';\n  const commonX = reference.x + reference.width / 2 - floating.width / 2;\n  const commonY = reference.y + reference.height / 2 - floating.height / 2;\n  const commonAlign = reference[alignLength] / 2 - floating[alignLength] / 2;\n  let coords;\n  switch (side) {\n    case 'top':\n      coords = {\n        x: commonX,\n        y: reference.y - floating.height\n      };\n      break;\n    case 'bottom':\n      coords = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n    case 'right':\n      coords = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n    case 'left':\n      coords = {\n        x: reference.x - floating.width,\n        y: commonY\n      };\n      break;\n    default:\n      coords = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n  switch (getAlignment(placement)) {\n    case 'start':\n      coords[alignmentAxis] -= commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n    case 'end':\n      coords[alignmentAxis] += commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n  }\n  return coords;\n}\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n *\n * This export does not have any `platform` interface logic. You will need to\n * write one for the platform you are using Floating UI with.\n */\nconst computePosition = async (reference, floating, config) => {\n  const {\n    placement = 'bottom',\n    strategy = 'absolute',\n    middleware = [],\n    platform\n  } = config;\n  const validMiddleware = middleware.filter(Boolean);\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(floating));\n  let rects = await platform.getElementRects({\n    reference,\n    floating,\n    strategy\n  });\n  let {\n    x,\n    y\n  } = computeCoordsFromPlacement(rects, placement, rtl);\n  let statefulPlacement = placement;\n  let middlewareData = {};\n  let resetCount = 0;\n  for (let i = 0; i < validMiddleware.length; i++) {\n    const {\n      name,\n      fn\n    } = validMiddleware[i];\n    const {\n      x: nextX,\n      y: nextY,\n      data,\n      reset\n    } = await fn({\n      x,\n      y,\n      initialPlacement: placement,\n      placement: statefulPlacement,\n      strategy,\n      middlewareData,\n      rects,\n      platform,\n      elements: {\n        reference,\n        floating\n      }\n    });\n    x = nextX != null ? nextX : x;\n    y = nextY != null ? nextY : y;\n    middlewareData = {\n      ...middlewareData,\n      [name]: {\n        ...middlewareData[name],\n        ...data\n      }\n    };\n    if (reset && resetCount <= 50) {\n      resetCount++;\n      if (typeof reset === 'object') {\n        if (reset.placement) {\n          statefulPlacement = reset.placement;\n        }\n        if (reset.rects) {\n          rects = reset.rects === true ? await platform.getElementRects({\n            reference,\n            floating,\n            strategy\n          }) : reset.rects;\n        }\n        ({\n          x,\n          y\n        } = computeCoordsFromPlacement(rects, statefulPlacement, rtl));\n      }\n      i = -1;\n    }\n  }\n  return {\n    x,\n    y,\n    placement: statefulPlacement,\n    strategy,\n    middlewareData\n  };\n};\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nasync function detectOverflow(state, options) {\n  var _await$platform$isEle;\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    x,\n    y,\n    platform,\n    rects,\n    elements,\n    strategy\n  } = state;\n  const {\n    boundary = 'clippingAncestors',\n    rootBoundary = 'viewport',\n    elementContext = 'floating',\n    altBoundary = false,\n    padding = 0\n  } = evaluate(options, state);\n  const paddingObject = getPaddingObject(padding);\n  const altContext = elementContext === 'floating' ? 'reference' : 'floating';\n  const element = elements[altBoundary ? altContext : elementContext];\n  const clippingClientRect = rectToClientRect(await platform.getClippingRect({\n    element: ((_await$platform$isEle = await (platform.isElement == null ? void 0 : platform.isElement(element))) != null ? _await$platform$isEle : true) ? element : element.contextElement || (await (platform.getDocumentElement == null ? void 0 : platform.getDocumentElement(elements.floating))),\n    boundary,\n    rootBoundary,\n    strategy\n  }));\n  const rect = elementContext === 'floating' ? {\n    x,\n    y,\n    width: rects.floating.width,\n    height: rects.floating.height\n  } : rects.reference;\n  const offsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(elements.floating));\n  const offsetScale = (await (platform.isElement == null ? void 0 : platform.isElement(offsetParent))) ? (await (platform.getScale == null ? void 0 : platform.getScale(offsetParent))) || {\n    x: 1,\n    y: 1\n  } : {\n    x: 1,\n    y: 1\n  };\n  const elementClientRect = rectToClientRect(platform.convertOffsetParentRelativeRectToViewportRelativeRect ? await platform.convertOffsetParentRelativeRectToViewportRelativeRect({\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  }) : rect);\n  return {\n    top: (clippingClientRect.top - elementClientRect.top + paddingObject.top) / offsetScale.y,\n    bottom: (elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom) / offsetScale.y,\n    left: (clippingClientRect.left - elementClientRect.left + paddingObject.left) / offsetScale.x,\n    right: (elementClientRect.right - clippingClientRect.right + paddingObject.right) / offsetScale.x\n  };\n}\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = options => ({\n  name: 'arrow',\n  options,\n  async fn(state) {\n    const {\n      x,\n      y,\n      placement,\n      rects,\n      platform,\n      elements,\n      middlewareData\n    } = state;\n    // Since `element` is required, we don't Partial<> the type.\n    const {\n      element,\n      padding = 0\n    } = evaluate(options, state) || {};\n    if (element == null) {\n      return {};\n    }\n    const paddingObject = getPaddingObject(padding);\n    const coords = {\n      x,\n      y\n    };\n    const axis = getAlignmentAxis(placement);\n    const length = getAxisLength(axis);\n    const arrowDimensions = await platform.getDimensions(element);\n    const isYAxis = axis === 'y';\n    const minProp = isYAxis ? 'top' : 'left';\n    const maxProp = isYAxis ? 'bottom' : 'right';\n    const clientProp = isYAxis ? 'clientHeight' : 'clientWidth';\n    const endDiff = rects.reference[length] + rects.reference[axis] - coords[axis] - rects.floating[length];\n    const startDiff = coords[axis] - rects.reference[axis];\n    const arrowOffsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(element));\n    let clientSize = arrowOffsetParent ? arrowOffsetParent[clientProp] : 0;\n\n    // DOM platform can return `window` as the `offsetParent`.\n    if (!clientSize || !(await (platform.isElement == null ? void 0 : platform.isElement(arrowOffsetParent)))) {\n      clientSize = elements.floating[clientProp] || rects.floating[length];\n    }\n    const centerToReference = endDiff / 2 - startDiff / 2;\n\n    // If the padding is large enough that it causes the arrow to no longer be\n    // centered, modify the padding so that it is centered.\n    const largestPossiblePadding = clientSize / 2 - arrowDimensions[length] / 2 - 1;\n    const minPadding = min(paddingObject[minProp], largestPossiblePadding);\n    const maxPadding = min(paddingObject[maxProp], largestPossiblePadding);\n\n    // Make sure the arrow doesn't overflow the floating element if the center\n    // point is outside the floating element's bounds.\n    const min$1 = minPadding;\n    const max = clientSize - arrowDimensions[length] - maxPadding;\n    const center = clientSize / 2 - arrowDimensions[length] / 2 + centerToReference;\n    const offset = clamp(min$1, center, max);\n\n    // If the reference is small enough that the arrow's padding causes it to\n    // to point to nothing for an aligned placement, adjust the offset of the\n    // floating element itself. To ensure `shift()` continues to take action,\n    // a single reset is performed when this is true.\n    const shouldAddOffset = !middlewareData.arrow && getAlignment(placement) != null && center !== offset && rects.reference[length] / 2 - (center < min$1 ? minPadding : maxPadding) - arrowDimensions[length] / 2 < 0;\n    const alignmentOffset = shouldAddOffset ? center < min$1 ? center - min$1 : center - max : 0;\n    return {\n      [axis]: coords[axis] + alignmentOffset,\n      data: {\n        [axis]: offset,\n        centerOffset: center - offset - alignmentOffset,\n        ...(shouldAddOffset && {\n          alignmentOffset\n        })\n      },\n      reset: shouldAddOffset\n    };\n  }\n});\n\nfunction getPlacementList(alignment, autoAlignment, allowedPlacements) {\n  const allowedPlacementsSortedByAlignment = alignment ? [...allowedPlacements.filter(placement => getAlignment(placement) === alignment), ...allowedPlacements.filter(placement => getAlignment(placement) !== alignment)] : allowedPlacements.filter(placement => getSide(placement) === placement);\n  return allowedPlacementsSortedByAlignment.filter(placement => {\n    if (alignment) {\n      return getAlignment(placement) === alignment || (autoAlignment ? getOppositeAlignmentPlacement(placement) !== placement : false);\n    }\n    return true;\n  });\n}\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'autoPlacement',\n    options,\n    async fn(state) {\n      var _middlewareData$autoP, _middlewareData$autoP2, _placementsThatFitOnE;\n      const {\n        rects,\n        middlewareData,\n        placement,\n        platform,\n        elements\n      } = state;\n      const {\n        crossAxis = false,\n        alignment,\n        allowedPlacements = placements,\n        autoAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const placements$1 = alignment !== undefined || allowedPlacements === placements ? getPlacementList(alignment || null, autoAlignment, allowedPlacements) : allowedPlacements;\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const currentIndex = ((_middlewareData$autoP = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP.index) || 0;\n      const currentPlacement = placements$1[currentIndex];\n      if (currentPlacement == null) {\n        return {};\n      }\n      const alignmentSides = getAlignmentSides(currentPlacement, rects, await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating)));\n\n      // Make `computeCoords` start from the right place.\n      if (placement !== currentPlacement) {\n        return {\n          reset: {\n            placement: placements$1[0]\n          }\n        };\n      }\n      const currentOverflows = [overflow[getSide(currentPlacement)], overflow[alignmentSides[0]], overflow[alignmentSides[1]]];\n      const allOverflows = [...(((_middlewareData$autoP2 = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP2.overflows) || []), {\n        placement: currentPlacement,\n        overflows: currentOverflows\n      }];\n      const nextPlacement = placements$1[currentIndex + 1];\n\n      // There are more placements to check.\n      if (nextPlacement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: nextPlacement\n          }\n        };\n      }\n      const placementsSortedByMostSpace = allOverflows.map(d => {\n        const alignment = getAlignment(d.placement);\n        return [d.placement, alignment && crossAxis ?\n        // Check along the mainAxis and main crossAxis side.\n        d.overflows.slice(0, 2).reduce((acc, v) => acc + v, 0) :\n        // Check only the mainAxis.\n        d.overflows[0], d.overflows];\n      }).sort((a, b) => a[1] - b[1]);\n      const placementsThatFitOnEachSide = placementsSortedByMostSpace.filter(d => d[2].slice(0,\n      // Aligned placements should not check their opposite crossAxis\n      // side.\n      getAlignment(d[0]) ? 2 : 3).every(v => v <= 0));\n      const resetPlacement = ((_placementsThatFitOnE = placementsThatFitOnEachSide[0]) == null ? void 0 : _placementsThatFitOnE[0]) || placementsSortedByMostSpace[0][0];\n      if (resetPlacement !== placement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: resetPlacement\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'flip',\n    options,\n    async fn(state) {\n      var _middlewareData$arrow, _middlewareData$flip;\n      const {\n        placement,\n        middlewareData,\n        rects,\n        initialPlacement,\n        platform,\n        elements\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true,\n        fallbackPlacements: specifiedFallbackPlacements,\n        fallbackStrategy = 'bestFit',\n        fallbackAxisSideDirection = 'none',\n        flipAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n\n      // If a reset by the arrow was caused due to an alignment offset being\n      // added, we should skip any logic now since `flip()` has already done its\n      // work.\n      // https://github.com/floating-ui/floating-ui/issues/2549#issuecomment-1719601643\n      if ((_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      const side = getSide(placement);\n      const initialSideAxis = getSideAxis(initialPlacement);\n      const isBasePlacement = getSide(initialPlacement) === initialPlacement;\n      const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n      const fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipAlignment ? [getOppositePlacement(initialPlacement)] : getExpandedPlacements(initialPlacement));\n      const hasFallbackAxisSideDirection = fallbackAxisSideDirection !== 'none';\n      if (!specifiedFallbackPlacements && hasFallbackAxisSideDirection) {\n        fallbackPlacements.push(...getOppositeAxisPlacements(initialPlacement, flipAlignment, fallbackAxisSideDirection, rtl));\n      }\n      const placements = [initialPlacement, ...fallbackPlacements];\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const overflows = [];\n      let overflowsData = ((_middlewareData$flip = middlewareData.flip) == null ? void 0 : _middlewareData$flip.overflows) || [];\n      if (checkMainAxis) {\n        overflows.push(overflow[side]);\n      }\n      if (checkCrossAxis) {\n        const sides = getAlignmentSides(placement, rects, rtl);\n        overflows.push(overflow[sides[0]], overflow[sides[1]]);\n      }\n      overflowsData = [...overflowsData, {\n        placement,\n        overflows\n      }];\n\n      // One or more sides is overflowing.\n      if (!overflows.every(side => side <= 0)) {\n        var _middlewareData$flip2, _overflowsData$filter;\n        const nextIndex = (((_middlewareData$flip2 = middlewareData.flip) == null ? void 0 : _middlewareData$flip2.index) || 0) + 1;\n        const nextPlacement = placements[nextIndex];\n        if (nextPlacement) {\n          const ignoreCrossAxisOverflow = checkCrossAxis === 'alignment' ? initialSideAxis !== getSideAxis(nextPlacement) : false;\n          if (!ignoreCrossAxisOverflow ||\n          // We leave the current main axis only if every placement on that axis\n          // overflows the main axis.\n          overflowsData.every(d => d.overflows[0] > 0 && getSideAxis(d.placement) === initialSideAxis)) {\n            // Try next placement and re-run the lifecycle.\n            return {\n              data: {\n                index: nextIndex,\n                overflows: overflowsData\n              },\n              reset: {\n                placement: nextPlacement\n              }\n            };\n          }\n        }\n\n        // First, find the candidates that fit on the mainAxis side of overflow,\n        // then find the placement that fits the best on the main crossAxis side.\n        let resetPlacement = (_overflowsData$filter = overflowsData.filter(d => d.overflows[0] <= 0).sort((a, b) => a.overflows[1] - b.overflows[1])[0]) == null ? void 0 : _overflowsData$filter.placement;\n\n        // Otherwise fallback.\n        if (!resetPlacement) {\n          switch (fallbackStrategy) {\n            case 'bestFit':\n              {\n                var _overflowsData$filter2;\n                const placement = (_overflowsData$filter2 = overflowsData.filter(d => {\n                  if (hasFallbackAxisSideDirection) {\n                    const currentSideAxis = getSideAxis(d.placement);\n                    return currentSideAxis === initialSideAxis ||\n                    // Create a bias to the `y` side axis due to horizontal\n                    // reading directions favoring greater width.\n                    currentSideAxis === 'y';\n                  }\n                  return true;\n                }).map(d => [d.placement, d.overflows.filter(overflow => overflow > 0).reduce((acc, overflow) => acc + overflow, 0)]).sort((a, b) => a[1] - b[1])[0]) == null ? void 0 : _overflowsData$filter2[0];\n                if (placement) {\n                  resetPlacement = placement;\n                }\n                break;\n              }\n            case 'initialPlacement':\n              resetPlacement = initialPlacement;\n              break;\n          }\n        }\n        if (placement !== resetPlacement) {\n          return {\n            reset: {\n              placement: resetPlacement\n            }\n          };\n        }\n      }\n      return {};\n    }\n  };\n};\n\nfunction getSideOffsets(overflow, rect) {\n  return {\n    top: overflow.top - rect.height,\n    right: overflow.right - rect.width,\n    bottom: overflow.bottom - rect.height,\n    left: overflow.left - rect.width\n  };\n}\nfunction isAnySideFullyClipped(overflow) {\n  return sides.some(side => overflow[side] >= 0);\n}\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'hide',\n    options,\n    async fn(state) {\n      const {\n        rects\n      } = state;\n      const {\n        strategy = 'referenceHidden',\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      switch (strategy) {\n        case 'referenceHidden':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              elementContext: 'reference'\n            });\n            const offsets = getSideOffsets(overflow, rects.reference);\n            return {\n              data: {\n                referenceHiddenOffsets: offsets,\n                referenceHidden: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        case 'escaped':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              altBoundary: true\n            });\n            const offsets = getSideOffsets(overflow, rects.floating);\n            return {\n              data: {\n                escapedOffsets: offsets,\n                escaped: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        default:\n          {\n            return {};\n          }\n      }\n    }\n  };\n};\n\nfunction getBoundingRect(rects) {\n  const minX = min(...rects.map(rect => rect.left));\n  const minY = min(...rects.map(rect => rect.top));\n  const maxX = max(...rects.map(rect => rect.right));\n  const maxY = max(...rects.map(rect => rect.bottom));\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction getRectsByLine(rects) {\n  const sortedRects = rects.slice().sort((a, b) => a.y - b.y);\n  const groups = [];\n  let prevRect = null;\n  for (let i = 0; i < sortedRects.length; i++) {\n    const rect = sortedRects[i];\n    if (!prevRect || rect.y - prevRect.y > prevRect.height / 2) {\n      groups.push([rect]);\n    } else {\n      groups[groups.length - 1].push(rect);\n    }\n    prevRect = rect;\n  }\n  return groups.map(rect => rectToClientRect(getBoundingRect(rect)));\n}\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'inline',\n    options,\n    async fn(state) {\n      const {\n        placement,\n        elements,\n        rects,\n        platform,\n        strategy\n      } = state;\n      // A MouseEvent's client{X,Y} coords can be up to 2 pixels off a\n      // ClientRect's bounds, despite the event listener being triggered. A\n      // padding of 2 seems to handle this issue.\n      const {\n        padding = 2,\n        x,\n        y\n      } = evaluate(options, state);\n      const nativeClientRects = Array.from((await (platform.getClientRects == null ? void 0 : platform.getClientRects(elements.reference))) || []);\n      const clientRects = getRectsByLine(nativeClientRects);\n      const fallback = rectToClientRect(getBoundingRect(nativeClientRects));\n      const paddingObject = getPaddingObject(padding);\n      function getBoundingClientRect() {\n        // There are two rects and they are disjoined.\n        if (clientRects.length === 2 && clientRects[0].left > clientRects[1].right && x != null && y != null) {\n          // Find the first rect in which the point is fully inside.\n          return clientRects.find(rect => x > rect.left - paddingObject.left && x < rect.right + paddingObject.right && y > rect.top - paddingObject.top && y < rect.bottom + paddingObject.bottom) || fallback;\n        }\n\n        // There are 2 or more connected rects.\n        if (clientRects.length >= 2) {\n          if (getSideAxis(placement) === 'y') {\n            const firstRect = clientRects[0];\n            const lastRect = clientRects[clientRects.length - 1];\n            const isTop = getSide(placement) === 'top';\n            const top = firstRect.top;\n            const bottom = lastRect.bottom;\n            const left = isTop ? firstRect.left : lastRect.left;\n            const right = isTop ? firstRect.right : lastRect.right;\n            const width = right - left;\n            const height = bottom - top;\n            return {\n              top,\n              bottom,\n              left,\n              right,\n              width,\n              height,\n              x: left,\n              y: top\n            };\n          }\n          const isLeftSide = getSide(placement) === 'left';\n          const maxRight = max(...clientRects.map(rect => rect.right));\n          const minLeft = min(...clientRects.map(rect => rect.left));\n          const measureRects = clientRects.filter(rect => isLeftSide ? rect.left === minLeft : rect.right === maxRight);\n          const top = measureRects[0].top;\n          const bottom = measureRects[measureRects.length - 1].bottom;\n          const left = minLeft;\n          const right = maxRight;\n          const width = right - left;\n          const height = bottom - top;\n          return {\n            top,\n            bottom,\n            left,\n            right,\n            width,\n            height,\n            x: left,\n            y: top\n          };\n        }\n        return fallback;\n      }\n      const resetRects = await platform.getElementRects({\n        reference: {\n          getBoundingClientRect\n        },\n        floating: elements.floating,\n        strategy\n      });\n      if (rects.reference.x !== resetRects.reference.x || rects.reference.y !== resetRects.reference.y || rects.reference.width !== resetRects.reference.width || rects.reference.height !== resetRects.reference.height) {\n        return {\n          reset: {\n            rects: resetRects\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\nconst originSides = /*#__PURE__*/new Set(['left', 'top']);\n\n// For type backwards-compatibility, the `OffsetOptions` type was also\n// Derivable.\n\nasync function convertValueToCoords(state, options) {\n  const {\n    placement,\n    platform,\n    elements\n  } = state;\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n  const side = getSide(placement);\n  const alignment = getAlignment(placement);\n  const isVertical = getSideAxis(placement) === 'y';\n  const mainAxisMulti = originSides.has(side) ? -1 : 1;\n  const crossAxisMulti = rtl && isVertical ? -1 : 1;\n  const rawValue = evaluate(options, state);\n\n  // eslint-disable-next-line prefer-const\n  let {\n    mainAxis,\n    crossAxis,\n    alignmentAxis\n  } = typeof rawValue === 'number' ? {\n    mainAxis: rawValue,\n    crossAxis: 0,\n    alignmentAxis: null\n  } : {\n    mainAxis: rawValue.mainAxis || 0,\n    crossAxis: rawValue.crossAxis || 0,\n    alignmentAxis: rawValue.alignmentAxis\n  };\n  if (alignment && typeof alignmentAxis === 'number') {\n    crossAxis = alignment === 'end' ? alignmentAxis * -1 : alignmentAxis;\n  }\n  return isVertical ? {\n    x: crossAxis * crossAxisMulti,\n    y: mainAxis * mainAxisMulti\n  } : {\n    x: mainAxis * mainAxisMulti,\n    y: crossAxis * crossAxisMulti\n  };\n}\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = function (options) {\n  if (options === void 0) {\n    options = 0;\n  }\n  return {\n    name: 'offset',\n    options,\n    async fn(state) {\n      var _middlewareData$offse, _middlewareData$arrow;\n      const {\n        x,\n        y,\n        placement,\n        middlewareData\n      } = state;\n      const diffCoords = await convertValueToCoords(state, options);\n\n      // If the placement is the same and the arrow caused an alignment offset\n      // then we don't need to change the positioning coordinates.\n      if (placement === ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse.placement) && (_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      return {\n        x: x + diffCoords.x,\n        y: y + diffCoords.y,\n        data: {\n          ...diffCoords,\n          placement\n        }\n      };\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'shift',\n    options,\n    async fn(state) {\n      const {\n        x,\n        y,\n        placement\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = false,\n        limiter = {\n          fn: _ref => {\n            let {\n              x,\n              y\n            } = _ref;\n            return {\n              x,\n              y\n            };\n          }\n        },\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const crossAxis = getSideAxis(getSide(placement));\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      if (checkMainAxis) {\n        const minSide = mainAxis === 'y' ? 'top' : 'left';\n        const maxSide = mainAxis === 'y' ? 'bottom' : 'right';\n        const min = mainAxisCoord + overflow[minSide];\n        const max = mainAxisCoord - overflow[maxSide];\n        mainAxisCoord = clamp(min, mainAxisCoord, max);\n      }\n      if (checkCrossAxis) {\n        const minSide = crossAxis === 'y' ? 'top' : 'left';\n        const maxSide = crossAxis === 'y' ? 'bottom' : 'right';\n        const min = crossAxisCoord + overflow[minSide];\n        const max = crossAxisCoord - overflow[maxSide];\n        crossAxisCoord = clamp(min, crossAxisCoord, max);\n      }\n      const limitedCoords = limiter.fn({\n        ...state,\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      });\n      return {\n        ...limitedCoords,\n        data: {\n          x: limitedCoords.x - x,\n          y: limitedCoords.y - y,\n          enabled: {\n            [mainAxis]: checkMainAxis,\n            [crossAxis]: checkCrossAxis\n          }\n        }\n      };\n    }\n  };\n};\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    options,\n    fn(state) {\n      const {\n        x,\n        y,\n        placement,\n        rects,\n        middlewareData\n      } = state;\n      const {\n        offset = 0,\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const crossAxis = getSideAxis(placement);\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      const rawOffset = evaluate(offset, state);\n      const computedOffset = typeof rawOffset === 'number' ? {\n        mainAxis: rawOffset,\n        crossAxis: 0\n      } : {\n        mainAxis: 0,\n        crossAxis: 0,\n        ...rawOffset\n      };\n      if (checkMainAxis) {\n        const len = mainAxis === 'y' ? 'height' : 'width';\n        const limitMin = rects.reference[mainAxis] - rects.floating[len] + computedOffset.mainAxis;\n        const limitMax = rects.reference[mainAxis] + rects.reference[len] - computedOffset.mainAxis;\n        if (mainAxisCoord < limitMin) {\n          mainAxisCoord = limitMin;\n        } else if (mainAxisCoord > limitMax) {\n          mainAxisCoord = limitMax;\n        }\n      }\n      if (checkCrossAxis) {\n        var _middlewareData$offse, _middlewareData$offse2;\n        const len = mainAxis === 'y' ? 'width' : 'height';\n        const isOriginSide = originSides.has(getSide(placement));\n        const limitMin = rects.reference[crossAxis] - rects.floating[len] + (isOriginSide ? ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse[crossAxis]) || 0 : 0) + (isOriginSide ? 0 : computedOffset.crossAxis);\n        const limitMax = rects.reference[crossAxis] + rects.reference[len] + (isOriginSide ? 0 : ((_middlewareData$offse2 = middlewareData.offset) == null ? void 0 : _middlewareData$offse2[crossAxis]) || 0) - (isOriginSide ? computedOffset.crossAxis : 0);\n        if (crossAxisCoord < limitMin) {\n          crossAxisCoord = limitMin;\n        } else if (crossAxisCoord > limitMax) {\n          crossAxisCoord = limitMax;\n        }\n      }\n      return {\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      };\n    }\n  };\n};\n\n/**\n * Provides data that allows you to change the size of the floating element —\n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'size',\n    options,\n    async fn(state) {\n      var _state$middlewareData, _state$middlewareData2;\n      const {\n        placement,\n        rects,\n        platform,\n        elements\n      } = state;\n      const {\n        apply = () => {},\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const side = getSide(placement);\n      const alignment = getAlignment(placement);\n      const isYAxis = getSideAxis(placement) === 'y';\n      const {\n        width,\n        height\n      } = rects.floating;\n      let heightSide;\n      let widthSide;\n      if (side === 'top' || side === 'bottom') {\n        heightSide = side;\n        widthSide = alignment === ((await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating))) ? 'start' : 'end') ? 'left' : 'right';\n      } else {\n        widthSide = side;\n        heightSide = alignment === 'end' ? 'top' : 'bottom';\n      }\n      const maximumClippingHeight = height - overflow.top - overflow.bottom;\n      const maximumClippingWidth = width - overflow.left - overflow.right;\n      const overflowAvailableHeight = min(height - overflow[heightSide], maximumClippingHeight);\n      const overflowAvailableWidth = min(width - overflow[widthSide], maximumClippingWidth);\n      const noShift = !state.middlewareData.shift;\n      let availableHeight = overflowAvailableHeight;\n      let availableWidth = overflowAvailableWidth;\n      if ((_state$middlewareData = state.middlewareData.shift) != null && _state$middlewareData.enabled.x) {\n        availableWidth = maximumClippingWidth;\n      }\n      if ((_state$middlewareData2 = state.middlewareData.shift) != null && _state$middlewareData2.enabled.y) {\n        availableHeight = maximumClippingHeight;\n      }\n      if (noShift && !alignment) {\n        const xMin = max(overflow.left, 0);\n        const xMax = max(overflow.right, 0);\n        const yMin = max(overflow.top, 0);\n        const yMax = max(overflow.bottom, 0);\n        if (isYAxis) {\n          availableWidth = width - 2 * (xMin !== 0 || xMax !== 0 ? xMin + xMax : max(overflow.left, overflow.right));\n        } else {\n          availableHeight = height - 2 * (yMin !== 0 || yMax !== 0 ? yMin + yMax : max(overflow.top, overflow.bottom));\n        }\n      }\n      await apply({\n        ...state,\n        availableWidth,\n        availableHeight\n      });\n      const nextDimensions = await platform.getDimensions(elements.floating);\n      if (width !== nextDimensions.width || height !== nextDimensions.height) {\n        return {\n          reset: {\n            rects: true\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\nexport { arrow, autoPlacement, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, shift, size };\n","function hasWindow() {\n  return typeof window !== 'undefined';\n}\nfunction getNodeName(node) {\n  if (isNode(node)) {\n    return (node.nodeName || '').toLowerCase();\n  }\n  // Mocked nodes in testing environments may not be instances of Node. By\n  // returning `#document` an infinite loop won't occur.\n  // https://github.com/floating-ui/floating-ui/issues/2317\n  return '#document';\n}\nfunction getWindow(node) {\n  var _node$ownerDocument;\n  return (node == null || (_node$ownerDocument = node.ownerDocument) == null ? void 0 : _node$ownerDocument.defaultView) || window;\n}\nfunction getDocumentElement(node) {\n  var _ref;\n  return (_ref = (isNode(node) ? node.ownerDocument : node.document) || window.document) == null ? void 0 : _ref.documentElement;\n}\nfunction isNode(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof Node || value instanceof getWindow(value).Node;\n}\nfunction isElement(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof Element || value instanceof getWindow(value).Element;\n}\nfunction isHTMLElement(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof HTMLElement || value instanceof getWindow(value).HTMLElement;\n}\nfunction isShadowRoot(value) {\n  if (!hasWindow() || typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n  return value instanceof ShadowRoot || value instanceof getWindow(value).ShadowRoot;\n}\nconst invalidOverflowDisplayValues = /*#__PURE__*/new Set(['inline', 'contents']);\nfunction isOverflowElement(element) {\n  const {\n    overflow,\n    overflowX,\n    overflowY,\n    display\n  } = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden|clip/.test(overflow + overflowY + overflowX) && !invalidOverflowDisplayValues.has(display);\n}\nconst tableElements = /*#__PURE__*/new Set(['table', 'td', 'th']);\nfunction isTableElement(element) {\n  return tableElements.has(getNodeName(element));\n}\nconst topLayerSelectors = [':popover-open', ':modal'];\nfunction isTopLayer(element) {\n  return topLayerSelectors.some(selector => {\n    try {\n      return element.matches(selector);\n    } catch (_e) {\n      return false;\n    }\n  });\n}\nconst transformProperties = ['transform', 'translate', 'scale', 'rotate', 'perspective'];\nconst willChangeValues = ['transform', 'translate', 'scale', 'rotate', 'perspective', 'filter'];\nconst containValues = ['paint', 'layout', 'strict', 'content'];\nfunction isContainingBlock(elementOrCss) {\n  const webkit = isWebKit();\n  const css = isElement(elementOrCss) ? getComputedStyle(elementOrCss) : elementOrCss;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  // https://drafts.csswg.org/css-transforms-2/#individual-transforms\n  return transformProperties.some(value => css[value] ? css[value] !== 'none' : false) || (css.containerType ? css.containerType !== 'normal' : false) || !webkit && (css.backdropFilter ? css.backdropFilter !== 'none' : false) || !webkit && (css.filter ? css.filter !== 'none' : false) || willChangeValues.some(value => (css.willChange || '').includes(value)) || containValues.some(value => (css.contain || '').includes(value));\n}\nfunction getContainingBlock(element) {\n  let currentNode = getParentNode(element);\n  while (isHTMLElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    if (isContainingBlock(currentNode)) {\n      return currentNode;\n    } else if (isTopLayer(currentNode)) {\n      return null;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  return null;\n}\nfunction isWebKit() {\n  if (typeof CSS === 'undefined' || !CSS.supports) return false;\n  return CSS.supports('-webkit-backdrop-filter', 'none');\n}\nconst lastTraversableNodeNames = /*#__PURE__*/new Set(['html', 'body', '#document']);\nfunction isLastTraversableNode(node) {\n  return lastTraversableNodeNames.has(getNodeName(node));\n}\nfunction getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}\nfunction getNodeScroll(element) {\n  if (isElement(element)) {\n    return {\n      scrollLeft: element.scrollLeft,\n      scrollTop: element.scrollTop\n    };\n  }\n  return {\n    scrollLeft: element.scrollX,\n    scrollTop: element.scrollY\n  };\n}\nfunction getParentNode(node) {\n  if (getNodeName(node) === 'html') {\n    return node;\n  }\n  const result =\n  // Step into the shadow DOM of the parent of a slotted node.\n  node.assignedSlot ||\n  // DOM Element detected.\n  node.parentNode ||\n  // ShadowRoot detected.\n  isShadowRoot(node) && node.host ||\n  // Fallback.\n  getDocumentElement(node);\n  return isShadowRoot(result) ? result.host : result;\n}\nfunction getNearestOverflowAncestor(node) {\n  const parentNode = getParentNode(node);\n  if (isLastTraversableNode(parentNode)) {\n    return node.ownerDocument ? node.ownerDocument.body : node.body;\n  }\n  if (isHTMLElement(parentNode) && isOverflowElement(parentNode)) {\n    return parentNode;\n  }\n  return getNearestOverflowAncestor(parentNode);\n}\nfunction getOverflowAncestors(node, list, traverseIframes) {\n  var _node$ownerDocument2;\n  if (list === void 0) {\n    list = [];\n  }\n  if (traverseIframes === void 0) {\n    traverseIframes = true;\n  }\n  const scrollableAncestor = getNearestOverflowAncestor(node);\n  const isBody = scrollableAncestor === ((_node$ownerDocument2 = node.ownerDocument) == null ? void 0 : _node$ownerDocument2.body);\n  const win = getWindow(scrollableAncestor);\n  if (isBody) {\n    const frameElement = getFrameElement(win);\n    return list.concat(win, win.visualViewport || [], isOverflowElement(scrollableAncestor) ? scrollableAncestor : [], frameElement && traverseIframes ? getOverflowAncestors(frameElement) : []);\n  }\n  return list.concat(scrollableAncestor, getOverflowAncestors(scrollableAncestor, [], traverseIframes));\n}\nfunction getFrameElement(win) {\n  return win.parent && Object.getPrototypeOf(win.parent) ? win.frameElement : null;\n}\n\nexport { getComputedStyle, getContainingBlock, getDocumentElement, getFrameElement, getNearestOverflowAncestor, getNodeName, getNodeScroll, getOverflowAncestors, getParentNode, getWindow, isContainingBlock, isElement, isHTMLElement, isLastTraversableNode, isNode, isOverflowElement, isShadowRoot, isTableElement, isTopLayer, isWebKit };\n","import { rectToClientRect, arrow as arrow$1, autoPlacement as autoPlacement$1, detectOverflow as detectOverflow$1, flip as flip$1, hide as hide$1, inline as inline$1, limitShift as limitShift$1, offset as offset$1, shift as shift$1, size as size$1, computePosition as computePosition$1 } from '@floating-ui/core';\nimport { round, createCoords, max, min, floor } from '@floating-ui/utils';\nimport { getComputedStyle, isHTMLElement, isElement, getWindow, isWebKit, getFrameElement, getNodeScroll, getDocumentElement, isTopLayer, getNodeName, isOverflowElement, getOverflowAncestors, getParentNode, isLastTraversableNode, isContainingBlock, isTableElement, getContainingBlock } from '@floating-ui/utils/dom';\nexport { getOverflowAncestors } from '@floating-ui/utils/dom';\n\nfunction getCssDimensions(element) {\n  const css = getComputedStyle(element);\n  // In testing environments, the `width` and `height` properties are empty\n  // strings for SVG elements, returning NaN. Fallback to `0` in this case.\n  let width = parseFloat(css.width) || 0;\n  let height = parseFloat(css.height) || 0;\n  const hasOffset = isHTMLElement(element);\n  const offsetWidth = hasOffset ? element.offsetWidth : width;\n  const offsetHeight = hasOffset ? element.offsetHeight : height;\n  const shouldFallback = round(width) !== offsetWidth || round(height) !== offsetHeight;\n  if (shouldFallback) {\n    width = offsetWidth;\n    height = offsetHeight;\n  }\n  return {\n    width,\n    height,\n    $: shouldFallback\n  };\n}\n\nfunction unwrapElement(element) {\n  return !isElement(element) ? element.contextElement : element;\n}\n\nfunction getScale(element) {\n  const domElement = unwrapElement(element);\n  if (!isHTMLElement(domElement)) {\n    return createCoords(1);\n  }\n  const rect = domElement.getBoundingClientRect();\n  const {\n    width,\n    height,\n    $\n  } = getCssDimensions(domElement);\n  let x = ($ ? round(rect.width) : rect.width) / width;\n  let y = ($ ? round(rect.height) : rect.height) / height;\n\n  // 0, NaN, or Infinity should always fallback to 1.\n\n  if (!x || !Number.isFinite(x)) {\n    x = 1;\n  }\n  if (!y || !Number.isFinite(y)) {\n    y = 1;\n  }\n  return {\n    x,\n    y\n  };\n}\n\nconst noOffsets = /*#__PURE__*/createCoords(0);\nfunction getVisualOffsets(element) {\n  const win = getWindow(element);\n  if (!isWebKit() || !win.visualViewport) {\n    return noOffsets;\n  }\n  return {\n    x: win.visualViewport.offsetLeft,\n    y: win.visualViewport.offsetTop\n  };\n}\nfunction shouldAddVisualOffsets(element, isFixed, floatingOffsetParent) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n  if (!floatingOffsetParent || isFixed && floatingOffsetParent !== getWindow(element)) {\n    return false;\n  }\n  return isFixed;\n}\n\nfunction getBoundingClientRect(element, includeScale, isFixedStrategy, offsetParent) {\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n  const clientRect = element.getBoundingClientRect();\n  const domElement = unwrapElement(element);\n  let scale = createCoords(1);\n  if (includeScale) {\n    if (offsetParent) {\n      if (isElement(offsetParent)) {\n        scale = getScale(offsetParent);\n      }\n    } else {\n      scale = getScale(element);\n    }\n  }\n  const visualOffsets = shouldAddVisualOffsets(domElement, isFixedStrategy, offsetParent) ? getVisualOffsets(domElement) : createCoords(0);\n  let x = (clientRect.left + visualOffsets.x) / scale.x;\n  let y = (clientRect.top + visualOffsets.y) / scale.y;\n  let width = clientRect.width / scale.x;\n  let height = clientRect.height / scale.y;\n  if (domElement) {\n    const win = getWindow(domElement);\n    const offsetWin = offsetParent && isElement(offsetParent) ? getWindow(offsetParent) : offsetParent;\n    let currentWin = win;\n    let currentIFrame = getFrameElement(currentWin);\n    while (currentIFrame && offsetParent && offsetWin !== currentWin) {\n      const iframeScale = getScale(currentIFrame);\n      const iframeRect = currentIFrame.getBoundingClientRect();\n      const css = getComputedStyle(currentIFrame);\n      const left = iframeRect.left + (currentIFrame.clientLeft + parseFloat(css.paddingLeft)) * iframeScale.x;\n      const top = iframeRect.top + (currentIFrame.clientTop + parseFloat(css.paddingTop)) * iframeScale.y;\n      x *= iframeScale.x;\n      y *= iframeScale.y;\n      width *= iframeScale.x;\n      height *= iframeScale.y;\n      x += left;\n      y += top;\n      currentWin = getWindow(currentIFrame);\n      currentIFrame = getFrameElement(currentWin);\n    }\n  }\n  return rectToClientRect({\n    width,\n    height,\n    x,\n    y\n  });\n}\n\n// If <html> has a CSS width greater than the viewport, then this will be\n// incorrect for RTL.\nfunction getWindowScrollBarX(element, rect) {\n  const leftScroll = getNodeScroll(element).scrollLeft;\n  if (!rect) {\n    return getBoundingClientRect(getDocumentElement(element)).left + leftScroll;\n  }\n  return rect.left + leftScroll;\n}\n\nfunction getHTMLOffset(documentElement, scroll, ignoreScrollbarX) {\n  if (ignoreScrollbarX === void 0) {\n    ignoreScrollbarX = false;\n  }\n  const htmlRect = documentElement.getBoundingClientRect();\n  const x = htmlRect.left + scroll.scrollLeft - (ignoreScrollbarX ? 0 :\n  // RTL <body> scrollbar.\n  getWindowScrollBarX(documentElement, htmlRect));\n  const y = htmlRect.top + scroll.scrollTop;\n  return {\n    x,\n    y\n  };\n}\n\nfunction convertOffsetParentRelativeRectToViewportRelativeRect(_ref) {\n  let {\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  } = _ref;\n  const isFixed = strategy === 'fixed';\n  const documentElement = getDocumentElement(offsetParent);\n  const topLayer = elements ? isTopLayer(elements.floating) : false;\n  if (offsetParent === documentElement || topLayer && isFixed) {\n    return rect;\n  }\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  let scale = createCoords(1);\n  const offsets = createCoords(0);\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isHTMLElement(offsetParent)) {\n      const offsetRect = getBoundingClientRect(offsetParent);\n      scale = getScale(offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    }\n  }\n  const htmlOffset = documentElement && !isOffsetParentAnElement && !isFixed ? getHTMLOffset(documentElement, scroll, true) : createCoords(0);\n  return {\n    width: rect.width * scale.x,\n    height: rect.height * scale.y,\n    x: rect.x * scale.x - scroll.scrollLeft * scale.x + offsets.x + htmlOffset.x,\n    y: rect.y * scale.y - scroll.scrollTop * scale.y + offsets.y + htmlOffset.y\n  };\n}\n\nfunction getClientRects(element) {\n  return Array.from(element.getClientRects());\n}\n\n// Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable.\nfunction getDocumentRect(element) {\n  const html = getDocumentElement(element);\n  const scroll = getNodeScroll(element);\n  const body = element.ownerDocument.body;\n  const width = max(html.scrollWidth, html.clientWidth, body.scrollWidth, body.clientWidth);\n  const height = max(html.scrollHeight, html.clientHeight, body.scrollHeight, body.clientHeight);\n  let x = -scroll.scrollLeft + getWindowScrollBarX(element);\n  const y = -scroll.scrollTop;\n  if (getComputedStyle(body).direction === 'rtl') {\n    x += max(html.clientWidth, body.clientWidth) - width;\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nfunction getViewportRect(element, strategy) {\n  const win = getWindow(element);\n  const html = getDocumentElement(element);\n  const visualViewport = win.visualViewport;\n  let width = html.clientWidth;\n  let height = html.clientHeight;\n  let x = 0;\n  let y = 0;\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    const visualViewportBased = isWebKit();\n    if (!visualViewportBased || visualViewportBased && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nconst absoluteOrFixed = /*#__PURE__*/new Set(['absolute', 'fixed']);\n// Returns the inner client rect, subtracting scrollbars if present.\nfunction getInnerBoundingClientRect(element, strategy) {\n  const clientRect = getBoundingClientRect(element, true, strategy === 'fixed');\n  const top = clientRect.top + element.clientTop;\n  const left = clientRect.left + element.clientLeft;\n  const scale = isHTMLElement(element) ? getScale(element) : createCoords(1);\n  const width = element.clientWidth * scale.x;\n  const height = element.clientHeight * scale.y;\n  const x = left * scale.x;\n  const y = top * scale.y;\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\nfunction getClientRectFromClippingAncestor(element, clippingAncestor, strategy) {\n  let rect;\n  if (clippingAncestor === 'viewport') {\n    rect = getViewportRect(element, strategy);\n  } else if (clippingAncestor === 'document') {\n    rect = getDocumentRect(getDocumentElement(element));\n  } else if (isElement(clippingAncestor)) {\n    rect = getInnerBoundingClientRect(clippingAncestor, strategy);\n  } else {\n    const visualOffsets = getVisualOffsets(element);\n    rect = {\n      x: clippingAncestor.x - visualOffsets.x,\n      y: clippingAncestor.y - visualOffsets.y,\n      width: clippingAncestor.width,\n      height: clippingAncestor.height\n    };\n  }\n  return rectToClientRect(rect);\n}\nfunction hasFixedPositionAncestor(element, stopNode) {\n  const parentNode = getParentNode(element);\n  if (parentNode === stopNode || !isElement(parentNode) || isLastTraversableNode(parentNode)) {\n    return false;\n  }\n  return getComputedStyle(parentNode).position === 'fixed' || hasFixedPositionAncestor(parentNode, stopNode);\n}\n\n// A \"clipping ancestor\" is an `overflow` element with the characteristic of\n// clipping (or hiding) child elements. This returns all clipping ancestors\n// of the given element up the tree.\nfunction getClippingElementAncestors(element, cache) {\n  const cachedResult = cache.get(element);\n  if (cachedResult) {\n    return cachedResult;\n  }\n  let result = getOverflowAncestors(element, [], false).filter(el => isElement(el) && getNodeName(el) !== 'body');\n  let currentContainingBlockComputedStyle = null;\n  const elementIsFixed = getComputedStyle(element).position === 'fixed';\n  let currentNode = elementIsFixed ? getParentNode(element) : element;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  while (isElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    const computedStyle = getComputedStyle(currentNode);\n    const currentNodeIsContaining = isContainingBlock(currentNode);\n    if (!currentNodeIsContaining && computedStyle.position === 'fixed') {\n      currentContainingBlockComputedStyle = null;\n    }\n    const shouldDropCurrentNode = elementIsFixed ? !currentNodeIsContaining && !currentContainingBlockComputedStyle : !currentNodeIsContaining && computedStyle.position === 'static' && !!currentContainingBlockComputedStyle && absoluteOrFixed.has(currentContainingBlockComputedStyle.position) || isOverflowElement(currentNode) && !currentNodeIsContaining && hasFixedPositionAncestor(element, currentNode);\n    if (shouldDropCurrentNode) {\n      // Drop non-containing blocks.\n      result = result.filter(ancestor => ancestor !== currentNode);\n    } else {\n      // Record last containing block for next iteration.\n      currentContainingBlockComputedStyle = computedStyle;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  cache.set(element, result);\n  return result;\n}\n\n// Gets the maximum area that the element is visible in due to any number of\n// clipping ancestors.\nfunction getClippingRect(_ref) {\n  let {\n    element,\n    boundary,\n    rootBoundary,\n    strategy\n  } = _ref;\n  const elementClippingAncestors = boundary === 'clippingAncestors' ? isTopLayer(element) ? [] : getClippingElementAncestors(element, this._c) : [].concat(boundary);\n  const clippingAncestors = [...elementClippingAncestors, rootBoundary];\n  const firstClippingAncestor = clippingAncestors[0];\n  const clippingRect = clippingAncestors.reduce((accRect, clippingAncestor) => {\n    const rect = getClientRectFromClippingAncestor(element, clippingAncestor, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromClippingAncestor(element, firstClippingAncestor, strategy));\n  return {\n    width: clippingRect.right - clippingRect.left,\n    height: clippingRect.bottom - clippingRect.top,\n    x: clippingRect.left,\n    y: clippingRect.top\n  };\n}\n\nfunction getDimensions(element) {\n  const {\n    width,\n    height\n  } = getCssDimensions(element);\n  return {\n    width,\n    height\n  };\n}\n\nfunction getRectRelativeToOffsetParent(element, offsetParent, strategy) {\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n  const isFixed = strategy === 'fixed';\n  const rect = getBoundingClientRect(element, true, isFixed, offsetParent);\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  const offsets = createCoords(0);\n\n  // If the <body> scrollbar appears on the left (e.g. RTL systems). Use\n  // Firefox with layout.scrollbar.side = 3 in about:config to test this.\n  function setLeftRTLScrollbarOffset() {\n    offsets.x = getWindowScrollBarX(documentElement);\n  }\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isOffsetParentAnElement) {\n      const offsetRect = getBoundingClientRect(offsetParent, true, isFixed, offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    } else if (documentElement) {\n      setLeftRTLScrollbarOffset();\n    }\n  }\n  if (isFixed && !isOffsetParentAnElement && documentElement) {\n    setLeftRTLScrollbarOffset();\n  }\n  const htmlOffset = documentElement && !isOffsetParentAnElement && !isFixed ? getHTMLOffset(documentElement, scroll) : createCoords(0);\n  const x = rect.left + scroll.scrollLeft - offsets.x - htmlOffset.x;\n  const y = rect.top + scroll.scrollTop - offsets.y - htmlOffset.y;\n  return {\n    x,\n    y,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\nfunction isStaticPositioned(element) {\n  return getComputedStyle(element).position === 'static';\n}\n\nfunction getTrueOffsetParent(element, polyfill) {\n  if (!isHTMLElement(element) || getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n  if (polyfill) {\n    return polyfill(element);\n  }\n  let rawOffsetParent = element.offsetParent;\n\n  // Firefox returns the <html> element as the offsetParent if it's non-static,\n  // while Chrome and Safari return the <body> element. The <body> element must\n  // be used to perform the correct calculations even if the <html> element is\n  // non-static.\n  if (getDocumentElement(element) === rawOffsetParent) {\n    rawOffsetParent = rawOffsetParent.ownerDocument.body;\n  }\n  return rawOffsetParent;\n}\n\n// Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\nfunction getOffsetParent(element, polyfill) {\n  const win = getWindow(element);\n  if (isTopLayer(element)) {\n    return win;\n  }\n  if (!isHTMLElement(element)) {\n    let svgOffsetParent = getParentNode(element);\n    while (svgOffsetParent && !isLastTraversableNode(svgOffsetParent)) {\n      if (isElement(svgOffsetParent) && !isStaticPositioned(svgOffsetParent)) {\n        return svgOffsetParent;\n      }\n      svgOffsetParent = getParentNode(svgOffsetParent);\n    }\n    return win;\n  }\n  let offsetParent = getTrueOffsetParent(element, polyfill);\n  while (offsetParent && isTableElement(offsetParent) && isStaticPositioned(offsetParent)) {\n    offsetParent = getTrueOffsetParent(offsetParent, polyfill);\n  }\n  if (offsetParent && isLastTraversableNode(offsetParent) && isStaticPositioned(offsetParent) && !isContainingBlock(offsetParent)) {\n    return win;\n  }\n  return offsetParent || getContainingBlock(element) || win;\n}\n\nconst getElementRects = async function (data) {\n  const getOffsetParentFn = this.getOffsetParent || getOffsetParent;\n  const getDimensionsFn = this.getDimensions;\n  const floatingDimensions = await getDimensionsFn(data.floating);\n  return {\n    reference: getRectRelativeToOffsetParent(data.reference, await getOffsetParentFn(data.floating), data.strategy),\n    floating: {\n      x: 0,\n      y: 0,\n      width: floatingDimensions.width,\n      height: floatingDimensions.height\n    }\n  };\n};\n\nfunction isRTL(element) {\n  return getComputedStyle(element).direction === 'rtl';\n}\n\nconst platform = {\n  convertOffsetParentRelativeRectToViewportRelativeRect,\n  getDocumentElement,\n  getClippingRect,\n  getOffsetParent,\n  getElementRects,\n  getClientRects,\n  getDimensions,\n  getScale,\n  isElement,\n  isRTL\n};\n\nfunction rectsAreEqual(a, b) {\n  return a.x === b.x && a.y === b.y && a.width === b.width && a.height === b.height;\n}\n\n// https://samthor.au/2021/observing-dom/\nfunction observeMove(element, onMove) {\n  let io = null;\n  let timeoutId;\n  const root = getDocumentElement(element);\n  function cleanup() {\n    var _io;\n    clearTimeout(timeoutId);\n    (_io = io) == null || _io.disconnect();\n    io = null;\n  }\n  function refresh(skip, threshold) {\n    if (skip === void 0) {\n      skip = false;\n    }\n    if (threshold === void 0) {\n      threshold = 1;\n    }\n    cleanup();\n    const elementRectForRootMargin = element.getBoundingClientRect();\n    const {\n      left,\n      top,\n      width,\n      height\n    } = elementRectForRootMargin;\n    if (!skip) {\n      onMove();\n    }\n    if (!width || !height) {\n      return;\n    }\n    const insetTop = floor(top);\n    const insetRight = floor(root.clientWidth - (left + width));\n    const insetBottom = floor(root.clientHeight - (top + height));\n    const insetLeft = floor(left);\n    const rootMargin = -insetTop + \"px \" + -insetRight + \"px \" + -insetBottom + \"px \" + -insetLeft + \"px\";\n    const options = {\n      rootMargin,\n      threshold: max(0, min(1, threshold)) || 1\n    };\n    let isFirstUpdate = true;\n    function handleObserve(entries) {\n      const ratio = entries[0].intersectionRatio;\n      if (ratio !== threshold) {\n        if (!isFirstUpdate) {\n          return refresh();\n        }\n        if (!ratio) {\n          // If the reference is clipped, the ratio is 0. Throttle the refresh\n          // to prevent an infinite loop of updates.\n          timeoutId = setTimeout(() => {\n            refresh(false, 1e-7);\n          }, 1000);\n        } else {\n          refresh(false, ratio);\n        }\n      }\n      if (ratio === 1 && !rectsAreEqual(elementRectForRootMargin, element.getBoundingClientRect())) {\n        // It's possible that even though the ratio is reported as 1, the\n        // element is not actually fully within the IntersectionObserver's root\n        // area anymore. This can happen under performance constraints. This may\n        // be a bug in the browser's IntersectionObserver implementation. To\n        // work around this, we compare the element's bounding rect now with\n        // what it was at the time we created the IntersectionObserver. If they\n        // are not equal then the element moved, so we refresh.\n        refresh();\n      }\n      isFirstUpdate = false;\n    }\n\n    // Older browsers don't support a `document` as the root and will throw an\n    // error.\n    try {\n      io = new IntersectionObserver(handleObserve, {\n        ...options,\n        // Handle <iframe>s\n        root: root.ownerDocument\n      });\n    } catch (_e) {\n      io = new IntersectionObserver(handleObserve, options);\n    }\n    io.observe(element);\n  }\n  refresh(true);\n  return cleanup;\n}\n\n/**\n * Automatically updates the position of the floating element when necessary.\n * Should only be called when the floating element is mounted on the DOM or\n * visible on the screen.\n * @returns cleanup function that should be invoked when the floating element is\n * removed from the DOM or hidden from the screen.\n * @see https://floating-ui.com/docs/autoUpdate\n */\nfunction autoUpdate(reference, floating, update, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    ancestorScroll = true,\n    ancestorResize = true,\n    elementResize = typeof ResizeObserver === 'function',\n    layoutShift = typeof IntersectionObserver === 'function',\n    animationFrame = false\n  } = options;\n  const referenceEl = unwrapElement(reference);\n  const ancestors = ancestorScroll || ancestorResize ? [...(referenceEl ? getOverflowAncestors(referenceEl) : []), ...getOverflowAncestors(floating)] : [];\n  ancestors.forEach(ancestor => {\n    ancestorScroll && ancestor.addEventListener('scroll', update, {\n      passive: true\n    });\n    ancestorResize && ancestor.addEventListener('resize', update);\n  });\n  const cleanupIo = referenceEl && layoutShift ? observeMove(referenceEl, update) : null;\n  let reobserveFrame = -1;\n  let resizeObserver = null;\n  if (elementResize) {\n    resizeObserver = new ResizeObserver(_ref => {\n      let [firstEntry] = _ref;\n      if (firstEntry && firstEntry.target === referenceEl && resizeObserver) {\n        // Prevent update loops when using the `size` middleware.\n        // https://github.com/floating-ui/floating-ui/issues/1740\n        resizeObserver.unobserve(floating);\n        cancelAnimationFrame(reobserveFrame);\n        reobserveFrame = requestAnimationFrame(() => {\n          var _resizeObserver;\n          (_resizeObserver = resizeObserver) == null || _resizeObserver.observe(floating);\n        });\n      }\n      update();\n    });\n    if (referenceEl && !animationFrame) {\n      resizeObserver.observe(referenceEl);\n    }\n    resizeObserver.observe(floating);\n  }\n  let frameId;\n  let prevRefRect = animationFrame ? getBoundingClientRect(reference) : null;\n  if (animationFrame) {\n    frameLoop();\n  }\n  function frameLoop() {\n    const nextRefRect = getBoundingClientRect(reference);\n    if (prevRefRect && !rectsAreEqual(prevRefRect, nextRefRect)) {\n      update();\n    }\n    prevRefRect = nextRefRect;\n    frameId = requestAnimationFrame(frameLoop);\n  }\n  update();\n  return () => {\n    var _resizeObserver2;\n    ancestors.forEach(ancestor => {\n      ancestorScroll && ancestor.removeEventListener('scroll', update);\n      ancestorResize && ancestor.removeEventListener('resize', update);\n    });\n    cleanupIo == null || cleanupIo();\n    (_resizeObserver2 = resizeObserver) == null || _resizeObserver2.disconnect();\n    resizeObserver = null;\n    if (animationFrame) {\n      cancelAnimationFrame(frameId);\n    }\n  };\n}\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nconst detectOverflow = detectOverflow$1;\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = offset$1;\n\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = autoPlacement$1;\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = shift$1;\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = flip$1;\n\n/**\n * Provides data that allows you to change the size of the floating element —\n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = size$1;\n\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = hide$1;\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = arrow$1;\n\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = inline$1;\n\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = limitShift$1;\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n */\nconst computePosition = (reference, floating, options) => {\n  // This caches the expensive `getClippingElementAncestors` function so that\n  // multiple lifecycle resets re-use the same result. It only lives for a\n  // single call. If other functions become expensive, we can add them as well.\n  const cache = new Map();\n  const mergedOptions = {\n    platform,\n    ...options\n  };\n  const platformWithCache = {\n    ...mergedOptions.platform,\n    _c: cache\n  };\n  return computePosition$1(reference, floating, {\n    ...mergedOptions,\n    platform: platformWithCache\n  });\n};\n\nexport { arrow, autoPlacement, autoUpdate, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, platform, shift, size };\n","//@ts-ignore\nimport { arrow as arrowCore } from \"./core\";\nimport { autoUpdate as _autoUpdate, computePosition } from \"./dom/index.js\";\nimport { get } from \"svelte/store\";\nimport { onDestroy, tick } from 'svelte';\nexport function createFloatingActions(initOptions) {\n    let referenceElement;\n    let floatingElement;\n    const defaultOptions = {\n        autoUpdate: true\n    };\n    let options = initOptions;\n    const getOptions = (mixin) => {\n        return { ...defaultOptions, ...(initOptions || {}), ...(mixin || {}) };\n    };\n    const updatePosition = (updateOptions) => {\n        if (referenceElement && floatingElement) {\n            options = getOptions(updateOptions);\n            computePosition(referenceElement, floatingElement, options)\n                .then(v => {\n                Object.assign(floatingElement.style, {\n                    position: v.strategy,\n                    left: `${v.x}px`,\n                    top: `${v.y}px`,\n                });\n                options?.onComputed && options.onComputed(v);\n            });\n        }\n    };\n    const referenceAction = node => {\n        if ('subscribe' in node) {\n            setupVirtualElementObserver(node);\n            return {};\n        }\n        else {\n            referenceElement = node;\n            updatePosition();\n        }\n    };\n    const contentAction = (node, contentOptions) => {\n        let autoUpdateDestroy;\n        floatingElement = node;\n        options = getOptions(contentOptions);\n        setTimeout(() => updatePosition(contentOptions), 0); //tick doesn't work\n        updatePosition(contentOptions);\n        const destroyAutoUpdate = () => {\n            if (autoUpdateDestroy) {\n                autoUpdateDestroy();\n                autoUpdateDestroy = undefined;\n            }\n        };\n        const initAutoUpdate = ({ autoUpdate } = options || {}) => {\n            destroyAutoUpdate();\n            if (autoUpdate !== false) {\n                tick().then(() => {\n                    return _autoUpdate(referenceElement, floatingElement, () => updatePosition(options), (autoUpdate === true ? {} : autoUpdate));\n                });\n            }\n            return;\n        };\n        autoUpdateDestroy = initAutoUpdate();\n        return {\n            update(contentOptions) {\n                updatePosition(contentOptions);\n                autoUpdateDestroy = initAutoUpdate(contentOptions);\n            },\n            destroy() {\n                destroyAutoUpdate();\n            }\n        };\n    };\n    const setupVirtualElementObserver = (node) => {\n        const unsubscribe = node.subscribe(($node) => {\n            if (referenceElement === undefined) {\n                referenceElement = $node;\n                updatePosition();\n            }\n            else {\n                // Preserve the reference to the virtual element.\n                Object.assign(referenceElement, $node);\n                updatePosition();\n            }\n        });\n        onDestroy(unsubscribe);\n    };\n    return [\n        referenceAction,\n        contentAction,\n        updatePosition\n    ];\n}\nexport function arrow(options) {\n    return {\n        name: \"arrow\",\n        options,\n        fn(args) {\n            const element = get(options.element);\n            if (element) {\n                return arrowCore({\n                    element,\n                    padding: options.padding\n                }).fn(args);\n            }\n            return {};\n        }\n    };\n}\n","export default function filter({\n    loadOptions,\n    filterText,\n    items,\n    multiple,\n    value,\n    itemId,\n    groupBy,\n    filterSelectedItems,\n    itemFilter,\n    convertStringItemsToObjects,\n    filterGroupedItems,\n    label,\n}) {\n    if (items && loadOptions) return items;\n    if (!items) return [];\n\n    if (items && items.length > 0 && typeof items[0] !== 'object') {\n        items = convertStringItemsToObjects(items);\n    }\n\n    let filterResults = items.filter((item) => {\n        let matchesFilter = itemFilter(item[label], filterText, item);\n        if (matchesFilter && multiple && value?.length) {\n            matchesFilter = !value.some((x) => {\n                return filterSelectedItems ? x[itemId] === item[itemId] : false;\n            });\n        }\n\n        return matchesFilter;\n    });\n\n    if (groupBy) {\n        filterResults = filterGroupedItems(filterResults);\n    }\n\n    return filterResults;\n}\n","export default async function getItems({ dispatch, loadOptions, convertStringItemsToObjects, filterText }) {\n    let res = await loadOptions(filterText).catch((err) => {\n        console.warn('svelte-select loadOptions error :>> ', err);\n        dispatch('error', { type: 'loadOptions', details: err });\n    });\n\n    if (res && !res.cancelled) {        \n        if (res) {\n            if (res && res.length > 0 && typeof res[0] !== 'object') {\n                res = convertStringItemsToObjects(res);\n            }\n            \n            dispatch('loaded', { items: res });\n        } else {\n            res = [];\n        }\n\n        return {\n            filteredItems: res,\n            loading: false,\n            focused: true,\n            listOpen: true,\n        };\n    }\n}\n","<script>\n    import { beforeUpdate, createEventDispatcher, onDestroy, onMount } from 'svelte';\n    import { offset, flip, shift } from 'svelte-floating-ui/dom';\n    import { createFloatingActions } from 'svelte-floating-ui';\n\n    const dispatch = createEventDispatcher();\n\n    import _filter from './filter';\n    import _getItems from './get-items';\n\n    import ChevronIcon from './ChevronIcon.svelte';\n    import ClearIcon from './ClearIcon.svelte';\n    import LoadingIcon from './LoadingIcon.svelte';\n\n    export let justValue = null; // read-only\n\n    export let filter = _filter;\n    export let getItems = _getItems;\n\n    export let id = null;\n    export let name = null;\n    export let container = undefined;\n    export let input = undefined;\n    export let multiple = false;\n    export let multiFullItemClearable = false;\n    export let disabled = false;\n    export let focused = false;\n    export let value = null;\n    export let filterText = '';\n    export let placeholder = 'Please select';\n    export let placeholderAlwaysShow = false;\n    export let items = null;\n    export let label = 'label';\n    export let itemFilter = (label, filterText, option) => `${label}`.toLowerCase().includes(filterText.toLowerCase());\n    export let groupBy = undefined;\n    export let groupFilter = (groups) => groups;\n    export let groupHeaderSelectable = false;\n    export let itemId = 'value';\n    export let loadOptions = undefined;\n    export let containerStyles = '';\n    export let hasError = false;\n    export let filterSelectedItems = true;\n    export let required = false;\n    export let closeListOnChange = true;\n    export let clearFilterTextOnBlur = true;\n\n    export let createGroupHeaderItem = (groupValue, item) => {\n        return {\n            value: groupValue,\n            [label]: groupValue,\n        };\n    };\n\n    export const getFilteredItems = () => {\n        return filteredItems;\n    };\n\n    export let searchable = true;\n    export let inputStyles = '';\n    export let clearable = true;\n    export let loading = false;\n    export let listOpen = false;\n\n    let timeout;\n    export let debounce = (fn, wait = 1) => {\n        clearTimeout(timeout);\n        timeout = setTimeout(fn, wait);\n    };\n\n    export let debounceWait = 300;\n    export let hideEmptyState = false;\n    export let inputAttributes = {};\n    export let listAutoWidth = true;\n    export let showChevron = false;\n    export let listOffset = 5;\n    export let hoverItemIndex = 0;\n    export let floatingConfig = {};\n\n    export { containerClasses as class };\n\n    let containerClasses = '';\n    let activeValue;\n    let prev_value;\n    let prev_filterText;\n    let prev_multiple;\n\n    function setValue() {\n        if (typeof value === 'string') {\n            let item = (items || []).find((item) => item[itemId] === value);\n            value = item || {\n                [itemId]: value,\n                label: value,\n            };\n        } else if (multiple && Array.isArray(value) && value.length > 0) {\n            value = value.map((item) => (typeof item === 'string' ? { value: item, label: item } : item));\n        }\n    }\n\n    let _inputAttributes;\n    function assignInputAttributes() {\n        _inputAttributes = Object.assign(\n            {\n                autocapitalize: 'none',\n                autocomplete: 'off',\n                autocorrect: 'off',\n                spellcheck: false,\n                tabindex: 0,\n                type: 'text',\n                'aria-autocomplete': 'list',\n            },\n            inputAttributes\n        );\n\n        if (id) {\n            _inputAttributes['id'] = id;\n        }\n\n        if (!searchable) {\n            _inputAttributes['readonly'] = true;\n        }\n    }\n\n    function convertStringItemsToObjects(_items) {\n        return _items.map((item, index) => {\n            return {\n                index,\n                value: item,\n                label: `${item}`,\n            };\n        });\n    }\n\n    function filterGroupedItems(_items) {\n        const groupValues = [];\n        const groups = {};\n\n        _items.forEach((item) => {\n            const groupValue = groupBy(item);\n\n            if (!groupValues.includes(groupValue)) {\n                groupValues.push(groupValue);\n                groups[groupValue] = [];\n\n                if (groupValue) {\n                    groups[groupValue].push(\n                        Object.assign(createGroupHeaderItem(groupValue, item), {\n                            id: groupValue,\n                            groupHeader: true,\n                            selectable: groupHeaderSelectable,\n                        })\n                    );\n                }\n            }\n\n            groups[groupValue].push(Object.assign({ groupItem: !!groupValue }, item));\n        });\n\n        const sortedGroupedItems = [];\n\n        groupFilter(groupValues).forEach((groupValue) => {\n            if (groups[groupValue]) sortedGroupedItems.push(...groups[groupValue]);\n        });\n\n        return sortedGroupedItems;\n    }\n\n    function dispatchSelectedItem() {\n        if (multiple) {\n            if (JSON.stringify(value) !== JSON.stringify(prev_value)) {\n                if (checkValueForDuplicates()) {\n                    dispatch('input', value);\n                }\n            }\n            return;\n        }\n\n        if (!prev_value || JSON.stringify(value[itemId]) !== JSON.stringify(prev_value[itemId])) {\n            dispatch('input', value);\n        }\n    }\n\n    function setupMulti() {\n        if (value) {\n            if (Array.isArray(value)) {\n                value = [...value];\n            } else {\n                value = [value];\n            }\n        }\n    }\n\n    function setupSingle() {\n        if (value) value = null;\n    }\n\n    $: if ((items, value)) setValue();\n    $: if (inputAttributes || !searchable) assignInputAttributes();\n    $: if (multiple) setupMulti();\n    $: if (prev_multiple && !multiple) setupSingle();\n    $: if (multiple && value && value.length > 1) checkValueForDuplicates();\n    $: if (value) dispatchSelectedItem();\n    $: if (!value && multiple && prev_value) dispatch('input', value);\n    $: if (!focused && input) closeList();\n    $: if (filterText !== prev_filterText) setupFilterText();\n    $: if (!multiple && listOpen && value && filteredItems) setValueIndexAsHoverIndex();\n    $: dispatchHover(hoverItemIndex);\n\n    function setValueIndexAsHoverIndex() {\n        const valueIndex = filteredItems.findIndex((i) => {\n            return i[itemId] === value[itemId];\n        });\n\n        checkHoverSelectable(valueIndex, true);\n    }\n\n    function dispatchHover(i) {\n        dispatch('hoverItem', i);\n    }\n\n    function checkHoverSelectable(startingIndex = 0, ignoreGroup) {\n        hoverItemIndex = startingIndex < 0 ? 0 : startingIndex;\n        if (!ignoreGroup && groupBy && filteredItems[hoverItemIndex] && !filteredItems[hoverItemIndex].selectable) {\n            setHoverIndex(1);\n        }\n    }\n\n    function setupFilterText() {\n        if (!loadOptions && filterText.length === 0) return;\n\n        if (loadOptions) {\n            debounce(async function () {\n                loading = true;\n                let res = await getItems({\n                    dispatch,\n                    loadOptions,\n                    convertStringItemsToObjects,\n                    filterText,\n                });\n\n                if (res) {\n                    loading = res.loading;\n                    listOpen = listOpen ? res.listOpen : filterText.length > 0 ? true : false;\n                    focused = listOpen && res.focused;\n                    items = groupBy ? filterGroupedItems(res.filteredItems) : res.filteredItems;\n                } else {\n                    loading = false;\n                    focused = true;\n                    listOpen = true;\n                }\n            }, debounceWait);\n        } else {\n            listOpen = true;\n\n            if (multiple) {\n                activeValue = undefined;\n            }\n        }\n    }\n\n    $: hasValue = multiple ? value && value.length > 0 : value;\n    $: hideSelectedItem = hasValue && filterText.length > 0;\n    $: showClear = hasValue && clearable && !disabled && !loading;\n    $: placeholderText =\n        placeholderAlwaysShow && multiple\n            ? placeholder\n            : multiple && value?.length === 0\n            ? placeholder\n            : value\n            ? ''\n            : placeholder;\n    $: ariaSelection = value ? handleAriaSelection(multiple) : '';\n    $: ariaContext = handleAriaContent({ filteredItems, hoverItemIndex, focused, listOpen });\n    $: updateValueDisplay(items);\n    $: justValue = computeJustValue(multiple, value, itemId);\n    $: if (!multiple && prev_value && !value) dispatch('input', value);\n    $: filteredItems = filter({\n        loadOptions,\n        filterText,\n        items,\n        multiple,\n        value,\n        itemId,\n        groupBy,\n        label,\n        filterSelectedItems,\n        itemFilter,\n        convertStringItemsToObjects,\n        filterGroupedItems,\n    });\n    $: if (listOpen && filteredItems && !multiple && !value) checkHoverSelectable();\n    $: handleFilterEvent(filteredItems);\n    $: if (container && floatingConfig) floatingUpdate(Object.assign(_floatingConfig, floatingConfig));\n    $: listDom = !!list;\n    $: listMounted(list, listOpen);\n    $: if (listOpen && container && list) setListWidth();\n    $: scrollToHoverItem = hoverItemIndex;\n    $: if (listOpen && multiple) hoverItemIndex = 0;\n    $: if (input && listOpen && !focused) handleFocus();\n    $: if (filterText) hoverItemIndex = 0;\n\n    function handleFilterEvent(items) {\n        if (listOpen) dispatch('filter', items);\n    }\n\n    beforeUpdate(async () => {\n        prev_value = value;\n        prev_filterText = filterText;\n        prev_multiple = multiple;\n    });\n\n    function computeJustValue() {\n        if (multiple) return value ? value.map((item) => item[itemId]) : null;\n        return value ? value[itemId] : value;\n    }\n\n    function checkValueForDuplicates() {\n        let noDuplicates = true;\n        if (value) {\n            const ids = [];\n            const uniqueValues = [];\n\n            value.forEach((val) => {\n                if (!ids.includes(val[itemId])) {\n                    ids.push(val[itemId]);\n                    uniqueValues.push(val);\n                } else {\n                    noDuplicates = false;\n                }\n            });\n\n            if (!noDuplicates) value = uniqueValues;\n        }\n        return noDuplicates;\n    }\n\n    function findItem(selection) {\n        let matchTo = selection ? selection[itemId] : value[itemId];\n        return items.find((item) => item[itemId] === matchTo);\n    }\n\n    function updateValueDisplay(items) {\n        if (!items || items.length === 0 || items.some((item) => typeof item !== 'object')) return;\n        if (!value || (multiple ? value.some((selection) => !selection || !selection[itemId]) : !value[itemId])) return;\n\n        if (Array.isArray(value)) {\n            value = value.map((selection) => findItem(selection) || selection);\n        } else {\n            value = findItem() || value;\n        }\n    }\n\n    async function handleMultiItemClear(i) {\n        const itemToRemove = value[i];\n\n        if (value.length === 1) {\n            value = undefined;\n        } else {\n            value = value.filter((item) => {\n                return item !== itemToRemove;\n            });\n        }\n\n        dispatch('clear', itemToRemove);\n    }\n\n    function handleKeyDown(e) {\n        if (!focused) return;\n        e.stopPropagation();\n        switch (e.key) {\n            case 'Escape':\n                e.preventDefault();\n                closeList();\n                break;\n            case 'Enter':\n                e.preventDefault();\n\n                if (listOpen) {\n                    if (filteredItems.length === 0) break;\n                    const hoverItem = filteredItems[hoverItemIndex];\n\n                    if (value && !multiple && value[itemId] === hoverItem[itemId]) {\n                        closeList();\n                        break;\n                    } else {\n                        handleSelect(filteredItems[hoverItemIndex]);\n                    }\n                }\n\n                break;\n            case 'ArrowDown':\n                e.preventDefault();\n\n                if (listOpen) {\n                    setHoverIndex(1);\n                } else {\n                    listOpen = true;\n                    activeValue = undefined;\n                }\n\n                break;\n            case 'ArrowUp':\n                e.preventDefault();\n\n                if (listOpen) {\n                    setHoverIndex(-1);\n                } else {\n                    listOpen = true;\n                    activeValue = undefined;\n                }\n\n                break;\n            case 'Tab':\n                if (listOpen && focused) {\n                    if (\n                        filteredItems.length === 0 ||\n                        (value && value[itemId] === filteredItems[hoverItemIndex][itemId])\n                    )\n                        return closeList();\n\n                    e.preventDefault();\n                    handleSelect(filteredItems[hoverItemIndex]);\n                    closeList();\n                }\n\n                break;\n            case 'Backspace':\n                if (!multiple || filterText.length > 0) return;\n\n                if (multiple && value && value.length > 0) {\n                    handleMultiItemClear(activeValue !== undefined ? activeValue : value.length - 1);\n                    if (activeValue === 0 || activeValue === undefined) break;\n                    activeValue = value.length > activeValue ? activeValue - 1 : undefined;\n                }\n\n                break;\n            case 'ArrowLeft':\n                if (!value || !multiple || filterText.length > 0) return;\n                if (activeValue === undefined) {\n                    activeValue = value.length - 1;\n                } else if (value.length > activeValue && activeValue !== 0) {\n                    activeValue -= 1;\n                }\n                break;\n            case 'ArrowRight':\n                if (!value || !multiple || filterText.length > 0 || activeValue === undefined) return;\n                if (activeValue === value.length - 1) {\n                    activeValue = undefined;\n                } else if (activeValue < value.length - 1) {\n                    activeValue += 1;\n                }\n                break;\n        }\n    }\n\n    function handleFocus(e) {\n        if (focused && input === document?.activeElement) return;\n        if (e) dispatch('focus', e);\n        input?.focus();\n        focused = true;\n    }\n\n    async function handleBlur(e) {\n        if (isScrolling) return;\n        if (listOpen || focused) {\n            dispatch('blur', e);\n            closeList();\n            focused = false;\n            activeValue = undefined;\n            input?.blur();\n        }\n    }\n\n    function handleClick() {\n        if (disabled) return;\n        if (filterText.length > 0) return listOpen = true;\n        listOpen = !listOpen;\n    }\n\n    export function handleClear() {\n        dispatch('clear', value);\n        value = undefined;\n        closeList();\n        handleFocus();\n    }\n\n    onMount(() => {\n        if (listOpen) focused = true;\n        if (focused && input) input.focus();\n    });\n\n    function itemSelected(selection) {\n        if (selection) {\n            filterText = '';\n            const item = Object.assign({}, selection);\n\n            if (item.groupHeader && !item.selectable) return;\n            value = multiple ? (value ? value.concat([item]) : [item]) : (value = item);\n\n            setTimeout(() => {\n                if (closeListOnChange) closeList();\n                activeValue = undefined;\n                dispatch('change', value);\n                dispatch('select', selection);\n            });\n        }\n    }\n\n    function closeList() {\n        if (clearFilterTextOnBlur) {\n            filterText = '';\n        }\n        listOpen = false;\n    }\n\n    export let ariaValues = (values) => {\n        return `Option ${values}, selected.`;\n    };\n\n    export let ariaListOpen = (label, count) => {\n        return `You are currently focused on option ${label}. There are ${count} results available.`;\n    };\n\n    export let ariaFocused = () => {\n        return `Select is focused, type to refine list, press down to open the menu.`;\n    };\n\n    function handleAriaSelection(_multiple) {\n        let selected = undefined;\n\n        if (_multiple && value.length > 0) {\n            selected = value.map((v) => v[label]).join(', ');\n        } else {\n            selected = value[label];\n        }\n\n        return ariaValues(selected);\n    }\n\n    function handleAriaContent() {\n        if (!filteredItems || filteredItems.length === 0) return '';\n        let _item = filteredItems[hoverItemIndex];\n        if (listOpen && _item) {\n            let count = filteredItems ? filteredItems.length : 0;\n            return ariaListOpen(_item[label], count);\n        } else {\n            return ariaFocused();\n        }\n    }\n\n    let list = null;\n\n    let isScrollingTimer;\n    function handleListScroll() {\n        clearTimeout(isScrollingTimer);\n        isScrollingTimer = setTimeout(() => {\n            isScrolling = false;\n        }, 100);\n    }\n\n    function handleClickOutside(event) {\n        if (!listOpen && !focused && container && !container.contains(event.target) && !list?.contains(event.target)) {\n            handleBlur();\n        }\n    }\n\n    onDestroy(() => {\n        list?.remove();\n    });\n\n    let isScrolling = false;\n\n    function handleSelect(item) {\n        if (!item || item.selectable === false) return;\n        itemSelected(item);\n    }\n\n    function handleHover(i) {\n        if (isScrolling) return;\n        hoverItemIndex = i;\n    }\n\n    function handleItemClick(args) {\n        const { item, i } = args;\n        if (item?.selectable === false) return;\n        if (value && !multiple && value[itemId] === item[itemId]) return closeList();\n        if (isItemSelectable(item)) {\n            hoverItemIndex = i;\n            handleSelect(item);\n        }\n    }\n\n    function setHoverIndex(increment) {\n        let selectableFilteredItems = filteredItems.filter(\n            (item) => !Object.hasOwn(item, 'selectable') || item.selectable === true\n        );\n\n        if (selectableFilteredItems.length === 0) {\n            return (hoverItemIndex = 0);\n        }\n\n        if (increment > 0 && hoverItemIndex === filteredItems.length - 1) {\n            hoverItemIndex = 0;\n        } else if (increment < 0 && hoverItemIndex === 0) {\n            hoverItemIndex = filteredItems.length - 1;\n        } else {\n            hoverItemIndex = hoverItemIndex + increment;\n        }\n\n        const hover = filteredItems[hoverItemIndex];\n\n        if (hover && hover.selectable === false) {\n            if (increment === 1 || increment === -1) setHoverIndex(increment);\n            return;\n        }\n    }\n\n    function isItemActive(item, value, itemId) {\n        if (multiple) return;\n        return value && value[itemId] === item[itemId];\n    }\n\n    function isItemFirst(itemIndex) {\n        return itemIndex === 0;\n    }\n\n    function isItemSelectable(item) {\n        return (item.groupHeader && item.selectable) || item.selectable || !item.hasOwnProperty('selectable');\n    }\n\n    const activeScroll = scrollAction;\n    const hoverScroll = scrollAction;\n\n    function scrollAction(node) {\n        return {\n            update(args) {\n                if (args.scroll) {\n                    handleListScroll();\n                    node.scrollIntoView({ behavior: 'auto', block: 'nearest' });\n                }\n            },\n        };\n    }\n\n    function setListWidth() {\n        const { width } = container.getBoundingClientRect();\n        list.style.width = listAutoWidth ? width + 'px' : 'auto';\n    }\n\n    let _floatingConfig = {\n        strategy: 'absolute',\n        placement: 'bottom-start',\n        middleware: [offset(listOffset), flip(), shift()],\n        autoUpdate: false,\n    };\n\n    const [floatingRef, floatingContent, floatingUpdate] = createFloatingActions(_floatingConfig);\n\n    $: if (container && floatingConfig?.autoUpdate === undefined) {\n        _floatingConfig.autoUpdate = true;\n    }\n\n    let prefloat = true;\n    function listMounted(list, listOpen) {\n        if (!list || !listOpen) return (prefloat = true);\n        setTimeout(() => {\n            prefloat = false;\n        }, 0);\n    }\n</script>\n\n<svelte:window on:click={handleClickOutside} on:keydown={handleKeyDown} />\n\n<div\n    class=\"svelte-select {containerClasses}\"\n    class:multi={multiple}\n    class:disabled\n    class:focused\n    class:list-open={listOpen}\n    class:show-chevron={showChevron}\n    class:error={hasError}\n    style={containerStyles}\n    on:pointerup|preventDefault={handleClick}\n    bind:this={container}\n    use:floatingRef\n    role=\"none\">\n    {#if listOpen}\n        <div\n            use:floatingContent\n            bind:this={list}\n            class=\"svelte-select-list\"\n            class:prefloat\n            on:scroll={handleListScroll}\n            on:pointerup|preventDefault|stopPropagation\n            on:mousedown|preventDefault|stopPropagation\n\t\t\trole=\"none\">\n            {#if $$slots['list-prepend']}<slot name=\"list-prepend\" />{/if}\n            {#if $$slots.list}<slot name=\"list\" {filteredItems} />\n            {:else if filteredItems.length > 0}\n                {#each filteredItems as item, i}\n                    <div\n                        on:mouseover={() => handleHover(i)}\n                        on:focus={() => handleHover(i)}\n                        on:click|stopPropagation={() => handleItemClick({ item, i })}\n                        on:keydown|preventDefault|stopPropagation\n                        class=\"list-item\"\n                        tabindex=\"-1\"\n                        role=\"none\">\n                        <div\n                            use:activeScroll={{ scroll: isItemActive(item, value, itemId), listDom }}\n                            use:hoverScroll={{ scroll: scrollToHoverItem === i, listDom }}\n                            class=\"item\"\n                            class:list-group-title={item.groupHeader}\n                            class:active={isItemActive(item, value, itemId)}\n                            class:first={isItemFirst(i)}\n                            class:hover={hoverItemIndex === i}\n                            class:group-item={item.groupItem}\n                            class:not-selectable={item?.selectable === false}>\n                            <slot name=\"item\" {item} index={i}>\n                                {item?.[label]}\n                            </slot>\n                        </div>\n                    </div>\n                {/each}\n            {:else if !hideEmptyState}\n                <slot name=\"empty\">\n                    <div class=\"empty\">No options</div>\n                </slot>\n            {/if}\n            {#if $$slots['list-append']}<slot name=\"list-append\" />{/if}\n        </div>\n    {/if}\n\n    <span aria-live=\"polite\" aria-atomic=\"false\" aria-relevant=\"additions text\" class=\"a11y-text\">\n        {#if focused}\n            <span id=\"aria-selection\">{ariaSelection}</span>\n            <span id=\"aria-context\">\n                {ariaContext}\n            </span>\n        {/if}\n    </span>\n\n    <div class=\"prepend\">\n        <slot name=\"prepend\" />\n    </div>\n\n    <div class=\"value-container\">\n        {#if hasValue}\n            {#if multiple}\n                {#each value as item, i}\n                    <div\n                        class=\"multi-item\"\n                        class:active={activeValue === i}\n                        class:disabled\n                        on:click|preventDefault={() => (multiFullItemClearable ? handleMultiItemClear(i) : {})}\n                        on:keydown|preventDefault|stopPropagation\n                        role=\"none\">\n                        <span class=\"multi-item-text\">\n                            <slot name=\"selection\" selection={item} index={i}>\n                                {item[label]}\n                            </slot>\n                        </span>\n\n                        {#if !disabled && !multiFullItemClearable && ClearIcon}\n                            <div\n                                class=\"multi-item-clear\"\n                                on:pointerup|preventDefault|stopPropagation={() => handleMultiItemClear(i)}>\n                                <slot name=\"multi-clear-icon\">\n                                    <ClearIcon />\n                                </slot>\n                            </div>\n                        {/if}\n                    </div>\n                {/each}\n            {:else}\n                <div class=\"selected-item\" class:hide-selected-item={hideSelectedItem}>\n                    <slot name=\"selection\" selection={value}>\n                        {value[label]}\n                    </slot>\n                </div>\n            {/if}\n        {/if}\n\n        <input\n            on:keydown={handleKeyDown}\n            on:blur={handleBlur}\n            on:focus={handleFocus}\n            readOnly={!searchable}\n            {..._inputAttributes}\n            bind:this={input}\n            bind:value={filterText}\n            placeholder={placeholderText}\n            style={inputStyles}\n            {disabled} />\n    </div>\n\n    <div class=\"indicators\">\n        {#if loading}\n            <div class=\"icon loading\" aria-hidden=\"true\">\n                <slot name=\"loading-icon\">\n                    <LoadingIcon />\n                </slot>\n            </div>\n        {/if}\n\n        {#if showClear}\n            <button type=\"button\" class=\"icon clear-select\" on:click={handleClear}>\n                <slot name=\"clear-icon\">\n                    <ClearIcon />\n                </slot>\n            </button>\n        {/if}\n\n        {#if showChevron}\n            <div class=\"icon chevron\" aria-hidden=\"true\">\n                <slot name=\"chevron-icon\" {listOpen}>\n                    <ChevronIcon />\n                </slot>\n            </div>\n        {/if}\n    </div>\n\n    <slot name=\"input-hidden\" {value}>\n        <input {name} type=\"hidden\" value={value ? JSON.stringify(value) : null} />\n    </slot>\n\n    {#if required && (!value || value.length === 0)}\n        <slot name=\"required\" {value}>\n            <select class=\"required\" required tabindex=\"-1\" aria-hidden=\"true\" />\n        </slot>\n    {/if}\n</div>\n\n<style>\n    .svelte-select {\n        /* deprecating camelCase custom props in favour of kebab-case for v5 */\n        --borderRadius: var(--border-radius);\n        --clearSelectColor: var(--clear-select-color);\n        --clearSelectWidth: var(--clear-select-width);\n        --disabledBackground: var(--disabled-background);\n        --disabledBorderColor: var(--disabled-border-color);\n        --disabledColor: var(--disabled-color);\n        --disabledPlaceholderColor: var(--disabled-placeholder-color);\n        --disabledPlaceholderOpacity: var(--disabled-placeholder-opacity);\n        --errorBackground: var(--error-background);\n        --errorBorder: var(--error-border);\n        --groupItemPaddingLeft: var(--group-item-padding-left);\n        --groupTitleColor: var(--group-title-color);\n        --groupTitleFontSize: var(--group-title-font-size);\n        --groupTitleFontWeight: var(--group-title-font-weight);\n        --groupTitlePadding: var(--group-title-padding);\n        --groupTitleTextTransform: var(--group-title-text-transform);\n        --groupTitleBorderColor: var(--group-title-border-color);\n        --groupTitleBorderWidth: var(--group-title-border-width);\n        --groupTitleBorderStyle: var(--group-title-border-style);\n        --indicatorColor: var(--chevron-color);\n        --indicatorHeight: var(--chevron-height);\n        --indicatorWidth: var(--chevron-width);\n        --inputColor: var(--input-color);\n        --inputLeft: var(--input-left);\n        --inputLetterSpacing: var(--input-letter-spacing);\n        --inputMargin: var(--input-margin);\n        --inputPadding: var(--input-padding);\n        --itemActiveBackground: var(--item-active-background);\n        --itemColor: var(--item-color);\n        --itemFirstBorderRadius: var(--item-first-border-radius);\n        --itemHoverBG: var(--item-hover-bg);\n        --itemHoverColor: var(--item-hover-color);\n        --itemIsActiveBG: var(--item-is-active-bg);\n        --itemIsActiveColor: var(--item-is-active-color);\n        --itemIsNotSelectableColor: var(--item-is-not-selectable-color);\n        --itemPadding: var(--item-padding);\n        --listBackground: var(--list-background);\n        --listBorder: var(--list-border);\n        --listBorderRadius: var(--list-border-radius);\n        --listEmptyColor: var(--list-empty-color);\n        --listEmptyPadding: var(--list-empty-padding);\n        --listEmptyTextAlign: var(--list-empty-text-align);\n        --listMaxHeight: var(--list-max-height);\n        --listPosition: var(--list-position);\n        --listShadow: var(--list-shadow);\n        --listZIndex: var(--list-z-index);\n        --multiItemBG: var(--multi-item-bg);\n        --multiItemBorderRadius: var(--multi-item-border-radius);\n        --multiItemDisabledHoverBg: var(--multi-item-disabled-hover-bg);\n        --multiItemDisabledHoverColor: var(--multi-item-disabled-hover-color);\n        --multiItemHeight: var(--multi-item-height);\n        --multiItemMargin: var(--multi-item-margin);\n        --multiItemPadding: var(--multi-item-padding);\n        --multiSelectInputMargin: var(--multi-select-input-margin);\n        --multiSelectInputPadding: var(--multi-select-input-padding);\n        --multiSelectPadding: var(--multi-select-padding);\n        --placeholderColor: var(--placeholder-color);\n        --placeholderOpacity: var(--placeholder-opacity);\n        --selectedItemPadding: var(--selected-item-padding);\n        --spinnerColor: var(--spinner-color);\n        --spinnerHeight: var(--spinner-height);\n        --spinnerWidth: var(--spinner-width);\n\n        --internal-padding: 0 0 0 16px;\n\n        border: var(--border, 1px solid #d8dbdf);\n        border-radius: var(--border-radius, 6px);\n        min-height: var(--height, 42px);\n        position: relative;\n        display: flex;\n        align-items: stretch;\n        padding: var(--padding, var(--internal-padding));\n        background: var(--background, #fff);\n        margin: var(--margin, 0);\n        width: var(--width, 100%);\n        font-size: var(--font-size, 16px);\n        max-height: var(--max-height);\n    }\n\n    * {\n        box-sizing: var(--box-sizing, border-box);\n    }\n\n    .svelte-select:hover {\n        border: var(--border-hover, 1px solid #b2b8bf);\n    }\n\n    .value-container {\n        display: flex;\n        flex: 1 1 0%;\n        flex-wrap: wrap;\n        align-items: center;\n        gap: 5px 10px;\n        padding: var(--value-container-padding, 5px 0);\n        position: relative;\n        overflow: var(--value-container-overflow, hidden);\n        align-self: stretch;\n    }\n\n    .prepend,\n    .indicators {\n        display: flex;\n        flex-shrink: 0;\n        align-items: center;\n    }\n\n    .indicators {\n        position: var(--indicators-position);\n        top: var(--indicators-top);\n        right: var(--indicators-right);\n        bottom: var(--indicators-bottom);\n    }\n\n    input {\n        position: absolute;\n        cursor: default;\n        border: none;\n        color: var(--input-color, var(--item-color));\n        padding: var(--input-padding, 0);\n        letter-spacing: var(--input-letter-spacing, inherit);\n        margin: var(--input-margin, 0);\n        min-width: 10px;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        background: transparent;\n        font-size: var(--font-size, 16px);\n    }\n\n    :not(.multi) > .value-container > input {\n        width: 100%;\n        height: 100%;\n    }\n\n    input::placeholder {\n        color: var(--placeholder-color, #78848f);\n        opacity: var(--placeholder-opacity, 1);\n    }\n\n    input:focus {\n        outline: none;\n    }\n\n    .svelte-select.focused {\n        border: var(--border-focused, 1px solid #006fe8);\n        border-radius: var(--border-radius-focused, var(--border-radius, 6px));\n    }\n\n    .disabled {\n        background: var(--disabled-background, #ebedef);\n        border-color: var(--disabled-border-color, #ebedef);\n        color: var(--disabled-color, #c1c6cc);\n    }\n\n    .disabled input::placeholder {\n        color: var(--disabled-placeholder-color, #c1c6cc);\n        opacity: var(--disabled-placeholder-opacity, 1);\n    }\n\n    .selected-item {\n        position: relative;\n        overflow: var(--selected-item-overflow, hidden);\n        padding: var(--selected-item-padding, 0 20px 0 0);\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        color: var(--selected-item-color, inherit);\n        font-size: var(--font-size, 16px);\n    }\n\n    .multi .selected-item {\n        position: absolute;\n        line-height: var(--height, 42px);\n        height: var(--height, 42px);\n    }\n\n    .selected-item:focus {\n        outline: none;\n    }\n\n    .hide-selected-item {\n        opacity: 0;\n    }\n\n    .icon {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .clear-select {\n        all: unset;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: var(--clear-select-width, 40px);\n        height: var(--clear-select-height, 100%);\n        color: var(--clear-select-color, var(--icons-color));\n        margin: var(--clear-select-margin, 0);\n        pointer-events: all;\n        flex-shrink: 0;\n    }\n\n    .clear-select:focus {\n        outline: var(--clear-select-focus-outline, 1px solid #006fe8);\n    }\n\n    .loading {\n        width: var(--loading-width, 40px);\n        height: var(--loading-height);\n        color: var(--loading-color, var(--icons-color));\n        margin: var(--loading--margin, 0);\n        flex-shrink: 0;\n    }\n\n    .chevron {\n        width: var(--chevron-width, 40px);\n        height: var(--chevron-height, 40px);\n        background: var(--chevron-background, transparent);\n        pointer-events: var(--chevron-pointer-events, none);\n        color: var(--chevron-color, var(--icons-color));\n        border: var(--chevron-border, 0 0 0 1px solid #d8dbdf);\n        flex-shrink: 0;\n    }\n\n    .multi {\n        padding: var(--multi-select-padding, var(--internal-padding));\n    }\n\n    .multi input {\n        padding: var(--multi-select-input-padding, 0);\n        position: relative;\n        margin: var(--multi-select-input-margin, 5px 0);\n        flex: 1 1 40px;\n    }\n\n    .svelte-select.error {\n        border: var(--error-border, 1px solid #ff2d55);\n        background: var(--error-background, #fff);\n    }\n\n    .a11y-text {\n        z-index: 9999;\n        border: 0px;\n        clip: rect(1px, 1px, 1px, 1px);\n        height: 1px;\n        width: 1px;\n        position: absolute;\n        overflow: hidden;\n        padding: 0px;\n        white-space: nowrap;\n    }\n\n    .multi-item {\n        background: var(--multi-item-bg, #ebedef);\n        margin: var(--multi-item-margin, 0);\n        outline: var(--multi-item-outline, 1px solid #ddd);\n        border-radius: var(--multi-item-border-radius, 4px);\n        height: var(--multi-item-height, 25px);\n        line-height: var(--multi-item-height, 25px);\n        display: flex;\n        cursor: default;\n        padding: var(--multi-item-padding, 0 5px);\n        overflow: hidden;\n        gap: var(--multi-item-gap, 4px);\n        outline-offset: -1px;\n        max-width: var(--multi-max-width, none);\n        color: var(--multi-item-color, var(--item-color));\n    }\n\n    .multi-item.disabled:hover {\n        background: var(--multi-item-disabled-hover-bg, #ebedef);\n        color: var(--multi-item-disabled-hover-color, #c1c6cc);\n    }\n\n    .multi-item-text {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n    }\n\n    .multi-item-clear {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        --clear-icon-color: var(--multi-item-clear-icon-color, #000);\n    }\n\n    .multi-item.active {\n        outline: var(--multi-item-active-outline, 1px solid #006fe8);\n    }\n\n    .svelte-select-list {\n        box-shadow: var(--list-shadow, 0 2px 3px 0 rgba(44, 62, 80, 0.24));\n        border-radius: var(--list-border-radius, 4px);\n        max-height: var(--list-max-height, 252px);\n        overflow-y: auto;\n        background: var(--list-background, #fff);\n        position: var(--list-position, absolute);\n        z-index: var(--list-z-index, 2);\n        border: var(--list-border);\n    }\n\n    .prefloat {\n        opacity: 0;\n        pointer-events: none;\n    }\n\n    .list-group-title {\n        color: var(--group-title-color, #8f8f8f);\n        cursor: default;\n        font-size: var(--group-title-font-size, 16px);\n        font-weight: var(--group-title-font-weight, 600);\n        height: var(--height, 42px);\n        line-height: var(--height, 42px);\n        padding: var(--group-title-padding, 0 20px);\n        text-overflow: ellipsis;\n        overflow-x: hidden;\n        white-space: nowrap;\n        text-transform: var(--group-title-text-transform, uppercase);\n        border-width: var(--group-title-border-width, medium);\n        border-style: var(--group-title-border-style, none);\n        border-color: var(--group-title-border-color, color);\n    }\n\n    .empty {\n        text-align: var(--list-empty-text-align, center);\n        padding: var(--list-empty-padding, 20px 0);\n        color: var(--list-empty-color, #78848f);\n    }\n\n    .item {\n        cursor: default;\n        height: var(--item-height, var(--height, 42px));\n        line-height: var(--item-line-height, var(--height, 42px));\n        padding: var(--item-padding, 0 20px);\n        color: var(--item-color, inherit);\n        text-overflow: ellipsis;\n        overflow: hidden;\n        white-space: nowrap;\n        transition: var(--item-transition, all 0.2s);\n        align-items: center;\n        width: 100%;\n    }\n\n    .item.group-item {\n        padding-left: var(--group-item-padding-left, 40px);\n    }\n\n    .item:active {\n        background: var(--item-active-background, #b9daff);\n    }\n\n    .item.active {\n        background: var(--item-is-active-bg, #007aff);\n        color: var(--item-is-active-color, #fff);\n    }\n\n    .item.first {\n        border-radius: var(--item-first-border-radius, 4px 4px 0 0);\n    }\n\n    .item.hover:not(.active) {\n        background: var(--item-hover-bg, #e7f2ff);\n        color: var(--item-hover-color, inherit);\n    }\n\n    .item.not-selectable,\n    .item.hover.item.not-selectable,\n    .item.active.item.not-selectable,\n    .item.not-selectable:active {\n        color: var(--item-is-not-selectable-color, #999);\n        background: transparent;\n    }\n\n    .required {\n        opacity: 0;\n        z-index: -1;\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n    }\n</style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Select from 'svelte-select'\n  import { getNestedPaths } from '$lib/utils/arrayUtils.js'\n  import { pathToOption } from '$lib/utils/pathUtils.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { isEqual } from 'lodash-es'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { setIn } from 'immutable-json-patch'\n  import type { PathOption, QueryLanguageOptions } from '$lib/types.js'\n\n  const debug = createDebug('jsoneditor:TransformWizard')\n\n  export let json: unknown\n  export let queryOptions: QueryLanguageOptions = {}\n  export let onChange: (queryOptions: QueryLanguageOptions) => void\n\n  // options\n  $: jsonIsArray = Array.isArray(json)\n  $: paths = jsonIsArray ? getNestedPaths(json) : []\n  $: pathsIncludingObjects = jsonIsArray ? getNestedPaths(json, true) : []\n  $: fieldOptions = paths.map(pathToOption)\n  $: projectionOptions = pathsIncludingObjects ? pathsIncludingObjects.map(pathToOption) : []\n\n  const filterRelationOptions = ['==', '!=', '<', '<=', '>', '>='].map((relation) => ({\n    value: relation,\n    label: relation\n  }))\n\n  const sortDirectionOptions = [\n    { value: 'asc', label: 'ascending' },\n    { value: 'desc', label: 'descending' }\n  ]\n\n  // TODO: the binding with the select boxes is very cumbersome. Can we simplify this?\n  let filterPath = queryOptions?.filter?.path ? pathToOption(queryOptions.filter.path) : undefined\n  let filterRelation =\n    filterRelationOptions.find((option) => option.value === queryOptions.filter?.relation) ??\n    filterRelationOptions[0]\n  let filterValue = queryOptions?.filter?.value || ''\n  let sortPath = queryOptions?.sort?.path ? pathToOption(queryOptions.sort.path) : undefined\n  let sortDirection =\n    sortDirectionOptions.find((option) => option.value === queryOptions.sort?.direction) ??\n    sortDirectionOptions[0]\n\n  $: projectionPaths =\n    queryOptions?.projection?.paths && projectionOptions\n      ? (queryOptions.projection.paths\n          .map((path) => projectionOptions.find((option) => isEqual(option.value, path)))\n          .filter((option) => !!option) as PathOption[])\n      : undefined\n\n  function changeFilterPath(path: JSONPath | undefined) {\n    if (!isEqual(queryOptions?.filter?.path, path)) {\n      debug('changeFilterPath', path)\n      queryOptions = setIn(queryOptions, ['filter', 'path'], path, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeFilterRelation(relation: string | undefined) {\n    if (!isEqual(queryOptions?.filter?.relation, relation)) {\n      debug('changeFilterRelation', relation)\n      queryOptions = setIn(queryOptions, ['filter', 'relation'], relation, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeFilterValue(value: string | undefined) {\n    if (!isEqual(queryOptions?.filter?.value, value)) {\n      debug('changeFilterValue', value)\n      queryOptions = setIn(queryOptions, ['filter', 'value'], value, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeSortPath(path: JSONPath | undefined) {\n    if (!isEqual(queryOptions?.sort?.path, path)) {\n      debug('changeSortPath', path)\n      queryOptions = setIn(queryOptions, ['sort', 'path'], path, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeSortDirection(direction: string | undefined) {\n    if (!isEqual(queryOptions?.sort?.direction, direction)) {\n      debug('changeSortDirection', direction)\n      queryOptions = setIn(queryOptions, ['sort', 'direction'], direction, true)\n      onChange(queryOptions)\n    }\n  }\n\n  function changeProjectionPaths(paths: JSONPath[] | unknown) {\n    if (!isEqual(queryOptions?.projection?.paths, paths)) {\n      debug('changeProjectionPaths', paths)\n      queryOptions = setIn(queryOptions, ['projection', 'paths'], paths, true)\n      onChange(queryOptions)\n    }\n  }\n\n  $: changeFilterPath(filterPath?.value)\n  $: changeFilterRelation(filterRelation?.value)\n  $: changeFilterValue(filterValue)\n  $: changeSortPath(sortPath?.value)\n  $: changeSortDirection(sortDirection?.value)\n  $: changeProjectionPaths(projectionPaths ? projectionPaths.map((item) => item.value) : undefined)\n</script>\n\n<table class=\"jse-transform-wizard\">\n  <tbody>\n    <tr>\n      <th>Filter</th>\n      <td>\n        <div class=\"jse-horizontal\">\n          <Select\n            class=\"jse-filter-path\"\n            showChevron\n            items={fieldOptions}\n            bind:value={filterPath}\n          />\n          <Select\n            class=\"jse-filter-relation\"\n            showChevron\n            clearable={false}\n            items={filterRelationOptions}\n            bind:value={filterRelation}\n          />\n          <input class=\"jse-filter-value\" bind:value={filterValue} />\n        </div>\n      </td>\n    </tr>\n    <tr>\n      <th>Sort</th>\n      <td>\n        <div class=\"jse-horizontal\">\n          <Select class=\"jse-sort-path\" showChevron items={fieldOptions} bind:value={sortPath} />\n          <Select\n            class=\"jse-sort-direction\"\n            showChevron\n            clearable={false}\n            items={sortDirectionOptions}\n            bind:value={sortDirection}\n          />\n        </div>\n      </td>\n    </tr>\n    <tr>\n      <th>Pick</th>\n      <td>\n        <div class=\"jse-horizontal\">\n          <Select\n            class=\"jse-projection-paths\"\n            multiple\n            showChevron\n            items={projectionOptions}\n            bind:value={projectionPaths}\n          />\n        </div>\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n<style src=\"./TransformWizard.scss\"></style>\n","<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faCheckSquare, faSquare } from '@fortawesome/free-regular-svg-icons'\n  import type { QueryLanguage, OnChangeQueryLanguage } from '$lib/types.js'\n\n  export let queryLanguages: QueryLanguage[]\n  export let queryLanguageId: string\n  export let onChangeQueryLanguage: OnChangeQueryLanguage\n\n  function handleChangeQueryLanguage(newQueryLanguageId: string) {\n    queryLanguageId = newQueryLanguageId\n    onChangeQueryLanguage(newQueryLanguageId)\n  }\n</script>\n\n<div class=\"jse-select-query-language\">\n  <div class=\"jse-select-query-language-container\">\n    {#each queryLanguages as queryLanguage}\n      <button\n        type=\"button\"\n        on:click={() => handleChangeQueryLanguage(queryLanguage.id)}\n        class=\"jse-query-language\"\n        class:selected={queryLanguage.id === queryLanguageId}\n        title={`Select ${queryLanguage.name} as query language`}\n      >\n        {#if queryLanguage.id === queryLanguageId}\n          <Icon data={faCheckSquare} />\n        {:else}\n          <Icon data={faSquare} />\n        {/if}\n        {queryLanguage.name}\n      </button>\n    {/each}\n  </div>\n</div>\n\n<style src=\"./SelectQueryLanguage.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import {\n    faDownLeftAndUpRightToCenter,\n    faTimes,\n    faUpRightAndDownLeftFromCenter\n  } from '@fortawesome/free-solid-svg-icons'\n\n  export let title = 'Modal'\n  export let fullScreenButton: boolean = false\n  export let fullscreen: boolean = false\n  export let onClose: (() => void) | undefined = undefined\n</script>\n\n<div class=\"jse-header\">\n  <div class=\"jse-title\">\n    {title}\n  </div>\n  <slot name=\"actions\" />\n  {#if fullScreenButton}\n    <button\n      type=\"button\"\n      class=\"jse-fullscreen\"\n      title=\"Toggle full screen\"\n      on:click={() => (fullscreen = !fullscreen)}\n    >\n      <Icon data={fullscreen ? faDownLeftAndUpRightToCenter : faUpRightAndDownLeftFromCenter} />\n    </button>\n  {/if}\n  <button type=\"button\" class=\"jse-close\" on:click={() => onClose?.()}>\n    <Icon data={faTimes} />\n  </button>\n</div>\n\n<style src=\"./Header.scss\"></style>\n","import { createDebug } from '$lib/utils/debug.js'\nimport {\n  AUTO_SCROLL_INTERVAL,\n  AUTO_SCROLL_SPEED_FAST,\n  AUTO_SCROLL_SPEED_NORMAL,\n  AUTO_SCROLL_SPEED_SLOW\n} from '$lib/constants.js'\n\nconst debug = createDebug('jsoneditor:AutoScrollHandler')\n\nexport function createAutoScrollHandler(scrollableElement: Element) {\n  debug('createAutoScrollHandler', scrollableElement)\n\n  let autoScrollSpeed: number | undefined // pixels per second\n  let autoScrollTimer: number | undefined\n\n  function calculateSpeed(diff: number) {\n    return diff < 20\n      ? AUTO_SCROLL_SPEED_SLOW\n      : diff < 50\n        ? AUTO_SCROLL_SPEED_NORMAL\n        : AUTO_SCROLL_SPEED_FAST\n  }\n\n  function autoScrollCallback() {\n    if (scrollableElement) {\n      // debug('auto scroll...')\n      const diff = (autoScrollSpeed || 0) * (AUTO_SCROLL_INTERVAL / 1000)\n\n      scrollableElement.scrollTop += diff\n    }\n  }\n\n  function startAutoScroll(speed: number) {\n    if (!autoScrollTimer || speed !== autoScrollSpeed) {\n      stopAutoScroll()\n\n      debug('startAutoScroll', speed)\n      autoScrollSpeed = speed\n      autoScrollTimer = setInterval(autoScrollCallback, AUTO_SCROLL_INTERVAL) as unknown as number\n    }\n  }\n\n  function stopAutoScroll() {\n    if (autoScrollTimer) {\n      debug('stopAutoScroll')\n\n      clearInterval(autoScrollTimer)\n      autoScrollTimer = undefined\n      autoScrollSpeed = undefined\n    }\n  }\n\n  function onDrag(event: MouseEvent) {\n    if (scrollableElement) {\n      const y = event.clientY\n      const { top, bottom } = scrollableElement.getBoundingClientRect()\n\n      if (y < top) {\n        const speed = calculateSpeed(top - y)\n        startAutoScroll(-speed)\n      } else if (y > bottom) {\n        const speed = calculateSpeed(y - bottom)\n        startAutoScroll(speed)\n      } else {\n        stopAutoScroll()\n      }\n    }\n  }\n\n  function onDragEnd() {\n    stopAutoScroll()\n  }\n\n  return {\n    onDrag,\n    onDragEnd\n  }\n}\n","// Robert Penner's easeInOutQuad\n\n// find the rest of his easing functions here: http://robertpenner.com/easing/\n// find them exported for ES6 consumption here: https://github.com/jaxgeller/ez.js\n\nexport default (t: number, b: number, c: number, d: number): number => {\n  t /= d / 2\n  if (t < 1) {\n    return (c / 2) * t * t + b\n  }\n  t--\n  return (-c / 2) * (t * (t - 2) - 1) + b\n}\n","import easeInOutQuad from './easing.js'\n\ntype Easing = (t: number, b: number, c: number, d: number) => number\ntype Duration = number | ((distance: number) => number)\n\ninterface JumpOptions {\n  duration?: Duration\n  offset?: number\n  callback?: () => void\n  easing?: Easing\n  a11y?: boolean\n  container?: Element | string\n}\n\nexport const createJump = () => {\n  // private variable cache\n  // no variables are created during a jump, preventing memory leaks\n\n  let container: Element // container element to be scrolled       (node)\n  let element: Element | undefined // element to scroll to                   (node)\n\n  let start: number // where scroll starts                    (px)\n  let stop: number // where scroll stops                     (px)\n\n  let offset // adjustment from the stop position      (px)\n  let easing: Easing // easing function                        (function)\n  let a11y: boolean // accessibility support flag             (boolean)\n\n  let distance: number // distance of scroll                     (px)\n  let duration: number // scroll duration                        (ms)\n\n  let timeStart: number // time scroll started                    (ms)\n  let timeElapsed: number // time spent scrolling thus far          (ms)\n\n  let next: number // next scroll position                   (px)\n\n  let callback: (() => void) | undefined // to call when done scrolling            (function)\n\n  let scrolling: boolean // true whilst scrolling                  (boolean)\n\n  // scroll position helper\n\n  function location() {\n    return container.scrollTop\n  }\n\n  // element offset helper\n\n  function top(element: Element) {\n    const elementTop = element.getBoundingClientRect().top\n    const containerTop = container.getBoundingClientRect ? container.getBoundingClientRect().top : 0\n\n    return elementTop - containerTop + start\n  }\n\n  // scrollTo helper\n\n  function scrollTo(top: number) {\n    if (container.scrollTo) {\n      container.scrollTo(container.scrollLeft, top) // window\n    } else {\n      container.scrollTop = top // custom container\n    }\n  }\n\n  // rAF loop helper\n\n  function loop(timeCurrent: number) {\n    // store time scroll started, if not started already\n    if (!timeStart) {\n      timeStart = timeCurrent\n    }\n\n    // determine time spent scrolling so far\n    timeElapsed = timeCurrent - timeStart\n\n    // calculate next scroll position\n    next = easing(timeElapsed, start, distance, duration)\n\n    // scroll to it\n    scrollTo(next)\n\n    scrolling = true\n\n    // check progress\n    if (timeElapsed < duration) {\n      requestAnimationFrame(loop) // continue scroll loop\n    } else {\n      done() // scrolling is done\n    }\n  }\n\n  // scroll finished helper\n\n  function done() {\n    // account for rAF time rounding inaccuracies\n    scrollTo(start + distance)\n\n    // if scrolling to an element, and accessibility is enabled\n    if (element && a11y) {\n      // add tabindex indicating programmatic focus\n      element.setAttribute('tabindex', '-1')\n\n      // focus the element\n      const htmlElement = element as HTMLElement\n      htmlElement.focus()\n    }\n\n    // if it exists, fire the callback\n    if (typeof callback === 'function') {\n      callback()\n    }\n\n    // reset time for next jump\n    timeStart = 0\n\n    // we're done scrolling\n    scrolling = false\n  }\n\n  // API\n\n  function jump(target: Element | number | string, options: JumpOptions = {}) {\n    // resolve options, or use defaults\n    duration = 1000\n    offset = options.offset || 0\n    callback = options.callback // \"undefined\" is a suitable default, and won't be called\n    easing = options.easing || easeInOutQuad\n    a11y = options.a11y || false\n\n    // resolve container\n    switch (typeof options.container) {\n      case 'object':\n        // we assume container is an HTML element (Node)\n        container = options.container\n        break\n\n      case 'string':\n        container = document.querySelector(options.container) as Element\n        break\n\n      default:\n        container = window.document.documentElement\n    }\n\n    // cache starting position\n    start = location()\n\n    // resolve target\n    switch (typeof target) {\n      // scroll from current position\n      case 'number':\n        element = undefined // no element to scroll to\n        a11y = false // make sure accessibility is off\n        stop = start + target\n        break\n\n      // scroll to element (node)\n      // bounding rect is relative to the viewport\n      case 'object':\n        element = target\n        stop = top(element)\n        break\n\n      // scroll to element (selector)\n      // bounding rect is relative to the viewport\n      case 'string':\n        element = document.querySelector(target) as unknown as Element\n        stop = top(element)\n        break\n\n      default:\n    }\n\n    // resolve scroll distance, accounting for offset\n    distance = stop - start + offset\n\n    // resolve duration\n    switch (typeof options.duration) {\n      // number in ms\n      case 'number':\n        duration = options.duration\n        break\n\n      // function passed the distance of the scroll\n      case 'function':\n        duration = options.duration(distance)\n        break\n\n      default:\n    }\n\n    // start the loop if we're not already scrolling\n    if (!scrolling) {\n      requestAnimationFrame(loop)\n    } else {\n      // reset time for next jump\n      timeStart = 0\n    }\n  }\n\n  // expose only the jump method\n  return jump\n}\n\n// export singleton\n\nconst singleton = createJump()\n\nexport default singleton\n","/**\n * Measure how long a callback takes to execute.\n * Returns the response from the callback\n * The measured duration is returned via the onDuration callback\n */\nexport function measure<T>(callback: () => T, onDuration: (duration: number) => void): T {\n  const start = Date.now()\n  const result = callback()\n  const end = Date.now()\n\n  onDuration(end - start)\n\n  return result\n}\n","import { initial, isEmpty } from 'lodash-es'\nimport type {\n  ContentErrors,\n  JSONParser,\n  RecursiveStateFactory,\n  ValidationErrors,\n  ValidationError,\n  Validator\n} from '$lib/types.js'\nimport { ValidationSeverity } from '$lib/types.js'\nimport { MAX_AUTO_REPAIRABLE_SIZE, MAX_VALIDATABLE_SIZE } from '../constants.js'\nimport { measure } from '../utils/timeUtils.js'\nimport { normalizeJsonParseError } from '../utils/jsonUtils.js'\nimport { createDebug } from '../utils/debug.js'\nimport { jsonrepair } from 'jsonrepair'\nimport { updateInRecursiveState } from './documentState.js'\nimport type { JSONPath } from 'immutable-json-patch'\n\nconst debug = createDebug('validation')\n\nexport const validationErrorsFactory: RecursiveStateFactory = {\n  createObjectDocumentState: () => ({ type: 'object', properties: {} }),\n  createArrayDocumentState: () => ({ type: 'array', items: [] }),\n  createValueDocumentState: () => ({ type: 'value' })\n}\n\nexport function updateInValidationErrors(\n  json: unknown,\n  errors: ValidationErrors | undefined,\n  path: JSONPath,\n  transform: (value: unknown, state: ValidationErrors) => ValidationErrors\n): ValidationErrors {\n  return updateInRecursiveState(json, errors, path, transform, validationErrorsFactory)\n}\n\n/**\n * Create a flat map with validation errors, where the key is the stringified path\n * and also create error messages for the parent nodes of the nodes having an error.\n *\n * Returns a nested object containing the validation errors\n */\nexport function toRecursiveValidationErrors(\n  json: unknown,\n  validationErrors: ValidationError[]\n): ValidationErrors | undefined {\n  let output: ValidationErrors | undefined\n\n  // first generate the errors themselves\n  validationErrors.forEach((validationError) => {\n    output = updateInValidationErrors(json, output, validationError.path, (_, state) => ({\n      ...state,\n      validationError\n    }))\n  })\n\n  // create error entries for all parent nodes (displayed when the node is collapsed)\n  validationErrors.forEach((validationError) => {\n    let parentPath = validationError.path\n\n    while (parentPath.length > 0) {\n      parentPath = initial(parentPath)\n\n      output = updateInValidationErrors(json, output, parentPath, (_, state) => {\n        return state.validationError\n          ? state\n          : {\n              ...state,\n              validationError: {\n                isChildError: true,\n                path: parentPath,\n                message: 'Contains invalid data',\n                severity: ValidationSeverity.warning\n              }\n            }\n      })\n    }\n  })\n\n  return output\n}\n\nexport function validateJSON(\n  json: unknown,\n  validator: Validator | undefined,\n  parser: JSONParser,\n  validationParser: JSONParser\n): ValidationError[] {\n  debug('validateJSON')\n\n  if (!validator) {\n    return []\n  }\n\n  if (parser !== validationParser) {\n    // if needed, convert for example Lossless JSON to native JSON\n    // (like replace bigint or LosslessNumber into regular numbers)\n    const text = parser.stringify(json)\n    const convertedJSON = text !== undefined ? validationParser.parse(text) : undefined\n    return validator(convertedJSON)\n  } else {\n    return validator(json)\n  }\n}\n\nexport function validateText(\n  text: string,\n  validator: Validator | undefined,\n  parser: JSONParser,\n  validationParser: JSONParser\n): ContentErrors | undefined {\n  debug('validateText')\n\n  if (text.length > MAX_VALIDATABLE_SIZE) {\n    const validationError: ValidationError = {\n      path: [],\n      message: 'Validation turned off: the document is too large',\n      severity: ValidationSeverity.info\n    }\n\n    return {\n      validationErrors: [validationError]\n    }\n  }\n\n  if (text.length === 0) {\n    // new, empty document, do not try to parse\n    return undefined\n  }\n\n  try {\n    // parse with the \"main\" parser (not the validation parser) to get parse errors\n    // (like syntax errors and duplicate keys errors)\n    const json = measure(\n      () => parser.parse(text),\n      (duration) => debug(`validate: parsed json in ${duration} ms`)\n    )\n\n    if (!validator) {\n      return undefined\n    }\n\n    // if needed, parse with the validationParser to be able to feed the json to the validator\n    const convertedJSON =\n      parser === validationParser\n        ? json\n        : measure(\n            () => validationParser.parse(text),\n            (duration) => debug(`validate: parsed json with the validationParser in ${duration} ms`)\n          )\n\n    // actually validate the json\n    const validationErrors = measure(\n      () => validator(convertedJSON),\n      (duration) => debug(`validate: validated json in ${duration} ms`)\n    )\n\n    return !isEmpty(validationErrors) ? { validationErrors } : undefined\n  } catch (err) {\n    const isRepairable = measure(\n      () => canAutoRepair(text, parser),\n      (duration) => debug(`validate: checked whether repairable in ${duration} ms`)\n    )\n\n    const parseError = normalizeJsonParseError(\n      text,\n      (err as Error).message || (err as Error).toString()\n    )\n\n    return {\n      parseError,\n      isRepairable\n    }\n  }\n}\n\nfunction canAutoRepair(text: string, parser: JSONParser): boolean {\n  if (text.length > MAX_AUTO_REPAIRABLE_SIZE) {\n    return false\n  }\n\n  try {\n    parser.parse(jsonrepair(text))\n\n    return true\n  } catch {\n    return false\n  }\n}\n","import { createDebug } from '$lib/utils/debug.js'\n\nconst debug = createDebug('jsoneditor:FocusTracker')\n\nexport interface FocusTrackerProps {\n  onMount: (callback: () => void) => void\n  onDestroy: (callback: () => void) => void\n  getWindow: () => Window | undefined\n  hasFocus: () => boolean\n  onFocus: () => void\n  onBlur: () => void\n}\n\nexport function createFocusTracker({\n  onMount,\n  onDestroy,\n  getWindow,\n  hasFocus,\n  onFocus,\n  onBlur\n}: FocusTrackerProps) {\n  let blurTimeoutHandle: number | undefined\n  let focus = false\n\n  function handleFocusIn() {\n    const newFocus = hasFocus()\n\n    if (newFocus) {\n      clearTimeout(blurTimeoutHandle)\n      if (!focus) {\n        debug('focus')\n        onFocus()\n        focus = newFocus\n      }\n    }\n  }\n\n  function handleFocusOut() {\n    if (focus) {\n      // We set focus to false after timeout. Often, you get a blur and directly\n      // another focus when moving focus from one button to another.\n      // The focusIn handler will cancel any pending blur timer in those cases\n      clearTimeout(blurTimeoutHandle)\n      blurTimeoutHandle = setTimeout(() => {\n        if (!hasFocus()) {\n          debug('blur')\n          focus = false\n          onBlur()\n        }\n      }) as unknown as number\n    }\n  }\n\n  onMount(() => {\n    debug('mount FocusTracker')\n    const window = getWindow()\n    if (window) {\n      window.addEventListener('focusin', handleFocusIn, true)\n      window.addEventListener('focusout', handleFocusOut, true)\n    }\n  })\n\n  onDestroy(() => {\n    debug('destroy FocusTracker')\n    const window = getWindow()\n    if (window) {\n      window.removeEventListener('focusin', handleFocusIn, true)\n      window.removeEventListener('focusout', handleFocusOut, true)\n    }\n  })\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import type { MessageAction } from '$lib/types'\n  import type { IconDefinition } from '@fortawesome/free-solid-svg-icons'\n  import { onDestroy } from 'svelte'\n\n  export let type: 'success' | 'error' | 'warning' | 'info' = 'success'\n  export let icon: IconDefinition | undefined = undefined\n  export let message: string | undefined = undefined\n  export let actions: MessageAction[] = []\n  export let onClick: (() => void) | undefined = undefined\n  export let onClose: (() => void) | undefined = undefined\n\n  if (onClose) {\n    onDestroy(onClose)\n  }\n\n  function handleClick() {\n    if (onClick) {\n      onClick()\n    }\n  }\n</script>\n\n<div class=\"jse-message jse-{type}\">\n  <!-- svelte-ignore a11y-click-events-have-key-events -->\n  <div\n    role=\"button\"\n    tabindex=\"-1\"\n    class=\"jse-text\"\n    class:jse-clickable={!!onClick}\n    on:click={handleClick}\n  >\n    <div class=\"jse-text-centered\">\n      {#if icon}\n        <Icon data={icon} />\n      {/if}\n      {message}\n    </div>\n  </div>\n  <div class=\"jse-actions\">\n    {#each actions as action}\n      <button\n        type=\"button\"\n        on:click={() => {\n          if (action.onClick) {\n            action.onClick()\n          }\n        }}\n        on:mousedown={() => {\n          if (action.onMouseDown) {\n            action.onMouseDown()\n          }\n        }}\n        class=\"jse-button jse-action jse-primary\"\n        title={action.title}\n        disabled={action.disabled}\n      >\n        {#if action.icon}\n          <Icon data={action.icon} />\n        {/if}\n        {action.text}\n      </button>\n    {/each}\n  </div>\n</div>\n\n<style src=\"./Message.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faAngleDown,\n    faAngleRight,\n    faExclamationTriangle\n  } from '@fortawesome/free-solid-svg-icons'\n  import { isEmpty } from 'lodash-es'\n  import Icon from 'svelte-awesome'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import { ValidationSeverity, type ValidationError } from '$lib/types.js'\n  import { MAX_VALIDATION_ERRORS } from '$lib/constants.js'\n  import { limit } from '$lib/utils/arrayUtils.js'\n\n  export let validationErrors: ValidationError[]\n  export let selectError: (error: ValidationError) => void\n\n  $: count = validationErrors.length\n\n  let expanded = true\n\n  function collapse() {\n    expanded = false\n  }\n\n  function expand() {\n    expanded = true\n  }\n\n  function getMaxSeverity(errors: ValidationError[]): ValidationSeverity | undefined {\n    const severities = [\n      ValidationSeverity.error,\n      ValidationSeverity.warning,\n      ValidationSeverity.info\n    ]\n\n    return severities.find((severity) => errors.some((error) => error.severity === severity))\n  }\n</script>\n\n{#if !isEmpty(validationErrors)}\n  <div class=\"jse-validation-errors-overview\">\n    {#if expanded || count === 1}\n      <table class=\"jse-validation-errors-overview-expanded\">\n        <tbody>\n          {#each limit(validationErrors, MAX_VALIDATION_ERRORS) as validationError, index}\n            <tr\n              class=\"jse-validation-{validationError.severity}\"\n              tabindex=\"0\"\n              on:click={() => {\n                // trigger on the next tick to prevent the editor not getting focus\n                setTimeout(() => selectError(validationError))\n              }}\n            >\n              <td class=\"jse-validation-error-icon\">\n                <Icon data={faExclamationTriangle} />\n              </td>\n              <td class=\"jse-validation-error-path\">\n                {stringifyJSONPath(validationError.path)}\n              </td>\n              <td class=\"jse-validation-error-message\">\n                {validationError.message}\n              </td>\n              <td class=\"jse-validation-error-action\">\n                {#if index === 0 && validationErrors.length > 1}\n                  <button\n                    type=\"button\"\n                    class=\"jse-validation-errors-collapse\"\n                    on:click|stopPropagation={collapse}\n                    title=\"Collapse validation errors\"\n                  >\n                    <Icon data={faAngleDown} />\n                  </button>\n                {/if}\n              </td>\n            </tr>\n          {/each}\n\n          {#if count > MAX_VALIDATION_ERRORS}\n            <tr class=\"jse-validation-error\">\n              <td></td>\n              <td></td>\n              <td>(and {count - MAX_VALIDATION_ERRORS} more errors)</td>\n              <td></td>\n            </tr>\n          {/if}\n        </tbody>\n      </table>\n    {:else}\n      <table class=\"jse-validation-errors-overview-collapsed\">\n        <tbody>\n          <tr class=\"jse-validation-{getMaxSeverity(validationErrors)}\" on:click={expand}>\n            <td class=\"jse-validation-error-icon\">\n              <Icon data={faExclamationTriangle} />\n            </td>\n            <td class=\"jse-validation-error-count\">\n              {count} validation errors\n              <div class=\"jse-validation-errors-expand\">\n                <Icon data={faAngleRight} />\n              </div>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    {/if}\n  </div>\n{/if}\n\n<style src=\"./ValidationErrorsOverview.scss\"></style>\n","type Callback = () => void\n\n/**\n * The provided callback is invoked when the user presses Escape, and then stops propagation of the event.\n */\nexport function onEscape(element: HTMLElement | undefined, callback: Callback) {\n  if (!element) {\n    return undefined\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    if (event.key === 'Escape') {\n      event.preventDefault()\n      event.stopPropagation()\n      callback()\n    }\n  }\n\n  element.addEventListener('keydown', handleKeyDown)\n\n  return {\n    destroy() {\n      element.removeEventListener('keydown', handleKeyDown)\n    }\n  }\n}\n","<script lang=\"ts\">\n  // code based on: https://svelte.dev/examples/modal\n  import { onEscape } from '$lib/actions/onEscape.js'\n  import { onDestroy, onMount } from 'svelte'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  export let className: string | undefined = undefined\n  export let fullscreen = false\n  export let onClose: () => void\n\n  let dialog: HTMLDialogElement\n\n  onMount(() => dialog.showModal())\n  onDestroy(() => dialog.close())\n\n  function close() {\n    onClose()\n  }\n</script>\n\n<dialog\n  bind:this={dialog}\n  on:close={close}\n  on:pointerdown|self={close}\n  on:cancel|preventDefault\n  use:onEscape={close}\n  class={classnames('jse-modal', className)}\n  class:jse-fullscreen={fullscreen}\n>\n  <div class=\"jse-modal-inner\">\n    <slot />\n  </div>\n</dialog>\n\n<style lang=\"scss\">\n  @use '../../themes/defaults.scss';\n  @use '../../styles.scss';\n\n  dialog.jse-modal {\n    border-radius: styles.$border-radius;\n    font-size: defaults.$padding; // for some reason that I don't understand, the font-size of the dialog is used as margin around the dialog\n    border: none;\n    padding: 0;\n    display: flex;\n    min-width: 0;\n    margin: auto;\n    overflow: visible;\n    transition:\n      width 0.1s ease-in-out,\n      height 0.1s ease-in-out;\n\n    &.jse-sort-modal {\n      width: 400px;\n    }\n\n    &.jse-repair-modal {\n      width: 600px;\n      height: 500px;\n    }\n\n    &.jse-jsoneditor-modal {\n      width: 800px;\n      height: 600px;\n    }\n\n    &.jse-transform-modal {\n      width: 1200px;\n      height: 800px;\n    }\n\n    &.jse-fullscreen {\n      width: 100%;\n      height: 100%;\n    }\n\n    &::backdrop {\n      background: defaults.$modal-overlay-background;\n    }\n\n    &[open] {\n      animation: zoom 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);\n    }\n\n    &[open]::backdrop {\n      animation: fade 0.2s ease-out;\n    }\n\n    & .jse-modal-inner {\n      @include styles.jse-modal-style;\n    }\n\n    @keyframes zoom {\n      from {\n        transform: scale(0.95);\n      }\n      to {\n        transform: scale(1);\n      }\n    }\n\n    @keyframes fade {\n      from {\n        opacity: 0;\n      }\n      to {\n        opacity: 1;\n      }\n    }\n\n    // styling for the select box, svelte-select\n    // see docs: https://github.com/rob-balfre/svelte-select#css-custom-properties-variables\n    :global(.svelte-select) {\n      --border: #{defaults.$svelte-select-border};\n      --item-is-active-bg: #{defaults.$svelte-select-item-is-active-bg};\n      --border-radius: #{defaults.$svelte-select-border-radius};\n      --background: #{defaults.$svelte-select-background};\n      --padding: #{defaults.$svelte-select-padding};\n      --multi-select-padding: #{defaults.$svelte-select-multi-select-padding};\n      --font-size: #{defaults.$svelte-select-font-size};\n      --height: 36px;\n      --multi-item-height: 28px;\n      --multi-item-margin: 2px;\n      --multi-item-padding: 2px 8px;\n      --multi-item-border-radius: 6px;\n      --indicator-top: 8px;\n    }\n  }\n</style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { isMacDevice } from '$lib/utils/navigatorUtils.js'\n  import Header from './Header.svelte'\n  import Modal from './Modal.svelte'\n\n  export let onClose: () => void\n\n  const ctrl = isMacDevice() ? '⌘' : 'Ctrl'\n</script>\n\n<Modal {onClose} className=\"jse-copy-paste\">\n  <Header title=\"Copying and pasting\" {onClose} />\n\n  <div class=\"jse-modal-contents\">\n    <div>Clipboard permission is disabled by your browser. You can use:</div>\n\n    <div class=\"jse-shortcuts\">\n      <div class=\"jse-shortcut\">\n        <div class=\"jse-key\">\n          {ctrl}+C\n        </div>\n        for copy\n      </div>\n      <div class=\"jse-shortcut\">\n        <div class=\"jse-key\">\n          {ctrl}+X\n        </div>\n        for cut\n      </div>\n      <div class=\"jse-shortcut\">\n        <div class=\"jse-key\">\n          {ctrl}+V\n        </div>\n        for paste\n      </div>\n    </div>\n\n    <div class=\"jse-actions\">\n      <button type=\"button\" class=\"jse-primary\" on:click={onClose}> Close </button>\n    </div>\n  </div>\n</Modal>\n\n<style src=\"./CopyPasteModal.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import type { MenuItem } from '$lib/types'\n  import { isMenuButton, isMenuSeparator, isMenuSpace } from '$lib/typeguards.js'\n\n  export let items: MenuItem[] = []\n\n  function unknownMenuItem(item: MenuItem): string {\n    console.error('Unknown type of menu item', item)\n    return '???'\n  }\n</script>\n\n<div class=\"jse-menu\">\n  <slot name=\"left\" />\n\n  {#each items as item}\n    {#if isMenuSeparator(item)}\n      <div class=\"jse-separator\"></div>\n    {:else if isMenuSpace(item)}\n      <div class=\"jse-space\"></div>\n    {:else if isMenuButton(item)}\n      <button\n        type=\"button\"\n        class=\"jse-button {item.className}\"\n        on:click={item.onClick}\n        title={item.title}\n        disabled={item.disabled || false}\n      >\n        {#if item.icon}\n          <Icon data={item.icon} />\n        {/if}\n        {#if item.text}\n          {item.text}\n        {/if}\n      </button>\n    {:else}\n      {unknownMenuItem(item)}\n    {/if}\n  {/each}\n\n  <slot name=\"right\" />\n</div>\n\n<style src=\"./Menu.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faArrowDown,\n    faCheck,\n    faExclamationTriangle,\n    faTimes,\n    faWrench\n  } from '@fortawesome/free-solid-svg-icons'\n  import { createDebug } from '$lib/utils/debug.js'\n  import Message from '../../controls/Message.svelte'\n  import { normalizeJsonParseError } from '$lib/utils/jsonUtils.js'\n  import Menu from '../../controls/Menu.svelte'\n  import type { MenuItem, ParseError } from '$lib/types.js'\n\n  export let text = ''\n  export let readOnly = false\n  export let onParse: (text: string) => void\n  export let onRepair: (text: string) => string\n  export let onChange: ((updatedText: string) => void) | undefined = undefined\n  export let onApply: (repairedText: string) => void\n  export let onCancel: () => void\n\n  const debug = createDebug('jsoneditor:JSONRepair')\n\n  let domTextArea: HTMLTextAreaElement\n\n  $: error = getErrorMessage(text)\n  $: repairable = isRepairable(text)\n\n  $: debug('error', error)\n\n  function getErrorMessage(jsonText: string): ParseError | undefined {\n    try {\n      onParse(jsonText)\n      return undefined\n    } catch (err) {\n      return normalizeJsonParseError(jsonText, (err as Error).message)\n    }\n  }\n\n  function isRepairable(jsonText: string) {\n    try {\n      onRepair(jsonText)\n      return true\n    } catch {\n      return false\n    }\n  }\n\n  function goToError() {\n    if (domTextArea && error) {\n      const position = error.position !== undefined ? error.position : 0\n      domTextArea.setSelectionRange(position, position)\n      domTextArea.focus()\n    }\n  }\n\n  function handleChange(event: Event & { currentTarget: EventTarget & HTMLTextAreaElement }) {\n    debug('handleChange')\n\n    const value = (event.target as HTMLTextAreaElement).value\n\n    if (text === value) {\n      return\n    }\n\n    text = value\n\n    if (onChange) {\n      onChange(text)\n    }\n  }\n\n  function handleApply() {\n    onApply(text)\n  }\n\n  function handleRepair() {\n    try {\n      // TODO: simpleJsonRepair should also partially apply fixes. Now it's all or nothing\n      text = onRepair(text)\n\n      if (onChange) {\n        onChange(text)\n      }\n    } catch {\n      // no need to do something with the error\n    }\n  }\n\n  let items: MenuItem[]\n  $: items = [\n    {\n      type: 'space'\n    },\n    {\n      type: 'button',\n      icon: faTimes,\n      title: 'Cancel repair',\n      className: 'jse-cancel',\n      onClick: onCancel\n    }\n  ]\n\n  $: gotoAction = {\n    icon: faArrowDown,\n    text: 'Show me',\n    title: 'Scroll to the error location',\n    onClick: goToError\n  }\n\n  $: repairAction = {\n    icon: faWrench,\n    text: 'Auto repair',\n    title: 'Automatically repair JSON',\n    onClick: handleRepair\n  }\n\n  $: errorActions = repairable ? [gotoAction, repairAction] : [gotoAction]\n\n  $: successActions = [\n    {\n      icon: faCheck,\n      text: 'Apply',\n      title: 'Apply fixed JSON',\n      disabled: readOnly,\n      onClick: handleApply\n    }\n  ]\n</script>\n\n<div class=\"jse-json-repair-component\">\n  <Menu {items}>\n    <div slot=\"left\" class=\"jse-info\">Repair invalid JSON, then click apply</div>\n  </Menu>\n\n  {#if error}\n    <Message\n      type=\"error\"\n      icon={faExclamationTriangle}\n      message={`Cannot parse JSON: ${error.message}`}\n      actions={errorActions}\n    />\n  {:else}\n    <Message\n      type=\"success\"\n      message=\"JSON is valid now and can be parsed.\"\n      actions={successActions}\n    />\n  {/if}\n  <textarea\n    bind:this={domTextArea}\n    on:input={handleChange}\n    readonly={readOnly}\n    class=\"jse-json-text\"\n    autocomplete=\"off\"\n    autocapitalize=\"off\"\n    spellcheck=\"false\">{text}</textarea\n  >\n</div>\n\n<style src=\"./JSONRepairComponent.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import JSONRepairComponent from './repair/JSONRepairComponent.svelte'\n  import Modal from './Modal.svelte'\n\n  export let text: string\n  export let onParse: (text: string) => void\n  export let onRepair: (text: string) => string\n  export let onApply: (repairedText: string) => void\n  export let onClose: () => void\n\n  function handleApply(repairedText: string) {\n    onApply(repairedText)\n    onClose()\n  }\n\n  function handleCancel() {\n    onClose()\n  }\n</script>\n\n<Modal {onClose} className=\"jse-repair-modal\">\n  <JSONRepairComponent\n    bind:text\n    {onParse}\n    {onRepair}\n    onApply={handleApply}\n    onCancel={handleCancel}\n  />\n</Modal>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getExpandItemsSections } from '$lib/logic/expandItemsSections.js'\n  import type { JSONSelection, Section, VisibleSection, JSONEditorContext } from '$lib/types.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { pathInSelection } from '$lib/logic/selection.js'\n\n  export let visibleSections: VisibleSection[]\n  export let sectionIndex: number\n  export let total: number\n  export let path: JSONPath\n  export let selection: JSONSelection | undefined\n  export let onExpandSection: (path: JSONPath, section: Section) => void\n  export let context: JSONEditorContext\n\n  $: visibleSection = visibleSections[sectionIndex]\n\n  $: startIndex = visibleSection.end\n  $: endIndex = visibleSections[sectionIndex + 1] ? visibleSections[sectionIndex + 1].start : total\n\n  $: selected = pathInSelection(context.getJson(), selection, path.concat(String(startIndex)))\n\n  $: expandItemsSections = getExpandItemsSections(startIndex, endIndex)\n\n  function handleMouseMove(event: MouseEvent) {\n    // prevent the whole array from being selected whilst dragging over\n    // a section with collapsed items\n    event.stopPropagation()\n  }\n</script>\n\n<div\n  role=\"none\"\n  class=\"jse-collapsed-items\"\n  class:jse-selected={selected}\n  on:mousemove={handleMouseMove}\n  style:--level={path.length + 2}\n>\n  <div>\n    <div class=\"jse-text\">Items {startIndex}-{endIndex}</div>\n    {#each expandItemsSections as expandItemsSection}<button\n        type=\"button\"\n        class=\"jse-expand-items\"\n        on:click={() => onExpandSection(path, expandItemsSection)}\n      >\n        show {expandItemsSection.start}-{expandItemsSection.end}\n      </button>\n    {/each}\n  </div>\n</div>\n\n<style src=\"./CollapsedItems.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { faCaretDown } from '@fortawesome/free-solid-svg-icons'\n  import Icon from 'svelte-awesome'\n  import {\n    CONTEXT_MENU_EXPLANATION,\n    CONTEXT_MENU_HEIGHT,\n    CONTEXT_MENU_WIDTH\n  } from '$lib/constants.js'\n  import type { OnContextMenu } from '$lib/types'\n\n  export let root: boolean = false\n  export let insert: boolean = false\n  export let selected: boolean\n  export let onContextMenu: OnContextMenu\n\n  function handleClick(event: MouseEvent & { currentTarget: EventTarget & HTMLButtonElement }) {\n    let buttonElem: Element | undefined = event.target as HTMLButtonElement\n    while (buttonElem && buttonElem.nodeName !== 'BUTTON') {\n      buttonElem = buttonElem.parentNode as Element\n    }\n\n    if (buttonElem) {\n      onContextMenu({\n        anchor: buttonElem,\n        left: 0,\n        top: 0,\n        width: CONTEXT_MENU_WIDTH,\n        height: CONTEXT_MENU_HEIGHT,\n        offsetTop: 2,\n        offsetLeft: 0,\n        showTip: true\n      })\n    }\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-context-menu-pointer\"\n  class:jse-root={root}\n  class:jse-insert={insert}\n  class:jse-selected={selected}\n  title={CONTEXT_MENU_EXPLANATION}\n  on:click={handleClick}\n>\n  <Icon data={faCaretDown} />\n</button>\n\n<style src=\"./ContextMenuPointer.scss\"></style>\n","<script lang=\"ts\">\n  import type { ExtendedSearchResultItem, JSONEditorContext, JSONSelection } from '$lib/types.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { isEditingSelection, isValueSelection } from '$lib/logic/selection.js'\n  import { isSvelteActionRenderer } from '$lib/typeguards.js'\n\n  interface Props {\n    path: JSONPath\n    value: unknown\n    context: JSONEditorContext\n    enforceString: boolean\n    selection: JSONSelection | undefined\n    searchResultItems: ExtendedSearchResultItem[] | undefined\n  }\n\n  const { path, value, context, enforceString, selection, searchResultItems }: Props = $props()\n\n  const isEditing = $derived(isValueSelection(selection) && isEditingSelection(selection))\n\n  const renderers = $derived(\n    context.onRenderValue({\n      path,\n      value,\n      mode: context.mode,\n      truncateTextSize: context.truncateTextSize,\n      readOnly: context.readOnly,\n      enforceString,\n      isEditing,\n      parser: context.parser,\n      normalization: context.normalization,\n      selection,\n      searchResultItems,\n      onPatch: context.onPatch,\n      onPasteJson: context.onPasteJson,\n      onSelect: context.onSelect,\n      onFind: context.onFind,\n      findNextInside: context.findNextInside,\n      focus: context.focus\n    })\n  )\n</script>\n\n{#each renderers as renderer}\n  {#if isSvelteActionRenderer(renderer)}\n    {@const action = renderer.action}\n    <div\n      role=\"button\"\n      tabindex=\"-1\"\n      class=\"jse-value\"\n      data-type=\"selectable-value\"\n      use:action={renderer.props}\n    ></div>\n  {:else}\n    {@const Component = renderer.component}\n    <Component {...renderer.props} />\n  {/if}\n{/each}\n","// used by JSONNode during dragging\nimport type { JSONPath } from 'immutable-json-patch'\n\nexport const singleton: Singleton = {\n  selecting: false,\n  selectionAnchor: undefined, // Path\n  selectionAnchorType: undefined, // Selection type\n  selectionFocus: undefined, // Path\n\n  dragging: false\n}\n\ninterface Singleton {\n  selecting: boolean\n  selectionAnchor: JSONPath | undefined\n  selectionAnchorType: string | undefined\n  selectionFocus: JSONPath | undefined\n\n  dragging: boolean\n}\n","import { createMultiSelection, getEndPath, getStartPath } from './selection.js'\nimport { initial, isEqual } from 'lodash-es'\nimport type { JSONPatchDocument } from 'immutable-json-patch'\nimport { getIn } from 'immutable-json-patch'\nimport { moveInsideParent } from './operations.js'\nimport type {\n  DragInsideAction,\n  DragInsideProps,\n  JSONSelection,\n  MultiSelection,\n  RenderedItem\n} from '$lib/types'\n\nexport interface MoveSelectionProps {\n  json: unknown\n  selection: JSONSelection | undefined\n  deltaY: number\n  items: RenderedItem[]\n}\n\nexport interface MoveSelectionResult {\n  operations: JSONPatchDocument | undefined\n  updatedSelection: JSONSelection | undefined\n  offset: number\n}\n\nexport function onMoveSelection({\n  json,\n  selection,\n  deltaY,\n  items\n}: MoveSelectionProps): MoveSelectionResult {\n  if (!selection) {\n    return {\n      operations: undefined,\n      updatedSelection: undefined,\n      offset: 0\n    }\n  }\n\n  const dragInsideAction =\n    deltaY < 0\n      ? findSwapPathUp({ json, selection, deltaY, items })\n      : findSwapPathDown({ json, selection, deltaY, items })\n\n  if (!dragInsideAction || dragInsideAction.offset === 0) {\n    return {\n      operations: undefined,\n      updatedSelection: undefined,\n      offset: 0\n    }\n  }\n\n  const operations = moveInsideParent(json, selection, dragInsideAction)\n\n  const path = initial(getStartPath(json, selection))\n  const value = getIn(json, path)\n  if (Array.isArray(value)) {\n    const updatedSelection = createUpdatedArraySelection({\n      items,\n      json,\n      selection,\n      offset: dragInsideAction.offset\n    })\n\n    return {\n      operations,\n      updatedSelection,\n      offset: dragInsideAction.offset\n    }\n  } else {\n    // object\n    return {\n      operations,\n      updatedSelection: undefined,\n      offset: dragInsideAction.offset\n    }\n  }\n}\n\nfunction findSwapPathUp({\n  json,\n  items,\n  selection,\n  deltaY\n}: DragInsideProps): DragInsideAction | undefined {\n  const initialPath = getStartPath(json, selection)\n  const initialIndex = items.findIndex((item) => isEqual(item.path, initialPath))\n\n  const prevHeight = () => items[index - 1]?.height\n\n  let index = initialIndex\n  let cumulativeHeight = 0\n\n  while (prevHeight() !== undefined && Math.abs(deltaY) > cumulativeHeight + prevHeight() / 2) {\n    cumulativeHeight += prevHeight()\n    index -= 1\n  }\n\n  const beforePath = items[index].path\n  const offset = index - initialIndex\n\n  return index !== initialIndex && items[index] !== undefined ? { beforePath, offset } : undefined\n}\n\nfunction findSwapPathDown({\n  json,\n  items,\n  selection,\n  deltaY\n}: DragInsideProps): DragInsideAction | undefined {\n  const initialPath = getEndPath(json, selection)\n  const initialIndex = items.findIndex((item) => isEqual(item.path, initialPath))\n\n  let cumulativeHeight = 0\n  let index = initialIndex\n\n  const nextHeight = () => items[index + 1]?.height\n\n  while (nextHeight() !== undefined && Math.abs(deltaY) > cumulativeHeight + nextHeight() / 2) {\n    cumulativeHeight += nextHeight()\n    index += 1\n  }\n\n  const parentPath = initial(initialPath)\n  const parent = getIn(json, parentPath)\n  const isArray = Array.isArray(parent)\n  const beforeIndex = isArray ? index : index + 1\n  const beforePath = items[beforeIndex]?.path\n  const offset = index - initialIndex\n\n  return beforePath ? { beforePath, offset } : { append: true, offset }\n}\n\ninterface UpdatedArraySelectionProps {\n  items: RenderedItem[]\n  json: unknown\n  selection: JSONSelection\n  offset: number\n}\n\nfunction createUpdatedArraySelection({\n  items,\n  json,\n  selection,\n  offset\n}: UpdatedArraySelectionProps): MultiSelection {\n  const startPath = getStartPath(json, selection)\n  const endPath = getEndPath(json, selection)\n\n  const startIndex = items.findIndex((item) => isEqual(item.path, startPath))\n  const endIndex = items.findIndex((item) => isEqual(item.path, endPath))\n\n  const anchorPath = items[startIndex + offset]?.path\n  const focusPath = items[endIndex + offset]?.path\n\n  return createMultiSelection(anchorPath, focusPath)\n}\n","<script lang=\"ts\">\n  import { faExclamationTriangle } from '@fortawesome/free-solid-svg-icons'\n  import Icon from 'svelte-awesome'\n  import { getContext } from 'svelte'\n  import { tooltip } from '../../controls/tooltip/tooltip.js'\n  import type { AbsolutePopupContext, NestedValidationError, ValidationError } from '$lib/types.js'\n  import { isNestedValidationError } from '$lib/typeguards.js'\n\n  const absolutePopupContext = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let validationError: NestedValidationError | ValidationError\n  export let onExpand: (event: MouseEvent) => void\n\n  $: text =\n    isNestedValidationError(validationError) && validationError.isChildError\n      ? 'Contains invalid data'\n      : validationError.message\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-validation-{validationError.severity}\"\n  on:click={onExpand}\n  use:tooltip={{ text, ...absolutePopupContext }}\n>\n  <Icon data={faExclamationTriangle} />\n</button>\n\n<style src=\"./ValidationErrorIcon.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { faCaretDown, faCaretRight } from '@fortawesome/free-solid-svg-icons'\n  import type { JSONPath, JSONPointer } from 'immutable-json-patch'\n  import { appendToJSONPointer, parseJSONPointer } from 'immutable-json-patch'\n  import { initial, isEqual, last, range } from 'lodash-es'\n  import Icon from 'svelte-awesome'\n  import {\n    DEFAULT_VISIBLE_SECTIONS,\n    HOVER_COLLECTION,\n    HOVER_INSERT_AFTER,\n    HOVER_INSERT_INSIDE,\n    INSERT_EXPLANATION\n  } from '$lib/constants.js'\n  import { getEnforceString, getVisibleCaretPositions } from '$lib/logic/documentState.js'\n  import { rename } from '$lib/logic/operations.js'\n  import {\n    createAfterSelection,\n    createInsideSelection,\n    createMultiSelection,\n    fromCaretPosition,\n    fromSelectionType,\n    getAnchorPath,\n    getEndPath,\n    getFocusPath,\n    getSelectionPaths,\n    getStartPath,\n    isAfterSelection,\n    isEditingSelection,\n    isInsideSelection,\n    isKeySelection,\n    isMultiSelection,\n    isValueSelection,\n    pathInSelection,\n    selectionIfOverlapping\n  } from '$lib/logic/selection.js'\n  import {\n    getDataPathFromTarget,\n    getSelectionTypeFromTarget,\n    isChildOfAttribute,\n    isChildOfNodeName,\n    isContentEditableDiv\n  } from '$lib/utils/domUtils.js'\n  import CollapsedItems from './CollapsedItems.svelte'\n  import ContextMenuPointer from '../../../components/controls/contextmenu/ContextMenuPointer.svelte'\n  import JSONKey from './JSONKey.svelte'\n  import JSONValue from './JSONValue.svelte'\n  import { singleton } from './singleton.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { onMoveSelection } from '$lib/logic/dragging.js'\n  import { forEachIndex, moveItems } from '$lib/utils/arrayUtils.js'\n  import type {\n    AbsolutePopupOptions,\n    CaretPosition,\n    DocumentState,\n    DraggingState,\n    JSONSelection,\n    NestedValidationError,\n    SearchResults,\n    ValidationErrors,\n    RenderedItem,\n    TreeModeContext,\n    VisibleSection\n  } from '$lib/types'\n  import { SelectionType } from '$lib/types.js'\n  import {\n    isArrayRecursiveState,\n    isExpandableState,\n    isObjectRecursiveState\n  } from '$lib/typeguards.js'\n  import { filterKeySearchResults, filterValueSearchResults } from '$lib/logic/search.js'\n  import ValidationErrorIcon from './ValidationErrorIcon.svelte'\n  import { isObject } from '$lib/utils/typeUtils.js'\n  import { classnames } from '$lib/utils/cssUtils.js'\n  import { isCtrlKeyDown } from 'svelte-jsoneditor/utils/keyBindings'\n  import Tag from '../../../components/controls/Tag.svelte'\n  import { flushSync } from 'svelte'\n\n  // We pass `pointer` instead of `path` because pointer (a string) is immutable.\n  // Without it, *all* nodes would re-render on *every* change in JSON or DocumentState,\n  // because the path changes every time by re-creating it.\n  export let pointer: JSONPointer\n  export let value: unknown\n  export let state: DocumentState | undefined\n  export let validationErrors: ValidationErrors | undefined\n  export let searchResults: SearchResults | undefined\n  export let selection: JSONSelection | undefined\n  export let context: TreeModeContext\n  export let onDragSelectionStart: (\n    event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }\n  ) => void\n\n  const debug = createDebug('jsoneditor:JSONNode')\n\n  let hover: string | undefined = undefined\n  let hoverTimer: number | undefined = undefined\n  let dragging: DraggingState | undefined = undefined\n\n  let path: JSONPath\n  $: path = parseJSONPointer(pointer)\n  $: dataPath = encodeURIComponent(pointer) // This is the same as encodeDataPath(path) but faster\n\n  let expanded: boolean\n  $: expanded = isExpandableState(state) ? state.expanded : false\n\n  let enforceString: boolean\n  $: enforceString = getEnforceString(value, state, [])\n\n  let visibleSections: VisibleSection[] | undefined\n  $: visibleSections = isArrayRecursiveState(state) ? state.visibleSections : undefined\n\n  let validationError: NestedValidationError | undefined\n  $: validationError = validationErrors?.validationError\n\n  let isNodeSelected: boolean\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: isNodeSelected = pathInSelection(context.getJson(), selection, path)\n\n  $: root = path.length === 0\n\n  /**\n   * Get sorted keys, applying dragging order\n   */\n  function getKeys(object: Record<string, unknown>, dragging: DraggingState | undefined): string[] {\n    const keys = Object.keys(object)\n\n    // reorder the keys whilst dragging\n    if (dragging && dragging.offset !== 0) {\n      return moveItems(\n        keys,\n        dragging.selectionStartIndex,\n        dragging.selectionItemsCount,\n        dragging.offset\n      )\n    }\n\n    return keys\n  }\n\n  interface ItemIndex {\n    index: number\n    gutterIndex: number\n  }\n\n  function getItems(\n    array: Array<unknown>,\n    visibleSection: VisibleSection,\n    dragging: DraggingState | undefined\n  ): ItemIndex[] {\n    const start = visibleSection.start\n    const end = Math.min(visibleSection.end, array.length)\n    const indices = range(start, end)\n\n    // reorder the items whilst dragging\n    if (dragging && dragging.offset !== 0) {\n      return moveItems(\n        indices,\n        dragging.selectionStartIndex,\n        dragging.selectionItemsCount,\n        dragging.offset\n      ).map((index, gutterIndex) => ({ index, gutterIndex }))\n    }\n\n    return indices.map((index) => ({ index, gutterIndex: index }))\n  }\n\n  function toggleExpand(event: MouseEvent) {\n    event.stopPropagation()\n\n    const recursive = isCtrlKeyDown(event)\n    context.onExpand(path, !expanded, recursive)\n  }\n\n  function handleExpand() {\n    context.onExpand(path, true)\n  }\n\n  function handleUpdateKey(oldKey: string, newKey: string): string {\n    const operations = rename(path, Object.keys(value as Record<string, unknown>), oldKey, newKey)\n    context.onPatch(operations)\n\n    // It is possible that the applied key differs from newKey,\n    // to prevent duplicate keys. Here we figure out the actually applied key\n    return last(parseJSONPointer(operations[0].path)) as string\n  }\n\n  function handleMouseDown(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    // only handle when the left or right mouse button is pressed, not the middle mouse button (scroll wheel)\n    if (event.buttons !== 1 && event.buttons !== 2) {\n      return\n    }\n\n    // check if the mouse down is not happening in the key or value input fields or on a button\n    if (\n      isContentEditableDiv(event.target as HTMLElement) ||\n      (event.buttons === 1 && isChildOfNodeName(event.target as Element, 'BUTTON')) // left mouse on a button\n    ) {\n      return\n    }\n\n    event.stopPropagation()\n    event.preventDefault()\n\n    // due to event.stopPropagation here and there, the focus tracker does not receive this mouse event.\n    // make sure the editor has focus\n    context.focus()\n\n    // we attach the mousemove and mouseup event listeners to the global document,\n    // so we will not miss if the mouse events happen outside the editor\n    document.addEventListener('mousemove', handleMouseMoveGlobal, true)\n    document.addEventListener('mouseup', handleMouseUpGlobal)\n\n    const anchorType = getSelectionTypeFromTarget(event.target as Element)\n    const json = context.getJson()\n    const documentState = context.getDocumentState()\n\n    if (\n      selection &&\n      anchorType !== SelectionType.after &&\n      anchorType !== SelectionType.inside &&\n      (selection.type === anchorType || selection.type === SelectionType.multi) &&\n      pathInSelection(json, selection, path)\n    ) {\n      // when right-clicking inside the current selection, do nothing: context menu will open\n      // when left-clicking inside the current selection, do nothing: it can be the start of dragging\n      if (event.button === 0) {\n        onDragSelectionStart(event)\n      }\n\n      return\n    }\n\n    // TODO: refactor dragging, there are now two separate mechanisms handling mouse movement: with dragging.* and with singleton.*\n    singleton.selecting = true\n    singleton.selectionAnchor = path\n    singleton.selectionAnchorType = anchorType\n    singleton.selectionFocus = path\n\n    if (event.shiftKey) {\n      // Shift+Click will select multiple entries\n      const fullSelection = context.getSelection()\n      if (fullSelection) {\n        context.onSelect(createMultiSelection(getAnchorPath(fullSelection), path))\n      }\n    } else {\n      if (anchorType === SelectionType.multi) {\n        if (root && (event.target as Element).hasAttribute('data-path')) {\n          const lastCaretPosition = last(\n            getVisibleCaretPositions(value, documentState)\n          ) as CaretPosition\n          context.onSelect(fromCaretPosition(lastCaretPosition))\n        } else {\n          context.onSelect(createMultiSelection(path, path))\n        }\n      } else if (json !== undefined) {\n        context.onSelect(fromSelectionType(anchorType, path))\n      }\n    }\n  }\n\n  function handleMouseMove(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    if (singleton.selecting) {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (singleton.selectionFocus === undefined) {\n        // First move event, no selection yet.\n        // Clear the default selection of the browser\n        if (window.getSelection) {\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          window.getSelection().empty()\n        }\n      }\n\n      const selectionType = getSelectionTypeFromTarget(event.target as Element)\n\n      if (\n        !isEqual(path, singleton.selectionFocus) ||\n        selectionType !== singleton.selectionAnchorType\n      ) {\n        singleton.selectionFocus = path\n        singleton.selectionAnchorType = selectionType // TODO: this is a bit ugly\n\n        context.onSelect(\n          createMultiSelection(\n            singleton.selectionAnchor || singleton.selectionFocus,\n            singleton.selectionFocus\n          )\n        )\n      }\n    }\n  }\n\n  function handleMouseMoveGlobal(event: MouseEvent) {\n    context.onDrag(event)\n  }\n\n  function handleMouseUpGlobal(event: Event) {\n    if (singleton.selecting) {\n      singleton.selecting = false\n\n      event.stopPropagation()\n    }\n\n    context.onDragEnd()\n\n    document.removeEventListener('mousemove', handleMouseMoveGlobal, true)\n    document.removeEventListener('mouseup', handleMouseUpGlobal)\n  }\n\n  function findContentTop() {\n    return context.findElement([])?.getBoundingClientRect()?.top || 0\n  }\n\n  function calculateDeltaY(dragging: DraggingState, event: MouseEvent) {\n    // calculate the contentOffset, this changes when scrolling\n    const contentTop = findContentTop()\n    const contentOffset = contentTop - dragging.initialContentTop\n\n    // calculate the vertical mouse movement\n    const clientOffset = event.clientY - dragging.initialClientY\n\n    return clientOffset - contentOffset\n  }\n\n  function handleDragSelectionStart(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }\n  ) {\n    if (context.readOnly || !selection) {\n      return\n    }\n\n    const selectionParentPath = initial(getFocusPath(selection))\n    if (!isEqual(path, selectionParentPath)) {\n      // pass to parent\n      onDragSelectionStart(event)\n\n      return\n    }\n\n    // note that the returned items will be of one section only,\n    // and when the selection is spread over multiple sections,\n    // no items will be returned: this is not (yet) supported\n    const items = getVisibleItemsWithHeights(selection, visibleSections || DEFAULT_VISIBLE_SECTIONS)\n\n    debug('dragSelectionStart', { selection, items })\n\n    if (!items) {\n      debug('Cannot drag the current selection (probably spread over multiple sections)')\n      return\n    }\n\n    const json = context.getJson()\n    if (json === undefined) {\n      return\n    }\n    const initialPath = getStartPath(json, selection)\n    const selectionStartIndex = items.findIndex((item) => isEqual(item.path, initialPath))\n    const { offset } = onMoveSelection({\n      json,\n      selection: context.getSelection(),\n      deltaY: 0,\n      items\n    })\n\n    dragging = {\n      initialTarget: event.target as Element,\n      initialClientY: event.clientY,\n      initialContentTop: findContentTop(),\n      selectionStartIndex,\n      selectionItemsCount: getSelectionPaths(json, selection).length,\n      items,\n      offset,\n      didMoveItems: false // whether items have been moved during dragging or not\n    }\n    singleton.dragging = true\n\n    document.addEventListener('mousemove', handleDragSelection, true)\n    document.addEventListener('mouseup', handleDragSelectionEnd)\n  }\n\n  function handleDragSelection(event: MouseEvent) {\n    if (dragging) {\n      const json = context.getJson()\n      if (json === undefined) {\n        return\n      }\n\n      const deltaY = calculateDeltaY(dragging, event)\n      const { offset } = onMoveSelection({\n        json,\n        selection: context.getSelection(),\n        deltaY,\n        items: dragging.items\n      })\n\n      if (offset !== dragging.offset) {\n        debug('drag selection', offset, deltaY)\n\n        dragging = {\n          ...dragging,\n          offset,\n          didMoveItems: true\n        }\n      }\n    }\n  }\n\n  function handleDragSelectionEnd(event: MouseEvent) {\n    if (dragging) {\n      const json = context.getJson()\n      if (json === undefined) {\n        return\n      }\n      const deltaY = calculateDeltaY(dragging, event)\n      const { operations, updatedSelection } = onMoveSelection({\n        json,\n        selection: context.getSelection(),\n        deltaY,\n        items: dragging.items\n      })\n\n      if (operations) {\n        context.onPatch(operations, (_, patchedState) => ({\n          state: patchedState,\n          selection: updatedSelection ?? selection\n        }))\n      } else {\n        // the user did click inside the selection and no contents have been dragged,\n        // select the clicked item\n        if (event.target === dragging.initialTarget && !dragging.didMoveItems) {\n          const selectionType = getSelectionTypeFromTarget(event.target as Element)\n          const path = getDataPathFromTarget(event.target as Element)\n          if (path) {\n            context.onSelect(fromSelectionType(selectionType, path))\n          }\n        }\n      }\n\n      dragging = undefined\n      singleton.dragging = false\n\n      document.removeEventListener('mousemove', handleDragSelection, true)\n      document.removeEventListener('mouseup', handleDragSelectionEnd)\n    }\n  }\n\n  /**\n   * Get a list with all visible items and their rendered heights inside\n   * this object or array\n   */\n  // TODO: extract and unit test getVisibleItemsWithHeights\n  function getVisibleItemsWithHeights(\n    selection: JSONSelection,\n    visibleSections: VisibleSection[]\n  ): RenderedItem[] | undefined {\n    const items: RenderedItem[] = []\n\n    function addHeight(prop: string) {\n      const itemPath = path.concat(prop)\n      const element = context.findElement(itemPath)\n      if (element !== undefined) {\n        items.push({\n          path: itemPath,\n          height: element.clientHeight\n        })\n      }\n    }\n\n    if (Array.isArray(value)) {\n      const json = context.getJson()\n      if (json === undefined) {\n        return undefined\n      }\n      const startPath = getStartPath(json, selection)\n      const endPath = getEndPath(json, selection)\n      const startIndex = parseInt(last(startPath) as string, 10)\n      const endIndex = parseInt(last(endPath) as string, 10)\n\n      // find the section where the selection is\n      // if the selection is spread over multiple visible sections,\n      // we will not return any items, so dragging will not work there.\n      // We do this to keep things simple for now.\n      const currentSection = visibleSections.find((visibleSection) => {\n        return startIndex >= visibleSection.start && endIndex <= visibleSection.end\n      })\n\n      if (!currentSection) {\n        return undefined\n      }\n\n      const { start, end } = currentSection\n      forEachIndex(start, Math.min(value.length, end), (index) => addHeight(String(index)))\n    } else {\n      // value is Object\n      Object.keys(value as Record<string, unknown>).forEach(addHeight)\n    }\n\n    return items\n  }\n\n  function handleMouseOver(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    if (singleton.selecting || singleton.dragging) {\n      return\n    }\n\n    event.stopPropagation()\n\n    if (isChildOfAttribute(event.target as Element, 'data-type', 'selectable-value')) {\n      hover = HOVER_COLLECTION\n    } else if (isChildOfAttribute(event.target as Element, 'data-type', 'selectable-key')) {\n      hover = undefined\n    } else if (\n      isChildOfAttribute(event.target as Element, 'data-type', 'insert-selection-area-inside')\n    ) {\n      hover = HOVER_INSERT_INSIDE\n    } else if (\n      isChildOfAttribute(event.target as Element, 'data-type', 'insert-selection-area-after')\n    ) {\n      hover = HOVER_INSERT_AFTER\n    }\n\n    clearTimeout(hoverTimer)\n  }\n\n  function handleMouseOut(event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    event.stopPropagation()\n\n    // to prevent \"flickering\" in the hovering state when hovering on the edge\n    // of the insert area context menu button: it's visibility toggles when\n    // `hover` toggles, which will alternating mouseout and mouseover events\n    hoverTimer = window.setTimeout(() => (hover = undefined))\n  }\n\n  function handleInsertInside(event: MouseEvent) {\n    if (!event.shiftKey) {\n      event.stopPropagation()\n      event.preventDefault()\n\n      context.onSelect(createInsideSelection(path))\n    }\n  }\n\n  function handleInsertAfter(event: MouseEvent) {\n    if (!event.shiftKey) {\n      event.stopPropagation()\n      event.preventDefault()\n\n      context.onSelect(createAfterSelection(path))\n    }\n  }\n\n  function handleInsertInsideOpenContextMenu(contextMenuProps: AbsolutePopupOptions) {\n    context.onSelect(createInsideSelection(path))\n\n    // ensure the updated selection is propagated to JSONEditorRoot\n    flushSync()\n\n    context.onContextMenu(contextMenuProps)\n  }\n\n  function handleInsertAfterOpenContextMenu(contextMenuProps: AbsolutePopupOptions) {\n    context.onSelect(createAfterSelection(path))\n\n    // ensure the updated selection is propagated to JSONEditorRoot\n    flushSync()\n\n    context.onContextMenu(contextMenuProps)\n  }\n</script>\n\n<!-- svelte-ignore a11y-mouse-events-have-key-events -->\n<div\n  role=\"treeitem\"\n  tabindex=\"-1\"\n  class={classnames(\n    'jse-json-node',\n    { 'jse-expanded': expanded },\n    context.onClassName(path, value)\n  )}\n  data-path={dataPath}\n  aria-selected={isNodeSelected}\n  style:--level={path.length}\n  class:jse-root={root}\n  class:jse-selected={isNodeSelected && isMultiSelection(selection)}\n  class:jse-selected-value={isNodeSelected && isValueSelection(selection)}\n  class:jse-readonly={context.readOnly}\n  class:jse-hovered={hover === HOVER_COLLECTION}\n  on:mousedown={handleMouseDown}\n  on:mousemove={handleMouseMove}\n  on:mouseover={handleMouseOver}\n  on:mouseout={handleMouseOut}\n>\n  {#if Array.isArray(value)}\n    <div class=\"jse-header-outer\">\n      <div class=\"jse-header\">\n        <button\n          type=\"button\"\n          class=\"jse-expand\"\n          on:click={toggleExpand}\n          title=\"Expand or collapse this array (Ctrl+Click to expand/collapse recursively)\"\n        >\n          {#if expanded}\n            <Icon data={faCaretDown} />\n          {:else}\n            <Icon data={faCaretRight} />\n          {/if}\n        </button>\n        <slot name=\"identifier\" />\n        {#if !root}\n          <div class=\"jse-separator\">:</div>\n        {/if}\n        <div class=\"jse-meta\">\n          <div class=\"jse-meta-inner\" data-type=\"selectable-value\">\n            {#if expanded}\n              <div class=\"jse-bracket\">[</div>\n              <Tag>\n                {value.length}\n                {value.length === 1 ? 'item' : 'items'}\n              </Tag>\n              &nbsp;\n            {:else}\n              <div class=\"jse-bracket\">[</div>\n              <Tag onclick={handleExpand}>\n                {value.length}\n                {value.length === 1 ? 'item' : 'items'}\n              </Tag>\n              <div class=\"jse-bracket\">]</div>\n            {/if}\n          </div>\n        </div>\n        {#if !context.readOnly && isNodeSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !isEditingSelection(selection) && isEqual(getFocusPath(selection), path)}\n          <div class=\"jse-context-menu-pointer-anchor\">\n            <ContextMenuPointer {root} selected={true} onContextMenu={context.onContextMenu} />\n          </div>\n        {/if}\n      </div>\n      {#if validationError && (!expanded || !validationError.isChildError)}\n        <ValidationErrorIcon {validationError} onExpand={handleExpand} />\n      {/if}\n      {#if expanded}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-inside\"\n          data-type=\"insert-selection-area-inside\"\n          on:click={handleInsertInside}\n        ></div>\n      {:else}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-after\"\n          data-type=\"insert-selection-area-after\"\n          on:click={handleInsertAfter}\n        ></div>\n      {/if}\n    </div>\n    {#if expanded}\n      <div class=\"jse-items\">\n        {#if !context.readOnly && (hover === HOVER_INSERT_INSIDE || (isNodeSelected && isInsideSelection(selection)))}\n          <div\n            class=\"jse-insert-area jse-inside\"\n            class:jse-hovered={hover === HOVER_INSERT_INSIDE}\n            class:jse-selected={isNodeSelected && isInsideSelection(selection)}\n            data-type=\"insert-selection-area-inside\"\n            style:--level={path.length + 1}\n            title={INSERT_EXPLANATION}\n          >\n            <ContextMenuPointer\n              insert={true}\n              selected={isNodeSelected && isInsideSelection(selection)}\n              onContextMenu={handleInsertInsideOpenContextMenu}\n            />\n          </div>\n        {/if}\n        {#each visibleSections || DEFAULT_VISIBLE_SECTIONS as visibleSection, sectionIndex (sectionIndex)}\n          {#each getItems(value, visibleSection, dragging) as item (item.index)}\n            {@const nestedValidationErrors = isArrayRecursiveState(validationErrors)\n              ? validationErrors.items[item.index]\n              : undefined}\n\n            {@const nestedSelection = selectionIfOverlapping(\n              context.getJson(),\n              selection,\n              path.concat(String(item.index))\n            )}\n\n            <svelte:self\n              value={value[item.index]}\n              pointer={appendToJSONPointer(pointer, item.index)}\n              state={isArrayRecursiveState(state) ? state.items[item.index] : undefined}\n              validationErrors={nestedValidationErrors}\n              searchResults={isArrayRecursiveState(searchResults)\n                ? searchResults.items[item.index]\n                : undefined}\n              selection={nestedSelection}\n              {context}\n              onDragSelectionStart={handleDragSelectionStart}\n            >\n              <div slot=\"identifier\" class=\"jse-identifier\">\n                <div class=\"jse-index\">{item.gutterIndex}</div>\n              </div>\n            </svelte:self>\n          {/each}\n          {#if visibleSection.end < value.length}\n            <CollapsedItems\n              visibleSections={visibleSections || DEFAULT_VISIBLE_SECTIONS}\n              {sectionIndex}\n              total={value.length}\n              {path}\n              onExpandSection={context.onExpandSection}\n              {selection}\n              {context}\n            />\n          {/if}\n        {/each}\n      </div>\n      <div class=\"jse-footer-outer\">\n        <div data-type=\"selectable-value\" class=\"jse-footer\">\n          <span class=\"jse-bracket\">]</span>\n        </div>\n        {#if !root}\n          <div\n            role=\"none\"\n            class=\"jse-insert-selection-area jse-after\"\n            data-type=\"insert-selection-area-after\"\n            on:click={handleInsertAfter}\n          ></div>\n        {/if}\n      </div>\n    {/if}\n  {:else if isObject(value)}\n    <div class=\"jse-header-outer\">\n      <div class=\"jse-header\">\n        <button\n          type=\"button\"\n          class=\"jse-expand\"\n          on:click={toggleExpand}\n          title=\"Expand or collapse this object (Ctrl+Click to expand/collapse recursively)\"\n        >\n          {#if expanded}\n            <Icon data={faCaretDown} />\n          {:else}\n            <Icon data={faCaretRight} />\n          {/if}\n        </button>\n        <slot name=\"identifier\" />\n        {#if !root}\n          <div class=\"jse-separator\">:</div>\n        {/if}\n        <div class=\"jse-meta\" data-type=\"selectable-value\">\n          <div class=\"jse-meta-inner\">\n            {#if expanded}\n              <div class=\"jse-bracket jse-expanded\">&lbrace;</div>\n            {:else}\n              <div class=\"jse-bracket\">&lbrace;</div>\n              <Tag onclick={handleExpand}>\n                {Object.keys(value).length}\n                {Object.keys(value).length === 1 ? 'prop' : 'props'}\n              </Tag>\n              <div class=\"jse-bracket\">&rbrace;</div>\n            {/if}\n          </div>\n        </div>\n        {#if !context.readOnly && isNodeSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !isEditingSelection(selection) && isEqual(getFocusPath(selection), path)}\n          <div class=\"jse-context-menu-pointer-anchor\">\n            <ContextMenuPointer {root} selected={true} onContextMenu={context.onContextMenu} />\n          </div>\n        {/if}\n      </div>\n      {#if validationError && (!expanded || !validationError.isChildError)}\n        <ValidationErrorIcon {validationError} onExpand={handleExpand} />\n      {/if}\n      {#if expanded}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-inside\"\n          data-type=\"insert-selection-area-inside\"\n          on:click={handleInsertInside}\n        ></div>\n      {:else if !root}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-after\"\n          data-type=\"insert-selection-area-after\"\n          on:click={handleInsertAfter}\n        ></div>\n      {/if}\n    </div>\n    {#if expanded}\n      <div class=\"jse-props\">\n        {#if !context.readOnly && (hover === HOVER_INSERT_INSIDE || (isNodeSelected && isInsideSelection(selection)))}\n          <div\n            class=\"jse-insert-area jse-inside\"\n            class:jse-hovered={hover === HOVER_INSERT_INSIDE}\n            class:jse-selected={isNodeSelected && isInsideSelection(selection)}\n            data-type=\"insert-selection-area-inside\"\n            style:--level={path.length + 1}\n            title={INSERT_EXPLANATION}\n          >\n            <ContextMenuPointer\n              insert={true}\n              selected={isNodeSelected && isInsideSelection(selection)}\n              onContextMenu={handleInsertInsideOpenContextMenu}\n            />\n          </div>\n        {/if}\n        {#each getKeys(value, dragging) as key}\n          {@const propPointer = appendToJSONPointer(pointer, key)}\n\n          {@const nestedSearchResults = isObjectRecursiveState(searchResults)\n            ? searchResults.properties[key]\n            : undefined}\n\n          {@const nestedValidationErrors = isObjectRecursiveState(validationErrors)\n            ? validationErrors.properties[key]\n            : undefined}\n\n          {@const nestedPath = path.concat(key)}\n\n          {@const nestedSelection = selectionIfOverlapping(\n            context.getJson(),\n            selection,\n            nestedPath\n          )}\n\n          <svelte:self\n            value={value[key]}\n            pointer={propPointer}\n            state={isObjectRecursiveState(state) ? state.properties[key] : undefined}\n            validationErrors={nestedValidationErrors}\n            searchResults={nestedSearchResults}\n            selection={nestedSelection}\n            {context}\n            onDragSelectionStart={handleDragSelectionStart}\n          >\n            <div\n              slot=\"identifier\"\n              class=\"jse-key-outer\"\n              class:jse-selected-key={isKeySelection(nestedSelection) &&\n                isEqual(nestedSelection.path, nestedPath)}\n            >\n              <JSONKey\n                pointer={propPointer}\n                {key}\n                selection={nestedSelection}\n                searchResultItems={filterKeySearchResults(nestedSearchResults)}\n                {context}\n                onUpdateKey={handleUpdateKey}\n              />\n            </div>\n          </svelte:self>\n        {/each}\n      </div>\n      <div class=\"jse-footer-outer\">\n        <div data-type=\"selectable-value\" class=\"jse-footer\">\n          <div class=\"jse-bracket\">&rbrace;</div>\n        </div>\n        {#if !root}\n          <div\n            role=\"none\"\n            class=\"jse-insert-selection-area jse-after\"\n            data-type=\"insert-selection-area-after\"\n            on:click={handleInsertAfter}\n          ></div>\n        {/if}\n      </div>\n    {/if}\n  {:else}\n    <div class=\"jse-contents-outer\">\n      <div class=\"jse-contents\">\n        <slot name=\"identifier\" />\n        {#if !root}\n          <div class=\"jse-separator\">:</div>\n        {/if}\n        <div class=\"jse-value-outer\">\n          <JSONValue\n            {path}\n            {value}\n            {enforceString}\n            selection={isNodeSelected ? selection : undefined}\n            searchResultItems={filterValueSearchResults(searchResults)}\n            {context}\n          />\n        </div>\n        {#if !context.readOnly && isNodeSelected && selection && (isValueSelection(selection) || isMultiSelection(selection)) && !isEditingSelection(selection) && isEqual(getFocusPath(selection), path)}\n          <div class=\"jse-context-menu-pointer-anchor\">\n            <ContextMenuPointer {root} selected={true} onContextMenu={context.onContextMenu} />\n          </div>\n        {/if}\n      </div>\n      {#if validationError}\n        <ValidationErrorIcon {validationError} onExpand={handleExpand} />\n      {/if}\n      {#if !root}\n        <div\n          role=\"none\"\n          class=\"jse-insert-selection-area jse-after\"\n          data-type=\"insert-selection-area-after\"\n          on:click={handleInsertAfter}\n        ></div>\n      {/if}\n    </div>\n  {/if}\n  {#if !context.readOnly && (hover === HOVER_INSERT_AFTER || (isNodeSelected && isAfterSelection(selection)))}\n    <div\n      class=\"jse-insert-area jse-after\"\n      class:jse-hovered={hover === HOVER_INSERT_AFTER}\n      class:jse-selected={isNodeSelected && isAfterSelection(selection)}\n      data-type=\"insert-selection-area-after\"\n      title={INSERT_EXPLANATION}\n    >\n      <ContextMenuPointer\n        insert={true}\n        selected={isNodeSelected && isAfterSelection(selection)}\n        onContextMenu={handleInsertAfterOpenContextMenu}\n      />\n    </div>\n  {/if}\n</div>\n\n<style src=\"./JSONNode.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { initial, isEqual } from 'lodash-es'\n  import {\n    createEditKeySelection,\n    createKeySelection,\n    createValueSelection,\n    isEditingSelection,\n    isKeySelection\n  } from '$lib/logic/selection.js'\n  import SearchResultHighlighter from './highlight/SearchResultHighlighter.svelte'\n  import EditableDiv from '../../controls/EditableDiv.svelte'\n  import { addNewLineSuffix } from '$lib/utils/domUtils.js'\n  import type { ExtendedSearchResultItem, JSONSelection, TreeModeContext } from '$lib/types.js'\n  import { UpdateSelectionAfterChange } from '$lib/types.js'\n  import { type JSONPath, type JSONPointer, parseJSONPointer } from 'immutable-json-patch'\n  import ContextMenuPointer from '../../../components/controls/contextmenu/ContextMenuPointer.svelte'\n\n  export let pointer: JSONPointer\n  export let key: string\n  export let selection: JSONSelection | undefined\n  export let searchResultItems: ExtendedSearchResultItem[] | undefined\n  export let onUpdateKey: (oldKey: string, newKey: string) => string\n\n  export let context: TreeModeContext\n\n  let path: JSONPath\n  $: path = parseJSONPointer(pointer)\n\n  $: isKeySelected = isKeySelection(selection) && isEqual(selection.path, path)\n  $: isEditingKey = isKeySelected && isEditingSelection(selection)\n\n  function handleKeyDoubleClick(\n    event: MouseEvent & { currentTarget: EventTarget & HTMLDivElement }\n  ) {\n    if (!isEditingKey && !context.readOnly) {\n      event.preventDefault()\n      context.onSelect(createEditKeySelection(path))\n    }\n  }\n\n  function handleChangeValue(newKey: string, updateSelection: UpdateSelectionAfterChange) {\n    const updatedKey = onUpdateKey(key, context.normalization.unescapeValue(newKey))\n    const updatedPath = initial(path).concat(updatedKey)\n\n    context.onSelect(\n      updateSelection === UpdateSelectionAfterChange.nextInside\n        ? createValueSelection(updatedPath)\n        : createKeySelection(updatedPath)\n    )\n\n    if (updateSelection !== UpdateSelectionAfterChange.self) {\n      context.focus()\n    }\n  }\n\n  function handleCancelChange() {\n    context.onSelect(createKeySelection(path))\n    context.focus()\n  }\n</script>\n\n{#if !context.readOnly && isEditingKey}\n  <EditableDiv\n    value={context.normalization.escapeValue(key)}\n    initialValue={isEditingSelection(selection) ? selection.initialValue : undefined}\n    label=\"Edit key\"\n    shortText\n    onChange={handleChangeValue}\n    onCancel={handleCancelChange}\n    onFind={context.onFind}\n  />\n{:else}\n  <div\n    role=\"none\"\n    data-type=\"selectable-key\"\n    class=\"jse-key\"\n    class:jse-empty={key === ''}\n    on:dblclick={handleKeyDoubleClick}\n  >\n    {#if searchResultItems}\n      <SearchResultHighlighter text={context.normalization.escapeValue(key)} {searchResultItems} />\n    {:else}\n      {addNewLineSuffix(context.normalization.escapeValue(key))}\n    {/if}\n  </div>\n{/if}\n{#if !context.readOnly && isKeySelected && !isEditingKey}\n  <ContextMenuPointer selected={true} onContextMenu={context.onContextMenu} />\n{/if}\n\n<style src=\"./JSONKey.scss\"></style>\n","import type { IconDefinition } from '@fortawesome/free-solid-svg-icons'\nimport type { IconName } from '@fortawesome/fontawesome-common-types'\n\nexport const faJSONEditorExpand: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-expand' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'M 0,448 V 512 h 512 v -64 z ' +\n      'M 0,0 V 64 H 512 V 0 Z ' +\n      'M 256,96 128,224 h 256 z ' +\n      'M 256,416 384,288 H 128 Z'\n  ]\n}\n\nexport const faJSONEditorCollapse: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-collapse' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'm 0,224 v 64 h 512 v -64 z ' + 'M 256,192 384,64 H 128 Z ' + 'M 256,320 128,448 h 256 z'\n  ]\n}\n\nexport const faJSONEditorFormat: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-format' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'M 0,32 v 64 h 416 v -64 z ' +\n      'M 160,160 v 64 h 352 v -64 z ' +\n      'M 160,288 v 64 h 288 v -64 z ' +\n      'M 0,416 v 64 h 320 v -64 z'\n  ]\n}\n\nexport const faJSONEditorCompact: IconDefinition = {\n  prefix: 'fas',\n  iconName: 'jsoneditor-compact' as IconName,\n  icon: [\n    512,\n    512,\n    [],\n    '',\n    'M 0,32 v 64 h 512 v -64 z ' + 'M 0,160 v 64 h 512 v -64 z ' + 'M 0,288 v 64 h 352 v -64 z'\n  ]\n}\n","<script lang=\"ts\">\n  interface Props {\n    readOnly: boolean\n    onCreateArray: () => void\n    onCreateObject: () => void\n    onClick: () => void\n  }\n\n  const { readOnly, onCreateArray, onCreateObject, onClick }: Props = $props()\n\n  function handleCreateObject(event: MouseEvent) {\n    event.stopPropagation()\n    onCreateObject()\n  }\n\n  function handleCreateArray(event: MouseEvent) {\n    event.stopPropagation()\n    onCreateArray()\n  }\n</script>\n\n<div class=\"jse-welcome\" onclick={() => onClick()} role=\"none\">\n  <div class=\"jse-space jse-before\"></div>\n  <div class=\"jse-contents\">\n    <div class=\"jse-welcome-title\">Empty document</div>\n    {#if !readOnly}\n      <div class=\"jse-welcome-info\">\n        You can paste clipboard data using <b>Ctrl+V</b>, or use the following options:\n      </div>\n      <button title={\"Create an empty JSON object (press '{')\"} onclick={handleCreateObject}\n        >Create object</button\n      >\n      <button title={\"Create an empty JSON array (press '[')\"} onclick={handleCreateArray}\n        >Create array</button\n      >\n    {/if}\n  </div>\n  <div class=\"jse-space jse-after\"></div>\n</div>\n\n<style src=\"./Welcome.scss\"></style>\n","import diffSequence from '../generated/diffSequence.js'\nimport type { JSONPatchDocument, JSONPatchOperation, JSONPath } from 'immutable-json-patch'\nimport {\n  compileJSONPointer,\n  getIn,\n  isJSONArray,\n  isJSONPatchCopy,\n  isJSONPatchMove,\n  parseFrom,\n  parsePath,\n  setIn\n} from 'immutable-json-patch'\nimport { first, initial, isEmpty, isEqual, last } from 'lodash-es'\nimport naturalCompare from 'natural-compare-lite'\nimport { int } from '../utils/numberUtils.js'\nimport { isObject, isObjectOrArray } from '../utils/typeUtils.js'\n\nexport function caseInsensitiveNaturalCompare(a: unknown, b: unknown) {\n  const aLower = typeof a === 'string' ? a.toLowerCase() : a\n  const bLower = typeof b === 'string' ? b.toLowerCase() : b\n\n  // @ts-expect-error The type definition expects strings\n  return naturalCompare(aLower, bLower)\n}\n\n/**\n * Sort a JSON object or array\n * @param json           The the JSON containing the (optionally nested)\n *                       object to be sorted\n * @param [rootPath=[]]  Relative path when the array was located\n * @param [itemPath=[]]  Item path by which to sort items in case of an array\n * @param [direction=1]  Pass 1 to sort ascending, -1 to sort descending\n * @return               Returns a JSONPatch document with move operation\n *                       to get the array sorted.\n */\nexport function sortJson(\n  json: unknown,\n  rootPath: JSONPath = [],\n  itemPath: JSONPath = [],\n  direction: 1 | -1 = 1\n): JSONPatchDocument {\n  const value = getIn(json, rootPath)\n\n  if (isJSONArray(value)) {\n    if (itemPath === undefined) {\n      throw new Error('Cannot sort: no property selected by which to sort the array')\n    }\n\n    return sortArray(json, rootPath, itemPath, direction)\n  }\n\n  if (isObject(value)) {\n    return sortObjectKeys(json, rootPath, direction)\n  }\n\n  throw new Error('Cannot sort: no array or object')\n}\n\n/**\n * Sort the keys of an object\n * @param json           The the JSON containing the (optionally nested)\n *                       object to be sorted\n * @param [rootPath=[]]  Relative path when the array was located\n * @param [direction=1]  Pass 1 to sort ascending, -1 to sort descending\n * @return               Returns a JSONPatch document with operations\n *                       to get the array sorted.\n */\nexport function sortObjectKeys(\n  json: unknown,\n  rootPath: JSONPath = [],\n  direction: 1 | -1 = 1\n): JSONPatchDocument {\n  const object = getIn(json, rootPath) as Record<string, unknown>\n  const keys = Object.keys(object as unknown as Record<string, unknown>)\n  const sortedKeys = keys.slice()\n\n  sortedKeys.sort((keyA, keyB) => {\n    return direction * caseInsensitiveNaturalCompare(keyA, keyB)\n  })\n\n  // for performance reasons, do a full replace (we could also create a move operation for every key)\n  const sortedObject: Record<string, unknown> = {}\n  sortedKeys.forEach((key) => (sortedObject[key] = object[key]))\n\n  return [\n    {\n      op: 'replace',\n      path: compileJSONPointer(rootPath),\n      value: sortedObject\n    }\n  ]\n}\n\n/**\n * Sort the items of an array\n * @param json               The document containing (optionally nested)\n *                           the array to be sorted.\n * @param [rootPath=[]]      Relative path when the array was located\n * @param [propertyPath=[]]  Nested path to the property on which to sort the contents\n * @param [direction=1]      Pass 1 to sort ascending, -1 to sort descending\n * @return                   Returns a JSONPatch document with move operation\n *                           to get the array sorted.\n */\nexport function sortArray(\n  json: unknown,\n  rootPath: JSONPath = [],\n  propertyPath: JSONPath = [],\n  direction: 1 | -1 = 1\n): JSONPatchDocument {\n  const comparator = createObjectComparator(propertyPath, direction)\n\n  // TODO: make the mechanism to sort configurable? Like use sortOperationsMove and sortOperationsMoveAdvanced\n  const array = getIn(json, rootPath) as Array<unknown>\n  return [\n    {\n      op: 'replace',\n      path: compileJSONPointer(rootPath),\n      value: array.slice(0).sort(comparator)\n    }\n  ]\n}\n\n/**\n * Create a comparator function to compare nested properties in an array\n */\nfunction createObjectComparator(propertyPath: JSONPath, direction: 1 | -1) {\n  const sortableTypes: Record<string, number> = { boolean: 0, number: 1, string: 2, undefined: 4 }\n  const otherTypes = 3\n\n  return function comparator(a: unknown, b: unknown) {\n    const valueA = getIn(a, propertyPath)\n    const valueB = getIn(b, propertyPath)\n\n    // Order mixed types\n    if (typeof valueA !== typeof valueB) {\n      const aIndex = sortableTypes[typeof valueA] ?? otherTypes\n      const bIndex = sortableTypes[typeof valueB] ?? otherTypes\n\n      return aIndex > bIndex ? direction : aIndex < bIndex ? -direction : 0\n    }\n\n    // Order two numbers, two strings, or two booleans\n    if (typeof valueA === 'number' || typeof valueA === 'boolean') {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      return valueA > valueB ? direction : valueA < valueB ? -direction : 0\n    }\n\n    // Leave objects and arrays unsorted\n    if (isObjectOrArray(valueA)) {\n      return 0\n    }\n\n    // sort strings and non-primitive types\n    return direction * caseInsensitiveNaturalCompare(valueA, valueB)\n  }\n}\n\n/**\n * Create a list with JSON Patch move operations\n * needed to sort the array contents.\n */\nexport function sortOperationsMove<T>(\n  array: T[],\n  comparator: (a: T, b: T) => number\n): JSONPatchOperation[] {\n  const operations: JSONPatchOperation[] = []\n  const sorted = []\n\n  // TODO: rewrite the function to pass a callback instead of returning an array?\n  for (let i = 0; i < array.length; i++) {\n    // TODO: can we simplify the following code?\n    const item = array[i]\n    if (i > 0 && comparator(sorted[i - 1], item) > 0) {\n      let j = i - 1\n      while (j > 0 && comparator(sorted[j - 1], item) > 0) {\n        j--\n      }\n\n      operations.push({\n        op: 'move',\n        from: '/' + i,\n        path: '/' + j\n      })\n\n      sorted.splice(j, 0, item)\n    } else {\n      sorted.push(item)\n    }\n  }\n\n  return operations\n}\n\n/**\n * Create an array containing all move operations\n * needed to sort the array contents.\n */\nexport function sortOperationsMoveAdvanced<T>(\n  array: T[],\n  comparator: (a: T, b: T) => number\n): JSONPatchOperation[] {\n  const moves: { from: number; to: number }[] = []\n\n  const sortedIndices = array\n    .map((item, index) => ({ item, index }))\n    .sort((a, b) => comparator(a.item, b.item))\n    .map((entry) => entry.index)\n\n  let bIndex = 0\n\n  function foundSubsequence(nCommon: number, aCommon: number, bCommon: number) {\n    for (let b = bIndex; b < bCommon; b++) {\n      moves.push({\n        from: sortedIndices[b],\n        to: aCommon\n      })\n    }\n\n    bIndex = bCommon + nCommon\n  }\n\n  const size = array.length\n\n  function isCommon(aIndex: number, bIndex: number) {\n    return aIndex === sortedIndices[bIndex]\n  }\n\n  diffSequence(size, size, isCommon, foundSubsequence)\n  foundSubsequence(0, size, size)\n\n  // every move will change the actual indices, so we've to adjust for that\n  // in all moves that still have to be executed\n  for (let i = 0; i < moves.length; i++) {\n    if (moves[i].to > moves[i].from) {\n      moves[i].to--\n    }\n\n    const { from, to } = moves[i]\n\n    for (let j = i + 1; j < moves.length; j++) {\n      const other = moves[j]\n      if (other.from >= from) {\n        other.from--\n      }\n      if (other.to >= from) {\n        other.to--\n      }\n      if (other.from >= to) {\n        other.from++\n      }\n      if (other.to >= to) {\n        other.to++\n      }\n    }\n  }\n\n  return moves.map(({ from, to }) => {\n    return {\n      op: 'move',\n      from: '/' + from,\n      path: '/' + to\n    }\n  })\n}\n\n/**\n * Fast solution to apply many JSON patch move operations inside a single array,\n * like applying all moves needed to sort an array.\n *\n * Throws an error when not all operations are move operation inside the same\n * array.\n */\n// TODO: write unit tests\nexport function fastPatchSort(json: unknown, operations: JSONPatchDocument): unknown {\n  if (isEmpty(operations)) {\n    // nothing to do :)\n    return json\n  }\n\n  // validate whether all operations are \"move\" operations\n  const invalidOp = operations.find((operation) => {\n    return operation.op !== 'move'\n  })\n  if (invalidOp) {\n    throw new Error(\n      'Cannot apply fastPatchSort: not a \"move\" operation ' +\n        '(actual: ' +\n        JSON.stringify(invalidOp) +\n        ')'\n    )\n  }\n\n  // parse all paths\n  const parsedOperations: Array<{ from: JSONPath | undefined; path: JSONPath }> = operations.map(\n    (operation) => ({\n      from:\n        isJSONPatchCopy(operation) || isJSONPatchMove(operation)\n          ? parseFrom(operation.from)\n          : undefined,\n      path: parsePath(json, operation.path)\n    })\n  )\n\n  // validate whether the move actions take place in an array\n  const arrayPath = initial(first(parsedOperations)?.path)\n  const array = getIn(json, arrayPath)\n  if (!Array.isArray(array)) {\n    throw new Error(\n      'Cannot apply fastPatchSort: not an Array ' + '(path: ' + JSON.stringify(arrayPath) + ')'\n    )\n  }\n\n  // validate whether all paths are in the same array\n  const invalidPath = parsedOperations.find((parsedOperation) => {\n    return (\n      !isEqual(arrayPath, initial(parsedOperation.path)) ||\n      !isEqual(arrayPath, initial(parsedOperation.from))\n    )\n  })\n  if (invalidPath) {\n    throw new Error(\n      'Cannot apply fastPatchSort: not all move operations are in the same array ' +\n        '(expected: ' +\n        JSON.stringify(arrayPath) +\n        ', actual: ' +\n        JSON.stringify(invalidPath) +\n        ')'\n    )\n  }\n\n  // apply the actual operations on the same array. Only copy the only array once\n  const updatedArray = array.slice(0)\n  parsedOperations.forEach((parsedOperation) => {\n    const toIndex = int(last(parsedOperation.path) || '-1')\n    const fromIndex = int(last(parsedOperation.from) || '-1')\n\n    const value = updatedArray.splice(fromIndex, 1)[0]\n    updatedArray.splice(toIndex, 0, value)\n  })\n\n  return setIn(json, arrayPath, updatedArray)\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { limit } from '$lib/utils/arrayUtils.js'\n  import { truncate } from '$lib/utils/stringUtils.js'\n\n  export let items: (string | number)[]\n  export let selectedItem: string | number\n  export let onSelect: (item: string | number) => void\n\n  const MAX_ITEMS = 100\n  const MAX_ITEM_CHARACTERS = 30\n</script>\n\n<div class=\"jse-navigation-bar-dropdown\">\n  {#each limit(items, MAX_ITEMS) as item (item)}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-dropdown-item\"\n      class:jse-selected={item === selectedItem}\n      on:click|stopPropagation={() => onSelect(item)}\n      title={item.toString()}\n    >\n      {truncate(item.toString(), MAX_ITEM_CHARACTERS)}\n    </button>\n  {/each}\n  {#if items.length > MAX_ITEMS}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-dropdown-item\"\n      title=\"Limited to {MAX_ITEMS} items\"\n    >\n      ...\n    </button>\n  {/if}\n</div>\n\n<style src=\"./NavigationBarDropdown.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faAngleRight } from '@fortawesome/free-solid-svg-icons'\n  import NavigationBarDropdown from '../../../components/controls/navigationBar/NavigationBarDropdown.svelte'\n  import { getContext } from 'svelte'\n  import type { JSONPath } from 'immutable-json-patch'\n  import type { AbsolutePopupContext } from '$lib/types'\n\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let path: JSONPath\n  export let index: number\n  export let onSelect: (path: JSONPath) => void\n  export let getItems: (path: JSONPath) => string[]\n\n  let refNavigationBarItem: Element | undefined\n  let open = false\n  let popupId: number | undefined\n\n  $: itemPath = path.slice(0, index)\n  $: selectedItem = path[index]\n\n  function handleSelectItem(item: string) {\n    closeAbsolutePopup(popupId)\n    onSelect(itemPath.concat(item))\n  }\n\n  function openDropdown() {\n    if (refNavigationBarItem) {\n      open = true\n\n      const props = {\n        items: getItems(itemPath),\n        selectedItem,\n        onSelect: handleSelectItem\n      }\n\n      popupId = openAbsolutePopup(NavigationBarDropdown, props, {\n        anchor: refNavigationBarItem,\n        closeOnOuterClick: true,\n        onClose: () => {\n          open = false\n        }\n      })\n    }\n  }\n</script>\n\n<div class=\"jse-navigation-bar-item\" bind:this={refNavigationBarItem}>\n  <button\n    type=\"button\"\n    class=\"jse-navigation-bar-button jse-navigation-bar-arrow\"\n    class:jse-open={open}\n    on:click={openDropdown}\n  >\n    <Icon data={faAngleRight} />\n  </button>\n  {#if selectedItem !== undefined}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-button\"\n      on:click={() => handleSelectItem(selectedItem)}\n    >\n      {selectedItem}\n    </button>\n  {/if}\n</div>\n\n<style src=\"./NavigationBarItem.scss\"></style>\n","export default function copyToClipBoard(text: string): Promise<void> {\n  if (navigator.clipboard) {\n    return navigator.clipboard.writeText(text)\n  }\n  // Compatible with old browsers such as Chrome <=65, Edge <=18 & IE\n  // Compatible with HTTP\n  else if (document.queryCommandSupported?.('copy')) {\n    const textarea = document.createElement('textarea')\n    textarea.value = text\n\n    textarea.style.position = 'fixed' // Avoid scrolling to bottom\n    textarea.style.opacity = '0'\n\n    document.body.appendChild(textarea)\n    textarea.select()\n\n    // Security exception may be thrown by some browsers\n    try {\n      document.execCommand('copy')\n    } catch (e) {\n      console.error(e)\n    } finally {\n      document.body.removeChild(textarea)\n    }\n\n    return Promise.resolve()\n  } else {\n    console.error('Copy failed.')\n\n    return Promise.resolve()\n  }\n}\n","<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { getContext, onDestroy, onMount } from 'svelte'\n  import copyToClipBoard from '$lib/utils/copyToClipboard.js'\n  import { faCopy, faExclamationTriangle } from '@fortawesome/free-solid-svg-icons'\n  import Icon from 'svelte-awesome'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { tooltip } from '../../controls/tooltip/tooltip.js'\n  import type { AbsolutePopupContext, JSONPathParser, OnError } from '$lib/types.js'\n\n  const absolutePopupContext = getContext<AbsolutePopupContext>('absolute-popup')\n\n  export let path: JSONPath\n  export let pathParser: JSONPathParser\n  export let onChange: (updatedPath: JSONPath) => void\n  export let onClose: () => void\n  export let onError: OnError\n  export let pathExists: (path: JSONPath) => boolean\n\n  let inputRef: HTMLInputElement\n  let inputPath: string\n  let validationActive = false\n  $: inputPath = pathParser.stringify(path)\n  $: inputValidationError = validationActive ? parseAndValidate(inputPath).error : undefined\n\n  let copiedTimer: number | undefined = undefined\n  let copied = false\n  const copiedDelay = 1000 // ms\n\n  onMount(() => {\n    focus()\n  })\n\n  onDestroy(() => {\n    clearTimeout(copiedTimer)\n  })\n\n  function focus() {\n    inputRef.focus()\n  }\n\n  function parseAndValidate(pathStr: string): {\n    path: JSONPath | undefined\n    error: Error | undefined\n  } {\n    try {\n      const path = pathParser.parse(pathStr)\n      validatePathExists(path)\n      return {\n        path,\n        error: undefined\n      }\n    } catch (error) {\n      return {\n        path: undefined,\n        error: error as Error\n      }\n    }\n  }\n\n  function validatePathExists(path: JSONPath) {\n    if (!pathExists(path)) {\n      throw new Error('Path does not exist in current document')\n    }\n  }\n\n  function handleInput(event: Event & { currentTarget: EventTarget & HTMLInputElement }) {\n    inputPath = event.currentTarget.value\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Escape') {\n      event.preventDefault()\n      onClose()\n    }\n\n    if (combo === 'Enter') {\n      event.preventDefault()\n\n      validationActive = true\n      const result = parseAndValidate(inputPath)\n      if (result.path !== undefined) {\n        onChange(result.path)\n      } else {\n        onError(result.error as Error)\n      }\n    }\n  }\n\n  function handleCopy() {\n    copyToClipBoard(inputPath)\n    copied = true\n    copiedTimer = window.setTimeout(() => (copied = false), copiedDelay)\n    focus()\n  }\n</script>\n\n<div class=\"jse-navigation-bar-path-editor\" class:error={inputValidationError}>\n  <input\n    type=\"text\"\n    class=\"jse-navigation-bar-text\"\n    value={inputPath}\n    bind:this={inputRef}\n    on:keydown|stopPropagation={handleKeyDown}\n    on:input={handleInput}\n  />\n  {#if inputValidationError}\n    <button\n      type=\"button\"\n      class=\"jse-navigation-bar-validation-error\"\n      use:tooltip={{\n        text: String(inputValidationError || ''),\n        ...absolutePopupContext\n      }}\n    >\n      <Icon data={faExclamationTriangle} />\n    </button>\n  {/if}\n  {#if copied}\n    <div class=\"jse-copied-text\">Copied!</div>\n  {/if}\n  <button\n    type=\"button\"\n    class=\"jse-navigation-bar-copy\"\n    class:copied\n    title=\"Copy selected path to the clipboard\"\n    on:click={handleCopy}\n  >\n    <Icon data={faCopy} />\n  </button>\n</div>\n\n<style src=\"./NavigationBarPathEditor.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { existsIn, getIn } from 'immutable-json-patch'\n  import { range } from 'lodash-es'\n  import { isObject, isObjectOrArray } from '$lib/utils/typeUtils.js'\n  import { createMultiSelection, getFocusPath } from '$lib/logic/selection.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import { caseInsensitiveNaturalCompare } from '$lib/logic/sort.js'\n  import type { JSONPathParser, JSONSelection, OnError, OnJSONSelect } from '$lib/types.js'\n  import Icon from 'svelte-awesome'\n  import { faClose, faEdit } from '@fortawesome/free-solid-svg-icons'\n  import NavigationBarItem from './NavigationBarItem.svelte'\n  import NavigationBarPathEditor from './NavigationBarPathEditor.svelte'\n\n  const debug = createDebug('jsoneditor:NavigationBar')\n\n  export let json: unknown\n  export let selection: JSONSelection | undefined\n  export let onSelect: OnJSONSelect\n  export let onError: OnError\n  export let pathParser: JSONPathParser\n\n  let refNavigationBar: Element | undefined\n  let editing = false\n\n  $: path = selection ? getFocusPath(selection) : []\n  $: hasNextItem = isObjectOrArray(getIn(json, path))\n\n  // we have an unused parameter path to trigger scrollToLastItem when path changes,\n  // see $: scrollToLastItem(path)\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  function scrollToLastItem(path: JSONPath) {\n    setTimeout(() => {\n      if (refNavigationBar && refNavigationBar.scrollTo) {\n        const left = refNavigationBar.scrollWidth - refNavigationBar.clientWidth\n        if (left > 0) {\n          debug('scrollTo ', left)\n          refNavigationBar.scrollTo({ left, behavior: 'smooth' })\n        }\n      }\n    })\n  }\n\n  // trigger scrollToLastItem when path changes\n  $: scrollToLastItem(path)\n\n  function getItems(path: JSONPath): string[] {\n    debug('get items for path', path)\n\n    const node = getIn(json, path)\n    if (Array.isArray(node)) {\n      return range(0, node.length).map(String)\n    } else if (isObject(node)) {\n      const keys = Object.keys(node)\n\n      const sortedKeys = keys.slice(0)\n      sortedKeys.sort(caseInsensitiveNaturalCompare)\n\n      return sortedKeys\n    } else {\n      // never happens but just for robustness...\n      return []\n    }\n  }\n\n  function pathExists(path: JSONPath): boolean {\n    return existsIn(json, path)\n  }\n\n  function handleSelect(path: JSONPath) {\n    debug('select path', JSON.stringify(path))\n\n    onSelect(createMultiSelection(path, path))\n  }\n\n  function toggleEditing() {\n    editing = !editing\n  }\n\n  function handleCloseEditor() {\n    editing = false\n  }\n\n  function handleChangePath(path: JSONPath) {\n    handleCloseEditor()\n    handleSelect(path)\n  }\n</script>\n\n<div class=\"jse-navigation-bar\" bind:this={refNavigationBar}>\n  {#if !editing}\n    <!-- eslint-disable-next-line @typescript-eslint/no-unused-vars -->\n    {#each path as item, index (index)}\n      <NavigationBarItem {getItems} {path} {index} onSelect={handleSelect} />\n    {/each}\n    {#if hasNextItem}\n      <NavigationBarItem {getItems} {path} index={path.length} onSelect={handleSelect} />\n    {/if}\n  {:else}\n    <NavigationBarPathEditor\n      {path}\n      onClose={handleCloseEditor}\n      onChange={handleChangePath}\n      {onError}\n      {pathExists}\n      {pathParser}\n    />\n  {/if}\n\n  <button\n    type=\"button\"\n    class=\"jse-navigation-bar-edit\"\n    class:flex={!editing}\n    class:editing\n    title={editing ? 'Cancel editing the selected path' : 'Edit the selected path'}\n    on:click={toggleEditing}\n  >\n    <span class=\"jse-navigation-bar-space\">\n      <!-- ensure the right height (arrows have less height than the text) -->\n      {!isObjectOrArray(json) && !editing ? 'Navigation bar' : '\\u00A0'}\n    </span>\n\n    <Icon data={editing ? faClose : faEdit} />\n  </button>\n</div>\n\n<style src=\"./NavigationBar.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { debounce } from 'lodash-es'\n  import Icon from 'svelte-awesome'\n  import {\n    faCaretDown,\n    faCaretRight,\n    faChevronDown,\n    faChevronUp,\n    faCircleNotch,\n    faSearch,\n    faTimes\n  } from '@fortawesome/free-solid-svg-icons'\n  import { DEBOUNCE_DELAY, MAX_SEARCH_RESULTS } from '$lib/constants.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type { DocumentState, JSONParser, OnPatch, SearchResultDetails } from '$lib/types.js'\n  import {\n    createSearchAndReplaceAllOperations,\n    createSearchAndReplaceOperations,\n    search,\n    searchNext,\n    searchPrevious,\n    updateSearchResult\n  } from '$lib/logic/search.js'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { flushSync } from 'svelte'\n\n  const debug = createDebug('jsoneditor:SearchBox')\n\n  export let json: unknown\n  export let documentState: DocumentState | undefined\n  export let parser: JSONParser\n  export let showSearch: boolean\n  export let showReplace: boolean\n  export let readOnly: boolean\n  export let columns: JSONPath[] | undefined\n  export let onSearch: (result: SearchResultDetails | undefined) => void\n  export let onFocus: (path: JSONPath, resultIndex: number) => Promise<void>\n  export let onPatch: OnPatch\n  export let onClose: () => void\n\n  let text = ''\n  let appliedText = ''\n  let replaceText = ''\n  let searching = false\n  let searchResult: SearchResultDetails | undefined\n\n  $: resultCount = searchResult?.items?.length || 0\n  $: activeIndex = searchResult?.activeIndex || 0\n  $: formattedResultCount =\n    resultCount >= MAX_SEARCH_RESULTS ? `${MAX_SEARCH_RESULTS - 1}+` : String(resultCount)\n\n  $: onSearch(searchResult)\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: applyChangedShowSearch(showSearch)\n\n  const applyChangedSearchTextDebounced = debounce(applyChangedSearchText, DEBOUNCE_DELAY)\n  $: applyChangedSearchTextDebounced(text)\n\n  const applyChangedJsonDebounced = debounce(applyChangedJson, DEBOUNCE_DELAY)\n  $: applyChangedJsonDebounced(json)\n\n  function toggleShowReplace() {\n    showReplace = !showReplace && !readOnly\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    // key events must not be handled by the generic keydown handler of the\n    // whole JSONEditor.\n    event.stopPropagation()\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Enter') {\n      event.preventDefault()\n\n      const pendingChanges = text !== appliedText\n      if (pendingChanges) {\n        applyChangedSearchTextDebounced.flush()\n      } else {\n        handleNext()\n      }\n    }\n\n    if (combo === 'Shift+Enter') {\n      event.preventDefault()\n      handlePrevious()\n    }\n\n    if (combo === 'Ctrl+Enter') {\n      event.preventDefault()\n\n      if (showReplace) {\n        handleReplace()\n      } else {\n        handleNext()\n        // TODO: move focus to the active element so you can start editing?\n      }\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      toggleShowReplace()\n    }\n\n    if (combo === 'Escape') {\n      event.preventDefault()\n\n      handleClose()\n    }\n  }\n\n  function handleReplaceKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n\n    if (combo === 'Enter') {\n      event.preventDefault()\n      event.stopPropagation()\n\n      handleReplace()\n    }\n  }\n\n  async function handlePaste() {\n    flushSync()\n    await applyChangedSearchTextDebounced.flush()\n  }\n\n  async function handleReplace() {\n    if (readOnly) {\n      return\n    }\n\n    const activeItem = searchResult?.activeItem\n    debug('handleReplace', { replaceText, activeItem })\n\n    if (!searchResult || !activeItem || json === undefined) {\n      return\n    }\n\n    // move to the next search result *before* applying the replacement\n    searchResult = {\n      ...searchNext(searchResult),\n      activeIndex // trick to prevent shortly flickering of index from 1 to 2 and then to 1 again after the next search\n    }\n\n    const { operations, newSelection } = createSearchAndReplaceOperations(\n      json,\n      documentState,\n      replaceText,\n      activeItem,\n      parser\n    )\n\n    onPatch(operations, (_, patchedState) => ({\n      state: patchedState,\n      selection: newSelection\n    }))\n\n    // immediately trigger updating the search results\n    flushSync()\n    await applyChangedJsonDebounced.flush()\n\n    // focus to the next search result\n    await handleFocus()\n  }\n\n  async function handleReplaceAll() {\n    if (readOnly) {\n      return\n    }\n\n    debug('handleReplaceAll', { text, replaceText })\n\n    const { operations, newSelection } = createSearchAndReplaceAllOperations(\n      json,\n      documentState,\n      text,\n      replaceText,\n      parser\n    )\n\n    onPatch(operations, (_, patchedState) => ({\n      state: patchedState,\n      selection: newSelection\n    }))\n\n    await handleFocus()\n  }\n\n  function initSearchInput(element: HTMLInputElement) {\n    element.select()\n  }\n\n  async function handleNext() {\n    searchResult = searchResult ? searchNext(searchResult) : undefined\n\n    await handleFocus()\n  }\n\n  async function handlePrevious() {\n    searchResult = searchResult ? searchPrevious(searchResult) : undefined\n\n    await handleFocus()\n  }\n\n  async function handleFocus() {\n    debug('handleFocus', searchResult)\n\n    const activeItem = searchResult?.activeItem\n    if (activeItem && json !== undefined) {\n      await onFocus(activeItem.path, activeItem.resultIndex)\n    }\n  }\n\n  async function applyChangedShowSearch(showSearch: boolean) {\n    await applySearch(showSearch, text, json)\n  }\n\n  async function applyChangedSearchText(text: string) {\n    await applySearch(showSearch, text, json)\n    await handleFocus()\n  }\n\n  async function applyChangedJson(json: unknown) {\n    await applySearch(showSearch, text, json)\n  }\n\n  // we pass searchText and json as argument to trigger search when these variables change,\n  // via various listeners like applyChangedSearchText\n  async function applySearch(showSearch: boolean, text: string, json: unknown): Promise<void> {\n    if (!showSearch) {\n      if (searchResult) {\n        searchResult = undefined\n      }\n\n      return Promise.resolve()\n    }\n\n    debug('applySearch', { showSearch, text })\n\n    if (text === '') {\n      debug('clearing search result')\n\n      if (searchResult !== undefined) {\n        searchResult = undefined\n      }\n\n      return Promise.resolve()\n    }\n\n    appliedText = text\n    searching = true\n\n    return new Promise<void>((resolve) => {\n      setTimeout(() => {\n        // wait until the search icon has been rendered\n        const newResultItems = search(text, json, { maxResults: MAX_SEARCH_RESULTS, columns })\n        searchResult = updateSearchResult(newResultItems, searchResult)\n\n        searching = false\n        resolve()\n      })\n    })\n  }\n\n  function handleClose() {\n    debug('handleClose')\n    applyChangedSearchTextDebounced.cancel()\n    applyChangedJsonDebounced.cancel()\n    applySearch(false, text, json) // will clear the search results\n    onClose()\n  }\n</script>\n\n{#if showSearch}\n  <div class=\"jse-search-box\">\n    <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n    <form class=\"jse-search-form\" on:keydown={handleKeyDown}>\n      {#if !readOnly}\n        <button\n          type=\"button\"\n          class=\"jse-replace-toggle\"\n          title=\"Toggle visibility of replace options (Ctrl+H)\"\n          on:click={toggleShowReplace}\n        >\n          <Icon data={showReplace ? faCaretDown : faCaretRight} />\n        </button>\n      {/if}\n      <div class=\"jse-search-contents\">\n        <div class=\"jse-search-section\">\n          <div class=\"jse-search-icon\">\n            {#if searching}\n              <Icon data={faCircleNotch} spin />\n            {:else}\n              <Icon data={faSearch} />\n            {/if}\n          </div>\n          <label class=\"jse-search-input-label\" about=\"jse-search input\">\n            <input\n              class=\"jse-search-input\"\n              title=\"Enter text to search\"\n              type=\"text\"\n              placeholder=\"Find\"\n              bind:value={text}\n              use:initSearchInput\n              on:paste={handlePaste}\n            />\n          </label>\n          <div class=\"jse-search-count\" class:jse-visible={text !== ''}>\n            {activeIndex !== -1 && activeIndex < resultCount\n              ? `${activeIndex + 1}/`\n              : ''}{formattedResultCount}\n          </div>\n          <button\n            type=\"button\"\n            class=\"jse-search-next\"\n            title=\"Go to next search result (Enter)\"\n            on:click={handleNext}\n          >\n            <Icon data={faChevronDown} />\n          </button>\n          <button\n            type=\"button\"\n            class=\"jse-search-previous\"\n            title=\"Go to previous search result (Shift+Enter)\"\n            on:click={handlePrevious}\n          >\n            <Icon data={faChevronUp} />\n          </button>\n          <button\n            type=\"button\"\n            class=\"jse-search-clear\"\n            title=\"Close search box (Esc)\"\n            on:click={handleClose}\n          >\n            <Icon data={faTimes} />\n          </button>\n        </div>\n        {#if showReplace && !readOnly}\n          <div class=\"jse-replace-section\">\n            <input\n              class=\"jse-replace-input\"\n              title=\"Enter replacement text\"\n              type=\"text\"\n              placeholder=\"Replace\"\n              bind:value={replaceText}\n              on:keydown={handleReplaceKeyDown}\n            />\n            <button\n              type=\"button\"\n              title=\"Replace current occurrence (Ctrl+Enter)\"\n              on:click={handleReplace}>Replace</button\n            >\n            <button type=\"button\" title=\"Replace all occurrences\" on:click={handleReplaceAll}\n              >All</button\n            >\n          </div>\n        {/if}\n      </div>\n    </form>\n  </div>\n{/if}\n\n<style src=\"./SearchBox.scss\"></style>\n","import type { JSONPatchOperation, JSONPath } from 'immutable-json-patch'\nimport {\n  compileJSONPointer,\n  isJSONArray,\n  isJSONObject,\n  parseJSONPointer\n} from 'immutable-json-patch'\nimport { groupBy, isEmpty, isEqual, mapValues, partition } from 'lodash-es'\nimport type { JSONSelection, SortedColumn, TableCellIndex, ValidationError } from '$lib/types.js'\nimport { ValidationSeverity } from '$lib/types.js'\nimport { createValueSelection, getFocusPath, pathStartsWith } from './selection.js'\nimport { containsNumber } from '../utils/numberUtils.js'\nimport type { Dictionary } from 'lodash'\nimport { stringifyJSONPath } from '$lib/utils/pathUtils.js'\nimport { forEachSample } from '$lib/utils/arrayUtils.js'\nimport { isObject } from '$lib/utils/typeUtils.js'\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\ntype NestedObject = Record<string, NestedObject>\n\nconst endOfPath = Symbol('path')\n\nexport function getColumns(\n  array: Array<unknown>,\n  flatten: boolean,\n  maxSampleCount = Infinity\n): JSONPath[] {\n  const merged: NestedObject = {}\n\n  if (Array.isArray(array)) {\n    // We read samples spread through the whole array, from begin to end.\n    // When the array is sorted, and a specific field is present only at the last\n    // couple of items of the array or in the middle, we want to pick that up too.\n    forEachSample(array, maxSampleCount, (item) => {\n      if (isObject(item)) {\n        _recurseObject(item, merged, flatten)\n      } else {\n        merged[endOfPath] = true\n      }\n    })\n  }\n\n  const paths: JSONPath[] = []\n  if (endOfPath in merged) {\n    paths.push([])\n  }\n  _collectPaths(merged, [], paths, flatten)\n\n  return paths\n}\n\n// internal function for getColumns\n// mutates the argument merged\nfunction _recurseObject(object: NestedObject, merged: NestedObject, flatten: boolean): void {\n  for (const key in object) {\n    const value = object[key]\n    const valueMerged = merged[key] || (merged[key] = {})\n\n    if (isObject(value) && flatten) {\n      _recurseObject(value, valueMerged, flatten)\n    } else {\n      if (valueMerged[endOfPath] === undefined) {\n        valueMerged[endOfPath] = true\n      }\n    }\n  }\n}\n\n// internal function for getColumns\n// mutates the argument paths\nfunction _collectPaths(\n  object: NestedObject,\n  parentPath: JSONPath,\n  paths: JSONPath[],\n  flatten: boolean\n): void {\n  for (const key in object) {\n    const path = parentPath.concat(key)\n    const value = object[key]\n\n    if (value && value[endOfPath] === true) {\n      paths.push(path)\n    }\n\n    if (isJSONObject(value) && flatten) {\n      _collectPaths(value, path, paths, flatten)\n    }\n  }\n}\n\nexport function maintainColumnOrder(\n  newColumns: JSONPath[],\n  previousColumns: JSONPath[]\n): JSONPath[] {\n  const orderedColumns = new Set(previousColumns.map(compileJSONPointer))\n  const newColumnsSet = new Set(newColumns.map(compileJSONPointer))\n\n  // delete the columns that are gone now\n  for (const column of orderedColumns) {\n    if (!newColumnsSet.has(column)) {\n      orderedColumns.delete(column)\n    }\n  }\n\n  // append the new columns to the end\n  for (const column of newColumnsSet) {\n    if (!orderedColumns.has(column)) {\n      orderedColumns.add(column)\n    }\n  }\n\n  return [...orderedColumns].map(parseJSONPointer)\n}\n\nexport function getShallowKeys(value: unknown): JSONPath[] {\n  return isJSONObject(value) ? Object.keys(value).map((key) => [key]) : [[]]\n}\n\nexport function getRecursiveKeys(value: unknown): JSONPath[] {\n  const paths: JSONPath[] = []\n\n  function recurse(value: unknown, path: JSONPath) {\n    if (isJSONObject(value)) {\n      Object.keys(value).forEach((key) => {\n        recurse(value[key], path.concat(key))\n      })\n    } else {\n      // array or primitive value like string or number\n      paths.push(path)\n    }\n  }\n\n  recurse(value, [])\n\n  return paths\n}\n\nexport interface VisibleSection {\n  startIndex: number\n  endIndex: number\n  startHeight: number\n  visibleHeight: number\n  endHeight: number\n  averageItemHeight: number\n  visibleItems: Array<unknown>\n}\n\n// TODO: write unit tests\nexport function calculateVisibleSection(\n  scrollTop: number,\n  viewPortHeight: number,\n  json: unknown | undefined,\n  itemHeights: Record<number, number>,\n  defaultItemHeight: number,\n  searchBoxOffset: number,\n  margin = 80\n): VisibleSection {\n  const itemCount = isJSONArray(json) ? json.length : 0\n  const averageItemHeight = calculateAverageItemHeight(itemHeights, defaultItemHeight)\n  const viewPortTop = scrollTop - margin\n  const viewPortBottom = viewPortHeight + 2 * margin\n\n  const getItemHeight = (index: number) => itemHeights[index] || defaultItemHeight\n\n  let startIndex = 0\n  let startHeight = searchBoxOffset\n  while (startHeight < viewPortTop && startIndex < itemCount) {\n    startHeight += getItemHeight(startIndex)\n    startIndex++\n  }\n  if (startIndex > 0) {\n    // go one item back, else there is white space at the top for up to 1 missing item\n    startIndex--\n    startHeight -= getItemHeight(startIndex)\n  }\n\n  let endIndex = startIndex\n  let visibleHeight = 0\n  while (visibleHeight < viewPortBottom && endIndex < itemCount) {\n    visibleHeight += getItemHeight(endIndex)\n    endIndex++\n  }\n\n  let endHeight = 0\n  for (let i = endIndex; i < itemCount; i++) {\n    endHeight += getItemHeight(i)\n  }\n\n  const visibleItems = isJSONArray(json) ? json.slice(startIndex, endIndex) : []\n\n  return {\n    startIndex,\n    endIndex,\n    startHeight,\n    endHeight,\n    averageItemHeight,\n    visibleHeight,\n    visibleItems\n  }\n}\n\n// TODO: cleanup if we will not use it in the end\n// TODO: write unit tests\nexport function calculateVisibleSectionApprox(\n  scrollTop: number,\n  viewPortHeight: number,\n  json: unknown | undefined,\n  defaultItemHeight: number\n): VisibleSection {\n  const itemCount = isJSONArray(json) ? json.length : 0\n  const averageItemHeight = defaultItemHeight\n\n  const viewPortTop = scrollTop\n  const startIndex = Math.floor(viewPortTop / defaultItemHeight)\n  const startHeight = startIndex * defaultItemHeight\n  const endIndex = Math.ceil((viewPortTop + viewPortHeight) / defaultItemHeight)\n  const visibleHeight = (endIndex - startIndex) * defaultItemHeight\n  const endHeight = (itemCount - endIndex) * defaultItemHeight\n\n  const visibleItems = isJSONArray(json) ? json.slice(startIndex, endIndex) : []\n\n  return {\n    startIndex,\n    endIndex,\n    startHeight,\n    endHeight,\n    averageItemHeight,\n    visibleHeight,\n    visibleItems\n  }\n}\n\n// TODO: write unit tests\nexport function calculateAbsolutePosition(\n  path: JSONPath,\n  columns: JSONPath[],\n  itemHeights: Record<number, number>,\n  defaultItemHeight: number\n): number {\n  const { rowIndex } = toTableCellPosition(path, columns)\n\n  let top = 0\n  for (let currentIndex = 0; currentIndex < rowIndex; currentIndex++) {\n    top += itemHeights[currentIndex] || defaultItemHeight\n  }\n\n  // TODO: also calculate left\n  return top\n}\n\nfunction calculateAverageItemHeight(\n  itemHeights: Record<number, number>,\n  defaultItemHeight: number\n): number {\n  const values = Object.values(itemHeights) // warning: itemHeights is mutated and not updated itself, we can't watch it!\n  if (isEmpty(values)) {\n    return defaultItemHeight\n  }\n\n  const add = (a: number, b: number) => a + b\n  const total = values.reduce(add)\n  return total / values.length\n}\n\nexport function selectPreviousRow(columns: JSONPath[], selection: JSONSelection): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (rowIndex > 0) {\n    const previousPosition = { rowIndex: rowIndex - 1, columnIndex }\n    const previousPath = fromTableCellPosition(previousPosition, columns)\n    return createValueSelection(previousPath)\n  }\n\n  return selection\n}\n\nexport function selectNextRow(\n  json: unknown,\n  columns: JSONPath[],\n  selection: JSONSelection\n): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (rowIndex < (json as Array<unknown>).length - 1) {\n    const nextPosition = { rowIndex: rowIndex + 1, columnIndex }\n    const nextPath = fromTableCellPosition(nextPosition, columns)\n    return createValueSelection(nextPath)\n  }\n\n  return selection\n}\n\nexport function selectPreviousColumn(columns: JSONPath[], selection: JSONSelection): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (columnIndex > 0) {\n    const previousPosition = { rowIndex, columnIndex: columnIndex - 1 }\n    const previousPath = fromTableCellPosition(previousPosition, columns)\n    return createValueSelection(previousPath)\n  }\n\n  return selection\n}\n\nexport function selectNextColumn(columns: JSONPath[], selection: JSONSelection): JSONSelection {\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  if (columnIndex < columns.length - 1) {\n    const nextPosition = { rowIndex, columnIndex: columnIndex + 1 }\n    const nextPath = fromTableCellPosition(nextPosition, columns)\n    return createValueSelection(nextPath)\n  }\n\n  return selection\n}\n\nexport function toTableCellPosition(path: JSONPath, columns: JSONPath[]): TableCellIndex {\n  const [index, ...column] = path\n\n  const rowIndex = parseInt(index, 10)\n\n  return {\n    rowIndex: !isNaN(rowIndex) ? rowIndex : -1,\n    columnIndex: columns.findIndex((c) => pathStartsWith(column, c))\n  }\n}\n\nexport function fromTableCellPosition(position: TableCellIndex, columns: JSONPath[]): JSONPath {\n  const { rowIndex, columnIndex } = position\n\n  return [String(rowIndex), ...columns[columnIndex]]\n}\n\nexport function stringifyTableCellPosition(position: TableCellIndex): string {\n  const { rowIndex, columnIndex } = position\n\n  return `${rowIndex}:${columnIndex}`\n}\n\ninterface GroupedValidationErrorsByRow {\n  row: ValidationError[]\n  columns: Dictionary<ValidationError[]>\n}\n\nexport interface GroupedValidationErrors {\n  root: ValidationError[]\n  rows: Dictionary<GroupedValidationErrorsByRow>\n}\n\n/**\n * Group validation errors for use in the Table view: per column, and a group for the row as a whole\n */\nexport function groupValidationErrors(\n  validationErrors: ValidationError[],\n  columns: JSONPath[]\n): GroupedValidationErrors {\n  const [arrayErrors, rootErrors] = partition(validationErrors, (validationError) =>\n    containsNumber(validationError.path[0])\n  )\n\n  const errorsByRow: Dictionary<ValidationError[]> = groupBy(arrayErrors, findRowIndex)\n\n  const groupedErrorsByRow = mapValues(errorsByRow, (errors) => {\n    const groupByRow: GroupedValidationErrorsByRow = {\n      row: [],\n      columns: {}\n    }\n\n    errors.forEach((error) => {\n      const columnIndex = findColumnIndex(error, columns)\n\n      if (columnIndex !== -1) {\n        if (groupByRow.columns[columnIndex] === undefined) {\n          groupByRow.columns[columnIndex] = []\n        }\n        groupByRow.columns[columnIndex].push(error)\n      } else {\n        groupByRow.row.push(error)\n      }\n    })\n\n    return groupByRow\n  })\n\n  return {\n    root: rootErrors,\n    rows: groupedErrorsByRow\n  }\n}\n\nexport function mergeValidationErrors(\n  path: JSONPath,\n  validationErrors: ValidationError[] | undefined\n): ValidationError | undefined {\n  if (!validationErrors || validationErrors.length === 0) {\n    return undefined\n  }\n\n  if (validationErrors.length === 1) {\n    return validationErrors[0]\n  }\n\n  return {\n    path,\n    message:\n      'Multiple validation issues: ' +\n      validationErrors\n        .map((error) => {\n          return stringifyJSONPath(error.path) + ' ' + error.message\n        })\n        .join(', '),\n    severity: ValidationSeverity.warning\n  }\n}\n\nfunction findRowIndex(error: ValidationError): number {\n  return parseInt(error.path[0], 10)\n}\n\nfunction findColumnIndex(error: ValidationError, columns: JSONPath[]): number {\n  const position = toTableCellPosition(error.path, columns)\n\n  if (position.columnIndex !== -1) {\n    return position.columnIndex\n  }\n\n  return -1\n}\n\n/**\n * Clear the sorted column from the documentState when it is affected by the operations\n */\nexport function clearSortedColumnWhenAffectedByOperations(\n  sortedColumn: SortedColumn | undefined,\n  operations: JSONPatchOperation[],\n  columms: JSONPath[]\n): SortedColumn | undefined {\n  const mustBeCleared = operations.some((operation) =>\n    operationAffectsSortedColumn(sortedColumn, operation, columms)\n  )\n\n  return mustBeCleared ? undefined : sortedColumn\n}\n\nexport function operationAffectsSortedColumn(\n  sortedColumn: SortedColumn | undefined,\n  operation: JSONPatchOperation,\n  columns: JSONPath[]\n): boolean {\n  if (!sortedColumn) {\n    return false\n  }\n\n  // an operation of replacing a value in a different column does not affect the currently sorted order\n  if (operation.op === 'replace') {\n    const path = parseJSONPointer(operation.path)\n    const { rowIndex, columnIndex } = toTableCellPosition(path, columns)\n    const selectedColumnIndex = columns.findIndex((column) => isEqual(column, sortedColumn.path))\n\n    if (rowIndex !== -1 && columnIndex !== -1 && columnIndex !== selectedColumnIndex) {\n      return false\n    }\n  }\n\n  // TODO: there are more cases where we can known an operation does not affect the sorted order, improve this\n  //  For example adding a nested value in a different column, or removing a full row.\n\n  return true\n}\n\n/**\n * Find nested arrays inside a JSON object\n */\nexport function findNestedArrays(json: unknown, maxLevel = 2): JSONPath[] {\n  const props: JSONPath[] = []\n\n  function recurse(value: unknown, path: JSONPath) {\n    if (isJSONObject(value) && path.length < maxLevel) {\n      Object.keys(value).forEach((key) => {\n        recurse(value[key], path.concat(key))\n      })\n    }\n\n    if (isJSONArray(value)) {\n      props.push(path)\n    }\n  }\n\n  recurse(json, [])\n\n  return props\n}\n","import {\n  createEditKeySelection,\n  createEditValueSelection,\n  createInsideSelection,\n  createMultiSelection,\n  createValueSelection,\n  getFocusPath,\n  hasSelectionContents,\n  isKeySelection,\n  isValueSelection,\n  selectionToPartialJson\n} from '$lib/logic/selection.js'\nimport copyToClipboard from '$lib/utils/copyToClipboard.js'\nimport {\n  append,\n  createNewValue,\n  createRemoveOperations,\n  duplicate,\n  insert,\n  insertBefore,\n  removeAll\n} from '$lib/logic/operations.js'\nimport type {\n  AfterPatchCallback,\n  InsertType,\n  JSONParser,\n  JSONSelection,\n  OnChange,\n  OnChangeText,\n  OnJSONSelect,\n  OnPatch\n} from '$lib/types'\nimport { createDebug } from '$lib/utils/debug.js'\nimport {\n  getIn,\n  isJSONObject,\n  isJSONPatchAdd,\n  isJSONPatchReplace,\n  type JSONPatchOperation,\n  type JSONPath,\n  parsePath\n} from 'immutable-json-patch'\nimport { isObject, isObjectOrArray } from '$lib/utils/typeUtils.js'\nimport { expandAll, expandNone, expandPath, expandSmart } from '$lib/logic/documentState.js'\nimport { initial, isEmpty, last } from 'lodash-es'\nimport { fromTableCellPosition, toTableCellPosition } from '$lib/logic/table.js'\nimport { parsePartialJson } from '$lib/utils/jsonUtils'\nimport { MAX_MULTILINE_PASTE_SIZE } from '$lib/constants'\n\nconst debug = createDebug('jsoneditor:actions')\n\nexport interface OnCutAction {\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  indentation: string | number | undefined\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n}\n\n// TODO: write unit tests\nexport async function onCut({\n  json,\n  selection,\n  indentation,\n  readOnly,\n  parser,\n  onPatch\n}: OnCutAction) {\n  if (readOnly || json === undefined || !selection || !hasSelectionContents(selection)) {\n    return\n  }\n\n  const clipboard = selectionToPartialJson(json, selection, indentation, parser)\n  if (clipboard === undefined) {\n    return\n  }\n\n  debug('cut', { selection, clipboard, indentation })\n\n  await copyToClipboard(clipboard)\n\n  const { operations, newSelection } = createRemoveOperations(json, selection)\n\n  onPatch(operations, (_, patchedState) => ({\n    state: patchedState,\n    selection: newSelection\n  }))\n}\n\nexport interface OnCopyAction {\n  json: unknown\n  selection: JSONSelection | undefined\n  indentation: string | number | undefined\n  parser: JSONParser\n}\n\n// TODO: write unit tests\nexport async function onCopy({ json, selection, indentation, parser }: OnCopyAction) {\n  const clipboard = selectionToPartialJson(json, selection, indentation, parser)\n  if (clipboard === undefined) {\n    return\n  }\n\n  debug('copy', { clipboard, indentation })\n\n  await copyToClipboard(clipboard)\n}\n\ntype RepairModalCallback = (text: string, onApply: (repairedText: string) => void) => void\n\ninterface OnPasteAction {\n  clipboardText: string\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onChangeText: OnChangeText\n  onPasteMultilineText: (pastedText: string) => void\n  openRepairModal: RepairModalCallback\n}\n\n// TODO: write unit tests\nexport function onPaste({\n  clipboardText,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onChangeText,\n  onPasteMultilineText,\n  openRepairModal\n}: OnPasteAction) {\n  if (readOnly) {\n    return\n  }\n\n  function doPaste(pastedText: string) {\n    if (json !== undefined) {\n      const ensureSelection = selection || createValueSelection([])\n\n      const operations = insert(json, ensureSelection, pastedText, parser)\n\n      const pasteMultilineText = isMultilineTextPastedAsArray(clipboardText, operations, parser)\n\n      debug('paste', { pastedText, operations, ensureSelection, pasteMultilineText })\n\n      onPatch(operations, (patchedJson, patchedState) => {\n        let updatedState = patchedState\n\n        // expand newly inserted object/array\n        operations\n          .filter(\n            (operation) =>\n              (isJSONPatchAdd(operation) || isJSONPatchReplace(operation)) &&\n              isObjectOrArray(operation.value)\n          )\n          .forEach((operation) => {\n            const path = parsePath(json, operation.path)\n            updatedState = expandSmart(patchedJson, updatedState, path)\n          })\n\n        return {\n          state: updatedState\n        }\n      })\n\n      if (pasteMultilineText) {\n        onPasteMultilineText(pastedText)\n      }\n    } else {\n      // no json: empty document, or the contents is invalid text\n      debug('paste text', { pastedText })\n\n      onChangeText(clipboardText, (patchedJson, patchedState) => {\n        if (patchedJson) {\n          const path: JSONPath = []\n          return {\n            state: expandSmart(patchedJson, patchedState, path)\n          }\n        }\n\n        return undefined\n      })\n    }\n  }\n\n  try {\n    doPaste(clipboardText)\n  } catch {\n    openRepairModal(clipboardText, (repairedText) => {\n      debug('repaired pasted text: ', repairedText)\n      doPaste(repairedText)\n    })\n  }\n}\n\n/**\n * When pasting text, we cannot always know how whether the text was intended as\n * a list with items that should be parsed into a JSON Array (after jsonrepair),\n * or a text with multiple lines that should be parsed into a single string.\n *\n * This function checks whether we're dealing with such a case, after which\n * we can show a message to the user asking about the intended behavior.\n */\nexport function isMultilineTextPastedAsArray(\n  clipboardText: string,\n  operators: JSONPatchOperation[],\n  parser: JSONParser,\n  maxSize = MAX_MULTILINE_PASTE_SIZE\n): boolean {\n  if (clipboardText.length > maxSize) {\n    // we don't want this feature detecting multiline text to impact performance, hence this max\n    return false\n  }\n\n  const containsNewline = /\\n/.test(clipboardText)\n  if (!containsNewline) {\n    return false\n  }\n\n  const replaceArrayOperation = operators.some(\n    (operator) => operator.op === 'replace' && Array.isArray(operator.value)\n  )\n  const multipleAddOperations = operators.filter((operator) => operator.op === 'add').length > 1\n  const pastingArray = replaceArrayOperation || multipleAddOperations\n  if (!pastingArray) {\n    return false\n  }\n\n  try {\n    parsePartialJson(clipboardText, parser.parse)\n\n    return false\n  } catch {\n    return true\n  }\n}\n\nexport interface OnRemoveAction {\n  json: unknown | undefined\n  text: string | undefined\n  selection: JSONSelection | undefined\n  keepSelection: boolean\n  readOnly: boolean\n  onChange: OnChange\n  onPatch: OnPatch\n}\n\n// TODO: write unit tests\nexport function onRemove({\n  json,\n  text,\n  selection,\n  keepSelection,\n  readOnly,\n  onChange,\n  onPatch\n}: OnRemoveAction) {\n  if (readOnly || !selection) {\n    return\n  }\n\n  // in case of a selected key or value, we change the selection to the whole\n  // entry to remove this, we do not want to clear a key or value only.\n  const removeSelection =\n    json !== undefined && (isKeySelection(selection) || isValueSelection(selection))\n      ? createMultiSelection(selection.path, selection.path)\n      : selection\n\n  if (isEmpty(getFocusPath(selection))) {\n    // root selected -> clear complete document\n    debug('remove root', { selection })\n\n    if (onChange) {\n      onChange(\n        { text: '', json: undefined },\n        json !== undefined ? { text: undefined, json } : { text: text || '', json },\n        {\n          contentErrors: undefined,\n          patchResult: undefined\n        }\n      )\n    }\n  } else {\n    // remove selection\n    if (json !== undefined) {\n      const { operations, newSelection } = createRemoveOperations(json, removeSelection)\n\n      debug('remove', { operations, selection, newSelection })\n\n      onPatch(operations, (_, patchedState) => ({\n        state: patchedState,\n        selection: keepSelection ? selection : newSelection\n      }))\n    }\n  }\n}\n\nexport interface OnDuplicateRowAction {\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onDuplicateRow({\n  json,\n  selection,\n  columns,\n  readOnly,\n  onPatch\n}: OnDuplicateRowAction) {\n  if (readOnly || json === undefined || !selection || !hasSelectionContents(selection)) {\n    return\n  }\n\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  debug('duplicate row', { rowIndex })\n\n  const rowPath = [String(rowIndex)]\n  const operations = duplicate(json, [rowPath])\n\n  onPatch(operations, (_, patchedState) => {\n    const newRowIndex = rowIndex < (json as Array<unknown>).length ? rowIndex + 1 : rowIndex\n    const newPath = fromTableCellPosition({ rowIndex: newRowIndex, columnIndex }, columns)\n    const newSelection = createValueSelection(newPath)\n\n    return {\n      state: patchedState,\n      selection: newSelection\n    }\n  })\n}\n\nexport interface OnInsertBeforeRowAction {\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onInsertBeforeRow({\n  json,\n  selection,\n  columns,\n  readOnly,\n  onPatch\n}: OnInsertBeforeRowAction) {\n  if (readOnly || json === undefined || !selection || !hasSelectionContents(selection)) {\n    return\n  }\n\n  const { rowIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  debug('insert before row', { rowIndex })\n\n  const rowPath = [String(rowIndex)]\n  const newValue = isJSONObject((json as Array<unknown>)[0]) ? {} : ''\n  const values = [{ key: '', value: newValue }]\n  const operations = insertBefore(json, rowPath, values)\n\n  onPatch(operations)\n}\n\nexport interface OnInsertAfterRowAction {\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onInsertAfterRow({\n  json,\n  selection,\n  columns,\n  readOnly,\n  onPatch\n}: OnInsertAfterRowAction) {\n  if (readOnly || json === undefined || !selection || !hasSelectionContents(selection)) {\n    return\n  }\n\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  debug('insert after row', { rowIndex })\n\n  const nextRowIndex = rowIndex + 1\n  const nextRowPath = [String(nextRowIndex)]\n  const newValue = isJSONObject((json as Array<unknown>)[0]) ? {} : ''\n  const values = [{ key: '', value: newValue }]\n\n  const operations =\n    nextRowIndex < (json as Array<unknown>).length\n      ? insertBefore(json, nextRowPath, values)\n      : append(json, [], values)\n\n  onPatch(operations, (_, patchedState) => {\n    const nextPath = fromTableCellPosition({ rowIndex: nextRowIndex, columnIndex }, columns)\n    const newSelection = createValueSelection(nextPath)\n\n    return {\n      state: patchedState,\n      selection: newSelection\n    }\n  })\n}\n\nexport interface OnRemoveRowAction {\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  columns: JSONPath[]\n  readOnly: boolean\n  onPatch: OnPatch\n}\n\n/**\n * This function assumes that the json holds the Array that we're duplicating a row for,\n * it cannot duplicate something in some nested array\n */\n// TODO: write unit tests\nexport function onRemoveRow({ json, selection, columns, readOnly, onPatch }: OnRemoveRowAction) {\n  if (readOnly || json === undefined || !selection || !hasSelectionContents(selection)) {\n    return\n  }\n\n  const { rowIndex, columnIndex } = toTableCellPosition(getFocusPath(selection), columns)\n\n  debug('remove row', { rowIndex })\n\n  const rowPath = [String(rowIndex)]\n  const operations = removeAll([rowPath])\n\n  onPatch(operations, (patchedJson, patchedState) => {\n    const newRowIndex =\n      rowIndex < (patchedJson as Array<unknown>).length\n        ? rowIndex\n        : rowIndex > 0\n          ? rowIndex - 1\n          : undefined\n\n    const newSelection =\n      newRowIndex !== undefined\n        ? createValueSelection(\n            fromTableCellPosition({ rowIndex: newRowIndex, columnIndex }, columns)\n          )\n        : undefined\n\n    debug('remove row new selection', { rowIndex, newRowIndex, newSelection })\n\n    return {\n      state: patchedState,\n      selection: newSelection\n    }\n  })\n}\n\nexport interface OnInsert {\n  insertType: InsertType\n  selectInside: boolean\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  initialValue: string | undefined\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onReplaceJson: (updatedJson: unknown, afterPatch: AfterPatchCallback) => void\n}\n\n// TODO: write unit tests\nexport function onInsert({\n  insertType,\n  selectInside,\n  initialValue,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onReplaceJson\n}: OnInsert): void {\n  if (readOnly) {\n    return\n  }\n\n  const newValue = createNewValue(json, selection, insertType)\n\n  if (json !== undefined) {\n    const data = parser.stringify(newValue) as string\n    const operations = insert(json, selection, data, parser)\n    debug('onInsert', { insertType, operations, newValue, data })\n\n    const operation = last(\n      operations.filter((operation) => operation.op === 'add' || operation.op === 'replace')\n    )\n\n    onPatch(operations, (patchedJson, patchedState, patchedSelection) => {\n      // TODO: extract determining the newSelection in a separate function\n      if (operation) {\n        const path = parsePath(patchedJson, operation.path)\n\n        if (isObjectOrArray(newValue)) {\n          return {\n            state: expandPath(patchedJson, patchedState, path, expandAll),\n            selection: selectInside ? createInsideSelection(path) : patchedSelection\n          }\n        }\n\n        if (newValue === '') {\n          // open the newly inserted value in edit mode\n          const parent = !isEmpty(path) ? getIn(patchedJson, initial(path)) : undefined\n\n          return {\n            state: expandPath(patchedJson, patchedState, path, expandNone),\n            selection: isObject(parent)\n              ? createEditKeySelection(path, initialValue)\n              : createEditValueSelection(path, initialValue)\n          }\n        }\n      }\n\n      return undefined\n    })\n\n    debug('after patch')\n  } else {\n    // document is empty or invalid (in that case it has text but no json)\n    debug('onInsert', { insertType, newValue })\n\n    const path: JSONPath = []\n    onReplaceJson(newValue, (patchedJson, patchedState) => ({\n      state: expandSmart(patchedJson, patchedState, path),\n      selection: isObjectOrArray(newValue)\n        ? createInsideSelection(path)\n        : createEditValueSelection(path)\n    }))\n  }\n}\n\nexport interface OnInsertCharacter {\n  char: string\n  selectInside: boolean\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onReplaceJson: (updatedJson: unknown, afterPatch: AfterPatchCallback) => void\n  onSelect: OnJSONSelect\n}\n\n// TODO: write unit tests\nexport async function onInsertCharacter({\n  char,\n  selectInside,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onReplaceJson,\n  onSelect\n}: OnInsertCharacter) {\n  // a regular key like a, A, _, etc. is entered.\n  // Replace selected contents with a new value having this first character as text\n  if (readOnly) {\n    return\n  }\n\n  if (isKeySelection(selection)) {\n    onSelect({ ...selection, edit: true, initialValue: char })\n    return\n  }\n\n  if (char === '{') {\n    onInsert({\n      insertType: 'object',\n      selectInside,\n      initialValue: undefined, // not relevant\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch,\n      onReplaceJson\n    })\n  } else if (char === '[') {\n    onInsert({\n      insertType: 'array',\n      selectInside,\n      initialValue: undefined, // not relevant\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch,\n      onReplaceJson\n    })\n  } else {\n    if (isValueSelection(selection) && json !== undefined) {\n      if (!isObjectOrArray(getIn(json, selection.path))) {\n        onSelect({ ...selection, edit: true, initialValue: char })\n      } else {\n        // TODO: replace the object/array with editing a text in edit mode?\n        //  (Ideally this this should not create an entry in history though,\n        //  which isn't really possible right now since we have to apply\n        //  a patch to change the object/array into a value)\n      }\n    } else {\n      debug('onInsertValueWithCharacter', { char })\n      await onInsertValueWithCharacter({\n        char,\n        json,\n        selection,\n        readOnly,\n        parser,\n        onPatch,\n        onReplaceJson\n      })\n    }\n  }\n}\n\ninterface OnInsertValueWithCharacter {\n  char: string\n  json: unknown | undefined\n  selection: JSONSelection | undefined\n  readOnly: boolean\n  parser: JSONParser\n  onPatch: OnPatch\n  onReplaceJson: (updatedJson: unknown, afterPatch: AfterPatchCallback) => void\n}\n\nasync function onInsertValueWithCharacter({\n  char,\n  json,\n  selection,\n  readOnly,\n  parser,\n  onPatch,\n  onReplaceJson\n}: OnInsertValueWithCharacter) {\n  if (readOnly) {\n    return\n  }\n\n  // first insert a new value\n  onInsert({\n    insertType: 'value',\n    selectInside: false, // not relevant, we insert a value, not an object or array\n    initialValue: char,\n    json,\n    selection,\n    readOnly,\n    parser,\n    onPatch,\n    onReplaceJson\n  })\n}\n","<script lang=\"ts\">\n  import type { JSONParser } from '$lib/types'\n  import { truncate } from '$lib/utils/stringUtils.js'\n  import { getText } from '$lib/utils/jsonUtils.js'\n  import { MAX_CHARACTERS_TEXT_PREVIEW } from '$lib/constants.js'\n\n  export let text: string | undefined\n  export let json: unknown | undefined\n  export let indentation: number | string\n  export let parser: JSONParser\n\n  $: content = json !== undefined ? { json } : { text: text || '' }\n  $: truncated = truncate(getText(content, indentation, parser), MAX_CHARACTERS_TEXT_PREVIEW)\n</script>\n\n<div class=\"jse-json-preview\">\n  {truncated}\n</div>\n\n<style src=\"./JSONPreview.scss\"></style>\n","<script lang=\"ts\">\n  import type { MenuButton } from '$lib/types'\n  import Icon from 'svelte-awesome'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  export let item: MenuButton\n  export let className: string | undefined = undefined\n  export let onRequestClose: () => void\n</script>\n\n<button\n  type=\"button\"\n  class={classnames('jse-context-menu-button', className, item.className)}\n  on:click={(event) => {\n    onRequestClose()\n    item.onClick(event)\n  }}\n  title={item.title}\n  disabled={item.disabled || false}\n>\n  {#if item.icon}\n    <Icon data={item.icon} />\n  {/if}\n  {#if item.text}\n    {item.text}\n  {/if}\n</button>\n\n<style src=\"./ContextMenuButton.scss\"></style>\n","<script lang=\"ts\">\n  import type { MenuDropDownButton } from '$lib/types'\n  import DropdownButton from '../DropdownButton.svelte'\n  import Icon from 'svelte-awesome'\n  import { classnames } from '$lib/utils/cssUtils.js'\n\n  export let item: MenuDropDownButton\n  export let className: string | undefined = undefined\n  export let onRequestClose: () => void\n\n  $: items = item.items.map((item) => ({\n    ...item,\n    onClick: (event: MouseEvent) => {\n      onRequestClose()\n      item.onClick(event)\n    }\n  }))\n</script>\n\n<DropdownButton width={item.width} {items}>\n  <button\n    class={classnames('jse-context-menu-button', className, item.main.className)}\n    type=\"button\"\n    slot=\"defaultItem\"\n    title={item.main.title}\n    on:click={(event) => {\n      onRequestClose()\n      item.main.onClick(event)\n    }}\n    disabled={item.main.disabled || false}\n  >\n    {#if item.main.icon}\n      <Icon data={item.main.icon} />\n    {/if}\n    {item.main.text}\n  </button>\n</DropdownButton>\n\n<style src=\"./ContextMenuDropDownButton.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faCaretDown } from '@fortawesome/free-solid-svg-icons'\n  import { onDestroy, onMount } from 'svelte'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import type { MenuButton } from '$lib/types.js'\n\n  export let items: MenuButton[] = []\n  export let title: string | undefined = undefined\n  export let width = '120px'\n\n  let visible = false\n\n  $: allItemsDisabled = items.every((item) => item.disabled === true)\n\n  function toggleShow() {\n    const wasVisible = visible\n\n    // trigger *after* the handleClick which changes visibility to false\n    setTimeout(() => (visible = !wasVisible))\n  }\n\n  function handleClick() {\n    visible = false\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    if (combo === 'Escape') {\n      event.preventDefault()\n      visible = false\n    }\n  }\n\n  onMount(() => {\n    document.addEventListener('click', handleClick)\n    document.addEventListener('keydown', handleKeyDown)\n  })\n\n  onDestroy(() => {\n    document.removeEventListener('click', handleClick)\n    document.removeEventListener('keydown', handleKeyDown)\n  })\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<div role=\"button\" tabindex=\"0\" class=\"jse-dropdown-button\" {title} on:click={handleClick}>\n  <slot name=\"defaultItem\" />\n\n  <button\n    type=\"button\"\n    class=\"jse-open-dropdown\"\n    data-type=\"jse-open-dropdown\"\n    class:jse-visible={visible}\n    on:click={toggleShow}\n    disabled={allItemsDisabled}\n  >\n    <Icon data={faCaretDown} />\n  </button>\n\n  <div class=\"jse-dropdown-items\" class:jse-visible={visible} style=\"width: {width};\">\n    <ul>\n      {#each items as item}\n        <li>\n          <button\n            type=\"button\"\n            on:click={(event) => item.onClick(event)}\n            title={item.title}\n            disabled={item.disabled}\n            class={item.className}\n          >\n            {#if item.icon}\n              <Icon data={item.icon} />\n            {/if}\n            {item.text}\n          </button>\n        </li>\n      {/each}\n    </ul>\n  </div>\n</div>\n\n<style src=\"./DropdownButton.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import Icon from 'svelte-awesome'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { faLightbulb } from '@fortawesome/free-regular-svg-icons'\n  import { findNearestElement } from '$lib/utils/domUtils.js'\n  import type { ContextMenuItem, MenuItem } from '$lib/types.js'\n  import {\n    isContextMenuColumn,\n    isContextMenuRow,\n    isMenuButton,\n    isMenuDropDownButton,\n    isMenuLabel,\n    isMenuSeparator\n  } from '$lib/typeguards.js'\n  import ContextMenuButton from './ContextMenuButton.svelte'\n  import ContextMenuDropDownButton from './ContextMenuDropDownButton.svelte'\n\n  export let items: ContextMenuItem[]\n  export let onRequestClose: () => void\n  export let tip: string | undefined\n\n  let refContextMenu: HTMLDivElement\n\n  onMount(() => {\n    const firstEnabledButton = Array.from(refContextMenu.querySelectorAll('button')).find(\n      (button) => !button.disabled\n    )\n\n    if (firstEnabledButton) {\n      firstEnabledButton.focus()\n    }\n  })\n\n  const directionByCombo: Record<string, 'Up' | 'Down' | 'Left' | 'Right'> = {\n    ArrowUp: 'Up',\n    ArrowDown: 'Down',\n    ArrowLeft: 'Left',\n    ArrowRight: 'Right'\n  }\n\n  function handleKeyDown(event: KeyboardEvent & { currentTarget: EventTarget & HTMLDivElement }) {\n    const combo = keyComboFromEvent(event)\n    const direction: 'Up' | 'Down' | 'Left' | 'Right' | undefined = directionByCombo[combo]\n\n    if (direction && event.target) {\n      event.preventDefault()\n\n      const buttons: HTMLButtonElement[] = Array.from(\n        refContextMenu.querySelectorAll('button:not([disabled])')\n      )\n      const nearest = findNearestElement<HTMLButtonElement>({\n        allElements: buttons,\n        currentElement: event.target as unknown as HTMLButtonElement,\n        direction,\n        hasPrio: (element: HTMLButtonElement) => {\n          return element.getAttribute('data-type') !== 'jse-open-dropdown'\n        }\n      })\n      if (nearest) {\n        nearest.focus()\n      }\n    }\n  }\n\n  function unknownMenuItem(item: MenuItem): string {\n    console.error('Unknown type of context menu item', item)\n    return '???'\n  }\n</script>\n\n<div\n  role=\"menu\"\n  tabindex=\"-1\"\n  class=\"jse-contextmenu\"\n  bind:this={refContextMenu}\n  on:keydown={handleKeyDown}\n>\n  {#each items as item}\n    {#if isMenuButton(item)}\n      <ContextMenuButton {item} {onRequestClose} />\n    {:else if isMenuDropDownButton(item)}\n      <ContextMenuDropDownButton {item} {onRequestClose} />\n    {:else if isContextMenuRow(item)}\n      <div class=\"jse-row\">\n        {#each item.items as rowItem}\n          {#if isMenuButton(rowItem)}\n            <ContextMenuButton item={rowItem} {onRequestClose} />\n          {:else if isMenuDropDownButton(rowItem)}\n            <ContextMenuDropDownButton item={rowItem} {onRequestClose} />\n          {:else if isContextMenuColumn(rowItem)}\n            <div class=\"jse-column\">\n              {#each rowItem.items as columnItem}\n                {#if isMenuButton(columnItem)}\n                  <ContextMenuButton className=\"left\" item={columnItem} {onRequestClose} />\n                {:else if isMenuDropDownButton(columnItem)}\n                  <ContextMenuDropDownButton className=\"left\" item={columnItem} {onRequestClose} />\n                {:else if isMenuSeparator(columnItem)}\n                  <div class=\"jse-separator\"></div>\n                {:else if isMenuLabel(columnItem)}\n                  <div class=\"jse-label\">\n                    {columnItem.text}\n                  </div>\n                {:else}\n                  {unknownMenuItem(columnItem)}\n                {/if}\n              {/each}\n            </div>\n          {:else if isMenuSeparator(rowItem)}\n            <div class=\"jse-separator\"></div>\n          {:else}\n            {unknownMenuItem(rowItem)}\n          {/if}\n        {/each}\n      </div>\n    {:else if isMenuSeparator(item)}\n      <div class=\"jse-separator\"></div>\n    {:else}\n      {unknownMenuItem(item)}\n    {/if}\n  {/each}\n\n  {#if tip}\n    <div class=\"jse-row\">\n      <div class=\"jse-tip\">\n        <div class=\"jse-tip-icon\">\n          <Icon data={faLightbulb} />\n        </div>\n        <div class=\"jse-tip-text\">{tip}</div>\n      </div>\n    </div>\n  {/if}\n</div>\n\n<style src=\"./ContextMenu.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer } from 'immutable-json-patch'\n  import { getValueClass } from '$lib/plugins/value/components/utils/getValueClass.js'\n  import { type JSONParser, type JSONSelection, Mode, type OnPatch } from '$lib/types.js'\n  import { isValueSelection } from '$lib/logic/selection.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let mode: Mode\n  export let parser: JSONParser\n  export let readOnly: boolean\n  export let selection: JSONSelection | undefined\n  export let onPatch: OnPatch\n\n  export let options: Array<{ value: unknown; text: string }>\n\n  let refSelect: HTMLSelectElement | undefined\n\n  let bindValue: unknown = value\n  $: bindValue = value\n\n  function applyFocus(selection: JSONSelection | undefined) {\n    if (selection) {\n      if (refSelect) {\n        refSelect.focus()\n      }\n    }\n  }\n\n  $: applyFocus(selection)\n\n  function handleSelect(event: Event) {\n    event.stopPropagation()\n\n    if (readOnly) {\n      return\n    }\n\n    onPatch([\n      {\n        op: 'replace',\n        path: compileJSONPointer(path),\n        value: bindValue\n      }\n    ])\n  }\n\n  function handleMouseDown(event: MouseEvent) {\n    // stop propagation to prevent selecting the whole line\n    event.stopPropagation()\n  }\n</script>\n\n<select\n  class={`jse-enum-value ${getValueClass(bindValue, mode, parser)}`}\n  class:jse-selected={isValueSelection(selection)}\n  bind:value={bindValue}\n  bind:this={refSelect}\n  on:change={handleSelect}\n  on:mousedown={handleMouseDown}\n>\n  {#each options as option}\n    <option value={option.value}>{option.text}</option>\n  {/each}\n</select>\n\n<style src=\"./EnumValue.scss\"></style>\n","import type { JSONPath } from 'immutable-json-patch'\nimport type { JSONSchema, JSONSchemaDefinitions, JSONSchemaEnum } from '$lib/types'\n\n/**\n * Find enum options for given path in a JSONSchema\n */\nexport function getJSONSchemaOptions(\n  schema: JSONSchema,\n  schemaDefinitions: JSONSchemaDefinitions | undefined,\n  path: JSONPath\n): JSONSchemaEnum | undefined {\n  const schemaForPath = findSchema(schema, schemaDefinitions || {}, path)\n\n  return schemaForPath ? findEnum(schemaForPath) : undefined\n}\n\n/**\n * find an enum definition in a JSON schema, as property `enum` or inside\n * one of the schemas composites (`oneOf`, `anyOf`, `allOf`)\n *\n * Source: https://github.com/josdejong/jsoneditor/blob/develop/src/js/Node.js\n */\nexport function findEnum(schema: JSONSchema): JSONSchemaEnum | undefined {\n  if (Array.isArray(schema['enum'])) {\n    return schema['enum']\n  }\n\n  const composite = schema['oneOf'] || schema['anyOf'] || schema['allOf']\n  if (Array.isArray(composite)) {\n    const match = composite.filter((entry) => entry.enum)\n    if (match.length > 0) {\n      return match[0].enum\n    }\n  }\n\n  return undefined\n}\n\n/**\n * Return the part of a JSON schema matching given path.\n *\n * Source: https://github.com/josdejong/jsoneditor/blob/develop/src/js/Node.js\n */\nexport function findSchema(\n  topLevelSchema: JSONSchema,\n  schemaDefinitions: JSONSchemaDefinitions,\n  path: JSONPath,\n  currentSchema = topLevelSchema\n): JSONSchema | undefined {\n  const nextPath = path.slice(1, path.length)\n  const nextKey = path[0]\n\n  let possibleSchemas = [currentSchema]\n  for (const subSchemas of [currentSchema.oneOf, currentSchema.anyOf, currentSchema.allOf]) {\n    if (Array.isArray(subSchemas)) {\n      possibleSchemas = possibleSchemas.concat(subSchemas)\n    }\n  }\n\n  for (const schema of possibleSchemas) {\n    currentSchema = schema\n\n    if ('$ref' in currentSchema && typeof currentSchema.$ref === 'string') {\n      const ref = currentSchema.$ref\n      if (ref in schemaDefinitions) {\n        currentSchema = schemaDefinitions[ref]\n      } else if (ref.startsWith('#/')) {\n        const refPath = ref.substring(2).split('/')\n        currentSchema = topLevelSchema\n        for (const segment of refPath) {\n          if (segment in currentSchema) {\n            currentSchema = currentSchema[segment] as JSONSchema\n          } else {\n            throw Error(`Unable to resolve reference ${ref}`)\n          }\n        }\n      } else if (ref.match(/#\\//g)?.length === 1) {\n        const [schemaUrl, relativePath] = ref.split('#/')\n        if (schemaUrl in schemaDefinitions) {\n          const referencedSchema = schemaDefinitions[schemaUrl]\n          const reference = { $ref: '#/'.concat(relativePath) }\n          const auxNextPath = []\n          auxNextPath.push(nextKey)\n          if (nextPath.length > 0) {\n            auxNextPath.push(...nextPath)\n          }\n          return findSchema(referencedSchema, schemaDefinitions, auxNextPath, reference)\n        } else {\n          throw Error(`Unable to resolve reference ${ref}`)\n        }\n      } else {\n        throw Error(`Unable to resolve reference ${ref}`)\n      }\n    }\n\n    // We have no more path segments to resolve, return the currently found schema\n    // We do this here, after resolving references, in case of the leaf schema beeing a reference\n    if (nextKey === undefined) {\n      return currentSchema\n    }\n\n    if (\n      typeof currentSchema.properties === 'object' &&\n      currentSchema.properties &&\n      nextKey in currentSchema.properties\n    ) {\n      currentSchema = (currentSchema.properties as Record<string, JSONSchema>)[nextKey]\n      return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n    }\n\n    if (typeof currentSchema.patternProperties === 'object' && currentSchema.patternProperties) {\n      for (const prop in currentSchema.patternProperties) {\n        if (nextKey.match(prop)) {\n          currentSchema = (currentSchema.patternProperties as Record<string, JSONSchema>)[prop]\n          return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n        }\n      }\n    }\n\n    if (typeof currentSchema.additionalProperties === 'object') {\n      currentSchema = currentSchema.additionalProperties as JSONSchema\n      return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n    }\n\n    if (typeof currentSchema.items === 'object' && currentSchema.items) {\n      currentSchema = currentSchema.items as JSONSchema\n      return findSchema(topLevelSchema, schemaDefinitions, nextPath, currentSchema)\n    }\n  }\n\n  return undefined\n}\n","import EnumValue from './components/EnumValue.svelte'\nimport { getJSONSchemaOptions } from '$lib/utils/jsonSchemaUtils.js'\nimport type {\n  JSONSchema,\n  JSONSchemaDefinitions,\n  RenderValueComponentDescription,\n  RenderValueProps\n} from '$lib/types'\n\n/**\n * Search the JSON schema for enums defined at given props.path. If found,\n * return an EnumValue renderer. If not found, return null. In that case you\n * have to fallback on the default valueRender function\n */\nexport function renderJSONSchemaEnum(\n  props: RenderValueProps,\n  schema: JSONSchema,\n  schemaDefinitions?: JSONSchemaDefinitions\n): RenderValueComponentDescription[] | undefined {\n  const enumValues = getJSONSchemaOptions(schema, schemaDefinitions, props.path)\n\n  if (enumValues) {\n    const options = enumValues.map((enumValue) => ({\n      value: enumValue,\n      text: enumValue\n    }))\n\n    // make sure the current value is also added as one of the options,\n    // else it would look as if the first option is the current value\n    const optionsWithValue = enumValues.includes(props.value)\n      ? options\n      : [{ value: props.value, text: props.value }].concat(options)\n\n    return [\n      {\n        component: EnumValue,\n        props: {\n          ...props,\n          options: optionsWithValue\n        }\n      }\n    ]\n  }\n\n  return undefined\n}\n","import type Ajv from 'ajv'\nimport type { Options, Schema, ErrorObject, ValidateFunction, AsyncSchema } from 'ajv'\nimport AjvDist from 'ajv'\nimport { parsePath } from 'immutable-json-patch'\nimport type { JSONSchema, JSONSchemaDefinitions, ValidationError, Validator } from '$lib/types'\nimport { ValidationSeverity } from '$lib/types.js'\n\nexport interface AjvValidatorOptions {\n  /**\n   * The JSON schema to validate (required).\n   */\n  schema: JSONSchema\n\n  /**\n   * An object containing JSON Schema definitions which can be referenced using $ref.\n   */\n  schemaDefinitions?: JSONSchemaDefinitions\n\n  /**\n   * Optional extra options for Ajv.\n   */\n  ajvOptions?: Options\n\n  /**\n   * An optional callback function allowing to apply additional configuration on the provided Ajv instance, or return\n   * your own Ajv instance and ignore the provided one.\n   */\n  onCreateAjv?: (ajv: Ajv) => Ajv | void\n\n  /**\n   * The severity of the validation error.\n   *\n   * @default ValidationSeverity.warning\n   */\n  errorSeverity?: ValidationSeverity\n}\n\n/**\n * Create a JSON Schema validator powered by Ajv.\n */\nexport function createAjvValidator(options: AjvValidatorOptions): Validator {\n  const ajv = createAjvInstance(options)\n\n  const validateAjv = ajv.compile(options.schema as Schema)\n\n  return createValidateFunction(validateAjv, options)\n}\n\n/**\n * Create a JSON Schema validator powered by Ajv.\n *\n * Same as `createAjvValidator`, but allows for remote schema resolution through `ajvOptions`'s `loadSchema(uri)`\n * function.\n *\n * Note that `ajvOptions.loadSchema` *must* be set, or Ajv throws an error on initialization!\n *\n * ### Example\n *\n *     const validate = await createAjvValidatorAsync({\n *       schema: {\n *         $ref: '/schema.json'\n *       },\n *       ajvOptions: {\n *         loadSchema(uri) {\n *           return fetch(uri).then((res) => res.json())\n *         }\n *       }\n *     })\n */\nexport async function createAjvValidatorAsync(options: AjvValidatorOptions): Promise<Validator> {\n  const ajv = createAjvInstance(options)\n\n  const validateAjv = await ajv.compileAsync(options.schema as AsyncSchema)\n\n  return createValidateFunction(validateAjv, options)\n}\n\nfunction createAjvInstance(options: AjvValidatorOptions): Ajv {\n  const { schemaDefinitions, ajvOptions } = options\n\n  let ajv = new AjvDist({\n    allErrors: true,\n    verbose: true,\n    $data: true,\n    ...ajvOptions\n  })\n\n  if (schemaDefinitions) {\n    Object.keys(schemaDefinitions).forEach((ref) => {\n      ajv.addSchema(schemaDefinitions[ref] as Schema, ref)\n    })\n  }\n\n  ajv = options.onCreateAjv?.(ajv) ?? ajv\n\n  // validate whether ajv is configured correctly (this is needed to enhance error messages)\n  if (ajv.opts.verbose === false) {\n    throw new Error('Ajv must be configured with the option verbose=true')\n  }\n\n  return ajv\n}\n\nfunction createValidateFunction(\n  ajvValidator: ValidateFunction<unknown>,\n  options: AjvValidatorOptions\n): Validator {\n  if (ajvValidator.errors) {\n    throw ajvValidator.errors[0]\n  }\n\n  return function validate(json: unknown): ValidationError[] {\n    ajvValidator(json)\n    const ajvErrors = ajvValidator.errors ?? []\n\n    return ajvErrors.map(improveAjvError).map((error) => normalizeAjvError(json, error, options))\n  }\n}\n\nfunction normalizeAjvError(\n  json: unknown,\n  ajvError: ErrorObject,\n  options: AjvValidatorOptions\n): ValidationError {\n  return {\n    path: parsePath(json, ajvError.instancePath),\n    message: ajvError.message ?? 'Unknown error',\n    severity: options.errorSeverity ?? ValidationSeverity.warning\n  }\n}\n\n/**\n * Improve the error message of a JSON schema error,\n * for example list the available values of an enum.\n */\nfunction improveAjvError(ajvError: ErrorObject): ErrorObject {\n  let message: string | undefined = undefined\n\n  if (ajvError.keyword === 'enum' && Array.isArray(ajvError.schema)) {\n    let enums = ajvError.schema\n    if (enums) {\n      enums = enums.map((value) => JSON.stringify(value))\n\n      if (enums.length > 5) {\n        const more = ['(' + (enums.length - 5) + ' more...)']\n        enums = enums.slice(0, 5)\n        enums.push(more)\n      }\n      message = 'should be equal to one of: ' + enums.join(', ')\n    }\n  }\n\n  if (ajvError.keyword === 'additionalProperties') {\n    message = 'should NOT have additional property: ' + ajvError.params.additionalProperty\n  }\n\n  return message ? { ...ajvError, message } : ajvError\n}\n","import jmespath from 'jmespath'\nimport type { JSONPath } from 'immutable-json-patch'\nimport { getIn } from 'immutable-json-patch'\nimport { parseString } from '$lib/utils/stringUtils.js'\nimport type { JSONParser, QueryLanguage, QueryLanguageOptions } from '$lib/types'\nimport { isEqualParser } from '$lib/utils/jsonUtils.js'\n\nconst description = `\n<p>\n  Enter a <a href=\"https://jmespath.org\" target=\"_blank\" rel=\"noopener noreferrer\">JMESPath</a> query \n  to filter, sort, or transform the JSON data.\n To learn JMESPath, go to <a href=\"https://jmespath.org/tutorial.html\" target=\"_blank\" rel=\"noopener noreferrer\">the interactive tutorial</a>.\n</p>\n`\n\nexport const jmespathQueryLanguage: QueryLanguage = {\n  id: 'jmespath',\n  name: 'JMESPath',\n  description: description,\n  createQuery,\n  executeQuery\n}\n\n/**\n * Build a JMESPath query based on query options coming from the wizard\n * @param json   The JSON document for which to build the query.\n *                      Used for context information like determining\n *                      the type of values (string or number)\n * @param queryOptions\n * @return Returns a query (as string)\n */\nfunction createQuery(json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { sort, filter, projection } = queryOptions\n  let query = ''\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    const examplePath = ['0'].concat(filter.path)\n    const exampleValue = getIn(json, examplePath)\n    const filterValue = parseString(filter.value)\n    const filterValueStr =\n      typeof exampleValue === 'string' && filterValue !== null && filterValue !== undefined\n        ? `\"${filter.value}\"`\n        : filterValue\n\n    query +=\n      '[? ' +\n      stringifyPathForJmespath(filter.path) +\n      ' ' +\n      filter.relation +\n      ' ' +\n      '`' +\n      filterValueStr +\n      '`' +\n      ']'\n  } else {\n    query += Array.isArray(json) ? '[*]' : '@'\n  }\n\n  if (sort && sort.path && sort.direction) {\n    if (sort.direction === 'desc') {\n      query += ' | reverse(sort_by(@, &' + stringifyPathForJmespath(sort.path) + '))'\n    } else {\n      query += ' | sort_by(@, &' + stringifyPathForJmespath(sort.path) + ')'\n    }\n  }\n\n  if (projection && projection.paths) {\n    if (query[query.length - 1] !== ']') {\n      query += ' | [*]'\n    }\n\n    if (projection.paths.length === 1) {\n      const path = projection.paths[0]\n\n      query +=\n        path.length === 0\n          ? '' // edge case, selecting projection of the item root\n          : '.' + stringifyPathForJmespath(path)\n    } else if (projection.paths.length > 1) {\n      query +=\n        '.{' +\n        projection.paths\n          .map((path) => {\n            const name = path[path.length - 1]\n            return stringifyProp(name) + ': ' + stringifyPathForJmespath(path)\n          })\n          .join(', ') +\n        '}'\n    } else {\n      // values.length === 0\n      // ignore\n    }\n  }\n\n  return query\n}\n\n/**\n * Execute a JMESPath query, returns the transformed JSON\n */\nfunction executeQuery(json: unknown, query: string, parser: JSONParser): unknown {\n  // JMESPath cannot handle non-native JSON data types like LosslessNumber\n\n  function stringifyAndParse(json: unknown) {\n    const text = parser.stringify(json)\n    return text !== undefined ? JSON.parse(text) : undefined\n  }\n\n  const preprocessedJson = isEqualParser(parser, JSON) ? json : stringifyAndParse(json)\n\n  return jmespath.search(preprocessedJson, query)\n}\n\n// TODO: unit test stringifyPathForJmespath\n// TODO: Isn't there a helper function exposed by the JMESPath library?\nexport function stringifyPathForJmespath(path: JSONPath): string {\n  if (path.length === 0) {\n    return '@'\n  }\n\n  const str = path\n    .map((prop) => {\n      if (typeof prop === 'number') {\n        return '[' + prop + ']'\n      } else {\n        return '.' + stringifyProp(String(prop))\n      }\n    })\n    .join('')\n\n  return str[0] === '.'\n    ? str.slice(1) // remove first dot\n    : str\n}\n\nfunction stringifyProp(prop: string): string {\n  return prop.match(/^[A-Za-z\\d_$]+$/) ? prop : JSON.stringify(prop)\n}\n","import { JSONPath as JSONPathPlus } from 'jsonpath-plus'\nimport { parseString } from '$lib/utils/stringUtils'\nimport type { QueryLanguage, QueryLanguageOptions } from '$lib/types'\nimport type { JSONPath } from 'immutable-json-patch'\n\nconst description = `\n<p>\n  Enter a <a href=\"https://github.com/JSONPath-Plus/JSONPath\" target=\"_blank\" \n  rel=\"noopener noreferrer\"><code>JSONPath</code></a> expression to filter, sort, or transform the data.\n</p>`\n\nexport const jsonpathQueryLanguage: QueryLanguage = {\n  id: 'jsonpath',\n  name: 'JSONPath',\n  description,\n  createQuery,\n  executeQuery\n}\n\nfunction createQuery(_json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { filter, sort, projection } = queryOptions\n  let expression = '$'\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    const filterValue = parseString(filter.value)\n    const filterValueStr = JSON.stringify(filterValue)\n\n    expression += `[?(@${pathToString(filter.path)} ${filter.relation} ${filterValueStr})]`\n  }\n\n  if (sort && sort.path && sort.direction) {\n    throw new Error('Sorting is not supported by JSONPath. Please clear the sorting fields')\n  }\n\n  if (projection && projection.paths) {\n    if (projection.paths.length > 1) {\n      throw new Error(\n        'Picking multiple fields is not supported by JSONPath. Please select only one field'\n      )\n    }\n\n    if (!expression.endsWith(']')) {\n      expression += '[*]'\n    }\n    expression += `${pathToString(projection.paths[0])}`.replace(/^\\.\\.\\./, '..')\n  }\n\n  return expression\n}\n\nfunction executeQuery(json: unknown, path: string): unknown {\n  const output = JSONPathPlus({ json: json as JSON, path })\n  return output !== undefined ? output : null\n}\n\nfunction pathToString(path: JSONPath): JSONPath | string {\n  const lettersOnlyRegex = /^[A-z]+$/\n\n  return path\n    .map((prop) => {\n      return lettersOnlyRegex.test(prop) ? `.${prop}` : JSON.stringify([prop])\n    })\n    .join('')\n}\n","import * as _ from 'lodash-es'\nimport { last } from 'lodash-es'\nimport { createLodashPropertySelector, createPropertySelector } from '$lib/utils/pathUtils.js'\nimport { parseString } from '$lib/utils/stringUtils.js'\nimport type { QueryLanguage, QueryLanguageOptions } from '$lib/types.js'\nimport { isInteger } from '$lib/utils/typeUtils.js'\n\nconst description = `\n<p>\n  Enter a JavaScript function to filter, sort, or transform the data.\n  You can use <a href=\"https://lodash.com\" target=\"_blank\" rel=\"noopener noreferrer\">Lodash</a>\n  functions like <code>_.map</code>, <code>_.filter</code>,\n  <code>_.orderBy</code>, <code>_.sortBy</code>, <code>_.groupBy</code>,\n  <code>_.pick</code>, <code>_.uniq</code>, <code>_.get</code>, etcetera.\n</p>\n`\n\nexport const lodashQueryLanguage: QueryLanguage = {\n  id: 'lodash',\n  name: 'Lodash',\n  description,\n  createQuery,\n  executeQuery\n}\n\nfunction createQuery(json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { filter, sort, projection } = queryOptions\n  const queryParts = ['  return _.chain(data)\\n']\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    // Note that the comparisons embrace type coercion,\n    // so a filter value like '5' (text) will match numbers like 5 too.\n    const actualValueGetter = `item => item${createPropertySelector(filter.path)}`\n\n    const filterValue = parseString(filter.value)\n    const filterValueStr =\n      typeof filterValue === 'string'\n        ? `'${filter.value}'`\n        : isInteger(filter.value) && !Number.isSafeInteger(filterValue)\n          ? `${filter.value}n` // bigint\n          : filter.value\n\n    queryParts.push(`    .filter(${actualValueGetter} ${filter.relation} ${filterValueStr})\\n`)\n  }\n\n  if (sort && sort.path && sort.direction) {\n    queryParts.push(\n      `    .orderBy([${createLodashPropertySelector(sort.path)}], ['${sort.direction}'])\\n`\n    )\n  }\n\n  if (projection && projection.paths) {\n    // It is possible to make a util function \"pickFlat\"\n    // and use that when building the query to make it more readable.\n    if (projection.paths.length > 1) {\n      // Note that we do not use _.pick() here because this function doesn't flatten the results\n      const paths = projection.paths.map((path) => {\n        const name = last(path) || 'item' // 'item' in case of having selected the item root\n        return `      ${JSON.stringify(name)}: item${createPropertySelector(path)}`\n      })\n      queryParts.push(`    .map(item => ({\\n${paths.join(',\\n')}\\n    }))\\n`)\n    } else {\n      const path = projection.paths[0]\n      queryParts.push(`    .map(item => item${createPropertySelector(path)})\\n`)\n    }\n  }\n\n  queryParts.push('    .value()\\n')\n\n  return `function query (data) {\\n${queryParts.join('')}}`\n}\n\nfunction executeQuery(json: unknown, query: string): unknown {\n  validate(query)\n\n  // TODO: only import the most relevant subset of lodash instead of the full library?\n  const queryFn = new Function(\n    '_',\n    '\"use strict\";\\n' +\n      '\\n' +\n      query +\n      '\\n' +\n      '\\n' +\n      'if (typeof query !== \"function\") {\\n' +\n      '  throw new Error(\"Cannot execute query: expecting a function named \\'query\\' but is undefined\")\\n' +\n      '}\\n' +\n      '\\n' +\n      'return query;\\n'\n  )(_)\n\n  const output = queryFn(json)\n  return output !== undefined ? output : null\n}\n\nfunction validate(query: string) {\n  // It is very common to forget to end a lodash chain with .value()\n  // This lets the JSON Editor crash though.\n  // Therefore, we do a simple validation (not a guarantee)\n  const chainCount = query.match(/_\\.chain\\(/g)?.length\n  const valueCount = query.match(/\\.value\\(\\)/g)?.length\n\n  if (chainCount !== valueCount) {\n    throw new Error('Cannot execute query: Lodash _.chain(...) must end with .value()')\n  }\n}\n","import { createPropertySelector } from '$lib/utils/pathUtils.js'\nimport { parseString } from '$lib/utils/stringUtils.js'\nimport type { QueryLanguage, QueryLanguageOptions } from '$lib/types.js'\nimport { isInteger } from '$lib/utils/typeUtils.js'\n\nconst description = `\n<p>\n  Enter a JavaScript function to filter, sort, or transform the data.\n</p>\n`\n\nexport const javascriptQueryLanguage: QueryLanguage = {\n  id: 'javascript',\n  name: 'JavaScript',\n  description,\n  createQuery,\n  executeQuery\n}\n\nfunction createQuery(json: unknown, queryOptions: QueryLanguageOptions): string {\n  const { filter, sort, projection } = queryOptions\n  const queryParts = ['  return data\\n']\n\n  if (filter && filter.path && filter.relation && filter.value) {\n    // Note that the comparisons embrace type coercion,\n    // so a filter value like '5' (text) will match numbers like 5 too.\n    const actualValueGetter = `item => item${createPropertySelector(filter.path)}`\n\n    const filterValue = parseString(filter.value)\n    const filterValueStr =\n      typeof filterValue === 'string'\n        ? `'${filter.value}'`\n        : isInteger(filter.value) && !Number.isSafeInteger(filterValue)\n          ? `${filter.value}n` // bigint\n          : filter.value\n\n    queryParts.push(`    .filter(${actualValueGetter} ${filter.relation} ${filterValueStr})\\n`)\n  }\n\n  if (sort && sort.path && sort.direction) {\n    if (sort.direction === 'desc') {\n      queryParts.push(\n        `    .slice()\\n` +\n          `    .sort((a, b) => {\\n` +\n          `      // sort descending\\n` +\n          `      const valueA = a${createPropertySelector(sort.path)}\\n` +\n          `      const valueB = b${createPropertySelector(sort.path)}\\n` +\n          `      return valueA > valueB ? -1 : valueA < valueB ? 1 : 0\\n` +\n          `    })\\n`\n      )\n    } else {\n      // sort direction 'asc'\n      queryParts.push(\n        `    .slice()\\n` +\n          `    .sort((a, b) => {\\n` +\n          `      // sort ascending\\n` +\n          `      const valueA = a${createPropertySelector(sort.path)}\\n` +\n          `      const valueB = b${createPropertySelector(sort.path)}\\n` +\n          `      return valueA > valueB ? 1 : valueA < valueB ? -1 : 0\\n` +\n          `    })\\n`\n      )\n    }\n  }\n\n  if (projection && projection.paths) {\n    // It is possible to make a util function \"pickFlat\"\n    // and use that when building the query to make it more readable.\n    if (projection.paths.length > 1) {\n      const paths = projection.paths.map((path) => {\n        const name = path[path.length - 1] || 'item' // 'item' in case of having selected the item root\n        const item = `item${createPropertySelector(path)}`\n        return `      ${JSON.stringify(name)}: ${item}`\n      })\n\n      queryParts.push(`    .map(item => ({\\n${paths.join(',\\n')}})\\n    )\\n`)\n    } else {\n      const item = `item${createPropertySelector(projection.paths[0])}`\n\n      queryParts.push(`    .map(item => ${item})\\n`)\n    }\n  }\n\n  return `function query (data) {\\n${queryParts.join('')}}`\n}\n\nfunction executeQuery(json: unknown, query: string): unknown {\n  // TODO: only import the most relevant subset of lodash instead of the full library?\n  const queryFn = new Function(\n    '\"use strict\";\\n' +\n      '\\n' +\n      query +\n      '\\n' +\n      '\\n' +\n      'if (typeof query !== \"function\") {\\n' +\n      '  throw new Error(\"Cannot execute query: expecting a function named \\'query\\' but is undefined\")\\n' +\n      '}\\n' +\n      '\\n' +\n      'return query;\\n'\n  )()\n\n  const output = queryFn(json)\n  return output !== undefined ? output : null\n}\n","// source: https://github.com/sveltejs/svelte/issues/7583\n\nlet observer: ResizeObserver\nlet callbacks: WeakMap<Element, (element: Element) => void>\n\n/**\n * Example usage:\n *\n *   <script lang=\"ts\">\n *      let clientWidth = 0\n *   </script>\n *\n *   <div use:resizeObserver={element => clientWidth = element.clientWidth}>\n *      My width is: {clientWidth}\n *   </div>\n */\nexport function resizeObserver(element: Element, onResize: (element: Element) => void) {\n  if (!observer) {\n    callbacks = new WeakMap()\n    observer = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        const onResize = callbacks.get(entry.target)\n        if (onResize) {\n          onResize(entry.target)\n        }\n      }\n    })\n  }\n\n  callbacks.set(element, onResize)\n  observer.observe(element)\n\n  return {\n    destroy: () => {\n      callbacks.delete(element)\n      observer.unobserve(element)\n    }\n  }\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { createAutoScrollHandler } from '../../controls/createAutoScrollHandler.js'\n  import { faCheck, faCode, faWrench } from '@fortawesome/free-solid-svg-icons'\n  import { createDebug } from '$lib/utils/debug.js'\n  import {\n    compileJSONPointer,\n    existsIn,\n    getIn,\n    immutableJSONPatch,\n    type JSONPatchDocument,\n    type JSONPath\n  } from 'immutable-json-patch'\n  import { jsonrepair } from 'jsonrepair'\n  import { initial, isEmpty, isEqual, noop, uniqueId } from 'lodash-es'\n  import { flushSync, getContext, onDestroy, onMount } from 'svelte'\n  import { createJump } from '$lib/assets/jump.js/src/jump.js'\n  import {\n    CONTEXT_MENU_HEIGHT,\n    CONTEXT_MENU_WIDTH,\n    SCROLL_DURATION,\n    SEARCH_BOX_HEIGHT\n  } from '$lib/constants.js'\n  import {\n    collapsePath,\n    createDocumentState,\n    documentStatePatch,\n    expandAll,\n    expandMinimal,\n    expandNone,\n    expandPath,\n    expandSection,\n    expandSelf,\n    expandSmart,\n    expandSmartIfCollapsed,\n    getEnforceString,\n    setInDocumentState,\n    syncDocumentState\n  } from '$lib/logic/documentState.js'\n  import { duplicate, extract, revertJSONPatchWithMoveOperations } from '$lib/logic/operations.js'\n  import {\n    canConvert,\n    createAfterSelection,\n    createEditKeySelection,\n    createEditValueSelection,\n    createInsideSelection,\n    createSelectionFromOperations,\n    createValueSelection,\n    findRootPath,\n    getAnchorPath,\n    getEndPath,\n    getFocusPath,\n    getInitialSelection,\n    getSelectionDown,\n    getSelectionLeft,\n    getSelectionNextInside,\n    getSelectionPaths,\n    getSelectionRight,\n    getSelectionUp,\n    hasSelectionContents,\n    isAfterSelection,\n    isEditingSelection,\n    isInsideSelection,\n    isJSONSelection,\n    isKeySelection,\n    isMultiSelection,\n    isMultiSelectionWithOneItem,\n    isSelectionInsidePath,\n    isValueSelection,\n    removeEditModeFromSelection,\n    selectAll\n  } from '$lib/logic/selection.js'\n  import { toRecursiveValidationErrors, validateJSON } from '$lib/logic/validation.js'\n  import {\n    activeElementIsChildOf,\n    createNormalizationFunctions,\n    encodeDataPath,\n    findParentWithNodeName,\n    getWindow,\n    isChildOf,\n    isChildOfNodeName\n  } from '$lib/utils/domUtils.js'\n  import {\n    convertValue,\n    isJSONContent,\n    isTextContent,\n    normalizeJsonParseError,\n    parseAndRepair,\n    parsePartialJson,\n    repairPartialJson\n  } from '$lib/utils/jsonUtils.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { isObjectOrArray, isUrl, stringConvert } from '$lib/utils/typeUtils.js'\n  import { createFocusTracker } from '../../controls/createFocusTracker.js'\n  import Message from '../../controls/Message.svelte'\n  import ValidationErrorsOverview from '../../controls/ValidationErrorsOverview.svelte'\n  import CopyPasteModal from '../../modals/CopyPasteModal.svelte'\n  import JSONRepairModal from '../../modals/JSONRepairModal.svelte'\n  import JSONNode from './JSONNode.svelte'\n  import TreeMenu from './menu/TreeMenu.svelte'\n  import Welcome from './Welcome.svelte'\n  import NavigationBar from '../../controls/navigationBar/NavigationBar.svelte'\n  import SearchBox from '../../controls/SearchBox.svelte'\n  import type {\n    AbsolutePopupContext,\n    AbsolutePopupOptions,\n    AfterPatchCallback,\n    Content,\n    ContentErrors,\n    ContextMenuItem,\n    ConvertType,\n    DocumentState,\n    History,\n    HistoryItem,\n    InsertType,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONPathParser,\n    JSONRepairModalProps,\n    JSONSelection,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnClassName,\n    OnError,\n    OnExpand,\n    OnFocus,\n    OnJSONEditorModal,\n    OnRedo,\n    OnRenderContextMenuInternal,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    OnUndo,\n    ParseError,\n    PastedJson,\n    ScrollToOptions,\n    SearchResultDetails,\n    SearchResults,\n    Section,\n    TransformModalOptions,\n    TreeModeContext,\n    ValidationError,\n    ValidationErrors,\n    Validator,\n    ValueNormalization\n  } from '$lib/types'\n  import { Mode, ValidationSeverity } from '$lib/types.js'\n  import memoizeOne from 'memoize-one'\n  import { measure } from '$lib/utils/timeUtils.js'\n  import {\n    onCopy,\n    onCut,\n    onInsert,\n    onInsertCharacter,\n    onPaste,\n    onRemove\n  } from '$lib/logic/actions.js'\n  import JSONPreview from '../../controls/JSONPreview.svelte'\n  import ContextMenu from '../../controls/contextmenu/ContextMenu.svelte'\n  import createTreeContextMenuItems from './contextmenu/createTreeContextMenuItems'\n  import { toRecursiveSearchResults as toRecursiveSearchResults } from 'svelte-jsoneditor/logic/search.js'\n  import { isTreeHistoryItem } from 'svelte-jsoneditor'\n\n  const debug = createDebug('jsoneditor:TreeMode')\n\n  const isSSR = typeof window === 'undefined'\n  debug('isSSR:', isSSR)\n\n  const sortModalId = uniqueId()\n  const transformModalId = uniqueId()\n\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n\n  let refContents: HTMLDivElement | undefined\n  let refHiddenInput: HTMLInputElement\n  let refJsonEditor: HTMLDivElement\n  let hasFocus = false\n  const jump = createJump()\n\n  export let readOnly: boolean\n  export let externalContent: Content\n  export let externalSelection: JSONEditorSelection | undefined\n  export let history: History<HistoryItem>\n  export let truncateTextSize: number\n  export let mainMenuBar: boolean\n  export let navigationBar: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validator: Validator | undefined\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n  export let indentation: number | string\n  export let onError: OnError\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onUndo: OnUndo\n  export let onRedo: OnRedo\n  export let onRenderValue: OnRenderValue\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onRenderContextMenu: OnRenderContextMenuInternal\n  export let onClassName: OnClassName | undefined\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n  export let onJSONEditorModal: OnJSONEditorModal\n\n  // modalOpen is true when one of the modals is open.\n  // This is used to track whether the editor still has focus\n  let modalOpen = false\n  let copyPasteModalOpen = false\n  let jsonRepairModalProps: JSONRepairModalProps | undefined = undefined\n\n  createFocusTracker({\n    onMount,\n    onDestroy,\n    getWindow: () => getWindow(refJsonEditor),\n    hasFocus: () => (modalOpen && document.hasFocus()) || activeElementIsChildOf(refJsonEditor),\n    onFocus: () => {\n      hasFocus = true\n      if (onFocus) {\n        onFocus()\n      }\n    },\n    onBlur: () => {\n      hasFocus = false\n      if (onBlur) {\n        onBlur()\n      }\n    }\n  })\n\n  let json: unknown | undefined\n  let text: string | undefined\n  let parseError: ParseError | undefined = undefined\n\n  let documentStateInitialized = false\n  let documentState: DocumentState | undefined = createDocumentState({ json })\n  let selection: JSONSelection | undefined = isJSONSelection(externalSelection)\n    ? externalSelection\n    : undefined\n\n  onMount(() => {\n    if (selection) {\n      const path = getFocusPath(selection)\n      documentState = expandPath(json, documentState, path, expandNone)\n      setTimeout(() => scrollIntoView(path))\n    }\n  })\n\n  function handleSelect(updatedSelection: JSONSelection | undefined) {\n    selection = updatedSelection\n  }\n\n  function emitOnSelect(updatedSelection: JSONSelection | undefined) {\n    if (!isEqual(updatedSelection, externalSelection)) {\n      debug('onSelect', updatedSelection)\n      onSelect(updatedSelection)\n    }\n  }\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: emitOnSelect(selection)\n\n  let normalization: ValueNormalization\n  $: normalization = createNormalizationFunctions({\n    escapeControlCharacters,\n    escapeUnicodeCharacters\n  })\n\n  let pastedJson: PastedJson | undefined\n  let pastedMultilineText: string | undefined\n\n  let searchResultDetails: SearchResultDetails | undefined\n  let searchResults: SearchResults | undefined\n  let showSearch = false\n  let showReplace = false\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: applySearchBoxSpacing(showSearch)\n\n  function applySearchBoxSpacing(showSearch: boolean) {\n    if (!refContents) {\n      return\n    }\n\n    if (showSearch && refContents.scrollTop === 0) {\n      refContents.style.overflowAnchor = 'none'\n      refContents.scrollTop += SEARCH_BOX_HEIGHT\n      setTimeout(() => {\n        if (refContents) {\n          refContents.style.overflowAnchor = ''\n        }\n      })\n    }\n  }\n\n  function handleSearch(result: SearchResultDetails | undefined) {\n    searchResultDetails = result\n    searchResults = searchResultDetails\n      ? toRecursiveSearchResults(json, searchResultDetails.items)\n      : undefined\n  }\n\n  async function handleFocusSearch(path: JSONPath, resultIndex: number) {\n    documentState = expandPath(json, documentState, path, expandNone)\n\n    const element = findSearchResult(resultIndex)\n\n    await scrollTo(path, { element })\n  }\n\n  function handleCloseSearch() {\n    showSearch = false\n    showReplace = false\n    focus()\n  }\n\n  function handleSelectValidationError(error: ValidationError) {\n    debug('select validation error', error)\n\n    selection = createValueSelection(error.path)\n    scrollTo(error.path)\n  }\n\n  export function expand(path: JSONPath, callback: OnExpand = expandSelf) {\n    debug('expand')\n\n    documentState = expandPath(json, documentState, path, callback)\n  }\n\n  export function collapse(path: JSONPath, recursive: boolean) {\n    documentState = collapsePath(json, documentState, path, recursive)\n\n    if (selection) {\n      // check whether the selection is still visible and not collapsed\n      if (isSelectionInsidePath(selection, path)) {\n        // remove selection when not visible anymore\n        selection = undefined\n      }\n    }\n  }\n\n  // two-way binding of externalContent and internal json and text (\n  // when receiving an updated prop, we have to update state for example\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: applyExternalContent(externalContent)\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: applyExternalSelection(externalSelection)\n\n  let textIsRepaired = false\n\n  let validationErrorList: ValidationError[] = []\n  let validationErrors: ValidationErrors | undefined\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: updateValidationErrors(json, validator, parser, validationParser)\n\n  // because onChange returns the validation errors and there is also a separate listener,\n  // we would execute validation twice. Memoizing the last result solves this.\n  const memoizedValidate = memoizeOne(validateJSON)\n\n  function updateValidationErrors(\n    json: unknown,\n    validator: Validator | undefined,\n    parser: JSONParser,\n    validationParser: JSONParser\n  ) {\n    measure(\n      () => {\n        let newValidationErrorList: ValidationError[]\n        try {\n          newValidationErrorList = memoizedValidate(json, validator, parser, validationParser)\n        } catch (err) {\n          newValidationErrorList = [\n            {\n              path: [],\n              message: 'Failed to validate: ' + (err as Error).message,\n              severity: ValidationSeverity.warning\n            }\n          ]\n        }\n\n        if (!isEqual(newValidationErrorList, validationErrorList)) {\n          debug('validationErrors changed:', newValidationErrorList)\n          validationErrorList = newValidationErrorList\n          validationErrors = toRecursiveValidationErrors(json, validationErrorList)\n        }\n      },\n      (duration) => debug(`validationErrors updated in ${duration} ms`)\n    )\n  }\n\n  export function validate(): ContentErrors | undefined {\n    debug('validate')\n\n    if (parseError) {\n      return {\n        parseError,\n        isRepairable: false // not applicable, if repairable, we will not have a parseError\n      }\n    }\n\n    // make sure the validation results are up-to-date\n    // normally, they are only updated on the next tick after the json is changed\n    updateValidationErrors(json, validator, parser, validationParser)\n    return !isEmpty(validationErrorList) ? { validationErrors: validationErrorList } : undefined\n  }\n\n  export function getJson() {\n    return json\n  }\n\n  function getDocumentState(): DocumentState | undefined {\n    return documentState\n  }\n\n  function getSelection(): JSONSelection | undefined {\n    return selection\n  }\n\n  function applyExternalContent(updatedContent: Content) {\n    debug('applyExternalContent', { updatedContent })\n\n    if (isJSONContent(updatedContent)) {\n      applyExternalJson(updatedContent.json)\n    } else if (isTextContent(updatedContent)) {\n      applyExternalText(updatedContent.text)\n    }\n  }\n\n  function applyExternalJson(updatedJson: unknown | undefined) {\n    if (updatedJson === undefined) {\n      return\n    }\n\n    // TODO: this is inefficient. Make an optional flag promising that the updates are immutable so we don't have to do a deep equality check? First do some profiling!\n    const isChanged = !isEqual(json, updatedJson)\n\n    debug('update external json', { isChanged, currentlyText: json === undefined })\n\n    if (!isChanged) {\n      // no actual change, don't do anything\n      return\n    }\n\n    const previousState = { documentState, selection, json, text, textIsRepaired }\n\n    json = updatedJson\n    documentState = syncDocumentState(updatedJson, documentState)\n    expandWhenNotInitialized(json)\n    text = undefined\n    textIsRepaired = false\n    parseError = undefined\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem(previousState)\n  }\n\n  function applyExternalText(updatedText: string | undefined) {\n    if (updatedText === undefined || isJSONContent(externalContent)) {\n      return\n    }\n\n    const isChanged = updatedText !== text\n\n    debug('update external text', { isChanged })\n\n    if (!isChanged) {\n      // no actual change, don't do anything\n      return\n    }\n\n    const previousState = { documentState, selection, json, text, textIsRepaired }\n\n    try {\n      json = parseMemoizeOne(updatedText)\n      documentState = syncDocumentState(json, documentState)\n      expandWhenNotInitialized(json)\n      text = updatedText\n      textIsRepaired = false\n      parseError = undefined\n    } catch (err) {\n      try {\n        json = parseMemoizeOne(jsonrepair(updatedText))\n        documentState = syncDocumentState(json, documentState)\n        expandWhenNotInitialized(json)\n        text = updatedText\n        textIsRepaired = true\n        parseError = undefined\n        clearSelectionWhenNotExisting(json)\n      } catch {\n        // no valid JSON, will show empty document or invalid json\n        json = undefined\n        documentState = undefined\n        text = externalContent['text']\n        textIsRepaired = false\n        parseError =\n          text !== undefined && text !== ''\n            ? normalizeJsonParseError(text, (err as Error).message || String(err))\n            : undefined\n      }\n    }\n\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem(previousState)\n  }\n\n  function applyExternalSelection(externalSelection: JSONEditorSelection | undefined) {\n    if (isEqual(selection, externalSelection)) {\n      return\n    }\n\n    debug('applyExternalSelection', { selection, externalSelection })\n\n    if (isJSONSelection(externalSelection)) {\n      selection = externalSelection\n    }\n  }\n\n  function expandWhenNotInitialized(json: unknown) {\n    if (!documentStateInitialized) {\n      documentStateInitialized = true\n      documentState = expandSmart(json, documentState, [])\n    }\n  }\n\n  function clearSelectionWhenNotExisting(json: unknown) {\n    if (!selection) {\n      return\n    }\n\n    if (existsIn(json, getAnchorPath(selection)) && existsIn(json, getFocusPath(selection))) {\n      return\n    }\n\n    debug('clearing selection: path does not exist anymore', selection)\n    selection = getInitialSelection(json, documentState)\n  }\n\n  interface PreviousState {\n    json: unknown | undefined\n    text: string | undefined\n    documentState: DocumentState | undefined\n    selection: JSONSelection | undefined\n    textIsRepaired: boolean\n  }\n\n  function addHistoryItem(previous: PreviousState) {\n    if (previous.json === undefined && previous.text === undefined) {\n      // initialization -> do not create a history item\n      return\n    }\n\n    const canPatch = json !== undefined && previous.json !== undefined\n\n    history.add({\n      type: 'tree',\n      undo: {\n        patch: canPatch ? [{ op: 'replace', path: '', value: previous.json }] : undefined,\n        json: previous.json,\n        text: previous.text,\n        documentState: previous.documentState,\n        textIsRepaired: previous.textIsRepaired,\n        selection: removeEditModeFromSelection(previous.selection),\n        sortedColumn: undefined\n      },\n      redo: {\n        patch: canPatch ? [{ op: 'replace', path: '', value: json }] : undefined,\n        json,\n        text,\n        documentState,\n        textIsRepaired,\n        selection: removeEditModeFromSelection(selection),\n        sortedColumn: undefined\n      }\n    })\n  }\n\n  function createDefaultSelection() {\n    debug('createDefaultSelection')\n\n    selection = createValueSelection([])\n  }\n\n  export function patch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('patch', operations, afterPatch)\n\n    if (json === undefined) {\n      throw new Error('Cannot apply patch: no JSON')\n    }\n\n    const previousJson = json\n    const previousState = {\n      json: undefined, // not needed: we use patch to reconstruct the json\n      text,\n      documentState,\n      selection: removeEditModeFromSelection(selection),\n      textIsRepaired,\n      sortedColumn: undefined\n    }\n\n    // execute the patch operations\n    const undo: JSONPatchDocument = revertJSONPatchWithMoveOperations(\n      json,\n      operations\n    ) as JSONPatchDocument\n    const patched = documentStatePatch(json, documentState, operations)\n\n    // update the selection based on the operations\n    const updatedSelection = createSelectionFromOperations(json, operations) ?? selection\n\n    const callback =\n      typeof afterPatch === 'function'\n        ? afterPatch(patched.json, patched.documentState, updatedSelection)\n        : undefined\n\n    json = callback?.json !== undefined ? callback.json : patched.json\n    documentState = callback?.state !== undefined ? callback.state : patched.documentState\n    selection = callback?.selection !== undefined ? callback.selection : updatedSelection\n    text = undefined\n    textIsRepaired = false\n    pastedJson = undefined\n    pastedMultilineText = undefined\n    parseError = undefined\n\n    // ensure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    history.add({\n      type: 'tree',\n      undo: {\n        patch: undo,\n        ...previousState\n      },\n      redo: {\n        patch: operations,\n        json: undefined, // not needed, we use patch to reconstruct\n        text,\n        documentState,\n        selection: removeEditModeFromSelection(selection),\n        sortedColumn: undefined,\n        textIsRepaired\n      }\n    })\n\n    return {\n      json,\n      previousJson,\n      undo,\n      redo: operations\n    }\n  }\n\n  function handleEditKey() {\n    if (readOnly || !selection) {\n      return\n    }\n\n    selection = createEditKeySelection(getFocusPath(selection))\n  }\n\n  function handleEditValue() {\n    if (readOnly || !selection) {\n      return\n    }\n\n    const path = getFocusPath(selection)\n    const value = getIn(json, path)\n    if (isObjectOrArray(value)) {\n      openJSONEditorModal(path, value)\n    } else {\n      selection = createEditValueSelection(path)\n    }\n  }\n\n  function handleToggleEnforceString() {\n    if (readOnly || !isValueSelection(selection)) {\n      return\n    }\n\n    const path = getFocusPath(selection)\n    const pointer = compileJSONPointer(path)\n    const value = getIn(json, path)\n    const enforceString = !getEnforceString(json, documentState, path)\n    const updatedValue = enforceString ? String(value) : stringConvert(String(value), parser)\n\n    debug('handleToggleEnforceString', { enforceString, value, updatedValue })\n\n    handlePatch(\n      [\n        {\n          op: 'replace',\n          path: pointer,\n          value: updatedValue\n        }\n      ],\n      (_, patchedState) => {\n        return {\n          state: setInDocumentState(json, patchedState, path, { type: 'value', enforceString })\n        }\n      }\n    )\n  }\n\n  export function acceptAutoRepair(): Content {\n    if (textIsRepaired && json !== undefined) {\n      handleReplaceJson(json)\n    }\n\n    return json !== undefined ? { json } : { text: text || '' }\n  }\n\n  async function handleCut(indent = true) {\n    await onCut({\n      json,\n      selection,\n      indentation: indent ? indentation : undefined,\n      readOnly,\n      parser,\n      onPatch: handlePatch\n    })\n  }\n\n  async function handleCopy(indent = true) {\n    if (json === undefined) {\n      return\n    }\n\n    await onCopy({\n      json,\n      selection,\n      indentation: indent ? indentation : undefined,\n      parser\n    })\n  }\n\n  function handlePaste(event: ClipboardEvent) {\n    event.preventDefault()\n\n    const clipboardText = event.clipboardData?.getData('text/plain')\n\n    _paste(clipboardText)\n  }\n\n  async function handlePasteFromMenu() {\n    try {\n      const clipboardText = await navigator.clipboard.readText()\n\n      _paste(clipboardText)\n    } catch (err) {\n      console.error(err)\n\n      copyPasteModalOpen = true\n    }\n  }\n\n  function _paste(clipboardText: string | undefined) {\n    if (clipboardText === undefined) {\n      return\n    }\n\n    onPaste({\n      clipboardText,\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onChangeText: handleChangeText,\n      onPasteMultilineText: handlePasteMultilineText,\n      openRepairModal\n    })\n  }\n\n  function openRepairModal(text: string, onApply: (repairedText: string) => void) {\n    jsonRepairModalProps = {\n      text,\n      onParse: (text) => parsePartialJson(text, (t) => parseAndRepair(t, parser)),\n      onRepair: repairPartialJson,\n      onApply,\n      onClose: focus\n    }\n  }\n\n  function handleRemove() {\n    onRemove({\n      json,\n      text,\n      selection,\n      keepSelection: false,\n      readOnly,\n      onChange,\n      onPatch: handlePatch\n    })\n  }\n\n  function handleDuplicate() {\n    if (\n      readOnly ||\n      json === undefined ||\n      !selection ||\n      !hasSelectionContents ||\n      isEmpty(getFocusPath(selection)) // root selected, cannot duplicate\n    ) {\n      return\n    }\n\n    debug('duplicate', { selection })\n\n    const operations = duplicate(json, getSelectionPaths(json, selection))\n\n    handlePatch(operations)\n  }\n\n  function handleExtract() {\n    if (\n      readOnly ||\n      !selection ||\n      (!isMultiSelection(selection) && !isValueSelection(selection)) ||\n      isEmpty(getFocusPath(selection)) // root selected, cannot extract\n    ) {\n      return\n    }\n\n    debug('extract', { selection })\n\n    const operations = extract(json, selection)\n\n    handlePatch(operations, (patchedJson, patchedState) => {\n      if (isObjectOrArray(patchedJson)) {\n        // expand extracted object/array\n        const path: JSONPath = []\n        return {\n          state: expandSmartIfCollapsed(patchedJson, patchedState, path)\n        }\n      }\n\n      return undefined\n    })\n  }\n\n  function handleInsert(insertType: InsertType): void {\n    onInsert({\n      insertType,\n      selectInside: true,\n      initialValue: undefined,\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onReplaceJson: handleReplaceJson\n    })\n  }\n\n  function handleInsertFromContextMenu(type: InsertType) {\n    if (isKeySelection(selection)) {\n      // in this case, we do not want to rename the key, but replace the property\n      selection = createValueSelection(selection.path)\n    }\n\n    if (!selection) {\n      selection = getInitialSelection(json, documentState)\n    }\n\n    handleInsert(type)\n  }\n\n  function handleConvert(type: ConvertType) {\n    if (readOnly || !selection) {\n      return\n    }\n\n    if (!canConvert(selection)) {\n      onError(new Error(`Cannot convert current selection to ${type}`))\n      return\n    }\n\n    try {\n      const path = getAnchorPath(selection)\n      const currentValue: unknown = getIn(json, path)\n      const convertedValue = convertValue(\n        currentValue,\n        type as 'value' | 'object' | 'array',\n        parser\n      )\n      if (convertedValue === currentValue) {\n        // no change, do nothing\n        return\n      }\n\n      const operations: JSONPatchDocument = [\n        { op: 'replace', path: compileJSONPointer(path), value: convertedValue }\n      ]\n\n      debug('handleConvert', { selection, path, type, operations })\n\n      handlePatch(operations, (patchedJson, patchedState) => {\n        // expand converted object/array\n        return {\n          state: selection\n            ? expandSmart(patchedJson, patchedState, getFocusPath(selection))\n            : documentState\n        }\n      })\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  function handleInsertBefore() {\n    if (!selection) {\n      return\n    }\n\n    const selectionBefore = getSelectionUp(json, documentState, selection, false)\n    const parentPath = initial(getFocusPath(selection))\n\n    if (\n      selectionBefore &&\n      !isEmpty(getFocusPath(selectionBefore)) &&\n      isEqual(parentPath, initial(getFocusPath(selectionBefore)))\n    ) {\n      selection = createAfterSelection(getFocusPath(selectionBefore))\n    } else {\n      selection = createInsideSelection(parentPath)\n    }\n\n    debug('insert before', { selection, selectionBefore, parentPath })\n\n    flushSync()\n    handleContextMenu()\n  }\n\n  function handleInsertAfter() {\n    if (!selection) {\n      return\n    }\n\n    const path = getEndPath(json, selection)\n\n    debug('insert after', path)\n\n    selection = createAfterSelection(path)\n\n    flushSync()\n    handleContextMenu()\n  }\n\n  async function handleInsertCharacter(char: string) {\n    await onInsertCharacter({\n      char,\n      selectInside: true,\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onReplaceJson: handleReplaceJson,\n      onSelect: handleSelect\n    })\n  }\n\n  function handleUndo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.canUndo) {\n      return\n    }\n\n    const item = history.undo()\n    if (!isTreeHistoryItem(item)) {\n      onUndo(item)\n\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.undo.patch ? immutableJSONPatch(json, item.undo.patch) : item.undo.json\n    documentState = item.undo.documentState\n    selection = item.undo.selection\n    text = item.undo.text\n    textIsRepaired = item.undo.textIsRepaired\n    parseError = undefined\n\n    debug('undo', { item, json, documentState, selection })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.undo.patch,\n            undo: item.redo.patch\n          }\n        : undefined\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (selection) {\n      scrollTo(getFocusPath(selection), { scrollToWhenVisible: false })\n    }\n  }\n\n  function handleRedo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.canRedo) {\n      return\n    }\n\n    const item = history.redo()\n    if (!isTreeHistoryItem(item)) {\n      onRedo(item)\n\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.redo.patch ? immutableJSONPatch(json, item.redo.patch) : item.redo.json\n    documentState = item.redo.documentState\n    selection = item.redo.selection\n    text = item.redo.text\n    textIsRepaired = item.redo.textIsRepaired\n    parseError = undefined\n\n    debug('redo', { item, json, documentState, selection })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.redo.patch,\n            undo: item.undo.patch\n          }\n        : undefined\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (selection) {\n      scrollTo(getFocusPath(selection), { scrollToWhenVisible: false })\n    }\n  }\n\n  function openSortModal(rootPath: JSONPath) {\n    if (readOnly || json === undefined) {\n      return\n    }\n\n    modalOpen = true\n\n    onSortModal({\n      id: sortModalId,\n      json,\n      rootPath,\n      onSort: async ({ operations }) => {\n        debug('onSort', rootPath, operations)\n\n        handlePatch(operations, (patchedJson, patchedState) => ({\n          // expand the newly replaced array if needed, and select it\n          state: expandSmartIfCollapsed(patchedJson, patchedState, rootPath),\n          selection: createValueSelection(rootPath)\n        }))\n      },\n      onClose: () => {\n        modalOpen = false\n        setTimeout(focus)\n      }\n    })\n  }\n\n  function handleSortSelection() {\n    if (!selection) {\n      return\n    }\n\n    const rootPath = findRootPath(json, selection)\n    openSortModal(rootPath)\n  }\n\n  function handleSortAll() {\n    const rootPath: JSONPath = []\n    openSortModal(rootPath)\n  }\n\n  /**\n   * This method is exposed via JSONEditor.transform\n   */\n  export function openTransformModal(options: TransformModalOptions) {\n    if (json === undefined) {\n      return\n    }\n\n    const { id, onTransform, onClose } = options\n    const rootPath = options.rootPath || []\n\n    modalOpen = true\n\n    onTransformModal({\n      id: id || transformModalId,\n      json,\n      rootPath,\n      onTransform: (operations) => {\n        if (onTransform) {\n          onTransform({\n            operations,\n            json,\n            transformedJson: immutableJSONPatch(json, operations)\n          })\n        } else {\n          debug('onTransform', rootPath, operations)\n\n          handlePatch(operations, (patchedJson, patchedState) => ({\n            // expand the newly replaced array if needed and select it\n            state: expandSmartIfCollapsed(patchedJson, patchedState, rootPath),\n            selection: createValueSelection(rootPath)\n          }))\n        }\n      },\n      onClose: () => {\n        modalOpen = false\n        setTimeout(focus)\n        if (onClose) {\n          onClose()\n        }\n      }\n    })\n  }\n\n  function handleTransformSelection() {\n    if (!selection) {\n      return\n    }\n\n    const rootPath = findRootPath(json, selection)\n    openTransformModal({\n      rootPath\n    })\n  }\n\n  function handleTransformAll() {\n    openTransformModal({\n      rootPath: []\n    })\n  }\n\n  function openJSONEditorModal(path: JSONPath, value: unknown) {\n    debug('openJSONEditorModal', { path, value })\n\n    modalOpen = true\n\n    // open a popup where you can edit the nested object/array\n    onJSONEditorModal({\n      content: {\n        json: value\n      },\n      path,\n      onPatch: context.onPatch,\n      onClose: () => {\n        modalOpen = false\n        setTimeout(focus)\n      }\n    })\n  }\n\n  /**\n   * Scroll the window vertically to the node with given path.\n   * Expand the path when needed.\n   */\n  export async function scrollTo(\n    path: JSONPath,\n    { scrollToWhenVisible = true, element }: ScrollToOptions = {}\n  ): Promise<void> {\n    documentState = expandPath(json, documentState, path, expandNone)\n\n    const elem = element ?? findElement(path)\n\n    debug('scrollTo', { path, elem, refContents })\n\n    if (!elem || !refContents) {\n      return Promise.resolve()\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    const elemRect = elem.getBoundingClientRect()\n    if (!scrollToWhenVisible) {\n      if (elemRect.bottom > viewPortRect.top && elemRect.top < viewPortRect.bottom) {\n        // element is fully or partially visible, don't scroll to it\n        return Promise.resolve()\n      }\n    }\n\n    const offset = -(viewPortRect.height / 4)\n\n    return new Promise<void>((resolve) => {\n      jump(elem, {\n        container: refContents,\n        offset,\n        duration: SCROLL_DURATION,\n        callback: () => resolve()\n      })\n    })\n  }\n\n  /**\n   * Find the DOM element of a given path.\n   * Note that the path can only be found when the node is expanded.\n   */\n  export function findElement(path: JSONPath): Element | undefined {\n    flushSync() // flush any changes, else the element we want to scroll to may not yet exist\n\n    return refContents?.querySelector(`div[data-path=\"${encodeDataPath(path)}\"]`) ?? undefined\n  }\n\n  /**\n   * Find the DOM element of a given search result.\n   * Note that the path can only be found when the node is expanded.\n   */\n  export function findSearchResult(resultIndex: number): Element | undefined {\n    flushSync() // flush any changes, else the element we want to scroll to may not yet exist\n\n    return (\n      refContents?.querySelector(`span[data-search-result-index=\"${resultIndex}\"]`) ?? undefined\n    )\n  }\n\n  /**\n   * If given path is outside the visible viewport, scroll up/down.\n   * When the path is already in view, nothing is done\n   */\n  function scrollIntoView(path: JSONPath) {\n    const elem = findElement(path)\n\n    if (!elem || !refContents) {\n      return\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    const elemRect = elem.getBoundingClientRect()\n    const margin = 20\n    const elemHeight = isObjectOrArray(getIn(json, path))\n      ? margin // do not use real height when array or object\n      : elemRect.height\n\n    if (elemRect.top < viewPortRect.top + margin) {\n      // scroll down\n      jump(elem, {\n        container: refContents,\n        offset: -margin,\n        duration: 0\n      })\n    } else if (elemRect.top + elemHeight > viewPortRect.bottom - margin) {\n      // scroll up\n      jump(elem, {\n        container: refContents,\n        offset: -(viewPortRect.height - elemHeight - margin),\n        duration: 0\n      })\n    }\n  }\n\n  function emitOnChange(previousContent: Content, patchResult: JSONPatchResult | undefined) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    if (previousContent.json === undefined && previousContent?.text === undefined) {\n      // initialization -> do not fire an onChange event\n      return\n    }\n\n    // make sure we cannot send an invalid contents like having both\n    // json and text defined, or having none defined\n    if (text !== undefined) {\n      const content = { text, json: undefined }\n      onChange?.(content, previousContent, {\n        contentErrors: validate(),\n        patchResult\n      })\n    } else if (json !== undefined) {\n      const content = { text: undefined, json }\n      onChange?.(content, previousContent, {\n        contentErrors: validate(),\n        patchResult\n      })\n    }\n  }\n\n  function handlePatch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('handlePatch', operations, afterPatch)\n\n    const previousContent = { json, text }\n    const patchResult = patch(operations, afterPatch)\n\n    emitOnChange(previousContent, patchResult)\n\n    return patchResult\n  }\n\n  function handleReplaceJson(updatedJson: unknown, afterPatch?: AfterPatchCallback) {\n    const previousContent = { json, text }\n    const previousState = { documentState, selection, json, text, textIsRepaired }\n\n    const updatedState = expandPath(\n      json,\n      syncDocumentState(updatedJson, documentState),\n      [],\n      expandMinimal\n    )\n\n    const callback =\n      typeof afterPatch === 'function'\n        ? afterPatch(updatedJson, updatedState, selection)\n        : undefined\n\n    json = callback?.json !== undefined ? callback.json : updatedJson\n    documentState = callback?.state !== undefined ? callback.state : updatedState\n    selection = callback?.selection !== undefined ? callback.selection : selection\n    text = undefined\n    textIsRepaired = false\n    parseError = undefined\n\n    // make sure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem(previousState)\n\n    // we could work out a patchResult, or use patch(), but only when the previous and new\n    // contents are both json and not text. We go for simplicity and consistency here and\n    // do _not_ return a patchResult ever.\n    const patchResult = undefined\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  function handleChangeText(updatedText: string, afterPatch?: AfterPatchCallback) {\n    debug('handleChangeText')\n\n    const previousContent = { json, text }\n    const previousState = { documentState, selection, json, text, textIsRepaired }\n\n    try {\n      json = parseMemoizeOne(updatedText)\n      documentState = expandPath(json, syncDocumentState(json, documentState), [], expandMinimal)\n      text = undefined\n      textIsRepaired = false\n      parseError = undefined\n    } catch (err) {\n      try {\n        json = parseMemoizeOne(jsonrepair(updatedText))\n        documentState = expandPath(json, syncDocumentState(json, documentState), [], expandMinimal)\n        text = updatedText\n        textIsRepaired = true\n        parseError = undefined\n      } catch {\n        // no valid JSON, will show empty document or invalid json\n        json = undefined\n        documentState = createDocumentState({ json, expand: expandMinimal })\n        text = updatedText\n        textIsRepaired = false\n        parseError =\n          text !== ''\n            ? normalizeJsonParseError(text, (err as Error).message || String(err))\n            : undefined\n      }\n    }\n\n    if (typeof afterPatch === 'function') {\n      const callback = afterPatch(json, documentState, selection)\n\n      json = callback?.json !== undefined ? callback.json : json\n      documentState = callback?.state !== undefined ? callback.state : documentState\n      selection = callback?.selection !== undefined ? callback.selection : selection\n    }\n\n    // ensure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem(previousState)\n\n    // no JSON patch actions available in text mode\n    const patchResult = undefined\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  /**\n   * Toggle expanded state of a node\n   * @param path The path to be expanded\n   * @param expanded  True if currently expanded, false when currently collapsed\n   * @param [recursive=false]  Only applicable when expanding\n   */\n  function handleExpand(path: JSONPath, expanded: boolean, recursive = false): void {\n    debug('handleExpand', { path, expanded, recursive })\n\n    if (expanded) {\n      expand(path, recursive ? expandAll : expandSelf)\n    } else {\n      collapse(path, recursive)\n    }\n\n    // set focus to the hidden input, so we can capture quick keys like Ctrl+X, Ctrl+C, Ctrl+V\n    focus()\n  }\n\n  function handleExpandAll() {\n    handleExpand([], true, true)\n  }\n\n  function handleCollapseAll() {\n    handleExpand([], false, true)\n  }\n\n  function openFind(findAndReplace: boolean): void {\n    debug('openFind', { findAndReplace })\n\n    showSearch = false\n    showReplace = false\n\n    flushSync()\n\n    // trick to make sure the focus goes to the search box\n    showSearch = true\n    showReplace = findAndReplace\n  }\n\n  function handleExpandSection(path: JSONPath, section: Section) {\n    debug('handleExpandSection', path, section)\n\n    documentState = expandSection(json, documentState, path, section)\n  }\n\n  function handlePasteJson(newPastedJson: PastedJson) {\n    debug('pasted json as text', newPastedJson)\n\n    pastedJson = newPastedJson\n  }\n\n  function handlePasteMultilineText(pastedText: string) {\n    debug('pasted multiline text', { pastedText })\n\n    pastedMultilineText = pastedText\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    const keepAnchorPath = event.shiftKey\n    debug('keydown', { combo, key: event.key })\n\n    if (combo === 'Ctrl+X') {\n      // cut formatted\n      event.preventDefault()\n      handleCut(true)\n    }\n    if (combo === 'Ctrl+Shift+X') {\n      // cut compact\n      event.preventDefault()\n      handleCut(false)\n    }\n    if (combo === 'Ctrl+C') {\n      // copy formatted\n      event.preventDefault()\n      handleCopy(true)\n    }\n    if (combo === 'Ctrl+Shift+C') {\n      // copy compact\n      event.preventDefault()\n      handleCopy(false)\n    }\n    // Note: Ctrl+V (paste) is handled by the on:paste event\n\n    if (combo === 'Ctrl+D') {\n      event.preventDefault()\n      handleDuplicate()\n    }\n    if (combo === 'Delete' || combo === 'Backspace') {\n      event.preventDefault()\n      handleRemove()\n    }\n    if (combo === 'Insert') {\n      event.preventDefault()\n      handleInsert('structure')\n    }\n    if (combo === 'Ctrl+A') {\n      event.preventDefault()\n      selection = selectAll()\n    }\n\n    if (combo === 'Ctrl+Q') {\n      handleContextMenu(event)\n    }\n\n    if (combo === 'ArrowUp' || combo === 'Shift+ArrowUp') {\n      event.preventDefault()\n\n      const newSelection = selection\n        ? getSelectionUp(json, documentState, selection, keepAnchorPath) || selection\n        : getInitialSelection(json, documentState)\n\n      selection = newSelection\n      scrollIntoView(getFocusPath(newSelection))\n    }\n    if (combo === 'ArrowDown' || combo === 'Shift+ArrowDown') {\n      event.preventDefault()\n\n      const newSelection = selection\n        ? getSelectionDown(json, documentState, selection, keepAnchorPath) || selection\n        : getInitialSelection(json, documentState)\n\n      selection = newSelection\n      scrollIntoView(getFocusPath(newSelection))\n    }\n    if (combo === 'ArrowLeft' || combo === 'Shift+ArrowLeft') {\n      event.preventDefault()\n\n      const newSelection = selection\n        ? getSelectionLeft(json, documentState, selection, keepAnchorPath, !readOnly) || selection\n        : getInitialSelection(json, documentState)\n\n      selection = newSelection\n      scrollIntoView(getFocusPath(newSelection))\n    }\n    if (combo === 'ArrowRight' || combo === 'Shift+ArrowRight') {\n      event.preventDefault()\n\n      const newSelection =\n        selection && json !== undefined\n          ? getSelectionRight(json, documentState, selection, keepAnchorPath, !readOnly) ||\n            selection\n          : getInitialSelection(json, documentState)\n\n      selection = newSelection\n      scrollIntoView(getFocusPath(newSelection))\n    }\n\n    if (combo === 'Enter' && selection) {\n      // when the selection consists of a single Array item, change selection to editing its value\n      if (isMultiSelectionWithOneItem(selection)) {\n        const path = selection.focusPath\n        const parent = getIn(json, initial(path))\n        if (Array.isArray(parent)) {\n          // change into selection of the value\n          event.preventDefault()\n          selection = createValueSelection(path)\n        }\n      }\n\n      if (isKeySelection(selection)) {\n        // go to key edit mode\n        event.preventDefault()\n        selection = { ...selection, edit: true }\n      }\n\n      if (isValueSelection(selection)) {\n        event.preventDefault()\n\n        const value = getIn(json, selection.path)\n        if (isObjectOrArray(value)) {\n          // expand object/array\n          handleExpand(selection.path, true)\n        } else {\n          // go to value edit mode\n          selection = { ...selection, edit: true }\n        }\n      }\n    }\n\n    const normalizedCombo = combo.replace(/^Shift\\+/, '') // replace 'Shift+A' with 'A'\n    if (normalizedCombo.length === 1 && selection) {\n      // a regular key like a, A, _, etc is entered.\n      // Replace selected contents with a new value having this first character as text\n      event.preventDefault()\n      handleInsertCharacter(event.key)\n      return\n    }\n\n    if (combo === 'Enter' && (isAfterSelection(selection) || isInsideSelection(selection))) {\n      // Enter on an insert area -> open the area in edit mode\n      event.preventDefault()\n      handleInsertCharacter('')\n      return\n    }\n\n    if (combo === 'Ctrl+Enter' && isValueSelection(selection)) {\n      const value = getIn(json, selection.path)\n\n      if (isUrl(value)) {\n        // open url in new page\n        window.open(String(value), '_blank')\n      }\n    }\n\n    if (combo === 'Escape' && selection) {\n      event.preventDefault()\n      selection = undefined\n    }\n\n    if (combo === 'Ctrl+F') {\n      event.preventDefault()\n      openFind(false)\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      openFind(true)\n    }\n\n    if (combo === 'Ctrl+Z') {\n      event.preventDefault()\n      handleUndo()\n    }\n\n    if (combo === 'Ctrl+Shift+Z') {\n      event.preventDefault()\n      handleRedo()\n    }\n  }\n\n  function handleMouseDown(event: Event) {\n    debug('handleMouseDown', event)\n\n    const target = event.target as HTMLElement\n\n    if (!isChildOfNodeName(target, 'BUTTON') && !target.isContentEditable) {\n      // for example when clicking on the empty area in the main menu\n      focus()\n\n      if (!selection && json === undefined && (text === '' || text === undefined)) {\n        createDefaultSelection()\n      }\n    }\n  }\n\n  function openContextMenu({\n    anchor,\n    left,\n    top,\n    width,\n    height,\n    offsetTop,\n    offsetLeft,\n    showTip\n  }: AbsolutePopupOptions) {\n    const defaultItems: ContextMenuItem[] = createTreeContextMenuItems({\n      json,\n      documentState,\n      selection,\n      readOnly,\n\n      onEditKey: handleEditKey,\n      onEditValue: handleEditValue,\n      onToggleEnforceString: handleToggleEnforceString,\n\n      onCut: handleCut,\n      onCopy: handleCopy,\n      onPaste: handlePasteFromMenu,\n\n      onRemove: handleRemove,\n      onDuplicate: handleDuplicate,\n      onExtract: handleExtract,\n\n      onInsertBefore: handleInsertBefore,\n      onInsert: handleInsertFromContextMenu,\n      onInsertAfter: handleInsertAfter,\n      onConvert: handleConvert,\n\n      onSort: handleSortSelection,\n      onTransform: handleTransformSelection\n    })\n\n    const items = onRenderContextMenu(defaultItems) ?? defaultItems\n\n    if (items === false) {\n      return\n    }\n\n    const props = {\n      tip: showTip\n        ? 'Tip: you can open this context menu via right-click or with Ctrl+Q'\n        : undefined,\n      items,\n      onRequestClose: () => closeAbsolutePopup(popupId)\n    }\n\n    const options = {\n      left,\n      top,\n      offsetTop,\n      offsetLeft,\n      width,\n      height,\n      anchor,\n      closeOnOuterClick: true,\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    }\n\n    modalOpen = true\n\n    const popupId = openAbsolutePopup(ContextMenu, props, options)\n  }\n\n  function handleContextMenu(event?: Event) {\n    if (isEditingSelection(selection)) {\n      return\n    }\n\n    if (event) {\n      event.stopPropagation()\n      event.preventDefault()\n    }\n\n    if (event && event.type === 'contextmenu' && event.target !== refHiddenInput) {\n      // right mouse click to open context menu\n      openContextMenu({\n        left: (event as MouseEvent).clientX,\n        top: (event as MouseEvent).clientY,\n        width: CONTEXT_MENU_WIDTH,\n        height: CONTEXT_MENU_HEIGHT,\n        showTip: false\n      })\n    } else {\n      // type === 'keydown' (from the quick key Ctrl+Q)\n      // or target is hidden input -> context menu button on keyboard\n      const anchor = refContents?.querySelector('.jse-context-menu-pointer.jse-selected')\n      if (anchor) {\n        openContextMenu({\n          anchor,\n          offsetTop: 2,\n          width: CONTEXT_MENU_WIDTH,\n          height: CONTEXT_MENU_HEIGHT,\n          showTip: false\n        })\n      } else {\n        // fallback on just displaying the TreeContextMenu top left\n        const rect = refContents?.getBoundingClientRect()\n        if (rect) {\n          openContextMenu({\n            top: rect.top + 2,\n            left: rect.left + 2,\n            width: CONTEXT_MENU_WIDTH,\n            height: CONTEXT_MENU_HEIGHT,\n            showTip: false\n          })\n        }\n      }\n    }\n  }\n\n  function handleContextMenuFromTreeMenu(event: MouseEvent) {\n    openContextMenu({\n      anchor: findParentWithNodeName(event.target as HTMLElement, 'BUTTON'),\n      offsetTop: 0,\n      width: CONTEXT_MENU_WIDTH,\n      height: CONTEXT_MENU_HEIGHT,\n      showTip: true\n    })\n  }\n\n  async function handleParsePastedJson() {\n    debug('apply pasted json', pastedJson)\n    if (!pastedJson) {\n      return\n    }\n\n    const { onPasteAsJson } = pastedJson\n    pastedJson = undefined\n\n    onPasteAsJson()\n\n    // TODO: get rid of the setTimeout here\n    setTimeout(focus)\n  }\n\n  async function handleParsePastedMultilineText() {\n    debug('apply pasted multiline text', pastedMultilineText)\n    if (!pastedMultilineText) {\n      return\n    }\n\n    _paste(JSON.stringify(pastedMultilineText))\n\n    // TODO: get rid of the setTimeout here\n    setTimeout(focus)\n  }\n\n  function handleClearPastedJson() {\n    debug('clear pasted json')\n    pastedJson = undefined\n    focus()\n  }\n\n  function handleClearPastedMultilineText() {\n    debug('clear pasted multiline text')\n    pastedMultilineText = undefined\n    focus()\n  }\n\n  function handleRequestRepair() {\n    onChangeMode(Mode.text)\n  }\n\n  function handleNavigationBarSelect(newSelection: JSONSelection) {\n    selection = newSelection\n\n    focus()\n    scrollTo(getFocusPath(newSelection))\n  }\n\n  export function focus() {\n    debug('focus')\n    // with just .focus(), sometimes the input doesn't react on onpaste events\n    // in Chrome when having a large document open and then doing cut/paste.\n    // Calling both .focus() and .select() did solve this issue.\n    if (refHiddenInput) {\n      refHiddenInput.focus()\n      refHiddenInput.select()\n    }\n  }\n\n  function handleWindowMouseDown(event: MouseEvent & { currentTarget: EventTarget & Window }) {\n    const outsideEditor = !isChildOf(\n      event.target as Element,\n      (element) => element === refJsonEditor\n    )\n    if (outsideEditor) {\n      if (isEditingSelection(selection)) {\n        debug('click outside the editor, exit edit mode')\n        selection = removeEditModeFromSelection(selection)\n\n        if (hasFocus && refHiddenInput) {\n          refHiddenInput.focus()\n          refHiddenInput.blur()\n        }\n\n        debug('blur (outside editor)')\n        if (refHiddenInput) {\n          refHiddenInput.blur()\n        }\n      }\n    }\n  }\n\n  function findNextInside(path: JSONPath): JSONSelection | undefined {\n    return getSelectionNextInside(json, documentState, path)\n  }\n\n  $: autoScrollHandler = refContents ? createAutoScrollHandler(refContents) : undefined\n\n  function handleDrag(event: MouseEvent) {\n    if (autoScrollHandler) {\n      autoScrollHandler.onDrag(event)\n    }\n  }\n\n  function handleDragEnd() {\n    if (autoScrollHandler) {\n      autoScrollHandler.onDragEnd()\n    }\n  }\n\n  // Note that we want the context to change as little as possible since it forces all nodes to re-render,\n  // it should only change when a config option like readOnly or onClassName is changed\n  let context: TreeModeContext\n  $: context = {\n    mode: Mode.tree,\n    readOnly,\n    truncateTextSize,\n    parser,\n    normalization,\n    getJson,\n    getDocumentState,\n    getSelection,\n    findElement,\n    findNextInside,\n    focus,\n    onPatch: handlePatch,\n    onInsert: handleInsert,\n    onExpand: handleExpand,\n    onSelect: handleSelect,\n    onFind: openFind,\n    onExpandSection: handleExpandSection,\n    onPasteJson: handlePasteJson,\n    onRenderValue,\n    onContextMenu: openContextMenu,\n    onClassName: onClassName || (() => undefined),\n    onDrag: handleDrag,\n    onDragEnd: handleDragEnd\n  }\n\n  $: debug('context changed', context)\n</script>\n\n<svelte:window on:mousedown={handleWindowMouseDown} />\n\n<div\n  role=\"tree\"\n  tabindex=\"-1\"\n  class=\"jse-tree-mode\"\n  class:no-main-menu={!mainMenuBar}\n  on:keydown={handleKeyDown}\n  on:mousedown={handleMouseDown}\n  on:contextmenu={handleContextMenu}\n  bind:this={refJsonEditor}\n>\n  {#if mainMenuBar}\n    <TreeMenu\n      {json}\n      {selection}\n      {readOnly}\n      {history}\n      bind:showSearch\n      onExpandAll={handleExpandAll}\n      onCollapseAll={handleCollapseAll}\n      onUndo={handleUndo}\n      onRedo={handleRedo}\n      onSort={handleSortAll}\n      onTransform={handleTransformAll}\n      onContextMenu={handleContextMenuFromTreeMenu}\n      onCopy={handleCopy}\n      {onRenderMenu}\n    />\n  {/if}\n\n  {#if navigationBar}\n    <NavigationBar {json} {selection} onSelect={handleNavigationBarSelect} {onError} {pathParser} />\n  {/if}\n\n  {#if !isSSR}\n    <label class=\"jse-hidden-input-label\">\n      <input\n        type=\"text\"\n        readonly={true}\n        tabindex=\"-1\"\n        class=\"jse-hidden-input\"\n        bind:this={refHiddenInput}\n        on:paste={handlePaste}\n      />\n    </label>\n    {#if json === undefined}\n      {#if text === '' || text === undefined}\n        <Welcome\n          {readOnly}\n          onCreateObject={() => {\n            focus()\n            handleInsertCharacter('{')\n          }}\n          onCreateArray={() => {\n            focus()\n            handleInsertCharacter('[')\n          }}\n          onClick={() => {\n            // FIXME: this is a workaround for the editor not putting the focus on refHiddenInput\n            //  when clicking in the welcome screen so you cannot paste a document from clipboard.\n            focus()\n          }}\n        />\n      {:else}\n        <Message\n          type=\"error\"\n          message=\"The loaded JSON document is invalid and could not be repaired automatically.\"\n          actions={!readOnly\n            ? [\n                {\n                  icon: faCode,\n                  text: 'Repair manually',\n                  title: 'Open the document in \"code\" mode and repair it manually',\n                  onClick: handleRequestRepair\n                }\n              ]\n            : []}\n        />\n        <JSONPreview {text} {json} {indentation} {parser} />\n      {/if}\n    {:else}\n      <div class=\"jse-search-box-container\">\n        <SearchBox\n          {json}\n          {documentState}\n          {parser}\n          {showSearch}\n          {showReplace}\n          {readOnly}\n          columns={undefined}\n          onSearch={handleSearch}\n          onFocus={handleFocusSearch}\n          onPatch={handlePatch}\n          onClose={handleCloseSearch}\n        />\n      </div>\n      <div class=\"jse-contents\" data-jsoneditor-scrollable-contents={true} bind:this={refContents}>\n        {#if showSearch}\n          <div class=\"jse-search-box-background\"></div>\n        {/if}\n        <JSONNode\n          value={json}\n          pointer={''}\n          state={documentState}\n          {validationErrors}\n          {searchResults}\n          {selection}\n          {context}\n          onDragSelectionStart={noop}\n        />\n      </div>\n\n      {#if pastedJson}\n        <Message\n          type=\"info\"\n          message={`You pasted a JSON ${\n            Array.isArray(pastedJson.contents) ? 'array' : 'object'\n          } as text`}\n          actions={[\n            {\n              icon: faWrench,\n              text: 'Paste as JSON instead',\n              title: 'Replace the value with the pasted JSON',\n              // We use mousedown here instead of click: this message pops up\n              // whilst the user is editing a value. When clicking this button,\n              // the actual value is applied and the event is not propagated\n              // and an onClick on this button never happens.\n              onMouseDown: handleParsePastedJson\n            },\n            {\n              text: 'Leave as is',\n              title: 'Keep the JSON embedded in the value',\n              onClick: handleClearPastedJson\n            }\n          ]}\n        />\n      {/if}\n\n      {#if pastedMultilineText}\n        <Message\n          type=\"info\"\n          message=\"Multiline text was pasted as array\"\n          actions={[\n            {\n              icon: faWrench,\n              text: 'Paste as string instead',\n              title: 'Paste the clipboard data as a single string value instead of an array',\n              onClick: handleParsePastedMultilineText\n            },\n            {\n              text: 'Leave as is',\n              title: 'Keep the pasted array',\n              onClick: handleClearPastedMultilineText\n            }\n          ]}\n        />\n      {/if}\n\n      {#if textIsRepaired}\n        <Message\n          type=\"success\"\n          message=\"The loaded JSON document was invalid but is successfully repaired.\"\n          actions={!readOnly\n            ? [\n                {\n                  icon: faCheck,\n                  text: 'Ok',\n                  title: 'Accept the repaired document',\n                  onClick: acceptAutoRepair\n                },\n                {\n                  icon: faCode,\n                  text: 'Repair manually instead',\n                  title: 'Leave the document unchanged and repair it manually instead',\n                  onClick: handleRequestRepair\n                }\n              ]\n            : []}\n          onClose={focus}\n        />\n      {/if}\n\n      <ValidationErrorsOverview\n        validationErrors={validationErrorList}\n        selectError={handleSelectValidationError}\n      />\n    {/if}\n  {:else}\n    <div class=\"jse-contents\">\n      <div class=\"jse-loading-space\"></div>\n      <div class=\"jse-loading\">loading...</div>\n    </div>\n  {/if}\n</div>\n\n{#if copyPasteModalOpen}\n  <CopyPasteModal onClose={() => (copyPasteModalOpen = false)} />\n{/if}\n\n{#if jsonRepairModalProps}\n  <JSONRepairModal\n    {...jsonRepairModalProps}\n    onClose={() => {\n      jsonRepairModalProps?.onClose()\n      jsonRepairModalProps = undefined\n    }}\n  />\n{/if}\n\n<style src=\"./TreeMode.scss\"></style>\n","import {\n  faArrowRightArrowLeft,\n  faCaretSquareDown,\n  faCaretSquareUp,\n  faCheckSquare,\n  faClone,\n  faCopy,\n  faCropAlt,\n  faCut,\n  faFilter,\n  faPaste,\n  faPen,\n  faPlus,\n  faSortAmountDownAlt,\n  faSquare,\n  faTrashCan\n} from '@fortawesome/free-solid-svg-icons'\nimport {\n  canConvert,\n  getFocusPath,\n  isAfterSelection,\n  isInsideSelection,\n  isKeySelection,\n  isMultiSelection,\n  isValueSelection,\n  singleItemSelected\n} from '$lib/logic/selection'\nimport type {\n  ConvertType,\n  DocumentState,\n  InsertType,\n  JSONSelection,\n  ContextMenuItem\n} from '$lib/types'\nimport { initial, isEmpty } from 'lodash-es'\nimport { getIn } from 'immutable-json-patch'\nimport { isObject, isObjectOrArray } from '$lib/utils/typeUtils'\nimport { getEnforceString } from '$lib/logic/documentState'\n\nexport default function ({\n  json,\n  documentState,\n  selection,\n  readOnly,\n  onEditKey,\n  onEditValue,\n  onToggleEnforceString,\n  onCut,\n  onCopy,\n  onPaste,\n  onRemove,\n  onDuplicate,\n  onExtract,\n  onInsertBefore,\n  onInsert,\n  onConvert,\n  onInsertAfter,\n  onSort,\n  onTransform\n}: {\n  json: unknown\n  documentState: DocumentState | undefined\n  selection: JSONSelection | undefined\n  readOnly: boolean\n  onEditKey: () => void\n  onEditValue: () => void\n  onToggleEnforceString: () => void\n  onCut: (indent: boolean) => void\n  onCopy: (indent: boolean) => void\n  onPaste: () => void\n  onRemove: () => void\n  onDuplicate: () => void\n  onExtract: () => void\n  onInsertBefore: () => void\n  onInsert: (type: InsertType) => void\n  onConvert: (type: ConvertType) => void\n  onInsertAfter: () => void\n  onSort: () => void\n  onTransform: () => void\n}): ContextMenuItem[] {\n  const hasJson = json !== undefined\n  const hasSelection = !!selection\n  const rootSelected = selection ? isEmpty(getFocusPath(selection)) : false\n  const focusValue = selection ? getIn(json, getFocusPath(selection)) : undefined\n  const editValueText = Array.isArray(focusValue)\n    ? 'Edit array'\n    : isObject(focusValue)\n      ? 'Edit object'\n      : 'Edit value'\n\n  const hasSelectionContents =\n    hasJson &&\n    (isMultiSelection(selection) || isKeySelection(selection) || isValueSelection(selection))\n\n  const parent =\n    selection && !rootSelected ? getIn(json, initial(getFocusPath(selection))) : undefined\n\n  const canEditKey =\n    !readOnly && hasJson && singleItemSelected(selection) && !rootSelected && !Array.isArray(parent)\n\n  const canEditValue =\n    !readOnly && hasJson && selection !== undefined && singleItemSelected(selection)\n  const canEnforceString = canEditValue && !isObjectOrArray(focusValue)\n\n  const canCut = !readOnly && hasSelectionContents\n  const canCopy = hasSelectionContents\n  const canPaste = !readOnly && hasSelection\n  const canDuplicate = !readOnly && hasJson && hasSelectionContents && !rootSelected // must not be root\n  const canExtract =\n    !readOnly &&\n    hasJson &&\n    selection !== undefined &&\n    (isMultiSelection(selection) || isValueSelection(selection)) &&\n    !rootSelected // must not be root\n\n  const convertMode = hasSelectionContents\n  const insertOrConvertText = convertMode ? 'Convert to:' : 'Insert:'\n\n  const canInsertOrConvertStructure =\n    !readOnly &&\n    ((isInsideSelection(selection) && Array.isArray(focusValue)) ||\n      (isAfterSelection(selection) && Array.isArray(parent)))\n  const canInsertOrConvertObject =\n    !readOnly && (convertMode ? canConvert(selection) && !isObject(focusValue) : hasSelection)\n  const canInsertOrConvertArray =\n    !readOnly && (convertMode ? canConvert(selection) && !Array.isArray(focusValue) : hasSelection)\n  const canInsertOrConvertValue =\n    !readOnly && (convertMode ? canConvert(selection) && isObjectOrArray(focusValue) : hasSelection)\n\n  const enforceString =\n    selection !== undefined ? getEnforceString(json, documentState, getFocusPath(selection)) : false\n\n  function handleInsertOrConvert(type: InsertType) {\n    if (hasSelectionContents) {\n      if (type !== 'structure') {\n        onConvert(type)\n      }\n    } else {\n      onInsert(type)\n    }\n  }\n\n  return [\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'button',\n          onClick: () => onEditKey(),\n          icon: faPen,\n          text: 'Edit key',\n          title: 'Edit the key (Double-click on the key)',\n          disabled: !canEditKey\n        },\n        {\n          type: 'dropdown-button',\n          main: {\n            type: 'button',\n            onClick: () => onEditValue(),\n            icon: faPen,\n            text: editValueText,\n            title: 'Edit the value (Double-click on the value)',\n            disabled: !canEditValue\n          },\n          width: '11em',\n          items: [\n            {\n              type: 'button',\n              icon: faPen,\n              text: editValueText,\n              title: 'Edit the value (Double-click on the value)',\n              onClick: () => onEditValue(),\n              disabled: !canEditValue\n            },\n            {\n              type: 'button',\n              icon: enforceString ? faCheckSquare : faSquare,\n              text: 'Enforce string',\n              title: 'Enforce keeping the value as string when it contains a numeric value',\n              onClick: () => onToggleEnforceString(),\n              disabled: !canEnforceString\n            }\n          ]\n        }\n      ]\n    },\n    { type: 'separator' },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'dropdown-button',\n          main: {\n            type: 'button',\n            onClick: () => onCut(true),\n            icon: faCut,\n            text: 'Cut',\n            title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n            disabled: !canCut\n          },\n          width: '10em',\n          items: [\n            {\n              type: 'button',\n              icon: faCut,\n              text: 'Cut formatted',\n              title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n              onClick: () => onCut(true),\n              disabled: !canCut\n            },\n            {\n              type: 'button',\n              icon: faCut,\n              text: 'Cut compacted',\n              title: 'Cut selected contents, without indentation (Ctrl+Shift+X)',\n              onClick: () => onCut(false),\n              disabled: !canCut\n            }\n          ]\n        },\n        {\n          type: 'dropdown-button',\n          main: {\n            type: 'button',\n            onClick: () => onCopy(true),\n            icon: faCopy,\n            text: 'Copy',\n            title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n            disabled: !canCopy\n          },\n          width: '12em',\n          items: [\n            {\n              type: 'button',\n              icon: faCopy,\n              text: 'Copy formatted',\n              title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n              onClick: () => onCopy(true),\n              disabled: !canCopy\n            },\n            {\n              type: 'button',\n              icon: faCopy,\n              text: 'Copy compacted',\n              title: 'Copy selected contents, without indentation (Ctrl+Shift+C)',\n              onClick: () => onCopy(false),\n              disabled: !canCopy\n            }\n          ]\n        },\n        {\n          type: 'button',\n          onClick: () => onPaste(),\n          icon: faPaste,\n          text: 'Paste',\n          title: 'Paste clipboard contents (Ctrl+V)',\n          disabled: !canPaste\n        }\n      ]\n    },\n    { type: 'separator' },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'column',\n          items: [\n            {\n              type: 'button',\n              onClick: () => onDuplicate(),\n              icon: faClone,\n              text: 'Duplicate',\n              title: 'Duplicate selected contents (Ctrl+D)',\n              disabled: !canDuplicate\n            },\n            {\n              type: 'button',\n              onClick: () => onExtract(),\n              icon: faCropAlt,\n              text: 'Extract',\n              title: 'Extract selected contents',\n              disabled: !canExtract\n            },\n            {\n              type: 'button',\n              onClick: () => onSort(),\n              icon: faSortAmountDownAlt,\n              text: 'Sort',\n              title: 'Sort array or object contents',\n              disabled: readOnly || !hasSelectionContents\n            },\n            {\n              type: 'button',\n              onClick: () => onTransform(),\n              icon: faFilter,\n              text: 'Transform',\n              title: 'Transform array or object contents (filter, sort, project)',\n              disabled: readOnly || !hasSelectionContents\n            },\n            {\n              type: 'button',\n              onClick: () => onRemove(),\n              icon: faTrashCan,\n              text: 'Remove',\n              title: 'Remove selected contents (Delete)',\n              disabled: readOnly || !hasSelectionContents\n            }\n          ]\n        },\n        {\n          type: 'column',\n          items: [\n            { type: 'label', text: insertOrConvertText },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('structure'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Structure',\n              title: insertOrConvertText + ' structure like the first item in the array',\n              disabled: !canInsertOrConvertStructure\n            },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('object'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Object',\n              title: insertOrConvertText + ' object',\n              disabled: !canInsertOrConvertObject\n            },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('array'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Array',\n              title: insertOrConvertText + ' array',\n              disabled: !canInsertOrConvertArray\n            },\n            {\n              type: 'button',\n              onClick: () => handleInsertOrConvert('value'),\n              icon: convertMode ? faArrowRightArrowLeft : faPlus,\n              text: 'Value',\n              title: insertOrConvertText + ' value',\n              disabled: !canInsertOrConvertValue\n            }\n          ]\n        }\n      ]\n    },\n    {\n      type: 'separator'\n    },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'button',\n          onClick: () => onInsertBefore(),\n          icon: faCaretSquareUp,\n          text: 'Insert before',\n          title: 'Select area before current entry to insert or paste contents',\n          disabled: readOnly || !hasSelectionContents || rootSelected\n        },\n        {\n          type: 'button',\n          onClick: () => onInsertAfter(),\n          icon: faCaretSquareDown,\n          text: 'Insert after',\n          title: 'Select area after current entry to insert or paste contents',\n          disabled: readOnly || !hasSelectionContents || rootSelected\n        }\n      ]\n    }\n  ]\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faCopy,\n    faEllipsisV,\n    faFilter,\n    faRedo,\n    faSearch,\n    faSortAmountDownAlt,\n    faUndo\n  } from '@fortawesome/free-solid-svg-icons'\n  import { CONTEXT_MENU_EXPLANATION } from '$lib/constants.js'\n  import { faJSONEditorCollapse, faJSONEditorExpand } from '$lib/img/customFontawesomeIcons.js'\n  import { isObjectOrArray } from '$lib/utils/typeUtils.js'\n  import Menu from '../../../controls/Menu.svelte'\n  import type {\n    HistoryItem,\n    History,\n    JSONSelection,\n    MenuItem,\n    OnRenderMenuInternal\n  } from '$lib/types'\n  import { isKeySelection, isMultiSelection, isValueSelection } from '$lib/logic/selection.js'\n\n  export let json: unknown\n  export let selection: JSONSelection | undefined\n\n  export let readOnly: boolean\n  export let showSearch = false\n  export let history: History<HistoryItem>\n\n  export let onExpandAll: () => void\n  export let onCollapseAll: () => void\n  export let onUndo: () => void\n  export let onRedo: () => void\n  export let onSort: () => void\n  export let onTransform: () => void\n  export let onContextMenu: (event: MouseEvent) => void\n  export let onCopy: () => void\n  export let onRenderMenu: OnRenderMenuInternal\n\n  function handleToggleSearch() {\n    showSearch = !showSearch\n  }\n\n  $: hasJson = json !== undefined\n  $: hasSelectionContents =\n    hasJson &&\n    (isMultiSelection(selection) || isKeySelection(selection) || isValueSelection(selection))\n\n  let expandMenuItem: MenuItem\n  $: expandMenuItem = {\n    type: 'button',\n    icon: faJSONEditorExpand,\n    title: 'Expand all',\n    className: 'jse-expand-all',\n    onClick: onExpandAll,\n    disabled: !isObjectOrArray(json)\n  }\n\n  let collapseMenuItem: MenuItem\n  $: collapseMenuItem = {\n    type: 'button',\n    icon: faJSONEditorCollapse,\n    title: 'Collapse all',\n    className: 'jse-collapse-all',\n    onClick: onCollapseAll,\n    disabled: !isObjectOrArray(json)\n  }\n\n  let searchMenuItem: MenuItem\n  $: searchMenuItem = {\n    type: 'button',\n    icon: faSearch,\n    title: 'Search (Ctrl+F)',\n    className: 'jse-search',\n    onClick: handleToggleSearch,\n    disabled: json === undefined\n  }\n\n  let defaultItems: MenuItem[]\n  $: defaultItems = !readOnly\n    ? [\n        expandMenuItem,\n        collapseMenuItem,\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faSortAmountDownAlt,\n          title: 'Sort',\n          className: 'jse-sort',\n          onClick: onSort,\n          disabled: readOnly || json === undefined\n        },\n        {\n          type: 'button',\n          icon: faFilter,\n          title: 'Transform contents (filter, sort, project)',\n          className: 'jse-transform',\n          onClick: onTransform,\n          disabled: readOnly || json === undefined\n        },\n        searchMenuItem,\n        {\n          type: 'button',\n          icon: faEllipsisV,\n          title: CONTEXT_MENU_EXPLANATION,\n          className: 'jse-contextmenu',\n          onClick: onContextMenu\n        },\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faUndo,\n          title: 'Undo (Ctrl+Z)',\n          className: 'jse-undo',\n          onClick: onUndo,\n          disabled: !history.canUndo\n        },\n        {\n          type: 'button',\n          icon: faRedo,\n          title: 'Redo (Ctrl+Shift+Z)',\n          className: 'jse-redo',\n          onClick: onRedo,\n          disabled: !history.canRedo\n        },\n        {\n          type: 'space'\n        }\n      ]\n    : [\n        expandMenuItem,\n        collapseMenuItem,\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faCopy,\n          title: 'Copy (Ctrl+C)',\n          className: 'jse-copy',\n          onClick: onCopy,\n          disabled: !hasSelectionContents\n        },\n        {\n          type: 'separator'\n        },\n        searchMenuItem,\n        {\n          type: 'space'\n        }\n      ]\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: items = onRenderMenu(defaultItems) || defaultItems\n</script>\n\n<Menu {items} />\n","/**\n * Create a readonly proxy around an object or array.\n *\n * Will throw an error when trying to mutate the object or array\n *\n * Inspired by: https://github.com/kourge/readonly-proxy/\n */\nexport function readonlyProxy(target: unknown): unknown {\n  if (!isObject(target)) {\n    return target\n  }\n\n  return new Proxy(target, {\n    get(target, property, receiver) {\n      const value = Reflect.get(target, property, receiver)\n\n      return readonlyProxy(value)\n    },\n\n    set() {\n      return false\n    },\n\n    deleteProperty() {\n      return false\n    }\n  })\n}\n\nfunction isObject(value: unknown): value is object {\n  return typeof value === 'object' && value !== null\n}\n","import { createDebug } from '../utils/debug.js'\nimport type { HistoryInstance, History } from 'svelte-jsoneditor'\n\nconst MAX_HISTORY_ITEMS = 1000\n\nconst debug = createDebug('jsoneditor:History')\n\nexport interface HistoryOptions<T> {\n  maxItems?: number\n  onChange?: (state: History<T>) => void\n}\n\nexport function createHistoryInstance<T>(options: HistoryOptions<T> = {}): HistoryInstance<T> {\n  const maxItems = options.maxItems || MAX_HISTORY_ITEMS\n\n  /**\n   * items in history are sorted from newest first to oldest last\n   */\n  let reverseItems: T[] = []\n\n  let index = 0\n\n  function canUndo(): boolean {\n    return index < reverseItems.length\n  }\n\n  function canRedo(): boolean {\n    return index > 0\n  }\n\n  function get(): History<T> {\n    return {\n      canUndo: canUndo(),\n      canRedo: canRedo(),\n      items: () => reverseItems.slice().reverse(),\n      add,\n      undo,\n      redo,\n      clear\n    }\n  }\n\n  function handleChange() {\n    if (options.onChange) {\n      options.onChange(get())\n    }\n  }\n\n  function add(item: T) {\n    debug('add', item)\n\n    reverseItems = [item].concat(reverseItems.slice(index)).slice(0, maxItems)\n\n    index = 0\n\n    handleChange()\n  }\n\n  function clear() {\n    debug('clear')\n\n    reverseItems = []\n    index = 0\n\n    handleChange()\n  }\n\n  function undo(): T | undefined {\n    if (canUndo()) {\n      const item = reverseItems[index]\n      index += 1\n\n      debug('undo', item)\n\n      handleChange()\n\n      return item\n    }\n\n    return undefined\n  }\n\n  function redo(): T | undefined {\n    if (canRedo()) {\n      index -= 1\n\n      debug('redo', reverseItems[index])\n\n      handleChange()\n\n      return reverseItems[index]\n    }\n\n    return undefined\n  }\n\n  return {\n    get\n  }\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { uniqueId } from '$lib/utils/uniqueId.js'\n  import { faCaretDown, faCaretRight } from '@fortawesome/free-solid-svg-icons'\n  import { debounce, isEmpty, noop } from 'lodash-es'\n  import Icon from 'svelte-awesome'\n  import { DEBOUNCE_DELAY } from '$lib/constants.js'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer, getIn } from 'immutable-json-patch'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import { transformModalStates, transformModalStateShared } from './transformModalStates.js'\n  import TransformWizard from './TransformWizard.svelte'\n  import TransformModalHeader from './TransformModalHeader.svelte'\n  import AbsolutePopup from './popup/AbsolutePopup.svelte'\n  import { createDebug } from '$lib/utils/debug.js'\n  import TreeMode from '../modes/treemode/TreeMode.svelte'\n  import type {\n    Content,\n    HistoryItem,\n    History,\n    JSONParser,\n    JSONPathParser,\n    OnChangeQueryLanguage,\n    OnClassName,\n    OnRenderContextMenuInternal,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    QueryLanguage,\n    QueryLanguageOptions\n  } from '$lib/types.js'\n  import { onEscape } from '$lib/actions/onEscape.js'\n  import { readonlyProxy } from '$lib/utils/readonlyProxy.js'\n  import Modal from './Modal.svelte'\n  import { onMount } from 'svelte'\n  import { createHistoryInstance } from '$lib/logic/history'\n\n  const debug = createDebug('jsoneditor:TransformModal')\n\n  export let id = 'transform-modal-' + uniqueId()\n  export let json: unknown\n  export let rootPath: JSONPath = []\n\n  export let indentation: number | string\n  export let truncateTextSize: number\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n\n  export let queryLanguages: QueryLanguage[]\n  export let queryLanguageId: string\n  export let onChangeQueryLanguage: OnChangeQueryLanguage\n\n  export let onRenderValue: OnRenderValue\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onRenderContextMenu: OnRenderContextMenuInternal\n  export let onClassName: OnClassName\n\n  export let onTransform: (operations: JSONPatchDocument) => void\n  export let onClose: () => void\n\n  let refQueryInput: HTMLTextAreaElement\n\n  const historyInstance = createHistoryInstance<HistoryItem>({\n    onChange: (updatedHistory) => (history = updatedHistory)\n  })\n\n  let history: History<HistoryItem> = historyInstance.get()\n\n  let selectedJson: unknown | undefined\n  $: selectedJson = readonlyProxy(getIn(json, rootPath))\n  let selectedContent: Content\n  $: selectedContent = selectedJson ? { json: selectedJson } : { text: '' }\n\n  let fullscreen = false\n\n  const stateId = `${id}:${compileJSONPointer(rootPath)}`\n  const state = transformModalStates[stateId] ?? {}\n\n  // showWizard is not stored inside a stateId\n  let showWizard = transformModalStateShared.showWizard !== false\n  let showOriginal = transformModalStateShared.showOriginal !== false\n\n  let queryOptions = state.queryOptions ?? {}\n  let query = queryLanguageId === state.queryLanguageId && state.query ? state.query : ''\n  let isManual = state.isManual ?? false\n  let queryError: string | undefined = undefined\n\n  let previewError: string | undefined = undefined\n  let previewContent: Content = { text: '' }\n\n  if (!isManual) {\n    updateQueryByWizard(queryOptions)\n  }\n\n  onMount(() => {\n    refQueryInput?.focus()\n  })\n\n  function getSelectedQueryLanguage(queryLanguageId: string): QueryLanguage {\n    return queryLanguages.find((item) => item.id === queryLanguageId) ?? queryLanguages[0]\n  }\n\n  function updateQueryByWizard(newQueryOptions: QueryLanguageOptions) {\n    try {\n      queryOptions = newQueryOptions\n\n      query = getSelectedQueryLanguage(queryLanguageId).createQuery(selectedJson, newQueryOptions)\n      queryError = undefined\n      isManual = false\n\n      debug('updateQueryByWizard', { queryOptions, query, isManual })\n    } catch (err) {\n      queryError = String(err)\n    }\n  }\n\n  function handleChangeQuery(event: Event) {\n    query = (event.target as HTMLTextAreaElement).value\n    isManual = true\n    debug('handleChangeQuery', { query, isManual })\n  }\n\n  function previewTransform(previewJson: unknown | undefined, query: string) {\n    if (previewJson === undefined) {\n      previewContent = { text: '' }\n      previewError = 'Error: No JSON'\n      return\n    }\n\n    if (query.trim() === '') {\n      previewContent = { json: previewJson }\n      return\n    }\n\n    try {\n      debug('previewTransform', {\n        query\n      })\n\n      const jsonTransformed = getSelectedQueryLanguage(queryLanguageId).executeQuery(\n        previewJson,\n        query,\n        parser\n      )\n\n      previewContent = { json: jsonTransformed }\n      previewError = undefined\n    } catch (err) {\n      previewContent = { text: '' }\n      previewError = String(err)\n    }\n  }\n\n  const previewTransformDebounced = debounce(previewTransform, DEBOUNCE_DELAY)\n\n  $: {\n    previewTransformDebounced(selectedJson, query)\n  }\n\n  $: {\n    // remember the selected values for the next time we open the SortModal\n    // just in memory, not persisted\n    transformModalStates[stateId] = {\n      queryOptions,\n      query,\n      queryLanguageId,\n      isManual\n    }\n\n    debug('store state in memory', stateId, transformModalStates[stateId])\n  }\n\n  function handleTransform() {\n    if (selectedJson === undefined) {\n      previewContent = { text: '' }\n      previewError = 'Error: No JSON'\n      return\n    }\n\n    try {\n      debug('handleTransform', { query })\n      const jsonTransformed = getSelectedQueryLanguage(queryLanguageId).executeQuery(\n        selectedJson,\n        query,\n        parser\n      )\n\n      onTransform([\n        {\n          op: 'replace',\n          path: compileJSONPointer(rootPath),\n          value: jsonTransformed\n        }\n      ])\n\n      onClose()\n    } catch (err) {\n      // this should never occur since we can only press the Transform\n      // button when creating a preview was successful\n      console.error(err)\n      previewContent = { text: '' }\n      previewError = String(err)\n    }\n  }\n\n  function toggleShowWizard() {\n    showWizard = !showWizard\n\n    // not stored inside a stateId\n    transformModalStateShared.showWizard = showWizard\n  }\n\n  function toggleShowOriginal() {\n    showOriginal = !showOriginal\n\n    // not stored inside a stateId\n    transformModalStateShared.showOriginal = showOriginal\n  }\n\n  function focus(element: HTMLElement) {\n    element.focus()\n  }\n\n  function handleChangeQueryLanguage(newQueryLanguageId: string) {\n    debug('handleChangeQueryLanguage', newQueryLanguageId)\n    queryLanguageId = newQueryLanguageId\n    onChangeQueryLanguage(newQueryLanguageId)\n\n    updateQueryByWizard(queryOptions)\n  }\n\n  function handleEscape() {\n    if (fullscreen) {\n      fullscreen = !fullscreen\n    } else {\n      onClose()\n    }\n  }\n</script>\n\n<Modal {onClose} className=\"jse-transform-modal\" {fullscreen}>\n  <div class=\"jse-transform-modal-inner\" use:onEscape={handleEscape}>\n    <AbsolutePopup>\n      <TransformModalHeader\n        {queryLanguages}\n        {queryLanguageId}\n        onChangeQueryLanguage={handleChangeQueryLanguage}\n        {onClose}\n        bind:fullscreen\n      />\n      <div class=\"jse-modal-contents\">\n        <div class=\"jse-main-contents\">\n          <div class=\"jse-query-contents\">\n            <div class=\"jse-label\">\n              <div class=\"jse-label-inner\">Language</div>\n            </div>\n            <div class=\"jse-description\">\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html getSelectedQueryLanguage(queryLanguageId).description}\n            </div>\n\n            <div class=\"jse-label\">\n              <div class=\"jse-label-inner\">Path</div>\n            </div>\n            <input\n              class=\"jse-path\"\n              type=\"text\"\n              readonly\n              title=\"Selected path\"\n              value={!isEmpty(rootPath) ? stringifyJSONPath(rootPath) : '(document root)'}\n            />\n\n            <div class=\"jse-label\">\n              <div class=\"jse-label-inner\">\n                <button type=\"button\" on:click={toggleShowWizard}>\n                  <Icon data={showWizard ? faCaretDown : faCaretRight} />\n                  Wizard\n                </button>\n              </div>\n            </div>\n            {#if showWizard}\n              {#if Array.isArray(selectedJson)}\n                <TransformWizard\n                  {queryOptions}\n                  json={selectedJson}\n                  onChange={updateQueryByWizard}\n                />\n                {#if queryError}\n                  <div class=\"query-error\">\n                    {queryError}\n                  </div>\n                {/if}\n              {:else}\n                (Only available for arrays, not for objects)\n              {/if}\n            {/if}\n\n            <div class=\"jse-label\">\n              <div class=\"jse-label-inner\">Query</div>\n            </div>\n            <textarea\n              bind:this={refQueryInput}\n              class=\"jse-query\"\n              spellcheck=\"false\"\n              on:input={handleChangeQuery}>{query}</textarea\n            >\n          </div>\n          <div class=\"jse-data-contents\" class:jse-hide-original-data={!showOriginal}>\n            <div class=\"jse-original-data\" class:jse-hide={!showOriginal}>\n              <div class=\"jse-label\">\n                <div class=\"jse-label-inner\">\n                  <button type=\"button\" on:click={toggleShowOriginal}>\n                    <Icon data={showOriginal ? faCaretDown : faCaretRight} />\n                    Original\n                  </button>\n                </div>\n              </div>\n              {#if showOriginal}\n                <TreeMode\n                  externalContent={selectedContent}\n                  externalSelection={undefined}\n                  {history}\n                  readOnly={true}\n                  {truncateTextSize}\n                  mainMenuBar={false}\n                  navigationBar={false}\n                  {indentation}\n                  {escapeControlCharacters}\n                  {escapeUnicodeCharacters}\n                  {parser}\n                  {parseMemoizeOne}\n                  {onRenderValue}\n                  {onRenderMenu}\n                  {onRenderContextMenu}\n                  onError={console.error}\n                  onChange={noop}\n                  onChangeMode={noop}\n                  onSelect={noop}\n                  onUndo={noop}\n                  onRedo={noop}\n                  onFocus={noop}\n                  onBlur={noop}\n                  onSortModal={noop}\n                  onTransformModal={noop}\n                  onJSONEditorModal={noop}\n                  {onClassName}\n                  validator={undefined}\n                  {validationParser}\n                  {pathParser}\n                />\n              {/if}\n            </div>\n            <div class=\"jse-preview-data\">\n              <div class=\"jse-label\">\n                <div class=\"jse-label-inner\">Preview</div>\n              </div>\n              {#if !previewError}\n                <TreeMode\n                  externalContent={previewContent}\n                  externalSelection={undefined}\n                  {history}\n                  readOnly={true}\n                  {truncateTextSize}\n                  mainMenuBar={false}\n                  navigationBar={false}\n                  {indentation}\n                  {escapeControlCharacters}\n                  {escapeUnicodeCharacters}\n                  {parser}\n                  {parseMemoizeOne}\n                  {onRenderValue}\n                  {onRenderMenu}\n                  {onRenderContextMenu}\n                  onError={console.error}\n                  onChange={noop}\n                  onChangeMode={noop}\n                  onSelect={noop}\n                  onUndo={noop}\n                  onRedo={noop}\n                  onFocus={noop}\n                  onBlur={noop}\n                  onSortModal={noop}\n                  onTransformModal={noop}\n                  onJSONEditorModal={noop}\n                  {onClassName}\n                  validator={undefined}\n                  {validationParser}\n                  {pathParser}\n                />\n              {:else}\n                <div class=\"jse-preview jse-error\">\n                  {previewError}\n                </div>\n              {/if}\n            </div>\n          </div>\n        </div>\n\n        <div class=\"jse-actions\">\n          <button\n            type=\"button\"\n            class=\"jse-primary\"\n            on:click={handleTransform}\n            use:focus\n            disabled={!!previewError}\n          >\n            Transform\n          </button>\n        </div>\n      </div>\n    </AbsolutePopup>\n  </div>\n</Modal>\n\n<style src=\"./TransformModal.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { getContext } from 'svelte'\n  import Icon from 'svelte-awesome'\n  import { faCog } from '@fortawesome/free-solid-svg-icons'\n  import SelectQueryLanguage from '../controls/selectQueryLanguage/SelectQueryLanguage.svelte'\n  import type { AbsolutePopupContext, OnChangeQueryLanguage, QueryLanguage } from '$lib/types.js'\n  import Header from './Header.svelte'\n\n  export let queryLanguages: QueryLanguage[]\n  export let queryLanguageId: string\n  export let fullscreen: boolean\n  export let onChangeQueryLanguage: OnChangeQueryLanguage\n  export let onClose: () => void\n\n  let refConfigButton: HTMLButtonElement | undefined\n  let popupId: number | undefined\n\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n\n  function openConfig() {\n    const props = {\n      queryLanguages,\n      queryLanguageId,\n      onChangeQueryLanguage: (queryLanguageId: string) => {\n        closeAbsolutePopup(popupId)\n        onChangeQueryLanguage(queryLanguageId)\n      }\n    }\n\n    popupId = openAbsolutePopup(SelectQueryLanguage, props, {\n      offsetTop: -2,\n      offsetLeft: 0,\n      anchor: refConfigButton,\n      closeOnOuterClick: true\n    })\n  }\n</script>\n\n<Header title=\"Transform\" fullScreenButton={true} bind:fullscreen {onClose}>\n  <button\n    slot=\"actions\"\n    type=\"button\"\n    bind:this={refConfigButton}\n    class=\"jse-config\"\n    class:hide={queryLanguages.length <= 1}\n    on:click={openConfig}\n    title=\"Select a query language\"\n  >\n    <Icon data={faCog} />\n  </button>\n</Header>\n\n<style src=\"./TransformModalHeader.scss\"></style>\n","export function noop() {\n  return undefined\n}\n","import { HighlightStyle, syntaxHighlighting } from '@codemirror/language'\nimport { tags } from '@lezer/highlight'\n\nconst highlightStyle = HighlightStyle.define([\n  { tag: tags.propertyName, color: 'var(--internal-key-color)' }, // keys\n  { tag: tags.number, color: 'var(--internal-value-color-number)' },\n  { tag: tags.bool, color: 'var(--internal-value-color-boolean)' },\n  { tag: tags.string, color: 'var(--internal-value-color-string)' },\n  { tag: tags.keyword, color: 'var(--internal-value-color-null)' } // null\n])\n\nexport const highlighter = syntaxHighlighting(highlightStyle)\n\n// TODO: remove workaround when not needed anymore\n// Workaround for the error \"CodeMirror plugin crashed: TypeError: tags3 is undefined\"\n// thrown when using the json() language from '@codemirror/lang-json'\n//\n// Note that a plain CodeSandbox with parcel and code mirror v6.0.0,\n// so it is maybe related to Vite\n//\n// See https://discuss.codemirror.net/t/highlighting-that-seems-ignored-in-cm6/4320/15\nconst originalStyle = highlightStyle.style\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// noinspection JSConstantReassignment\nhighlightStyle.style = (tags) => originalStyle(tags || [])\n","import { getIndentUnit } from \"@codemirror/language\";\nimport { RangeSetBuilder } from \"@codemirror/state\";\nimport { Decoration, ViewPlugin, } from \"@codemirror/view\";\nclass WrappedLineIndent {\n    constructor(view) {\n        this.view = view;\n        this.indentUnit = getIndentUnit(view.state);\n        this.initialPaddingLeft = null;\n        this.isChrome = window === null || window === void 0 ? void 0 : window.navigator.userAgent.includes(\"Chrome\");\n        this.generate(view.state);\n    }\n    update(update) {\n        const indentUnit = getIndentUnit(update.state);\n        if (indentUnit !== this.indentUnit ||\n            update.docChanged ||\n            update.viewportChanged) {\n            this.indentUnit = indentUnit;\n            this.generate(update.state);\n        }\n    }\n    generate(state) {\n        const builder = new RangeSetBuilder();\n        if (this.initialPaddingLeft) {\n            this.addStyleToBuilder(builder, state, this.initialPaddingLeft);\n        }\n        else {\n            this.view.requestMeasure({\n                read: (view) => {\n                    const lineElement = view.contentDOM.querySelector(\".cm-line\");\n                    if (lineElement) {\n                        this.initialPaddingLeft = window\n                            .getComputedStyle(lineElement)\n                            .getPropertyValue(\"padding-left\");\n                        this.addStyleToBuilder(builder, view.state, this.initialPaddingLeft);\n                    }\n                    this.decorations = builder.finish();\n                },\n            });\n        }\n        this.decorations = builder.finish();\n    }\n    addStyleToBuilder(builder, state, initialPaddingLeft) {\n        const visibleLines = this.getVisibleLines(state);\n        for (const line of visibleLines) {\n            const { numColumns, containsTab } = this.numColumns(line.text, state.tabSize);\n            const paddingValue = `calc(${numColumns + this.indentUnit}ch + ${initialPaddingLeft})`;\n            const textIndentValue = this.isChrome\n                ? `calc(-${numColumns + this.indentUnit}ch - ${containsTab ? 1 : 0}px)`\n                : `-${numColumns + this.indentUnit}ch`;\n            builder.add(line.from, line.from, Decoration.line({\n                attributes: {\n                    style: `padding-left: ${paddingValue}; text-indent: ${textIndentValue};`,\n                },\n            }));\n        }\n    }\n    // Get all lines that are currently visible in the viewport.\n    getVisibleLines(state) {\n        const lines = new Set();\n        let lastLine = null;\n        for (const { from, to } of this.view.visibleRanges) {\n            let pos = from;\n            while (pos <= to) {\n                const line = state.doc.lineAt(pos);\n                if (lastLine !== line) {\n                    lines.add(line);\n                    lastLine = line;\n                }\n                pos = line.to + 1;\n            }\n        }\n        return lines;\n    }\n    numColumns(str, tabSize) {\n        let cols = 0;\n        let containsTab = false;\n        loop: for (let i = 0; i < str.length; i++) {\n            switch (str[i]) {\n                case \" \": {\n                    cols += 1;\n                    continue loop;\n                }\n                case \"\\t\": {\n                    cols += tabSize - (cols % tabSize);\n                    containsTab = true;\n                    continue loop;\n                }\n                case \"\\r\": {\n                    continue loop;\n                }\n                default: {\n                    break loop;\n                }\n            }\n        }\n        return { numColumns: cols, containsTab };\n    }\n}\nexport const wrappedLineIndent = [\n    ViewPlugin.fromClass(WrappedLineIndent, {\n        decorations: (v) => v.decorations,\n    }),\n];\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faExclamationTriangle,\n    faEye,\n    faTimes,\n    faWrench\n  } from '@fortawesome/free-solid-svg-icons'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { immutableJSONPatch, revertJSONPatch } from 'immutable-json-patch'\n  import { jsonrepair } from 'jsonrepair'\n  import { debounce, isEqual, uniqueId } from 'lodash-es'\n  import { flushSync, onDestroy, onMount } from 'svelte'\n  import {\n    JSON_STATUS_INVALID,\n    JSON_STATUS_REPAIRABLE,\n    JSON_STATUS_VALID,\n    MAX_CHARACTERS_TEXT_PREVIEW,\n    MAX_DOCUMENT_SIZE_TEXT_MODE,\n    TEXT_MODE_ONCHANGE_DELAY\n  } from '$lib/constants.js'\n  import {\n    activeElementIsChildOf,\n    createNormalizationFunctions,\n    getWindow\n  } from '$lib/utils/domUtils.js'\n  import { formatSize } from '$lib/utils/fileUtils.js'\n  import { findTextLocation, getText, needsFormatting } from '$lib/utils/jsonUtils.js'\n  import { expandSelf } from '$lib/logic/documentState.js'\n  import { createFocusTracker } from '../../controls/createFocusTracker.js'\n  import Message from '../../controls/Message.svelte'\n  import ValidationErrorsOverview from '../../controls/ValidationErrorsOverview.svelte'\n  import TextMenu from './menu/TextMenu.svelte'\n  import {\n    Annotation,\n    ChangeSet,\n    Compartment,\n    EditorSelection,\n    EditorState,\n    type Extension\n  } from '@codemirror/state'\n  import {\n    crosshairCursor,\n    drawSelection,\n    dropCursor,\n    EditorView,\n    highlightActiveLine,\n    highlightActiveLineGutter,\n    highlightSpecialChars,\n    keymap,\n    lineNumbers,\n    rectangularSelection,\n    type ViewUpdate\n  } from '@codemirror/view'\n  import { defaultKeymap, indentWithTab } from '@codemirror/commands'\n  import type { Diagnostic } from '@codemirror/lint'\n  import { linter, lintGutter, lintKeymap } from '@codemirror/lint'\n  import { json as jsonLang } from '@codemirror/lang-json'\n  import {\n    bracketMatching,\n    defaultHighlightStyle,\n    foldGutter,\n    foldKeymap,\n    indentOnInput,\n    indentUnit,\n    syntaxHighlighting,\n    foldCode,\n    unfoldCode,\n    foldAll,\n    unfoldAll\n  } from '@codemirror/language'\n  import {\n    closeSearchPanel,\n    highlightSelectionMatches,\n    openSearchPanel,\n    search,\n    searchKeymap\n  } from '@codemirror/search'\n  import {\n    autocompletion,\n    closeBrackets,\n    closeBracketsKeymap,\n    completionKeymap\n  } from '@codemirror/autocomplete'\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  import jsonSourceMap from 'json-source-map'\n  import StatusBar from './StatusBar.svelte'\n  import { highlighter } from './codemirror/codemirror-theme.js'\n  import type {\n    Content,\n    ContentErrors,\n    History,\n    HistoryItem,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnError,\n    OnExpand,\n    OnFocus,\n    OnRedo,\n    OnRenderMenuInternal,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    OnUndo,\n    ParseError,\n    RichValidationError,\n    TextHistoryItem,\n    TextSelection,\n    TransformModalOptions,\n    ValidationError,\n    Validator\n  } from '$lib/types.js'\n  import { Mode, SelectionType, ValidationSeverity } from '$lib/types.js'\n  import {\n    isContentParseError,\n    isContentValidationErrors,\n    isTextHistoryItem\n  } from '$lib/typeguards.js'\n  import memoizeOne from 'memoize-one'\n  import { validateText } from '$lib/logic/validation.js'\n  import { truncate } from '$lib/utils/stringUtils.js'\n  import { faJSONEditorFormat } from '$lib/img/customFontawesomeIcons.js'\n  import { indentationMarkers } from '@replit/codemirror-indentation-markers'\n  import { isTextSelection } from '$lib/logic/selection.js'\n  import { wrappedLineIndent } from 'codemirror-wrapped-line-indent/dist/index.js' // ensure loading ESM, otherwise the vitest test fail\n\n  export let readOnly: boolean\n  export let mainMenuBar: boolean\n  export let statusBar: boolean\n  export let askToFormat: boolean\n  export let externalContent: Content\n  export let externalSelection: JSONEditorSelection | undefined\n  export let history: History<HistoryItem>\n  export let indentation: number | string\n  export let tabSize: number\n  export let escapeUnicodeCharacters: boolean\n  export let parser: JSONParser\n  export let validator: Validator | undefined\n  export let validationParser: JSONParser\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onUndo: OnUndo\n  export let onRedo: OnRedo\n  export let onError: OnError\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n\n  const debug = createDebug('jsoneditor:TextMode')\n\n  const formatCompactKeyBinding = {\n    key: 'Mod-i',\n    run: handleFormat,\n    shift: handleCompact,\n    preventDefault: true\n  }\n\n  const isSSR = typeof window === 'undefined'\n  debug('isSSR:', isSSR)\n\n  let codeMirrorRef: HTMLDivElement\n  let domTextMode: HTMLDivElement\n  let codeMirrorView: EditorView\n  let editorState: EditorState\n\n  let acceptTooLarge = false\n  let askToFormatApplied = askToFormat\n\n  let validationErrors: ValidationError[] = []\n  const linterCompartment = new Compartment()\n  const readOnlyCompartment = new Compartment()\n  const indentCompartment = new Compartment()\n  const tabSizeCompartment = new Compartment()\n  const themeCompartment = new Compartment()\n\n  let content: Content = externalContent\n  let text = getText(content, indentation, parser) // text is just a cached version of content.text or parsed content.json\n\n  let historyAnnotation = Annotation.define()\n\n  let historyUpdatesQueue: ViewUpdate[] | null = null\n\n  function addHistoryItem(): boolean {\n    if (!historyUpdatesQueue || historyUpdatesQueue.length === 0) {\n      return false\n    }\n\n    // merge changes and create the inverse changes\n    const startState = historyUpdatesQueue[0].startState\n    const endState = historyUpdatesQueue[historyUpdatesQueue.length - 1].state\n    const mergedChanges = historyUpdatesQueue\n      .map((update) => update.changes)\n      .reduce((mergedChanges, change) => mergedChanges.compose(change))\n    const inverseChanges = mergedChanges.invert(startState.doc)\n\n    // create a history item with undo/redo actions\n    const item: TextHistoryItem = {\n      type: 'text',\n      undo: {\n        changes: inverseChanges.toJSON(),\n        selection: toTextSelection(startState.selection)\n      },\n      redo: {\n        changes: mergedChanges.toJSON(),\n        selection: toTextSelection(endState.selection)\n      }\n    }\n\n    debug('add history item', item)\n\n    history.add(item)\n\n    historyUpdatesQueue = null\n    return true\n  }\n\n  $: normalization = createNormalizationFunctions({\n    escapeControlCharacters: false,\n    escapeUnicodeCharacters\n  })\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: setCodeMirrorContent(externalContent, false, false)\n  $: applyExternalSelection(externalSelection)\n  $: updateLinter(validator)\n  $: updateIndentation(indentation)\n  $: updateTabSize(tabSize)\n  $: updateReadOnly(readOnly)\n\n  // force updating the text when escapeUnicodeCharacters changes\n  let previousEscapeUnicodeCharacters = escapeUnicodeCharacters\n  $: {\n    if (previousEscapeUnicodeCharacters !== escapeUnicodeCharacters) {\n      previousEscapeUnicodeCharacters = escapeUnicodeCharacters\n      forceUpdateText()\n    }\n  }\n\n  onMount(async () => {\n    if (isSSR) {\n      return\n    }\n\n    try {\n      codeMirrorView = createCodeMirrorView({\n        target: codeMirrorRef,\n        initialText: !disableTextEditor(text, acceptTooLarge)\n          ? normalization.escapeValue(text)\n          : '',\n        readOnly,\n        indentation\n      })\n    } catch (err) {\n      // TODO: report error to the user\n      console.error(err)\n    }\n  })\n\n  onDestroy(() => {\n    flush()\n\n    if (codeMirrorView) {\n      debug('Destroy CodeMirror editor')\n      codeMirrorView.destroy()\n    }\n  })\n\n  const sortModalId = uniqueId()\n  const transformModalId = uniqueId()\n\n  export function focus() {\n    if (codeMirrorView) {\n      debug('focus')\n      codeMirrorView.focus()\n    }\n  }\n\n  export function collapse(path: JSONPath) {\n    if (!codeMirrorView) {\n      return\n    }\n\n    try {\n      if (path && path.length > 0) {\n        // Find the text location of the given JSON path\n        const { from } = findTextLocation(normalization.escapeValue(text), path)\n\n        if (from !== undefined) {\n          // Set selection to the position we want to fold\n          codeMirrorView.dispatch({\n            selection: { anchor: from, head: from }\n          })\n          // Use CodeMirror's foldCode command for specific path\n          foldCode(codeMirrorView)\n        }\n      } else {\n        foldAll(codeMirrorView)\n      }\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  export function expand(path: JSONPath, callback: OnExpand = expandSelf) {\n    if (!codeMirrorView) {\n      return\n    }\n\n    try {\n      if (path && path.length > 0) {\n        // Find the text location of the given JSON path\n        const { from } = findTextLocation(normalization.escapeValue(text), path)\n\n        if (from !== undefined) {\n          // Set selection to the position we want to unfold\n          codeMirrorView.dispatch({\n            selection: { anchor: from, head: from }\n          })\n          // Use CodeMirror's unfoldCode command for specific path\n          unfoldCode(codeMirrorView)\n        }\n      } else {\n        // When path is empty (expand all)\n        unfoldAll(codeMirrorView)\n      }\n      callback?.(path)\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  // modalOpen is true when one of the modals is open.\n  // This is used to track whether the editor still has focus\n  let modalOpen = false\n\n  createFocusTracker({\n    onMount,\n    onDestroy,\n    getWindow: () => getWindow(domTextMode),\n    hasFocus: () => (modalOpen && document.hasFocus()) || activeElementIsChildOf(domTextMode),\n    onFocus,\n    onBlur: () => {\n      flush()\n      onBlur()\n    }\n  })\n\n  export function patch(operations: JSONPatchDocument): JSONPatchResult {\n    return handlePatch(operations, false)\n  }\n\n  export function handlePatch(operations: JSONPatchDocument, emitChange: boolean): JSONPatchResult {\n    debug('handlePatch', operations, emitChange)\n\n    const previousJson = parser.parse(text)\n    const updatedJson = immutableJSONPatch(previousJson, operations)\n    const undo = revertJSONPatch(previousJson, operations)\n    const updatedContent = {\n      text: parser.stringify(updatedJson, null, indentation) as string\n    }\n\n    setCodeMirrorContent(updatedContent, emitChange, false)\n\n    return {\n      json: updatedJson,\n      previousJson,\n      undo,\n      redo: operations\n    }\n  }\n\n  function handleFormat(): boolean {\n    debug('format')\n\n    if (readOnly) {\n      return false\n    }\n\n    try {\n      const updatedJson = parser.parse(text)\n      const updatedContent = {\n        text: parser.stringify(updatedJson, null, indentation) as string\n      }\n\n      setCodeMirrorContent(updatedContent, true, false)\n\n      askToFormatApplied = askToFormat // reset to the original value\n\n      return true\n    } catch (err) {\n      onError(err as Error)\n    }\n\n    return false\n  }\n\n  function handleCompact(): boolean {\n    debug('compact')\n\n    if (readOnly) {\n      return false\n    }\n\n    try {\n      const updatedJson = parser.parse(text)\n      const updatedContent = {\n        text: parser.stringify(updatedJson) as string\n      }\n\n      setCodeMirrorContent(updatedContent, true, false)\n\n      askToFormatApplied = false\n\n      return true\n    } catch (err) {\n      onError(err as Error)\n    }\n\n    return false\n  }\n\n  function handleRepair() {\n    debug('repair')\n\n    if (readOnly) {\n      return\n    }\n\n    try {\n      const updatedContent = {\n        text: jsonrepair(text)\n      }\n\n      setCodeMirrorContent(updatedContent, true, false)\n\n      jsonStatus = JSON_STATUS_VALID\n      jsonParseError = undefined\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  function handleSort() {\n    if (readOnly) {\n      return\n    }\n\n    try {\n      const json = parser.parse(text)\n\n      modalOpen = true\n\n      onSortModal({\n        id: sortModalId,\n        json,\n        rootPath: [],\n        onSort: async ({ operations }) => {\n          debug('onSort', operations)\n          handlePatch(operations, true)\n        },\n        onClose: () => {\n          modalOpen = false\n          focus()\n        }\n      })\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  /**\n   * This method is exposed via JSONEditor.transform\n   */\n  export function openTransformModal({\n    id,\n    rootPath,\n    onTransform,\n    onClose\n  }: TransformModalOptions) {\n    try {\n      const json = parser.parse(text)\n\n      modalOpen = true\n\n      onTransformModal({\n        id: id || transformModalId,\n        json,\n        rootPath: rootPath || [],\n        onTransform: (operations) => {\n          if (onTransform) {\n            onTransform({\n              operations,\n              json,\n              transformedJson: immutableJSONPatch(json, operations)\n            })\n          } else {\n            debug('onTransform', operations)\n            handlePatch(operations, true)\n          }\n        },\n        onClose: () => {\n          modalOpen = false\n          focus()\n          if (onClose) {\n            onClose()\n          }\n        }\n      })\n    } catch (err) {\n      onError(err as Error)\n    }\n  }\n\n  function handleTransform() {\n    if (readOnly) {\n      return\n    }\n\n    openTransformModal({\n      rootPath: []\n    })\n  }\n\n  function handleToggleSearch() {\n    if (codeMirrorView) {\n      // TODO: figure out the proper way to detect whether the search panel is open\n      if (codeMirrorRef && codeMirrorRef.querySelector('.cm-search')) {\n        closeSearchPanel(codeMirrorView)\n      } else {\n        openSearchPanel(codeMirrorView)\n      }\n    }\n  }\n\n  function handleUndo(): boolean {\n    if (readOnly) {\n      return false\n    }\n\n    // first flush any pending changes\n    flush()\n\n    const item = history.undo()\n    debug('undo', item)\n    if (!isTextHistoryItem(item)) {\n      onUndo(item)\n\n      return false\n    }\n\n    codeMirrorView.dispatch({\n      annotations: historyAnnotation.of('undo'),\n      changes: ChangeSet.fromJSON(item.undo.changes),\n      selection: EditorSelection.fromJSON(item.undo.selection),\n      scrollIntoView: true\n    })\n\n    return true\n  }\n\n  function handleRedo(): boolean {\n    if (readOnly) {\n      return false\n    }\n\n    // first flush any pending changes\n    flush()\n\n    const item = history.redo()\n    debug('redo', item)\n    if (!isTextHistoryItem(item)) {\n      onRedo(item)\n\n      return false\n    }\n\n    codeMirrorView.dispatch({\n      annotations: historyAnnotation.of('redo'),\n      changes: ChangeSet.fromJSON(item.redo.changes),\n      selection: EditorSelection.fromJSON(item.redo.selection),\n      scrollIntoView: true\n    })\n\n    return true\n  }\n\n  function handleAcceptTooLarge() {\n    acceptTooLarge = true\n    setCodeMirrorContent(externalContent, true, true)\n  }\n\n  function handleSwitchToTreeMode() {\n    onChangeMode(Mode.tree)\n  }\n\n  function cancelLoadTooLarge() {\n    // copy the latest contents of the text editor again into text\n    onChangeCodeMirrorValue()\n  }\n\n  function handleSelectValidationError(validationError: ValidationError) {\n    debug('select validation error', validationError)\n\n    const { from, to } = toRichValidationError(validationError)\n    if (from === undefined || to === undefined) {\n      return\n    }\n\n    // we take \"to\" as head, not as anchor, because the scrollIntoView will\n    // move to the head, and when a large whole object is selected as a whole,\n    // we want to scroll to the start of the object and not the end\n    setSelection(from, to)\n\n    focus()\n  }\n\n  function handleSelectParseError(parseError: ParseError) {\n    debug('select parse error', parseError)\n\n    const richParseError = toRichParseError(parseError, false)\n    const from = richParseError.from != null ? richParseError.from : 0\n    const to = richParseError.to != null ? richParseError.to : 0\n\n    // we take \"to\" as head, not as anchor, because the scrollIntoView will\n    // move to the head, and when a large whole object is selected as a whole,\n    // we want to scroll to the start of the object and not the end\n    setSelection(from, to)\n\n    focus()\n  }\n\n  function setSelection(anchor: number, head: number) {\n    debug('setSelection', { anchor, head })\n\n    if (codeMirrorView) {\n      codeMirrorView.dispatch(\n        codeMirrorView.state.update({\n          selection: { anchor, head },\n          scrollIntoView: true\n        })\n      )\n    }\n  }\n\n  function handleDoubleClick(_event: MouseEvent, view: EditorView) {\n    // When the user double-clicked right from a bracket [ or {,\n    // select the contents of the array or object\n    if (view.state.selection.ranges.length === 1) {\n      const range = view.state.selection.ranges[0]\n      const selectedText = text.slice(range.from, range.to)\n      if (selectedText === '{' || selectedText === '[') {\n        const jsmap = jsonSourceMap.parse(text)\n        const path = Object.keys(jsmap.pointers).find((path) => {\n          const pointer = jsmap.pointers[path]\n          return pointer.value?.pos === range.from\n        })\n        const pointer = jsmap.pointers[path]\n\n        if (path && pointer && pointer.value && pointer.valueEnd) {\n          debug('pointer found, selecting inner contents of path:', path, pointer)\n          const anchor = pointer.value.pos + 1\n          const head = pointer.valueEnd.pos - 1\n          setSelection(anchor, head)\n        }\n      }\n    }\n  }\n\n  function createLinter() {\n    return linter(linterCallback, { delay: TEXT_MODE_ONCHANGE_DELAY })\n  }\n\n  function createCodeMirrorView({\n    target,\n    initialText,\n    readOnly,\n    indentation\n  }: {\n    target: HTMLDivElement\n    initialText: string\n    readOnly: boolean\n    indentation: number | string\n  }): EditorView {\n    debug('Create CodeMirror editor', { readOnly, indentation })\n\n    const selection = isValidSelection(externalSelection, initialText)\n      ? fromTextSelection(externalSelection)\n      : undefined\n\n    const state = EditorState.create({\n      doc: initialText,\n      selection,\n      extensions: [\n        keymap.of([indentWithTab, formatCompactKeyBinding]),\n        linterCompartment.of(createLinter()),\n        lintGutter(),\n        lineNumbers(),\n        highlightActiveLineGutter(),\n        highlightSpecialChars(),\n        foldGutter(),\n        drawSelection(),\n        dropCursor(),\n        EditorState.allowMultipleSelections.of(true),\n        indentOnInput(),\n        syntaxHighlighting(defaultHighlightStyle, { fallback: true }),\n        bracketMatching(),\n        closeBrackets(),\n        autocompletion(),\n        rectangularSelection(),\n        crosshairCursor(),\n        highlightActiveLine(),\n        highlightSelectionMatches(),\n        keymap.of([\n          ...closeBracketsKeymap,\n          ...defaultKeymap,\n          ...searchKeymap,\n          { key: 'Mod-z', run: handleUndo, preventDefault: true },\n          { key: 'Mod-y', mac: 'Mod-Shift-z', run: handleRedo, preventDefault: true },\n          { key: 'Ctrl-Shift-z', run: handleRedo, preventDefault: true },\n          ...foldKeymap,\n          ...completionKeymap,\n          ...lintKeymap\n        ]),\n        highlighter,\n        indentationMarkers({ hideFirstIndent: true }),\n        EditorView.domEventHandlers({\n          dblclick: handleDoubleClick\n        }),\n        EditorView.updateListener.of((update) => {\n          editorState = update.state\n\n          if (update.docChanged) {\n            const isCustomHistoryEvent = update.transactions.some(\n              (transaction) => !!transaction.annotation(historyAnnotation)\n            )\n\n            if (!isCustomHistoryEvent) {\n              historyUpdatesQueue = [...(historyUpdatesQueue ?? []), update]\n            }\n\n            onChangeCodeMirrorValueDebounced()\n          }\n\n          if (update.selectionSet) {\n            // note that emitOnSelect is invoked in onChangeCodeMirrorValue too,\n            // right after firing onChange. Hence, the else if here, we do not want to fire it twice.\n            emitOnSelect()\n          }\n        }),\n        jsonLang(),\n        search({\n          top: true\n        }),\n        EditorView.lineWrapping,\n        readOnlyCompartment.of(EditorState.readOnly.of(readOnly)),\n        tabSizeCompartment.of(EditorState.tabSize.of(tabSize)),\n        indentCompartment.of(createIndent(indentation)),\n        themeCompartment.of(EditorView.theme({}, { dark: hasDarkTheme() }))\n      ]\n    })\n\n    codeMirrorView = new EditorView({\n      state,\n      parent: target\n    })\n\n    if (selection) {\n      // important to do via dispatch, since that is executed on the next tick.\n      // Otherwise, the editor is not scrolled down enough when the statusbar is rendered on the next tick\n      codeMirrorView.dispatch(\n        codeMirrorView.state.update({\n          selection: selection.main,\n          scrollIntoView: true // FIXME: scrollIntoView also affects scroll of the main page, possibly causing the main page to scroll when jsoneditor has an initial selection\n        })\n      )\n    }\n\n    return codeMirrorView\n  }\n\n  function getCodeMirrorValue() {\n    return codeMirrorView ? normalization.unescapeValue(codeMirrorView.state.doc.toString()) : ''\n  }\n\n  function hasDarkTheme() {\n    return codeMirrorRef\n      ? getComputedStyle(codeMirrorRef).getPropertyValue('--jse-theme').includes('dark')\n      : false\n  }\n\n  function isValidSelection(selection: JSONEditorSelection | undefined, text: string): boolean {\n    if (!isTextSelection(selection)) {\n      return false\n    }\n\n    return selection.ranges.every((range) => range.anchor < text.length && range.head < text.length)\n  }\n\n  function toRichValidationError(validationError: ValidationError): RichValidationError {\n    const { path, message, severity } = validationError\n    const { line, column, from, to } = findTextLocation(normalization.escapeValue(text), path)\n\n    return {\n      path,\n      line,\n      column,\n      from,\n      to,\n      message,\n      severity,\n      actions: []\n    }\n  }\n\n  function toRichParseError(parseError: ParseError, isRepairable: boolean): RichValidationError {\n    const { line, column, position, message } = parseError\n\n    return {\n      path: [] as JSONPath,\n      line,\n      column,\n      from: position,\n      to: position,\n      severity: ValidationSeverity.error,\n      message,\n      actions:\n        isRepairable && !readOnly\n          ? [\n              {\n                name: 'Auto repair',\n                apply: () => handleRepair()\n              }\n            ]\n          : undefined\n    }\n  }\n\n  function toDiagnostic(error: RichValidationError): Diagnostic {\n    return {\n      from: error.from || 0,\n      to: error.to || 0,\n      message: error.message || '',\n      actions: error.actions as Diagnostic['actions'],\n      severity: error.severity\n    }\n  }\n\n  function setCodeMirrorContent(newContent: Content, emitChange: boolean, forceUpdate: boolean) {\n    const newText = getText(newContent, indentation, parser)\n    const isChanged = !isEqual(newContent, content)\n    const previousContent = content\n\n    debug('setCodeMirrorContent', { isChanged, emitChange, forceUpdate })\n\n    if (!codeMirrorView || (!isChanged && !forceUpdate)) {\n      return\n    }\n\n    content = newContent\n    text = newText\n\n    if (!disableTextEditor(text, acceptTooLarge)) {\n      // keep state\n      // to reset state: codeMirrorView.setState(EditorState.create({doc: text, extensions: ...}))\n      codeMirrorView.dispatch({\n        changes: {\n          from: 0,\n          to: codeMirrorView.state.doc.length,\n          insert: normalization.escapeValue(text)\n        }\n      })\n    }\n\n    addHistoryItem()\n\n    if (isChanged && emitChange) {\n      emitOnChange(content, previousContent)\n    }\n  }\n\n  function applyExternalSelection(externalSelection: JSONEditorSelection | undefined) {\n    if (!isTextSelection(externalSelection)) {\n      return\n    }\n\n    const selection = fromTextSelection(externalSelection)\n    if (codeMirrorView && selection && (!editorState || !editorState.selection.eq(selection))) {\n      debug('applyExternalSelection', selection)\n\n      // note that we cannot clear the selection (we could maybe set the cursor to 0 but that's not really what we want)\n      codeMirrorView.dispatch({ selection })\n    }\n  }\n\n  function fromTextSelection(\n    selection: JSONEditorSelection | undefined\n  ): EditorSelection | undefined {\n    return isTextSelection(selection) ? EditorSelection.fromJSON(selection) : undefined\n  }\n\n  /**\n   * Force refreshing the editor, for example after changing the font size\n   * to update the positioning of the line numbers in the gutter\n   */\n  export async function refresh(): Promise<void> {\n    debug('refresh')\n\n    // update the theme (light/dark), but also, as a side effect,\n    // refresh the font size of the line numbers in the gutter\n    await updateTheme()\n  }\n\n  function forceUpdateText() {\n    debug('forceUpdateText', { escapeUnicodeCharacters })\n\n    if (codeMirrorView) {\n      codeMirrorView.dispatch({\n        changes: {\n          from: 0,\n          to: codeMirrorView.state.doc.length,\n          insert: normalization.escapeValue(text)\n        }\n      })\n    }\n  }\n\n  function onChangeCodeMirrorValue() {\n    if (!codeMirrorView) {\n      return\n    }\n\n    const codeMirrorText = getCodeMirrorValue()\n\n    const isChanged = codeMirrorText !== text\n    debug('onChangeCodeMirrorValue', { isChanged })\n    if (!isChanged) {\n      return\n    }\n\n    const previousContent = content\n    text = codeMirrorText\n    content = { text }\n\n    addHistoryItem()\n\n    emitOnChange(content, previousContent)\n\n    // We emit OnSelect on the next tick to cater for the case where\n    // the user changes the content directly inside the OnChange callback.\n    // This change will be dispatched by Svelte on the next tick. Before\n    // that tick, emitOnSelect would be fired based on the \"old\" contents,\n    // which may be out of range when the replacement by the user is shorter.\n    flushSync()\n    emitOnSelect()\n  }\n\n  function updateLinter(validator: Validator | undefined) {\n    debug('updateLinter', validator)\n\n    if (!codeMirrorView) {\n      return\n    }\n\n    codeMirrorView.dispatch({\n      effects: linterCompartment.reconfigure(createLinter())\n    })\n  }\n\n  function updateIndentation(indentation: number | string) {\n    if (codeMirrorView) {\n      debug('updateIndentation', indentation)\n\n      codeMirrorView.dispatch({\n        effects: indentCompartment.reconfigure(createIndent(indentation))\n      })\n    }\n  }\n\n  function updateTabSize(tabSize: number) {\n    if (codeMirrorView) {\n      debug('updateTabSize', tabSize)\n\n      codeMirrorView.dispatch({\n        effects: tabSizeCompartment.reconfigure(EditorState.tabSize.of(tabSize))\n      })\n    }\n  }\n\n  function updateReadOnly(readOnly: boolean) {\n    if (codeMirrorView) {\n      debug('updateReadOnly', readOnly)\n\n      codeMirrorView.dispatch({\n        effects: [readOnlyCompartment.reconfigure(EditorState.readOnly.of(readOnly))]\n      })\n    }\n  }\n\n  async function updateTheme(): Promise<void> {\n    // we check the theme on the next tick, to make sure the page\n    // is re-rendered with (possibly) changed CSS variables\n    flushSync()\n\n    if (codeMirrorView) {\n      const dark = hasDarkTheme()\n      debug('updateTheme', { dark })\n\n      codeMirrorView.dispatch({\n        effects: [themeCompartment.reconfigure(EditorView.theme({}, { dark }))]\n      })\n\n      // resolve on next tick, when code mirror rendering is updated\n      return new Promise((resolve) => setTimeout(resolve))\n    }\n\n    return Promise.resolve()\n  }\n\n  function createIndent(indentation: number | string): Extension[] {\n    const indent = indentUnit.of(\n      typeof indentation === 'number' ? ' '.repeat(indentation) : indentation\n    )\n\n    // We disable wrappedLineIndent in case of tabs to work around a bug:\n    // https://github.com/fauzi9331/codemirror-wrapped-line-indent/issues/2\n    return indentation === '\\t' ? [indent] : [indent, wrappedLineIndent]\n  }\n\n  // debounce the input: when pressing Enter at the end of a line, two change\n  // events are fired: one with the new Return character, and a second with\n  // indentation added on the new line. This causes a race condition when used\n  // for example in React. Debouncing the onChange events also results in not\n  // firing a change event with every character that a user types, but only as\n  // soon as the user stops typing.\n  const onChangeCodeMirrorValueDebounced = debounce(\n    onChangeCodeMirrorValue,\n    TEXT_MODE_ONCHANGE_DELAY\n  )\n\n  export function flush() {\n    onChangeCodeMirrorValueDebounced.flush()\n  }\n\n  function emitOnChange(content: Content, previousContent: Content) {\n    if (onChange) {\n      onChange(content, previousContent, {\n        contentErrors: validate(),\n        patchResult: undefined\n      })\n    }\n  }\n\n  function emitOnSelect() {\n    onSelect(toTextSelection(editorState.selection))\n  }\n\n  function toTextSelection(selection: EditorSelection): TextSelection {\n    return {\n      type: SelectionType.text,\n      ...selection.toJSON()\n    }\n  }\n\n  function disableTextEditor(text: string, acceptTooLarge: boolean): boolean {\n    const tooLarge = text ? text.length > MAX_DOCUMENT_SIZE_TEXT_MODE : false\n    return tooLarge && !acceptTooLarge\n  }\n\n  let jsonStatus = JSON_STATUS_VALID\n\n  let jsonParseError: ParseError | undefined\n\n  function linterCallback(): Diagnostic[] {\n    if (disableTextEditor(text, acceptTooLarge)) {\n      return []\n    }\n\n    const contentErrors = validate()\n\n    if (isContentParseError(contentErrors)) {\n      const { parseError, isRepairable } = contentErrors\n\n      return [toDiagnostic(toRichParseError(parseError, isRepairable))]\n    }\n\n    if (isContentValidationErrors(contentErrors)) {\n      return contentErrors.validationErrors.map(toRichValidationError).map(toDiagnostic)\n    }\n\n    return []\n  }\n\n  export function validate(): ContentErrors | undefined {\n    debug('validate:start')\n\n    flush()\n\n    const contentErrors = memoizedValidateText(\n      normalization.escapeValue(text),\n      validator,\n      parser,\n      validationParser\n    )\n\n    if (isContentParseError(contentErrors)) {\n      jsonStatus = contentErrors.isRepairable ? JSON_STATUS_REPAIRABLE : JSON_STATUS_INVALID\n      jsonParseError = contentErrors.parseError\n      validationErrors = []\n    } else {\n      jsonStatus = JSON_STATUS_VALID\n      jsonParseError = undefined\n      validationErrors = contentErrors?.validationErrors || []\n    }\n\n    debug('validate:end')\n\n    return contentErrors\n  }\n\n  // because onChange returns the validation errors and there is also a separate listener,\n  // we would execute validation twice. Memoizing the last result solves this.\n  const memoizedValidateText = memoizeOne(validateText)\n\n  function handleShowMe() {\n    if (jsonParseError) {\n      handleSelectParseError(jsonParseError)\n    }\n  }\n\n  const repairActionShowMe = {\n    icon: faEye,\n    text: 'Show me',\n    title: 'Move to the parse error location',\n    onClick: handleShowMe\n  }\n\n  $: repairActions =\n    jsonStatus === JSON_STATUS_REPAIRABLE && !readOnly\n      ? [\n          {\n            icon: faWrench,\n            text: 'Auto repair',\n            title: 'Automatically repair JSON',\n            onClick: handleRepair\n          },\n          repairActionShowMe\n        ]\n      : [repairActionShowMe]\n</script>\n\n<div class=\"jse-text-mode\" class:no-main-menu={!mainMenuBar} bind:this={domTextMode}>\n  {#if mainMenuBar}\n    {@const isNewDocument = text.length === 0}\n\n    <TextMenu\n      {readOnly}\n      onFormat={handleFormat}\n      onCompact={handleCompact}\n      onSort={handleSort}\n      onTransform={handleTransform}\n      onToggleSearch={handleToggleSearch}\n      onUndo={handleUndo}\n      onRedo={handleRedo}\n      canFormat={!isNewDocument}\n      canCompact={!isNewDocument}\n      canSort={!isNewDocument}\n      canTransform={!isNewDocument}\n      canUndo={history.canUndo}\n      canRedo={history.canRedo}\n      {onRenderMenu}\n    />\n  {/if}\n\n  {#if !isSSR}\n    {@const editorDisabled = disableTextEditor(text, acceptTooLarge)}\n\n    <div class=\"jse-contents\" class:jse-hidden={editorDisabled} bind:this={codeMirrorRef}></div>\n\n    {#if editorDisabled}\n      <Message\n        icon={faExclamationTriangle}\n        type=\"error\"\n        message={`The JSON document is larger than ${formatSize(MAX_DOCUMENT_SIZE_TEXT_MODE)}, ` +\n          `and may crash your browser when loading it in text mode. Actual size: ${formatSize(text.length)}.`}\n        actions={[\n          {\n            text: 'Open anyway',\n            title: 'Open the document in text mode. This may freeze or crash your browser.',\n            onClick: handleAcceptTooLarge\n          },\n          {\n            text: 'Open in tree mode',\n            title: 'Open the document in tree mode. Tree mode can handle large documents.',\n            onClick: handleSwitchToTreeMode\n          },\n          {\n            text: 'Cancel',\n            title: 'Cancel opening this large document.',\n            onClick: cancelLoadTooLarge\n          }\n        ]}\n        onClose={focus}\n      />\n\n      <div class=\"jse-contents jse-preview\">\n        {truncate(text || '', MAX_CHARACTERS_TEXT_PREVIEW)}\n      </div>\n    {/if}\n\n    {#if !editorDisabled}\n      {#if statusBar}\n        <StatusBar {editorState} />\n      {/if}\n\n      {#if jsonParseError}\n        <Message\n          type=\"error\"\n          icon={faExclamationTriangle}\n          message={jsonParseError.message}\n          actions={repairActions}\n          onClick={handleShowMe}\n          onClose={focus}\n        />\n      {/if}\n\n      {#if !jsonParseError && askToFormatApplied && needsFormatting(text)}\n        <Message\n          type=\"success\"\n          message=\"Do you want to format the JSON?\"\n          actions={[\n            {\n              icon: faJSONEditorFormat,\n              text: 'Format',\n              title: 'Format JSON: add proper indentation and new lines (Ctrl+I)',\n              onClick: handleFormat\n            },\n            {\n              icon: faTimes,\n              text: 'No thanks',\n              title: 'Close this message',\n              onClick: () => (askToFormatApplied = false)\n            }\n          ]}\n          onClose={focus}\n        />\n      {/if}\n\n      <ValidationErrorsOverview {validationErrors} selectError={handleSelectValidationError} />\n    {/if}\n  {:else}\n    <div class=\"jse-contents\">\n      <div class=\"jse-loading-space\"></div>\n      <div class=\"jse-loading\">loading...</div>\n    </div>\n  {/if}\n</div>\n\n<style src=\"./TextMode.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import {\n    faFilter,\n    faRedo,\n    faSearch,\n    faSortAmountDownAlt,\n    faUndo\n  } from '@fortawesome/free-solid-svg-icons'\n  import { faJSONEditorCompact, faJSONEditorFormat } from '$lib/img/customFontawesomeIcons.js'\n  import Menu from '../../../controls/Menu.svelte'\n  import type { MenuItem, OnRenderMenuInternal } from '$lib/types'\n\n  export let readOnly = false\n  export let onFormat: () => boolean\n  export let onCompact: () => boolean\n  export let onSort: () => void\n  export let onTransform: () => void\n  export let onToggleSearch: () => void\n  export let onUndo: () => void\n  export let onRedo: () => void\n  export let canUndo: boolean\n  export let canRedo: boolean\n  export let canFormat: boolean\n  export let canCompact: boolean\n  export let canSort: boolean\n  export let canTransform: boolean\n  export let onRenderMenu: OnRenderMenuInternal\n\n  const searchItem: MenuItem = {\n    type: 'button',\n    icon: faSearch,\n    title: 'Search (Ctrl+F)',\n    className: 'jse-search',\n    onClick: onToggleSearch\n  }\n\n  let defaultItems: MenuItem[]\n  $: defaultItems = !readOnly\n    ? [\n        {\n          type: 'button',\n          icon: faJSONEditorFormat,\n          title: 'Format JSON: add proper indentation and new lines (Ctrl+I)',\n          className: 'jse-format',\n          onClick: onFormat,\n          disabled: readOnly || !canFormat\n        },\n        {\n          type: 'button',\n          icon: faJSONEditorCompact,\n          title: 'Compact JSON: remove all white spacing and new lines (Ctrl+Shift+I)',\n          className: 'jse-compact',\n          onClick: onCompact,\n          disabled: readOnly || !canCompact\n        },\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faSortAmountDownAlt,\n          title: 'Sort',\n          className: 'jse-sort',\n          onClick: onSort,\n          disabled: readOnly || !canSort\n        },\n        {\n          type: 'button',\n          icon: faFilter,\n          title: 'Transform contents (filter, sort, project)',\n          className: 'jse-transform',\n          onClick: onTransform,\n          disabled: readOnly || !canTransform\n        },\n        searchItem,\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faUndo,\n          title: 'Undo (Ctrl+Z)',\n          className: 'jse-undo',\n          onClick: onUndo,\n          disabled: !canUndo\n        },\n        {\n          type: 'button',\n          icon: faRedo,\n          title: 'Redo (Ctrl+Shift+Z)',\n          className: 'jse-redo',\n          onClick: onRedo,\n          disabled: !canRedo\n        },\n        {\n          type: 'space'\n        }\n      ]\n    : [\n        searchItem,\n        {\n          type: 'space'\n        }\n      ]\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: items = onRenderMenu(defaultItems) || defaultItems\n</script>\n\n<Menu {items} />\n","<script lang=\"ts\">\n  import type { EditorState, Line } from '@codemirror/state'\n\n  export let editorState: EditorState | undefined\n\n  let pos: number | undefined\n  $: pos = editorState?.selection?.main?.head\n\n  let line: Line | undefined\n  $: line = pos !== undefined ? editorState?.doc?.lineAt(pos) : undefined\n\n  let lineNumber: number | undefined\n  $: lineNumber = line !== undefined ? line.number : undefined\n\n  let columnNumber: number | undefined\n  $: columnNumber = line !== undefined && pos !== undefined ? pos - line.from + 1 : undefined\n\n  let charCount: number | undefined\n  $: charCount = editorState?.selection?.ranges?.reduce((count, range) => {\n    return count + range.to - range.from\n  }, 0)\n</script>\n\n<div class=\"jse-status-bar\">\n  {#if lineNumber !== undefined}\n    <div class=\"jse-status-bar-info\">Line: {lineNumber}</div>\n  {/if}\n\n  {#if columnNumber !== undefined}\n    <div class=\"jse-status-bar-info\">Column: {columnNumber}</div>\n  {/if}\n\n  {#if charCount !== undefined && charCount > 0}\n    <div class=\"jse-status-bar-info\">Selection: {charCount} characters</div>\n  {/if}\n</div>\n\n<style src=\"./StatusBar.scss\"></style>\n","<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import { getIn, isJSONArray, isJSONObject } from 'immutable-json-patch'\n  import type { JSONParser, OnChangeMode } from '$lib/types.js'\n  import { Mode } from '$lib/types.js'\n  import { valueType } from '$lib/utils/typeUtils.js'\n  import { findNestedArrays } from '$lib/logic/table.js'\n  import { isEmpty } from 'lodash-es'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n\n  interface Props {\n    text: string | undefined\n    json: unknown | undefined\n    readOnly: boolean\n    parser: JSONParser\n    openJSONEditorModal: (path: JSONPath) => void\n    extractPath: (path: JSONPath) => void\n    onChangeMode: OnChangeMode\n    onClick: () => void\n  }\n\n  const {\n    text,\n    json,\n    readOnly,\n    parser,\n    openJSONEditorModal,\n    extractPath,\n    onChangeMode,\n    onClick\n  }: Props = $props()\n\n  const nestedArrayPaths: JSONPath[] = $derived(\n    json\n      ? findNestedArrays(json)\n          .slice(0, 99)\n          .filter((path) => path.length > 0)\n      : []\n  )\n  const hasNestedArrays = $derived(!isEmpty(nestedArrayPaths))\n  const isEmptyDocument = $derived(json === undefined && (text === '' || text === undefined))\n\n  const documentType = $derived(\n    hasNestedArrays\n      ? 'Object with nested arrays'\n      : isEmptyDocument\n        ? 'An empty document'\n        : isJSONObject(json)\n          ? 'An object'\n          : isJSONArray(json)\n            ? 'An empty array' // note: can also be an array with objects but without properties\n            : `A ${valueType(json, parser)}`\n  )\n\n  function countItems(nestedArrayPath: JSONPath): number {\n    return (getIn(json, nestedArrayPath) as JSONPath).length\n  }\n</script>\n\n<div class=\"jse-table-mode-welcome\" onclick={() => onClick()} role=\"none\">\n  <div class=\"jse-space jse-before\"></div>\n\n  <div class=\"jse-nested-arrays\">\n    <div class=\"jse-nested-arrays-title\">{documentType}</div>\n    <div class=\"jse-nested-arrays-info\">\n      {#if hasNestedArrays}\n        An object cannot be opened in table mode. You can open a nested array instead, or open the\n        document in tree mode.\n      {:else if isEmptyDocument && !readOnly}\n        An empty document cannot be opened in table mode. You can go to tree mode instead, or paste\n        a JSON Array using <b>Ctrl+V</b>.\n      {:else}\n        {documentType} cannot be opened in table mode. You can open the document in tree mode instead.\n      {/if}\n    </div>\n    {#each nestedArrayPaths as nestedArrayPath}\n      {@const count = countItems(nestedArrayPath)}\n\n      <div class=\"jse-nested-property\">\n        <div class=\"jse-nested-property-path\">\n          \"{stringifyJSONPath(nestedArrayPath)}\"\n          <span class=\"jse-nested-property-count\">({count} {count !== 1 ? 'items' : 'item'})</span>\n        </div>\n\n        <button\n          type=\"button\"\n          class=\"jse-nested-array-action\"\n          onclick={() => openJSONEditorModal(nestedArrayPath)}\n        >\n          {readOnly ? 'View' : 'Edit'}\n        </button>\n        {#if !readOnly}\n          <button\n            type=\"button\"\n            class=\"jse-nested-array-action\"\n            onclick={() => extractPath(nestedArrayPath)}\n          >\n            Extract\n          </button>\n        {/if}\n      </div>\n    {/each}\n    <button type=\"button\" class=\"jse-nested-array-action\" onclick={() => onChangeMode(Mode.tree)}>\n      Switch to tree mode\n    </button>\n  </div>\n\n  <div class=\"jse-space jse-after\"></div>\n</div>\n\n<style src=\"./TableModeWelcome.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type {\n    AbsolutePopupContext,\n    AbsolutePopupOptions,\n    AfterPatchCallback,\n    Content,\n    ContentErrors,\n    ContextMenuItem,\n    DocumentState,\n    History,\n    HistoryItem,\n    JSONEditorContext,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONRepairModalProps,\n    JSONSelection,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnFocus,\n    OnJSONEditorModal,\n    OnRedo,\n    OnRenderContextMenuInternal,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    OnUndo,\n    ParseError,\n    PastedJson,\n    ScrollToOptions,\n    SearchResultDetails,\n    SearchResults,\n    SortedColumn,\n    TransformModalOptions,\n    ValidationError,\n    Validator,\n    ValueNormalization\n  } from '$lib/types'\n  import { Mode, SortDirection, ValidationSeverity } from '$lib/types.js'\n  import TableMenu from './menu/TableMenu.svelte'\n  import {\n    compileJSONPointer,\n    existsIn,\n    getIn,\n    immutableJSONPatch,\n    isJSONArray,\n    type JSONPatchDocument,\n    type JSONPath\n  } from 'immutable-json-patch'\n  import {\n    isTextContent,\n    normalizeJsonParseError,\n    parseAndRepair,\n    parsePartialJson,\n    repairPartialJson\n  } from '../../../utils/jsonUtils.js'\n  import {\n    calculateAbsolutePosition,\n    calculateVisibleSection,\n    clearSortedColumnWhenAffectedByOperations,\n    getColumns,\n    groupValidationErrors,\n    maintainColumnOrder,\n    mergeValidationErrors,\n    selectNextColumn,\n    selectNextRow,\n    selectPreviousColumn,\n    selectPreviousRow,\n    toTableCellPosition\n  } from '$lib/logic/table.js'\n  import { isEmpty, isEqual, uniqueId } from 'lodash-es'\n  import {\n    activeElementIsChildOf,\n    createNormalizationFunctions,\n    encodeDataPath,\n    findParentWithNodeName,\n    getDataPathFromTarget,\n    getWindow,\n    isChildOf\n  } from '$lib/utils/domUtils.js'\n  import { createDebug } from '$lib/utils/debug.js'\n  import {\n    createDocumentState,\n    documentStatePatch,\n    getEnforceString,\n    getInRecursiveState,\n    setInDocumentState,\n    syncDocumentState\n  } from '$lib/logic/documentState.js'\n  import { isObjectOrArray, isUrl, stringConvert } from '$lib/utils/typeUtils.js'\n  import InlineValue from './tag/InlineValue.svelte'\n  import {\n    createNestedValueOperations,\n    extract,\n    revertJSONPatchWithMoveOperations\n  } from '$lib/logic/operations.js'\n  import {\n    createValueSelection,\n    getAnchorPath,\n    getFocusPath,\n    isEditingSelection,\n    isJSONSelection,\n    isValueSelection,\n    pathInSelection,\n    pathStartsWith,\n    removeEditModeFromSelection\n  } from '$lib/logic/selection.js'\n  import ColumnHeader from './ColumnHeader.svelte'\n  import { sortJson } from '$lib/logic/sort.js'\n  import { keyComboFromEvent } from '$lib/utils/keyBindings.js'\n  import { createFocusTracker } from '$lib/components/controls/createFocusTracker.js'\n  import { flushSync, getContext, onDestroy, onMount } from 'svelte'\n  import { jsonrepair } from 'jsonrepair'\n  import Message from '../../controls/Message.svelte'\n  import { faCheck, faCode, faWrench } from '@fortawesome/free-solid-svg-icons'\n  import { measure } from '$lib/utils/timeUtils.js'\n  import memoizeOne from 'memoize-one'\n  import { validateJSON } from '$lib/logic/validation.js'\n  import ValidationErrorsOverview from '../../controls/ValidationErrorsOverview.svelte'\n  import {\n    CONTEXT_MENU_HEIGHT,\n    CONTEXT_MENU_WIDTH,\n    SCROLL_DURATION,\n    SEARCH_BOX_HEIGHT\n  } from '$lib/constants.js'\n  import { noop } from '$lib/utils/noop.js'\n  import { createJump } from '$lib/assets/jump.js/src/jump.js'\n  import ValidationErrorIcon from '../treemode/ValidationErrorIcon.svelte'\n  import {\n    onCopy,\n    onCut,\n    onDuplicateRow,\n    onInsertAfterRow,\n    onInsertBeforeRow,\n    onInsertCharacter,\n    onPaste,\n    onRemove,\n    onRemoveRow\n  } from '$lib/logic/actions.js'\n  import JSONRepairModal from '../../modals/JSONRepairModal.svelte'\n  import { resizeObserver } from '$lib/actions/resizeObserver.js'\n  import CopyPasteModal from '../../../components/modals/CopyPasteModal.svelte'\n  import ContextMenuPointer from '../../../components/controls/contextmenu/ContextMenuPointer.svelte'\n  import SearchBox from '../../controls/SearchBox.svelte'\n  import TableModeWelcome from './TableModeWelcome.svelte'\n  import JSONPreview from '../../controls/JSONPreview.svelte'\n  import RefreshColumnHeader from './RefreshColumnHeader.svelte'\n  import createTableContextMenuItems from './contextmenu/createTableContextMenuItems'\n  import ContextMenu from '../../controls/contextmenu/ContextMenu.svelte'\n  import { flattenSearchResults, toRecursiveSearchResults } from '$lib/logic/search.js'\n  import JSONValue from '../treemode/JSONValue.svelte'\n  import { isTreeHistoryItem } from 'svelte-jsoneditor'\n\n  const debug = createDebug('jsoneditor:TableMode')\n  const { openAbsolutePopup, closeAbsolutePopup } =\n    getContext<AbsolutePopupContext>('absolute-popup')\n  const jump = createJump()\n  const sortModalId = uniqueId()\n  const transformModalId = uniqueId()\n\n  const isSSR = typeof window === 'undefined'\n  debug('isSSR:', isSSR)\n\n  export let readOnly: boolean\n  export let externalContent: Content\n  export let externalSelection: JSONEditorSelection | undefined\n  export let history: History<HistoryItem>\n  export let truncateTextSize: number\n  export let mainMenuBar: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let flattenColumns: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validator: Validator | undefined\n  export let validationParser: JSONParser\n  export let indentation: number | string\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onUndo: OnUndo\n  export let onRedo: OnRedo\n  export let onRenderValue: OnRenderValue\n  export let onRenderMenu: OnRenderMenuInternal\n  export let onRenderContextMenu: OnRenderContextMenuInternal\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n  export let onJSONEditorModal: OnJSONEditorModal\n\n  let normalization: ValueNormalization\n  $: normalization = createNormalizationFunctions({\n    escapeControlCharacters,\n    escapeUnicodeCharacters\n  })\n\n  let refJsonEditor: HTMLDivElement\n  let refContents: HTMLDivElement | undefined\n  let refHiddenInput: HTMLInputElement\n\n  let jsonRepairModalProps: JSONRepairModalProps | undefined = undefined\n\n  createFocusTracker({\n    onMount,\n    onDestroy,\n    getWindow: () => getWindow(refJsonEditor),\n    hasFocus: () => (modalOpen && document.hasFocus()) || activeElementIsChildOf(refJsonEditor),\n    onFocus: () => {\n      hasFocus = true\n      if (onFocus) {\n        onFocus()\n      }\n    },\n    onBlur: () => {\n      hasFocus = false\n      if (onBlur) {\n        onBlur()\n      }\n    }\n  })\n\n  let json: unknown | undefined\n  let text: string | undefined\n  let parseError: ParseError | undefined = undefined\n\n  let pastedJson: PastedJson | undefined\n  let pastedMultilineText: string | undefined\n\n  let searchResultDetails: SearchResultDetails | undefined\n  let searchResults: SearchResults | undefined\n  let showSearch = false\n  let showReplace = false\n\n  $: applySearchBoxSpacing(showSearch)\n\n  function applySearchBoxSpacing(showSearch: boolean) {\n    if (!refContents) {\n      return\n    }\n\n    const offset = showSearch ? SEARCH_BOX_HEIGHT : -SEARCH_BOX_HEIGHT\n    refContents.scrollTo({\n      top: (refContents.scrollTop += offset),\n      left: refContents.scrollLeft\n    })\n  }\n\n  function handleSearch(result: SearchResultDetails | undefined) {\n    searchResultDetails = result\n    searchResults = searchResultDetails\n      ? toRecursiveSearchResults(json, searchResultDetails.items)\n      : undefined\n  }\n\n  async function handleFocusSearch(path: JSONPath) {\n    selection = undefined // navigation path of current selection would be confusing\n    await scrollTo(path)\n  }\n\n  function handleCloseSearch() {\n    showSearch = false\n    showReplace = false\n    focus()\n  }\n\n  $: applyExternalContent(externalContent)\n  $: applyExternalSelection(externalSelection)\n\n  let maxSampleCount = 10_000\n  let columns: JSONPath[] = []\n  $: columns = isJSONArray(json)\n    ? maintainColumnOrder(getColumns(json, flattenColumns, maxSampleCount), columns)\n    : []\n\n  let containsValidArray: boolean\n  $: containsValidArray = !!(json && !isEmpty(columns))\n  $: showRefreshButton = Array.isArray(json) && json.length > maxSampleCount\n\n  // modalOpen is true when one of the modals is open.\n  // This is used to track whether the editor still has focus\n  let modalOpen = false\n\n  let hasFocus = false\n  let copyPasteModalOpen = false\n\n  let itemHeightsCache: Record<number, number> = {}\n\n  let viewPortHeight = 600\n  let scrollTop = 0\n  let defaultItemHeight = 18 // px\n\n  $: visibleSection = calculateVisibleSection(\n    scrollTop,\n    viewPortHeight,\n    json,\n    itemHeightsCache, // warning: itemHeightsCache is mutated and is not responsive itself\n    defaultItemHeight,\n    showSearch ? SEARCH_BOX_HEIGHT : 0\n  )\n\n  $: refreshScrollTop(json)\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  function refreshScrollTop(_json: unknown | undefined) {\n    // When the contents go from lots of items and scrollable contents to only a few items and\n    // no vertical scroll, the actual scrollTop changes to 0 but there is no on:scroll event\n    // triggered, so the internal scrollTop variable is not up-to-date.\n    // This is a workaround to update the scrollTop by triggering an on:scroll event\n    if (refContents) {\n      refContents.scrollTo({\n        top: refContents.scrollTop,\n        left: refContents.scrollLeft\n      })\n    }\n  }\n\n  function handleSelect(updatedSelection: JSONSelection | undefined) {\n    selection = updatedSelection\n  }\n\n  function emitOnSelect(updatedSelection: JSONSelection | undefined) {\n    if (!isEqual(updatedSelection, externalSelection)) {\n      debug('onSelect', updatedSelection)\n      onSelect(updatedSelection)\n    }\n  }\n\n  $: emitOnSelect(selection)\n\n  function clearSelectionWhenNotExisting(json: unknown | undefined) {\n    if (!selection || json === undefined) {\n      return\n    }\n\n    if (existsIn(json, getAnchorPath(selection)) && existsIn(json, getFocusPath(selection))) {\n      return\n    }\n\n    debug('clearing selection: path does not exist anymore', selection)\n    selection = undefined // TODO: try find the closest cell that still exists (similar to getInitialSelection)\n  }\n\n  let documentState: DocumentState | undefined =\n    json !== undefined ? createDocumentState({ json }) : undefined\n  let selection: JSONSelection | undefined = isJSONSelection(externalSelection)\n    ? externalSelection\n    : undefined\n  let sortedColumn: SortedColumn | undefined\n  let textIsRepaired = false\n\n  onMount(() => {\n    if (selection) {\n      scrollIntoView(getFocusPath(selection))\n    }\n  })\n\n  function onSortByHeader(newSortedColumn: SortedColumn) {\n    if (readOnly) {\n      return\n    }\n\n    debug('onSortByHeader', newSortedColumn)\n\n    const rootPath: JSONPath = []\n    const direction = newSortedColumn.sortDirection === SortDirection.desc ? -1 : 1\n    const operations = sortJson(json, rootPath, newSortedColumn.path, direction)\n    handlePatch(operations, (_, patchedState) => {\n      return {\n        state: patchedState,\n        sortedColumn: newSortedColumn\n      }\n    })\n  }\n\n  let context: JSONEditorContext\n  $: context = {\n    mode: Mode.table,\n    readOnly,\n    truncateTextSize,\n    parser,\n    normalization,\n    getJson: () => json,\n    getDocumentState: () => documentState,\n    findElement,\n    findNextInside,\n    focus,\n    onPatch: (operations, afterPatch) => {\n      // When having flattened table columns and having inserted a new row, it is possible that\n      // we edit a nested value of which the parent object is not existing. Therefore, we call\n      // replaceNestedValue to create the parent object(s) first.\n      return handlePatch(createNestedValueOperations(operations, json), afterPatch)\n    },\n    onSelect: handleSelect,\n    onFind: openFind,\n    onPasteJson: handlePasteJson,\n    onRenderValue\n  }\n\n  function applyExternalContent(content: Content) {\n    const currentContent = { json }\n    const isChanged = isTextContent(content)\n      ? content.text !== text\n      : !isEqual(currentContent.json, content.json)\n\n    debug('update external content', { isChanged })\n\n    if (!isChanged) {\n      // no actual change, don't do anything\n      return\n    }\n\n    const previousState = { json, documentState, selection, sortedColumn, text, textIsRepaired }\n\n    if (isTextContent(content)) {\n      try {\n        json = parseMemoizeOne(content.text)\n        documentState = syncDocumentState(json, documentState)\n        text = content.text\n        textIsRepaired = false\n        parseError = undefined\n      } catch (err) {\n        try {\n          json = parseMemoizeOne(jsonrepair(content.text))\n          documentState = syncDocumentState(json, documentState)\n          text = content.text\n          textIsRepaired = true\n          parseError = undefined\n        } catch {\n          // no valid JSON, will show empty document or invalid json\n          json = undefined\n          documentState = undefined\n          text = content.text\n          textIsRepaired = false\n          parseError =\n            text !== ''\n              ? normalizeJsonParseError(text, (err as Error).message || String(err))\n              : undefined\n        }\n      }\n    } else {\n      json = content.json\n      documentState = syncDocumentState(json, documentState)\n      text = undefined\n      textIsRepaired = false\n      parseError = undefined\n    }\n\n    // make sure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    // reset the sorting order (we don't know...)\n    sortedColumn = undefined\n\n    addHistoryItem(previousState)\n  }\n\n  function applyExternalSelection(externalSelection: JSONEditorSelection | undefined) {\n    if (isEqual(selection, externalSelection)) {\n      return\n    }\n\n    debug('applyExternalSelection', { selection, externalSelection })\n\n    if (isJSONSelection(externalSelection)) {\n      selection = externalSelection\n    }\n  }\n\n  interface PreviousState {\n    json: unknown | undefined\n    text: string | undefined\n    documentState: DocumentState | undefined\n    selection: JSONSelection | undefined\n    textIsRepaired: boolean\n    sortedColumn: SortedColumn | undefined\n  }\n\n  function addHistoryItem(previous: PreviousState) {\n    if (previous.json === undefined && previous.text === undefined) {\n      // initialization -> do not create a history item\n      return\n    }\n\n    const canPatch = json !== undefined && previous.json !== undefined\n\n    history.add({\n      type: 'tree',\n      undo: {\n        patch: canPatch ? [{ op: 'replace', path: '', value: previous.json }] : undefined,\n        json: previous.json,\n        text: previous.text,\n        documentState: previous.documentState,\n        textIsRepaired: previous.textIsRepaired,\n        selection: removeEditModeFromSelection(previous.selection),\n        sortedColumn: previous.sortedColumn\n      },\n      redo: {\n        patch: canPatch ? [{ op: 'replace', path: '', value: json }] : undefined,\n        json,\n        text,\n        documentState,\n        textIsRepaired,\n        selection: removeEditModeFromSelection(selection),\n        sortedColumn\n      }\n    })\n  }\n\n  let validationErrors: ValidationError[] = []\n  $: updateValidationErrors(json, validator, parser, validationParser)\n  $: groupedValidationErrors = groupValidationErrors(validationErrors, columns)\n\n  // because onChange returns the validation errors and there is also a separate listener,\n  // we would execute validation twice. Memoizing the last result solves this.\n  const memoizedValidate = memoizeOne(validateJSON)\n\n  function updateValidationErrors(\n    json: unknown,\n    validator: Validator | undefined,\n    parser: JSONParser,\n    validationParser: JSONParser\n  ) {\n    measure(\n      () => {\n        let newValidationErrors: ValidationError[]\n        try {\n          newValidationErrors = memoizedValidate(json, validator, parser, validationParser)\n        } catch (err) {\n          newValidationErrors = [\n            {\n              path: [],\n              message: 'Failed to validate: ' + (err as Error).message,\n              severity: ValidationSeverity.warning\n            }\n          ]\n        }\n\n        if (!isEqual(newValidationErrors, validationErrors)) {\n          debug('validationErrors changed:', newValidationErrors)\n          validationErrors = newValidationErrors\n        }\n      },\n      (duration) => debug(`validationErrors updated in ${duration} ms`)\n    )\n  }\n\n  export function validate(): ContentErrors | undefined {\n    debug('validate')\n\n    if (parseError) {\n      return {\n        parseError,\n        isRepairable: false // not applicable, if repairable, we will not have a parseError\n      }\n    }\n\n    // make sure the validation results are up-to-date\n    // normally, they are only updated on the next tick after the json is changed\n    updateValidationErrors(json, validator, parser, validationParser)\n    return !isEmpty(validationErrors) ? { validationErrors } : undefined\n  }\n\n  export function patch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('patch', operations, afterPatch)\n\n    if (json === undefined) {\n      throw new Error('Cannot apply patch: no JSON')\n    }\n\n    const previousJson = json\n    const previousState: PreviousState = {\n      json: undefined, // not needed: we use patch to reconstruct the json\n      text,\n      documentState,\n      selection: removeEditModeFromSelection(selection),\n      sortedColumn,\n      textIsRepaired\n    }\n\n    // execute the patch operations\n    const undo: JSONPatchDocument = revertJSONPatchWithMoveOperations(\n      json,\n      operations\n    ) as JSONPatchDocument\n    const patched = documentStatePatch(json, documentState, operations)\n\n    // Clear the sorted column when needed. We need to do this before `afterPatch`,\n    // else we clear any changed made in the callback. It is a bit odd that\n    // afterPatch does not receive the actual previousDocumentState. Better ideas?\n    const patchedSortedColumn = clearSortedColumnWhenAffectedByOperations(\n      sortedColumn,\n      operations,\n      columns\n    )\n\n    const callback =\n      typeof afterPatch === 'function'\n        ? afterPatch(patched.json, patched.documentState, selection)\n        : undefined\n\n    json = callback?.json !== undefined ? callback.json : patched.json\n    documentState = callback?.state !== undefined ? callback.state : patched.documentState\n    selection = callback?.selection !== undefined ? callback.selection : selection\n    sortedColumn =\n      callback?.sortedColumn !== undefined ? callback.sortedColumn : patchedSortedColumn\n    text = undefined\n    textIsRepaired = false\n    pastedJson = undefined\n    pastedMultilineText = undefined\n    parseError = undefined\n\n    history.add({\n      type: 'tree',\n      undo: {\n        patch: undo,\n        ...previousState\n      },\n      redo: {\n        patch: operations,\n        json: undefined, // not needed: we use patch to reconstruct the json\n        text: undefined,\n        documentState,\n        selection: removeEditModeFromSelection(selection),\n        sortedColumn,\n        textIsRepaired\n      }\n    })\n\n    return {\n      json,\n      previousJson,\n      undo,\n      redo: operations\n    }\n  }\n\n  function handlePatch(\n    operations: JSONPatchDocument,\n    afterPatch?: AfterPatchCallback\n  ): JSONPatchResult {\n    debug('handlePatch', operations, afterPatch)\n\n    const previousContent = { json, text }\n    const patchResult = patch(operations, afterPatch)\n\n    emitOnChange(previousContent, patchResult)\n\n    return patchResult\n  }\n\n  function emitOnChange(previousContent: Content, patchResult: JSONPatchResult | undefined) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    if (previousContent.json === undefined && previousContent?.text === undefined) {\n      // initialization -> do not fire an onChange event\n      return\n    }\n\n    // make sure we cannot send an invalid contents like having both\n    // json and text defined, or having none defined\n    if (onChange) {\n      if (text !== undefined) {\n        const content = { text, json: undefined }\n        onChange(content, previousContent, {\n          contentErrors: validate(),\n          patchResult\n        })\n      } else if (json !== undefined) {\n        const content = { text: undefined, json }\n        onChange(content, previousContent, {\n          contentErrors: validate(),\n          patchResult\n        })\n      }\n    }\n  }\n\n  function handlePasteJson(newPastedJson: PastedJson) {\n    debug('pasted json as text', newPastedJson)\n\n    pastedJson = newPastedJson\n  }\n\n  function handlePasteMultilineText(pastedText: string) {\n    debug('pasted multiline text', { pastedText })\n\n    pastedMultilineText = pastedText\n  }\n\n  function findNextInside(path: JSONPath): JSONSelection {\n    const index = parseInt(path[0], 10)\n    const nextPath = [String(index + 1), ...path.slice(1)]\n\n    return existsIn(json, nextPath) ? createValueSelection(nextPath) : createValueSelection(path)\n  }\n\n  export function focus() {\n    debug('focus')\n    // with just .focus(), sometimes the input doesn't react on onpaste events\n    // in Chrome when having a large document open and then doing cut/paste.\n    // Calling both .focus() and .select() did solve this issue.\n    if (refHiddenInput) {\n      refHiddenInput.focus()\n      refHiddenInput.select()\n    }\n  }\n\n  function handleWindowMouseDown(event: MouseEvent & { currentTarget: EventTarget & Window }) {\n    const outsideEditor = !isChildOf(\n      event.target as Element,\n      (element) => element === refJsonEditor\n    )\n    if (outsideEditor) {\n      if (isEditingSelection(selection)) {\n        debug('click outside the editor, exit edit mode')\n        selection = removeEditModeFromSelection(selection)\n\n        if (hasFocus && refHiddenInput) {\n          refHiddenInput.focus()\n          refHiddenInput.blur()\n        }\n\n        debug('blur (outside editor)')\n        if (refHiddenInput) {\n          refHiddenInput.blur()\n        }\n      }\n    }\n  }\n\n  function handleScroll(event: Event) {\n    scrollTop = (event.target as HTMLElement)['scrollTop']\n  }\n\n  function handleMouseDown(event: MouseEvent) {\n    // only handle when the left or right mouse button is pressed, not the middle mouse button (scroll wheel)\n    if (event.buttons !== 1 && event.buttons !== 2) {\n      return\n    }\n\n    const target = event.target as HTMLElement\n    if (!target.isContentEditable) {\n      focus()\n    }\n\n    const path = getDataPathFromTarget(target)\n    if (path) {\n      // when clicking inside the current selection, editing a value, do nothing\n      if (isEditingSelection(selection) && pathInSelection(json, selection, path)) {\n        return\n      }\n\n      selection = createValueSelection(path)\n\n      event.preventDefault()\n    }\n  }\n\n  function createDefaultSelection(): JSONSelection | undefined {\n    if (isJSONArray(json) && !isEmpty(json) && !isEmpty(columns)) {\n      // Select the first row, first column\n      const path = ['0', ...columns[0]]\n\n      return createValueSelection(path)\n    } else {\n      return undefined\n    }\n  }\n\n  function createDefaultSelectionWhenUndefined() {\n    if (!selection) {\n      selection = createDefaultSelection()\n    }\n  }\n\n  export function acceptAutoRepair() {\n    if (textIsRepaired && json !== undefined) {\n      const previousContent = { json, text }\n      const previousState = { json, documentState, selection, sortedColumn, text, textIsRepaired }\n\n      // json stays as is\n      text = undefined\n      textIsRepaired = false\n\n      clearSelectionWhenNotExisting(json)\n\n      addHistoryItem(previousState)\n\n      // we could work out a patchResult, or use patch(), but only when the previous and new\n      // contents are both json and not text. We go for simplicity and consistency here and\n      // do _not_ return a patchResult ever.\n      const patchResult = undefined\n\n      emitOnChange(previousContent, patchResult)\n    }\n\n    return { json, text }\n  }\n\n  /**\n   * Scroll the window vertically to the node with given path.\n   * Expand the path when needed.\n   */\n  export function scrollTo(\n    path: JSONPath,\n    { scrollToWhenVisible = true }: ScrollToOptions = {}\n  ): Promise<void> {\n    const searchBoxHeight = showSearch ? SEARCH_BOX_HEIGHT : 0\n    const top = calculateAbsolutePosition(path, columns, itemHeightsCache, defaultItemHeight)\n    const roughDistance = top - scrollTop + searchBoxHeight + defaultItemHeight\n    const elem = findElement(path)\n\n    debug('scrollTo', { path, top, scrollTop, elem })\n\n    if (!refContents) {\n      return Promise.resolve()\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    if (elem && !scrollToWhenVisible) {\n      const elemRect = elem.getBoundingClientRect()\n      if (elemRect.bottom > viewPortRect.top && elemRect.top < viewPortRect.bottom) {\n        // element is fully or partially visible, don't scroll to it\n        return Promise.resolve()\n      }\n    }\n\n    const offset = -Math.max(searchBoxHeight + 2 * defaultItemHeight, viewPortRect.height / 4)\n\n    if (elem) {\n      return new Promise((resolve) => {\n        jump(elem, {\n          container: refContents,\n          offset,\n          duration: SCROLL_DURATION,\n          callback: () => {\n            // TODO: improve horizontal scrolling: animate and integrate with the vertical scrolling (jump)\n            scrollToHorizontal(path)\n            resolve()\n          }\n        })\n      })\n    } else {\n      return new Promise((resolve) => {\n        jump(roughDistance, {\n          container: refContents,\n          offset,\n          duration: SCROLL_DURATION,\n          callback: () => {\n            // ensure the element is rendered now that it is scrolled into view\n            flushSync()\n\n            // TODO: improve horizontal scrolling: animate and integrate with the vertical scrolling (jump)\n            scrollToHorizontal(path)\n            resolve()\n          }\n        })\n      })\n    }\n  }\n\n  function scrollToVertical(path: JSONPath) {\n    if (!refContents) {\n      return\n    }\n\n    const { rowIndex } = toTableCellPosition(path, columns)\n    const top = calculateAbsolutePosition(path, columns, itemHeightsCache, defaultItemHeight)\n    const bottom = top + (itemHeightsCache[rowIndex] || defaultItemHeight)\n\n    const headerHeight = defaultItemHeight\n    const viewPortRect = refContents.getBoundingClientRect()\n    const viewPortTop = scrollTop\n    const viewPortBottom = scrollTop + viewPortRect.height - headerHeight\n\n    if (bottom > viewPortBottom) {\n      const diff = bottom - viewPortBottom\n      refContents.scrollTop += diff\n    }\n\n    if (top < viewPortTop) {\n      const diff = viewPortTop - top\n      refContents.scrollTop -= diff\n    }\n  }\n\n  function scrollToHorizontal(path: JSONPath) {\n    const elem = findElement(path)\n    if (!elem || !refContents) {\n      return\n    }\n\n    const viewPortRect = refContents.getBoundingClientRect()\n    const elemRect = elem.getBoundingClientRect() // TODO: scroll to column instead of item (is always rendered)\n\n    if (elemRect.right > viewPortRect.right) {\n      const diff = elemRect.right - viewPortRect.right\n      refContents.scrollLeft += diff\n    }\n\n    if (elemRect.left < viewPortRect.left) {\n      const diff = viewPortRect.left - elemRect.left\n      refContents.scrollLeft -= diff\n    }\n  }\n\n  function scrollIntoView(path: JSONPath) {\n    scrollToVertical(path)\n    scrollToHorizontal(path)\n  }\n\n  /**\n   * Find the DOM element of a given path.\n   * Note that the path can only be found when the node is expanded.\n   */\n  export function findElement(path: JSONPath): Element | undefined {\n    const column = columns.find((c) => pathStartsWith(path.slice(1), c))\n\n    const resolvedPath = column ? path.slice(0, 1).concat(column) : path\n\n    return (\n      refContents?.querySelector(`td[data-path=\"${encodeDataPath(resolvedPath)}\"]`) ?? undefined\n    )\n  }\n\n  function openContextMenu({\n    anchor,\n    left,\n    top,\n    width,\n    height,\n    offsetTop,\n    offsetLeft,\n    showTip\n  }: AbsolutePopupOptions) {\n    const defaultItems: ContextMenuItem[] = createTableContextMenuItems({\n      json,\n      documentState,\n      selection,\n      readOnly,\n\n      onEditValue: handleEditValue,\n      onEditRow: handleEditRow,\n      onToggleEnforceString: handleToggleEnforceString,\n\n      onCut: handleCut,\n      onCopy: handleCopy,\n      onPaste: handlePasteFromMenu,\n\n      onRemove: handleRemove,\n      onDuplicateRow: handleDuplicateRow,\n      onInsertBeforeRow: handleInsertBeforeRow,\n      onInsertAfterRow: handleInsertAfterRow,\n      onRemoveRow: handleRemoveRow\n    })\n\n    const items = onRenderContextMenu(defaultItems) ?? defaultItems\n\n    if (items === false) {\n      return\n    }\n\n    const props = {\n      tip: showTip\n        ? 'Tip: you can open this context menu via right-click or with Ctrl+Q'\n        : undefined,\n      items,\n      onRequestClose: function () {\n        closeAbsolutePopup(popupId)\n        focus()\n      }\n    }\n\n    const options = {\n      left,\n      top,\n      offsetTop,\n      offsetLeft,\n      width,\n      height,\n      anchor,\n      closeOnOuterClick: true,\n      onClose: () => {\n        modalOpen = false\n        focus()\n      }\n    }\n\n    modalOpen = true\n\n    const popupId = openAbsolutePopup(ContextMenu, props, options)\n  }\n\n  function handleContextMenu(event: Event) {\n    if (isEditingSelection(selection)) {\n      return\n    }\n\n    if (event) {\n      event.stopPropagation()\n      event.preventDefault()\n    }\n\n    if (event && event.type === 'contextmenu' && event.target !== refHiddenInput) {\n      // right mouse click to open context menu\n      openContextMenu({\n        left: (event as MouseEvent).clientX,\n        top: (event as MouseEvent).clientY,\n        width: CONTEXT_MENU_WIDTH,\n        height: CONTEXT_MENU_HEIGHT,\n        showTip: false\n      })\n    } else {\n      // type === 'keydown' (from the quick key Ctrl+Q)\n      // or target is hidden input -> context menu button on keyboard\n      const anchor = refContents?.querySelector('.jse-table-cell.jse-selected-value')\n      if (anchor) {\n        openContextMenu({\n          anchor,\n          offsetTop: 2,\n          width: CONTEXT_MENU_WIDTH,\n          height: CONTEXT_MENU_HEIGHT,\n          showTip: false\n        })\n      } else {\n        // fallback on just displaying the TreeContextMenu top left\n        const rect = refContents?.getBoundingClientRect()\n        if (rect) {\n          openContextMenu({\n            top: rect.top + 2,\n            left: rect.left + 2,\n            width: CONTEXT_MENU_WIDTH,\n            height: CONTEXT_MENU_HEIGHT,\n            showTip: false\n          })\n        }\n      }\n    }\n  }\n\n  function handleContextMenuFromTableMenu(event: MouseEvent) {\n    openContextMenu({\n      anchor: findParentWithNodeName(event.target as HTMLElement, 'BUTTON'),\n      offsetTop: 0,\n      width: CONTEXT_MENU_WIDTH,\n      height: CONTEXT_MENU_HEIGHT,\n      showTip: true\n    })\n  }\n\n  function handleEditValue() {\n    if (readOnly || !selection) {\n      return\n    }\n\n    const path = getFocusPath(selection)\n    const value = getIn(json, path)\n    if (isObjectOrArray(value)) {\n      openJSONEditorModal(path)\n    } else {\n      selection = createValueSelection(path)\n    }\n  }\n\n  function handleEditRow() {\n    if (readOnly || !selection) {\n      return\n    }\n\n    const path = getFocusPath(selection)\n    const pathRow = path.slice(0, 1)\n    openJSONEditorModal(pathRow)\n  }\n\n  function handleToggleEnforceString() {\n    if (readOnly || !isValueSelection(selection)) {\n      return\n    }\n\n    const path = selection.path\n    const pointer = compileJSONPointer(path)\n    const value = getIn(json, path)\n    const enforceString = !getEnforceString(json, documentState, path)\n    const updatedValue = enforceString ? String(value) : stringConvert(String(value), parser)\n\n    debug('handleToggleEnforceString', { enforceString, value, updatedValue })\n\n    handlePatch(\n      [\n        {\n          op: 'replace',\n          path: pointer,\n          value: updatedValue\n        }\n      ],\n      (_, patchedState) => {\n        return {\n          state: setInDocumentState(json, patchedState, path, { type: 'value', enforceString })\n        }\n      }\n    )\n  }\n\n  async function handleParsePastedJson() {\n    debug('apply pasted json', pastedJson)\n    if (!pastedJson) {\n      return\n    }\n\n    const { onPasteAsJson } = pastedJson\n    onPasteAsJson()\n\n    // TODO: get rid of the setTimeout here\n    setTimeout(focus)\n  }\n\n  async function handlePasteFromMenu() {\n    try {\n      const clipboardText = await navigator.clipboard.readText()\n\n      _paste(clipboardText)\n    } catch (err) {\n      console.error(err)\n\n      copyPasteModalOpen = true\n    }\n  }\n\n  async function handleParsePastedMultilineText() {\n    debug('apply pasted multiline text', pastedMultilineText)\n    if (!pastedMultilineText) {\n      return\n    }\n\n    _paste(JSON.stringify(pastedMultilineText))\n\n    // TODO: get rid of the setTimeout here\n    setTimeout(focus)\n  }\n\n  function handleClearPastedJson() {\n    debug('clear pasted json')\n    pastedJson = undefined\n    focus()\n  }\n\n  function handleClearPastedMultilineText() {\n    debug('clear pasted multiline text')\n    pastedMultilineText = undefined\n    focus()\n  }\n\n  function handleRequestRepair() {\n    onChangeMode(Mode.text)\n  }\n\n  async function handleCut(indent: boolean) {\n    await onCut({\n      json,\n      selection,\n      indentation: indent ? indentation : undefined,\n      readOnly,\n      parser,\n      onPatch: handlePatch\n    })\n  }\n\n  async function handleCopy(indent = true) {\n    if (json === undefined) {\n      return\n    }\n\n    await onCopy({\n      json,\n      selection,\n      indentation: indent ? indentation : undefined,\n      parser\n    })\n  }\n\n  function handleRemove() {\n    onRemove({\n      json,\n      text,\n      selection,\n      keepSelection: true,\n      readOnly,\n      onChange,\n      onPatch: handlePatch\n    })\n  }\n\n  function handleExtract(path: JSONPath) {\n    if (readOnly) {\n      return\n    }\n\n    debug('extract', { path })\n\n    const operations = extract(json, createValueSelection(path))\n\n    handlePatch(operations)\n  }\n\n  function handleDuplicateRow() {\n    onDuplicateRow({ json, selection, columns, readOnly, onPatch: handlePatch })\n  }\n\n  function handleInsertBeforeRow() {\n    onInsertBeforeRow({ json, selection, columns, readOnly, onPatch: handlePatch })\n  }\n\n  function handleInsertAfterRow() {\n    onInsertAfterRow({ json, selection, columns, readOnly, onPatch: handlePatch })\n  }\n\n  function handleRemoveRow() {\n    onRemoveRow({ json, selection, columns, readOnly, onPatch: handlePatch })\n  }\n\n  async function handleInsertCharacter(char: string) {\n    await onInsertCharacter({\n      char,\n      selectInside: false,\n      json,\n      selection: selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onReplaceJson: handleReplaceJson,\n      onSelect: handleSelect\n    })\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    const combo = keyComboFromEvent(event)\n    debug('keydown', { combo, key: event.key })\n\n    if (combo === 'Ctrl+X') {\n      // cut formatted\n      event.preventDefault()\n      handleCut(true)\n    }\n    if (combo === 'Ctrl+Shift+X') {\n      // cut compact\n      event.preventDefault()\n      handleCut(false)\n    }\n    if (combo === 'Ctrl+C') {\n      // copy formatted\n      event.preventDefault()\n      handleCopy(true)\n    }\n    if (combo === 'Ctrl+Shift+C') {\n      // copy compact\n      event.preventDefault()\n      handleCopy(false)\n    }\n    // Note: Ctrl+V (paste) is handled by the on:paste event\n\n    if (combo === 'Ctrl+D') {\n      event.preventDefault()\n      handleDuplicateRow()\n    }\n    if (combo === 'Delete' || combo === 'Backspace') {\n      event.preventDefault()\n      handleRemove()\n    }\n    if (combo === 'Insert') {\n      event.preventDefault()\n      // TODO: implement insert\n    }\n    if (combo === 'Ctrl+A') {\n      event.preventDefault()\n      // selection = selectAll()\n      // TODO: implement select all\n    }\n\n    if (combo === 'Ctrl+Q') {\n      handleContextMenu(event)\n    }\n\n    if (combo === 'ArrowLeft') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (selection) {\n        const newSelection = selectPreviousColumn(columns, selection)\n        selection = newSelection\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'ArrowRight') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (selection) {\n        const newSelection = selectNextColumn(columns, selection)\n        selection = newSelection\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'ArrowUp') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (selection) {\n        const newSelection = selectPreviousRow(columns, selection)\n        selection = newSelection\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'ArrowDown') {\n      event.preventDefault()\n\n      createDefaultSelectionWhenUndefined()\n\n      if (selection) {\n        const newSelection = selectNextRow(json, columns, selection)\n        selection = newSelection\n        scrollIntoView(getFocusPath(newSelection))\n      }\n    }\n\n    if (combo === 'Enter' && selection) {\n      if (isValueSelection(selection)) {\n        event.preventDefault()\n\n        const path = selection.path\n        const value = getIn(json, path)\n        if (isObjectOrArray(value)) {\n          // edit nested object/array\n          openJSONEditorModal(path)\n        } else {\n          if (!readOnly) {\n            // go to value edit mode\n            selection = { ...selection, edit: true }\n          }\n        }\n      }\n    }\n\n    const normalizedCombo = combo.replace(/^Shift\\+/, '') // replace 'Shift+A' with 'A'\n    if (normalizedCombo.length === 1 && selection) {\n      // a regular key like a, A, _, etc is entered.\n      // Replace selected contents with a new value having this first character as text\n      event.preventDefault()\n      handleInsertCharacter(event.key)\n      return\n    }\n\n    if (combo === 'Ctrl+Enter' && isValueSelection(selection)) {\n      event.preventDefault()\n\n      const value = getIn(json, selection.path)\n\n      if (isUrl(value)) {\n        // open url in new page\n        window.open(String(value), '_blank')\n      }\n    }\n\n    if (combo === 'Escape' && selection) {\n      event.preventDefault()\n      selection = undefined\n    }\n\n    if (combo === 'Ctrl+F') {\n      event.preventDefault()\n      openFind(false)\n    }\n\n    if (combo === 'Ctrl+H') {\n      event.preventDefault()\n      openFind(true)\n    }\n\n    if (combo === 'Ctrl+Z') {\n      event.preventDefault()\n\n      handleUndo()\n    }\n\n    if (combo === 'Ctrl+Shift+Z') {\n      event.preventDefault()\n\n      handleRedo()\n    }\n  }\n\n  function handlePaste(event: ClipboardEvent) {\n    event.preventDefault()\n\n    const clipboardText = event.clipboardData?.getData('text/plain')\n\n    _paste(clipboardText)\n  }\n\n  function _paste(clipboardText: string | undefined) {\n    if (clipboardText === undefined) {\n      return\n    }\n\n    onPaste({\n      clipboardText,\n      json,\n      selection,\n      readOnly,\n      parser,\n      onPatch: handlePatch,\n      onChangeText: handleChangeText,\n      onPasteMultilineText: handlePasteMultilineText,\n      openRepairModal\n    })\n  }\n\n  // TODO: this function is duplicated from TreeMode. See if we can reuse the code instead\n  function handleReplaceJson(updatedJson: unknown, afterPatch?: AfterPatchCallback) {\n    const previousContent = { json, text }\n    const previousState = { json, documentState, selection, sortedColumn, text, textIsRepaired }\n\n    const updatedState = syncDocumentState(updatedJson, documentState)\n\n    const callback =\n      typeof afterPatch === 'function'\n        ? afterPatch(updatedJson, updatedState, selection)\n        : undefined\n\n    json = callback?.json !== undefined ? callback.json : updatedJson\n    documentState = callback?.state !== undefined ? callback.state : updatedState\n    selection = callback?.selection !== undefined ? callback.selection : selection\n    sortedColumn = undefined // we can't know whether the new json is still sorted or not\n    text = undefined\n    textIsRepaired = false\n    parseError = undefined\n\n    // make sure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem(previousState)\n\n    // we could work out a patchResult, or use patch(), but only when the previous and new\n    // contents are both json and not text. We go for simplicity and consistency here and\n    // do _not_ return a patchResult ever.\n    const patchResult = undefined\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  // TODO: this function is duplicated from TreeMode. See if we can reuse the code instead\n  function handleChangeText(updatedText: string, afterPatch?: AfterPatchCallback) {\n    debug('handleChangeText')\n\n    const previousContent = { json, text }\n    const previousState = { json, documentState, selection, sortedColumn, text, textIsRepaired }\n\n    try {\n      json = parseMemoizeOne(updatedText)\n      documentState = syncDocumentState(json, documentState)\n      text = undefined\n      textIsRepaired = false\n      parseError = undefined\n    } catch (err) {\n      try {\n        json = parseMemoizeOne(jsonrepair(updatedText))\n        documentState = syncDocumentState(json, documentState)\n        text = updatedText\n        textIsRepaired = true\n        parseError = undefined\n      } catch {\n        // no valid JSON, will show empty document or invalid json\n        json = undefined\n        documentState = undefined\n        text = updatedText\n        textIsRepaired = false\n        parseError =\n          text !== ''\n            ? normalizeJsonParseError(text, (err as Error).message || String(err))\n            : undefined\n      }\n    }\n\n    if (typeof afterPatch === 'function') {\n      const callback = afterPatch(json, documentState, selection)\n\n      json = callback?.json !== undefined ? callback.json : json\n      documentState = callback?.state !== undefined ? callback.state : documentState\n      selection = callback?.selection !== undefined ? callback.selection : selection\n    }\n\n    // ensure the selection is valid\n    clearSelectionWhenNotExisting(json)\n\n    addHistoryItem(previousState)\n\n    // no JSON patch actions available in text mode\n    const patchResult = undefined\n\n    emitOnChange(previousContent, patchResult)\n  }\n\n  function handleSelectValidationError(error: ValidationError) {\n    debug('select validation error', error)\n\n    selection = createValueSelection(error.path)\n\n    scrollTo(error.path)\n  }\n\n  function openSortModal(rootPath: JSONPath) {\n    if (readOnly || json === undefined) {\n      return\n    }\n\n    modalOpen = true\n\n    onSortModal({\n      id: sortModalId,\n      json,\n      rootPath,\n      onSort: ({ operations, itemPath, direction }) => {\n        debug('onSort', operations, rootPath, itemPath, direction)\n\n        handlePatch(operations, (_, patchedState) => {\n          return {\n            state: patchedState,\n            sortedColumn: {\n              path: itemPath,\n              sortDirection: direction === -1 ? SortDirection.desc : SortDirection.asc\n            }\n          }\n        })\n      },\n      onClose: () => {\n        modalOpen = false\n        setTimeout(focus)\n      }\n    })\n  }\n\n  /**\n   * This method is exposed via JSONEditor.transform\n   */\n  export function openTransformModal(options: TransformModalOptions) {\n    if (json === undefined) {\n      return\n    }\n\n    const { id, onTransform, onClose } = options\n    const rootPath = options.rootPath || []\n\n    modalOpen = true\n\n    onTransformModal({\n      id: id || transformModalId,\n      json,\n      rootPath: rootPath || [],\n      onTransform: (operations) => {\n        if (onTransform) {\n          onTransform({\n            operations,\n            json: json,\n            transformedJson: immutableJSONPatch(json, operations)\n          })\n        } else {\n          debug('onTransform', rootPath, operations)\n\n          handlePatch(operations)\n        }\n      },\n      onClose: () => {\n        modalOpen = false\n        setTimeout(focus)\n        if (onClose) {\n          onClose()\n        }\n      }\n    })\n  }\n\n  function openJSONEditorModal(path: JSONPath) {\n    debug('openJSONEditorModal', { path })\n\n    modalOpen = true\n\n    // open a popup where you can edit the nested object/array\n    onJSONEditorModal({\n      content: {\n        json: getIn(json, path)\n      },\n      path,\n      onPatch: handlePatch,\n      onClose: () => {\n        modalOpen = false\n        setTimeout(focus)\n      }\n    })\n  }\n\n  function openRepairModal(text: string, onApply: (repairedText: string) => void) {\n    jsonRepairModalProps = {\n      text,\n      onParse: (text) => parsePartialJson(text, (t) => parseAndRepair(t, parser)),\n      onRepair: repairPartialJson,\n      onApply,\n      onClose: focus\n    }\n  }\n\n  function handleSortAll() {\n    const rootPath: JSONPath = []\n    openSortModal(rootPath)\n  }\n\n  function handleTransformAll() {\n    openTransformModal({\n      rootPath: []\n    })\n  }\n\n  function openFind(findAndReplace: boolean): void {\n    debug('openFind', { findAndReplace })\n\n    showSearch = false\n    showReplace = false\n\n    flushSync()\n\n    // trick to make sure the focus goes to the search box\n    showSearch = true\n    showReplace = findAndReplace\n  }\n\n  function handleUndo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.canUndo) {\n      return\n    }\n\n    const item = history.undo()\n    if (!isTreeHistoryItem(item)) {\n      onUndo(item)\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.undo.patch ? immutableJSONPatch(json, item.undo.patch) : item.undo.json\n    documentState = item.undo.documentState\n    selection = item.undo.selection\n    sortedColumn = item.undo.sortedColumn\n    text = item.undo.text\n    textIsRepaired = item.undo.textIsRepaired\n    parseError = undefined\n\n    debug('undo', { item, json })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.undo.patch,\n            undo: item.redo.patch\n          }\n        : undefined\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (selection) {\n      scrollTo(getFocusPath(selection), { scrollToWhenVisible: false })\n    }\n  }\n\n  function handleRedo() {\n    if (readOnly) {\n      return\n    }\n\n    if (!history.canRedo) {\n      return\n    }\n\n    const item = history.redo()\n    if (!isTreeHistoryItem(item)) {\n      onRedo(item)\n      return\n    }\n\n    const previousContent = { json, text }\n\n    json = item.redo.patch ? immutableJSONPatch(json, item.redo.patch) : item.redo.json\n    documentState = item.redo.documentState\n    selection = item.redo.selection\n    sortedColumn = item.redo.sortedColumn\n    text = item.redo.text\n    textIsRepaired = item.redo.textIsRepaired\n    parseError = undefined\n\n    debug('redo', { item, json })\n\n    const patchResult =\n      item.undo.patch && item.redo.patch\n        ? {\n            json,\n            previousJson: previousContent.json,\n            redo: item.redo.patch,\n            undo: item.undo.patch\n          }\n        : undefined\n\n    emitOnChange(previousContent, patchResult)\n\n    focus()\n    if (selection) {\n      scrollTo(getFocusPath(selection), { scrollToWhenVisible: false })\n    }\n  }\n\n  function handleResizeContents(element: Element) {\n    viewPortHeight = element.getBoundingClientRect().height\n  }\n\n  function handleResizeRow(element: Element, rowIndex: number) {\n    itemHeightsCache[rowIndex] = element.getBoundingClientRect().height\n  }\n</script>\n\n<svelte:window on:mousedown={handleWindowMouseDown} />\n\n<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n<div\n  role=\"table\"\n  class=\"jse-table-mode\"\n  class:no-main-menu={!mainMenuBar}\n  on:mousedown={handleMouseDown}\n  on:keydown={handleKeyDown}\n  on:contextmenu={handleContextMenu}\n  bind:this={refJsonEditor}\n>\n  {#if mainMenuBar}\n    <TableMenu\n      {containsValidArray}\n      {readOnly}\n      bind:showSearch\n      {history}\n      onSort={handleSortAll}\n      onTransform={handleTransformAll}\n      onUndo={handleUndo}\n      onRedo={handleRedo}\n      onContextMenu={handleContextMenuFromTableMenu}\n      {onRenderMenu}\n    />\n  {/if}\n\n  {#if !isSSR}\n    <label class=\"jse-hidden-input-label\">\n      <input\n        type=\"text\"\n        readonly={true}\n        tabindex=\"-1\"\n        class=\"jse-hidden-input\"\n        bind:this={refHiddenInput}\n        on:paste={handlePaste}\n      />\n    </label>\n    {#if containsValidArray}\n      <div class=\"jse-search-box-container\">\n        <SearchBox\n          {json}\n          {documentState}\n          {parser}\n          {showSearch}\n          {showReplace}\n          {readOnly}\n          {columns}\n          onSearch={handleSearch}\n          onFocus={handleFocusSearch}\n          onPatch={handlePatch}\n          onClose={handleCloseSearch}\n        />\n      </div>\n      <div\n        class=\"jse-contents\"\n        bind:this={refContents}\n        use:resizeObserver={handleResizeContents}\n        on:scroll={handleScroll}\n      >\n        <table class=\"jse-table-main\">\n          <tbody>\n            <tr class=\"jse-table-row jse-table-row-header\">\n              <th class=\"jse-table-cell jse-table-cell-header\">\n                {#if !isEmpty(groupedValidationErrors?.root)}\n                  {@const validationError = mergeValidationErrors(\n                    [],\n                    groupedValidationErrors?.root\n                  )}\n                  {#if validationError}\n                    <div class=\"jse-table-root-error\">\n                      <ValidationErrorIcon {validationError} onExpand={noop} />\n                    </div>\n                  {/if}\n                {/if}\n              </th>\n              {#each columns as column}\n                <th class=\"jse-table-cell jse-table-cell-header\">\n                  <ColumnHeader path={column} {sortedColumn} {readOnly} onSort={onSortByHeader} />\n                </th>\n              {/each}\n              {#if showRefreshButton}\n                <th class=\"jse-table-cell jse-table-cell-header\">\n                  <RefreshColumnHeader\n                    count={Array.isArray(json) ? json.length : 0}\n                    {maxSampleCount}\n                    {readOnly}\n                    onRefresh={() => (maxSampleCount = Infinity)}\n                  />\n                </th>\n              {/if}\n            </tr>\n            <tr\n              class=\"jse-table-invisible-start-section\"\n              class:jse-search-box-background={showSearch}\n            >\n              <td style:height={visibleSection.startHeight + 'px'} colspan={columns.length}></td>\n            </tr>\n            {#each visibleSection.visibleItems as item, visibleIndex}\n              {@const rowIndex = visibleSection.startIndex + visibleIndex}\n              {@const validationErrorsByRow = groupedValidationErrors.rows[rowIndex]}\n              {@const validationError = mergeValidationErrors(\n                [String(rowIndex)],\n                validationErrorsByRow?.row\n              )}\n              {@const searchResultByRow = getInRecursiveState(json, searchResults, [\n                String(rowIndex)\n              ])}\n              <tr class=\"jse-table-row\">\n                {#key rowIndex}\n                  <th\n                    class=\"jse-table-cell jse-table-cell-gutter\"\n                    use:resizeObserver={(element) => handleResizeRow(element, rowIndex)}\n                  >\n                    {rowIndex}\n                    {#if validationError}\n                      <ValidationErrorIcon {validationError} onExpand={noop} />\n                    {/if}\n                  </th>\n                {/key}\n                {#each columns as column, columnIndex}\n                  {@const path = [String(rowIndex)].concat(column)}\n                  {@const value = getIn(item, column)}\n                  {@const isSelected =\n                    isValueSelection(selection) && pathStartsWith(selection.path, path)}\n                  {@const validationErrorsByColumn = validationErrorsByRow?.columns[columnIndex]}\n                  {@const validationError = mergeValidationErrors(path, validationErrorsByColumn)}\n                  <td class=\"jse-table-cell\" data-path={encodeDataPath(path)}>\n                    <div class=\"jse-value-outer\" class:jse-selected-value={isSelected}>\n                      {#if isObjectOrArray(value)}\n                        {@const searchResultsByCell = flattenSearchResults(\n                          getInRecursiveState(item, searchResultByRow, column)\n                        )}\n\n                        {@const containsActiveSearchResult = searchResultsByCell\n                          ? searchResultsByCell.some((item) => item.active)\n                          : false}\n\n                        <InlineValue\n                          {path}\n                          {value}\n                          {parser}\n                          {isSelected}\n                          containsSearchResult={!isEmpty(searchResultsByCell)}\n                          {containsActiveSearchResult}\n                          onEdit={openJSONEditorModal}\n                        />{:else}\n                        {@const searchResultItemsByCell = getInRecursiveState(\n                          json,\n                          searchResults,\n                          path\n                        )?.searchResults}\n\n                        <JSONValue\n                          {path}\n                          value={value !== undefined ? value : ''}\n                          enforceString={getEnforceString(json, documentState, path)}\n                          selection={isSelected ? selection : undefined}\n                          searchResultItems={searchResultItemsByCell}\n                          {context}\n                        />{/if}{#if !readOnly && isSelected && !isEditingSelection(selection)}\n                        <div class=\"jse-context-menu-anchor\">\n                          <ContextMenuPointer selected={true} onContextMenu={openContextMenu} />\n                        </div>\n                      {/if}\n                    </div>\n                    {#if validationError}\n                      <ValidationErrorIcon {validationError} onExpand={noop} />\n                    {/if}\n                  </td>\n                {/each}\n                {#if showRefreshButton}\n                  <td class=\"jse-table-cell\"></td>\n                {/if}\n              </tr>\n            {/each}\n\n            <tr class=\"jse-table-invisible-end-section\">\n              <td style:height={visibleSection.endHeight + 'px'} colspan={columns.length}></td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      {#if pastedJson}\n        <Message\n          type=\"info\"\n          message={`You pasted a JSON ${\n            Array.isArray(pastedJson.contents) ? 'array' : 'object'\n          } as text`}\n          actions={[\n            {\n              icon: faWrench,\n              text: 'Paste as JSON instead',\n              title: 'Paste the text as JSON instead of a single value',\n              // We use mousedown here instead of click: this message pops up\n              // whilst the user is editing a value. When clicking this button,\n              // the actual value is applied and the event is not propagated\n              // and an onClick on this button never happens.\n              onMouseDown: handleParsePastedJson\n            },\n            {\n              text: 'Leave as is',\n              title: 'Keep the pasted content as a single value',\n              onClick: handleClearPastedJson\n            }\n          ]}\n        />\n      {/if}\n\n      {#if pastedMultilineText}\n        <Message\n          type=\"info\"\n          message=\"Multiline text was pasted as array\"\n          actions={[\n            {\n              icon: faWrench,\n              text: 'Paste as string instead',\n              title: 'Paste the clipboard data as a single string value instead of an array',\n              onClick: handleParsePastedMultilineText\n            },\n            {\n              text: 'Leave as is',\n              title: 'Keep the pasted array',\n              onClick: handleClearPastedMultilineText\n            }\n          ]}\n        />\n      {/if}\n\n      {#if textIsRepaired}\n        <Message\n          type=\"success\"\n          message=\"The loaded JSON document was invalid but is successfully repaired.\"\n          actions={!readOnly\n            ? [\n                {\n                  icon: faCheck,\n                  text: 'Ok',\n                  title: 'Accept the repaired document',\n                  onClick: acceptAutoRepair\n                },\n                {\n                  icon: faCode,\n                  text: 'Repair manually instead',\n                  title: 'Leave the document unchanged and repair it manually instead',\n                  onClick: handleRequestRepair\n                }\n              ]\n            : []}\n          onClose={focus}\n        />\n      {/if}\n\n      <ValidationErrorsOverview {validationErrors} selectError={handleSelectValidationError} />\n    {:else if parseError && text !== undefined && text !== ''}\n      <Message\n        type=\"error\"\n        message=\"The loaded JSON document is invalid and could not be repaired automatically.\"\n        actions={!readOnly\n          ? [\n              {\n                icon: faCode,\n                text: 'Repair manually',\n                title: 'Open the document in \"code\" mode and repair it manually',\n                onClick: handleRequestRepair\n              }\n            ]\n          : []}\n      />\n      <JSONPreview {text} {json} {indentation} {parser} />\n    {:else}\n      <TableModeWelcome\n        {text}\n        {json}\n        {readOnly}\n        {parser}\n        {openJSONEditorModal}\n        extractPath={handleExtract}\n        {onChangeMode}\n        onClick={() => {\n          // FIXME: this is a workaround for the editor not putting the focus on refHiddenInput\n          //  when clicking in the welcome screen so you cannot paste a document from clipboard.\n          focus()\n        }}\n      />\n    {/if}\n  {:else}\n    <div class=\"jse-contents jse-contents-loading\">\n      <div class=\"jse-loading-space\"></div>\n      <div class=\"jse-loading\">loading...</div>\n    </div>\n  {/if}\n</div>\n\n{#if copyPasteModalOpen}\n  <CopyPasteModal onClose={() => (copyPasteModalOpen = false)} />\n{/if}\n\n{#if jsonRepairModalProps}\n  <JSONRepairModal\n    {...jsonRepairModalProps}\n    onClose={() => {\n      jsonRepairModalProps?.onClose()\n      jsonRepairModalProps = undefined\n    }}\n  />\n{/if}\n\n<style src=\"./TableMode.scss\"></style>\n","import type { ContextMenuItem, DocumentState, JSONSelection } from 'svelte-jsoneditor'\nimport {\n  faCheckSquare,\n  faClone,\n  faCopy,\n  faCut,\n  faPaste,\n  faPen,\n  faPlus,\n  faSquare,\n  faTrashCan\n} from '@fortawesome/free-solid-svg-icons'\nimport { isKeySelection, isMultiSelection, isValueSelection } from '$lib/logic/selection'\nimport { getIn } from 'immutable-json-patch'\nimport { getFocusPath, singleItemSelected } from '$lib/logic/selection'\nimport { isObjectOrArray } from '$lib/utils/typeUtils'\nimport { getEnforceString } from '$lib/logic/documentState'\n\nexport default function ({\n  json,\n  documentState,\n  selection,\n  readOnly,\n  onEditValue,\n  onEditRow,\n  onToggleEnforceString,\n  onCut,\n  onCopy,\n  onPaste,\n  onRemove,\n  onDuplicateRow,\n  onInsertBeforeRow,\n  onInsertAfterRow,\n  onRemoveRow\n}: {\n  json: unknown | undefined\n  documentState: DocumentState | undefined\n  selection: JSONSelection | undefined\n  readOnly: boolean\n  onEditValue: () => void\n  onEditRow: () => void\n  onToggleEnforceString: () => void\n  onCut: (indent: boolean) => void\n  onCopy: (indent: boolean) => void\n  onPaste: () => void\n  onRemove: () => void\n  onDuplicateRow: () => void\n  onInsertBeforeRow: () => void\n  onInsertAfterRow: () => void\n  onRemoveRow: () => void\n}): ContextMenuItem[] {\n  const hasJson = json !== undefined\n  const hasSelection = !!selection\n  const focusValue =\n    json !== undefined && selection ? getIn(json, getFocusPath(selection)) : undefined\n\n  const hasSelectionContents =\n    hasJson &&\n    (isMultiSelection(selection) || isKeySelection(selection) || isValueSelection(selection))\n\n  const canEditValue =\n    !readOnly && hasJson && selection !== undefined && singleItemSelected(selection)\n  const canEnforceString = canEditValue && !isObjectOrArray(focusValue)\n\n  const canCut = !readOnly && hasSelectionContents\n\n  const enforceString =\n    selection !== undefined ? getEnforceString(json, documentState, getFocusPath(selection)) : false\n\n  return [\n    { type: 'separator' },\n    {\n      type: 'row',\n      items: [\n        {\n          type: 'column',\n          items: [\n            { type: 'label', text: 'Table cell:' },\n            {\n              type: 'dropdown-button',\n              main: {\n                type: 'button',\n                onClick: () => onEditValue(),\n                icon: faPen,\n                text: 'Edit',\n                title: 'Edit the value (Double-click on the value)',\n                disabled: !canEditValue\n              },\n              width: '11em',\n              items: [\n                {\n                  type: 'button',\n                  icon: faPen,\n                  text: 'Edit',\n                  title: 'Edit the value (Double-click on the value)',\n                  onClick: () => onEditValue(),\n                  disabled: !canEditValue\n                },\n                {\n                  type: 'button',\n                  icon: enforceString ? faCheckSquare : faSquare,\n                  text: 'Enforce string',\n                  title: 'Enforce keeping the value as string when it contains a numeric value',\n                  onClick: () => onToggleEnforceString(),\n                  disabled: !canEnforceString\n                }\n              ]\n            },\n            {\n              type: 'dropdown-button',\n              main: {\n                type: 'button',\n                onClick: () => onCut(true),\n                icon: faCut,\n                text: 'Cut',\n                title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n                disabled: !canCut\n              },\n              width: '10em',\n              items: [\n                {\n                  type: 'button',\n                  icon: faCut,\n                  text: 'Cut formatted',\n                  title: 'Cut selected contents, formatted with indentation (Ctrl+X)',\n                  onClick: () => onCut(true),\n                  disabled: readOnly || !hasSelectionContents\n                },\n                {\n                  type: 'button',\n                  icon: faCut,\n                  text: 'Cut compacted',\n                  title: 'Cut selected contents, without indentation (Ctrl+Shift+X)',\n                  onClick: () => onCut(false),\n                  disabled: readOnly || !hasSelectionContents\n                }\n              ]\n            },\n            {\n              type: 'dropdown-button',\n              main: {\n                type: 'button',\n                onClick: () => onCopy(true),\n                icon: faCopy,\n                text: 'Copy',\n                title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n                disabled: !hasSelectionContents\n              },\n              width: '12em',\n              items: [\n                {\n                  type: 'button',\n                  icon: faCopy,\n                  text: 'Copy formatted',\n                  title: 'Copy selected contents, formatted with indentation (Ctrl+C)',\n                  onClick: () => onCopy(false),\n                  disabled: !hasSelectionContents\n                },\n                {\n                  type: 'button',\n                  icon: faCopy,\n                  text: 'Copy compacted',\n                  title: 'Copy selected contents, without indentation (Ctrl+Shift+C)',\n                  onClick: () => onCopy(false),\n                  disabled: !hasSelectionContents\n                }\n              ]\n            },\n            {\n              type: 'button',\n              onClick: () => onPaste(),\n              icon: faPaste,\n              text: 'Paste',\n              title: 'Paste clipboard contents (Ctrl+V)',\n              disabled: readOnly || !hasSelection\n            },\n            {\n              type: 'button',\n              onClick: () => onRemove(),\n              icon: faTrashCan,\n              text: 'Remove',\n              title: 'Remove selected contents (Delete)',\n              disabled: readOnly || !hasSelectionContents\n            }\n          ]\n        },\n        {\n          type: 'column',\n          items: [\n            { type: 'label', text: 'Table row:' },\n            {\n              type: 'button',\n              onClick: () => onEditRow(),\n              icon: faPen,\n              text: 'Edit row',\n              title: 'Edit the current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onDuplicateRow(),\n              icon: faClone,\n              text: 'Duplicate row',\n              title: 'Duplicate the current row (Ctrl+D)',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onInsertBeforeRow(),\n              icon: faPlus,\n              text: 'Insert before',\n              title: 'Insert a row before the current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onInsertAfterRow(),\n              icon: faPlus,\n              text: 'Insert after',\n              title: 'Insert a row after the current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            },\n            {\n              type: 'button',\n              onClick: () => onRemoveRow(),\n              icon: faTrashCan,\n              text: 'Remove row',\n              title: 'Remove current row',\n              disabled: readOnly || !hasSelection || !hasJson\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { HistoryItem, History, MenuItem, OnRenderMenuInternal } from '$lib/types'\n  import Menu from '../../../controls/Menu.svelte'\n  import {\n    faEllipsisV,\n    faFilter,\n    faRedo,\n    faSearch,\n    faSortAmountDownAlt,\n    faUndo\n  } from '@fortawesome/free-solid-svg-icons'\n  import { CONTEXT_MENU_EXPLANATION } from '$lib/constants.js'\n\n  export let containsValidArray: boolean\n  export let readOnly: boolean\n  export let showSearch = false\n  export let history: History<HistoryItem>\n  export let onSort: () => void\n  export let onTransform: () => void\n  export let onContextMenu: (event: MouseEvent) => void\n  export let onUndo: () => void\n  export let onRedo: () => void\n  export let onRenderMenu: OnRenderMenuInternal\n\n  function handleToggleSearch() {\n    showSearch = !showSearch\n  }\n\n  let defaultItems: MenuItem[]\n  $: defaultItems = !readOnly\n    ? [\n        {\n          type: 'button',\n          icon: faSortAmountDownAlt,\n          title: 'Sort',\n          className: 'jse-sort',\n          onClick: onSort,\n          disabled: readOnly || !containsValidArray\n        },\n        {\n          type: 'button',\n          icon: faFilter,\n          title: 'Transform contents (filter, sort, project)',\n          className: 'jse-transform',\n          onClick: onTransform,\n          disabled: readOnly || !containsValidArray\n        },\n        {\n          type: 'button',\n          icon: faSearch,\n          title: 'Search (Ctrl+F)',\n          className: 'jse-search',\n          onClick: handleToggleSearch,\n          disabled: !containsValidArray\n        },\n        {\n          type: 'button',\n          icon: faEllipsisV,\n          title: CONTEXT_MENU_EXPLANATION,\n          className: 'jse-contextmenu',\n          onClick: onContextMenu\n        },\n        {\n          type: 'separator'\n        },\n        {\n          type: 'button',\n          icon: faUndo,\n          title: 'Undo (Ctrl+Z)',\n          className: 'jse-undo',\n          onClick: onUndo,\n          disabled: !history.canUndo\n        },\n        {\n          type: 'button',\n          icon: faRedo,\n          title: 'Redo (Ctrl+Shift+Z)',\n          className: 'jse-redo',\n          onClick: onRedo,\n          disabled: !history.canRedo\n        },\n        {\n          type: 'space'\n        }\n      ]\n    : [\n        {\n          type: 'space'\n        }\n      ]\n\n  let items: MenuItem[]\n  $: items = onRenderMenu(defaultItems) || defaultItems\n</script>\n\n<Menu {items} />\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import type { SortedColumn } from '$lib/types.js'\n  import { SortDirection } from '$lib/types.js'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import Icon from 'svelte-awesome'\n  import { faCaretDown, faCaretUp } from '@fortawesome/free-solid-svg-icons'\n  import { isEmpty, isEqual } from 'lodash-es'\n  import { MAX_HEADER_NAME_CHARACTERS, SORT_DIRECTION_NAMES } from '$lib/constants.js'\n  import { truncate } from '$lib/utils/stringUtils.js'\n\n  export let path: JSONPath\n  export let sortedColumn: SortedColumn | undefined\n  export let readOnly: boolean\n  export let onSort: (sortedColumn: SortedColumn) => void\n\n  // TODO: improve truncating of long column names when they are a deeply nested path: the last item from the path should be visible, and halfway the path is least interesting\n  $: columnName = !isEmpty(path) ? stringifyJSONPath(path) : 'values'\n\n  $: sortDirection =\n    sortedColumn && isEqual(path, sortedColumn?.path) ? sortedColumn.sortDirection : undefined\n\n  $: sortDirectionName = sortDirection ? SORT_DIRECTION_NAMES[sortDirection] : undefined\n\n  function handleSort() {\n    if (readOnly) {\n      return\n    }\n\n    onSort({\n      path,\n      sortDirection: sortDirection === SortDirection.asc ? SortDirection.desc : SortDirection.asc\n    })\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-column-header\"\n  class:jse-readonly={readOnly}\n  on:click={handleSort}\n  title={!readOnly ? columnName + ' (Click to sort the data by this column)' : columnName}\n>\n  <span class=\"jse-column-name\">\n    {truncate(columnName, MAX_HEADER_NAME_CHARACTERS)}\n  </span>\n  {#if sortDirection !== undefined}\n    <span class=\"jse-column-sort-icon\" title={`Currently sorted in ${sortDirectionName} order`}>\n      <Icon data={sortDirection === SortDirection.asc ? faCaretDown : faCaretUp} />\n    </span>\n  {/if}\n</button>\n\n<style src=\"./ColumnHeader.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import Icon from 'svelte-awesome'\n  import { faRotate } from '@fortawesome/free-solid-svg-icons'\n\n  export let count: number\n  export let maxSampleCount: number\n  export let readOnly: boolean\n  export let onRefresh: () => void\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-column-header\"\n  class:jse-readonly={readOnly}\n  title={`The Columns are created by sampling ${maxSampleCount} items out of ${count}. ` +\n    \"If you're missing a column, click here to sample all of the items instead of a subset. \" +\n    'This is slower.'}\n  on:click={() => onRefresh()}\n>\n  <Icon data={faRotate} />\n</button>\n\n<style src=\"./RefreshColumnHeader.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import type { JSONPath } from 'immutable-json-patch'\n  import type { JSONParser } from '$lib/types'\n  import { truncate } from '$lib/utils/stringUtils.js'\n  import { MAX_INLINE_OBJECT_CHARS } from '$lib/constants.js'\n\n  export let path: JSONPath\n  export let value: unknown\n  export let parser: JSONParser\n  export let isSelected: boolean\n  export let containsSearchResult: boolean\n  export let containsActiveSearchResult: boolean\n  export let onEdit: (path: JSONPath) => void\n</script>\n\n<button\n  type=\"button\"\n  class=\"jse-inline-value\"\n  class:jse-selected={isSelected}\n  class:jse-highlight={containsSearchResult}\n  class:jse-active={containsActiveSearchResult}\n  on:dblclick={() => onEdit(path)}\n>\n  {truncate(parser.stringify(value) ?? '', MAX_INLINE_OBJECT_CHARS)}\n</button>\n\n<style src=\"./InlineValue.scss\"></style>\n","<script lang=\"ts\">\n  import type {\n    Content,\n    ContentErrors,\n    ContextMenuItem,\n    HistoryItem,\n    History,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONPathParser,\n    MenuItem,\n    MenuSeparator,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnClassName,\n    OnError,\n    OnExpand,\n    OnFocus,\n    OnJSONEditorModal,\n    OnRenderContextMenu,\n    OnRenderContextMenuInternal,\n    OnRenderMenu,\n    OnRenderMenuInternal,\n    OnRenderValue,\n    OnSelect,\n    OnSortModal,\n    OnTransformModal,\n    TransformModalOptions,\n    Validator,\n    ModeHistoryItem\n  } from '$lib/types'\n  import { Mode } from '$lib/types.js'\n  import TextMode from './textmode/TextMode.svelte'\n  import TableMode from './tablemode/TableMode.svelte'\n  import TreeMode from './treemode/TreeMode.svelte'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { isMenuSpace, isModeHistoryItem } from '$lib/typeguards.js'\n  import { cloneDeep } from 'lodash-es'\n  import { createHistoryInstance } from '$lib/logic/history'\n  import { createDebug } from '$lib/utils/debug'\n\n  export let content: Content\n  export let selection: JSONEditorSelection | undefined\n\n  export let readOnly: boolean\n  export let indentation: number | string\n  export let tabSize: number\n  export let truncateTextSize: number\n  export let externalMode: Mode\n  export let mainMenuBar: boolean\n  export let navigationBar: boolean\n  export let statusBar: boolean\n  export let askToFormat: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let flattenColumns: boolean\n  export let parser: JSONParser\n  export let parseMemoizeOne: JSONParser['parse']\n  export let validator: Validator | undefined\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n  export let insideModal: boolean\n\n  export let onChange: OnChange\n  export let onChangeMode: OnChangeMode\n  export let onSelect: OnSelect\n  export let onRenderValue: OnRenderValue\n  export let onClassName: OnClassName\n  export let onRenderMenu: OnRenderMenu\n  export let onRenderContextMenu: OnRenderContextMenu\n  export let onError: OnError\n  export let onFocus: OnFocus\n  export let onBlur: OnBlur\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n  export let onJSONEditorModal: OnJSONEditorModal\n\n  let refTreeMode: TreeMode | undefined\n  let refTableMode: TableMode | undefined\n  let refTextMode: TextMode | undefined\n\n  const debug = createDebug('jsoneditor:JSONEditorRoot')\n\n  const historyInstance = createHistoryInstance<HistoryItem>({\n    onChange: (updatedHistory) => (history = updatedHistory)\n  })\n\n  let history: History<HistoryItem> = historyInstance.get()\n\n  let mode = externalMode\n\n  function applyExternalMode(externalMode: Mode) {\n    if (externalMode === mode) {\n      return\n    }\n\n    const item: ModeHistoryItem = {\n      type: 'mode',\n      undo: { mode, selection: undefined },\n      redo: { mode: externalMode, selection: undefined }\n    }\n\n    if (mode === 'text' && refTextMode) {\n      // flush pending changes before adding a new history item\n      refTextMode.flush()\n    }\n\n    debug('add history item', item)\n    history.add(item)\n\n    mode = externalMode\n  }\n\n  // eslint-disable-next-line svelte/no-unused-svelte-ignore\n  // svelte-ignore reactive_declaration_non_reactive_property\n  $: applyExternalMode(externalMode)\n\n  function handleUndo(item: HistoryItem | undefined) {\n    if (isModeHistoryItem(item)) {\n      mode = item.undo.mode // important to prevent a new history item from being created\n\n      // find the selection of the previous history item (if any), and use that as initial selection\n      const items = history.items()\n      const index = items.findIndex((i) => i === item)\n      const prevItem = index !== -1 ? items[index - 1] : undefined\n      debug('handleUndo', { index, item, items, prevItem })\n      if (prevItem) {\n        selection = prevItem.redo.selection\n      }\n\n      onChangeMode(mode)\n    }\n  }\n\n  function handleRedo(item: HistoryItem | undefined) {\n    if (isModeHistoryItem(item)) {\n      // prevent a new history item from being created\n      mode = item.redo.mode\n\n      // find the selection of the next history item (if any), and use that as initial selection\n      const items = history.items()\n      const index = items.findIndex((i) => i === item)\n      const nextItem = index !== -1 ? items[index + 1] : undefined\n      debug('handleRedo', { index, item, items, nextItem })\n      if (nextItem) {\n        selection = nextItem.undo.selection\n      }\n\n      onChangeMode(mode)\n    }\n  }\n\n  let modeMenuItems: MenuItem[]\n  $: modeMenuItems = [\n    {\n      type: 'button',\n      text: 'text',\n      title: `Switch to text mode (current mode: ${mode})`,\n      className: 'jse-group-button jse-first' + (mode === Mode.text ? ' jse-selected' : ''),\n      onClick: () => onChangeMode(Mode.text)\n    },\n    {\n      type: 'button',\n      text: 'tree',\n      title: `Switch to tree mode (current mode: ${mode})`,\n      className: 'jse-group-button ' + (mode === Mode.tree ? ' jse-selected' : ''),\n      onClick: () => onChangeMode(Mode.tree)\n    },\n    {\n      type: 'button',\n      text: 'table',\n      title: `Switch to table mode (current mode: ${mode})`,\n      className: 'jse-group-button jse-last' + (mode === Mode.table ? ' jse-selected' : ''),\n      onClick: () => onChangeMode(Mode.table)\n    }\n  ]\n\n  const separatorMenuItem: MenuSeparator = {\n    type: 'separator'\n  }\n\n  let handleRenderMenu: OnRenderMenuInternal\n  $: handleRenderMenu = (items: MenuItem[]) => {\n    const updatedItems = isMenuSpace(items[0])\n      ? modeMenuItems.concat(items) // menu is empty, readOnly mode\n      : modeMenuItems.concat(separatorMenuItem, items)\n\n    const updatedItemsOriginal = cloneDeep(updatedItems) // the user may change updatedItems in the callback\n\n    return (\n      onRenderMenu(updatedItems, { mode, modal: insideModal, readOnly }) || updatedItemsOriginal\n    )\n  }\n\n  let handleRenderContextMenu: OnRenderContextMenuInternal\n  $: handleRenderContextMenu = (items: ContextMenuItem[]) => {\n    const itemsOriginal = cloneDeep(items) // the user may change items in the callback\n\n    return (\n      onRenderContextMenu(items, { mode, modal: insideModal, readOnly, selection }) ??\n      (readOnly ? false : itemsOriginal)\n    )\n  }\n\n  export function patch(operations: JSONPatchDocument): JSONPatchResult {\n    if (refTreeMode) {\n      // Note that tree mode has an optional afterPatch callback.\n      // right now we don's support this in the public API.\n      return refTreeMode.patch(operations)\n    }\n\n    if (refTableMode) {\n      // Note that tree mode has an optional afterPatch callback.\n      // right now we don's support this in the public API.\n      return refTableMode.patch(operations)\n    }\n\n    if (refTextMode) {\n      return refTextMode.patch(operations)\n    }\n\n    throw new Error(`Method patch is not available in mode \"${mode}\"`)\n  }\n\n  export function expand(path: JSONPath, callback?: OnExpand): void {\n    if (refTreeMode) {\n      return refTreeMode.expand(path, callback)\n    } else if (refTextMode) {\n      return refTextMode.expand(path, callback)\n    } else {\n      throw new Error(`Method expand is not available in mode \"${mode}\"`)\n    }\n  }\n\n  export function collapse(path: JSONPath, recursive: boolean): void {\n    if (refTreeMode) {\n      return refTreeMode.collapse(path, recursive)\n    } else if (refTextMode) {\n      return refTextMode.collapse(path)\n    } else {\n      throw new Error(`Method collapse is not available in mode \"${mode}\"`)\n    }\n  }\n\n  /**\n   * Open the transform modal\n   */\n  export function transform(options: TransformModalOptions): void {\n    if (refTextMode) {\n      refTextMode.openTransformModal(options)\n    } else if (refTreeMode) {\n      refTreeMode.openTransformModal(options)\n    } else if (refTableMode) {\n      refTableMode.openTransformModal(options)\n    } else {\n      throw new Error(`Method transform is not available in mode \"${mode}\"`)\n    }\n  }\n\n  /**\n   * Validate the contents of the editor using the configured validator.\n   * Returns a parse error or a list with validation warnings\n   */\n  export function validate(): ContentErrors | undefined {\n    if (refTextMode) {\n      return refTextMode.validate()\n    } else if (refTreeMode) {\n      return refTreeMode.validate()\n    } else if (refTableMode) {\n      return refTableMode.validate()\n    } else {\n      throw new Error(`Method validate is not available in mode \"${mode}\"`)\n    }\n  }\n\n  /**\n   * In tree mode, invalid JSON is automatically repaired when loaded. When the\n   * repair was successful, the repaired contents are rendered but not yet\n   * applied to the document itself until the user clicks \"Ok\" or starts editing\n   * the data. Instead of accepting the repair, the user can also click\n   * \"Repair manually instead\". Invoking `.acceptAutoRepair()` will\n   * programmatically accept the repair. This will trigger an update,\n   * and the method itself also returns the updated contents. In case of text\n   * mode or when the editor is not in an \"accept auto repair\" status, nothing\n   * will happen, and the contents will be returned as is.\n   */\n  export function acceptAutoRepair(): Content {\n    if (refTreeMode) {\n      return refTreeMode.acceptAutoRepair()\n    } else {\n      return content\n    }\n  }\n\n  export function scrollTo(path: JSONPath): Promise<void> {\n    if (refTreeMode) {\n      return refTreeMode.scrollTo(path)\n    } else if (refTableMode) {\n      return refTableMode.scrollTo(path)\n    } else {\n      // TODO: implement scrollTo for text mode\n      throw new Error(`Method scrollTo is not available in mode \"${mode}\"`)\n    }\n  }\n\n  export function findElement(path: JSONPath): Element | undefined {\n    if (refTreeMode) {\n      return refTreeMode.findElement(path)\n    } else if (refTableMode) {\n      return refTableMode.findElement(path)\n    } else {\n      throw new Error(`Method findElement is not available in mode \"${mode}\"`)\n    }\n  }\n\n  export function focus() {\n    if (refTextMode) {\n      refTextMode.focus()\n    } else if (refTreeMode) {\n      refTreeMode.focus()\n    } else if (refTableMode) {\n      refTableMode.focus()\n    }\n  }\n\n  export async function refresh(): Promise<void> {\n    if (refTextMode) {\n      await refTextMode.refresh()\n    } else {\n      // nothing to do in tree or table mode (also: don't throw an exception or so,\n      // that annoying having to reckon with that when using .refresh()).\n    }\n  }\n</script>\n\n{#if mode === Mode.text || String(mode) === 'code'}\n  <TextMode\n    bind:this={refTextMode}\n    externalContent={content}\n    externalSelection={selection}\n    {history}\n    {readOnly}\n    {indentation}\n    {tabSize}\n    {mainMenuBar}\n    {statusBar}\n    {askToFormat}\n    {escapeUnicodeCharacters}\n    {parser}\n    {validator}\n    {validationParser}\n    {onChange}\n    {onChangeMode}\n    {onSelect}\n    onUndo={handleUndo}\n    onRedo={handleRedo}\n    {onError}\n    {onFocus}\n    {onBlur}\n    onRenderMenu={handleRenderMenu}\n    {onSortModal}\n    {onTransformModal}\n  />\n{:else if mode === Mode.table}\n  <TableMode\n    bind:this={refTableMode}\n    externalContent={content}\n    externalSelection={selection}\n    {history}\n    {readOnly}\n    {truncateTextSize}\n    {mainMenuBar}\n    {escapeControlCharacters}\n    {escapeUnicodeCharacters}\n    {flattenColumns}\n    {parser}\n    {parseMemoizeOne}\n    {validator}\n    {validationParser}\n    {indentation}\n    {onChange}\n    {onChangeMode}\n    {onSelect}\n    onUndo={handleUndo}\n    onRedo={handleRedo}\n    {onRenderValue}\n    {onFocus}\n    {onBlur}\n    onRenderMenu={handleRenderMenu}\n    onRenderContextMenu={handleRenderContextMenu}\n    {onSortModal}\n    {onTransformModal}\n    {onJSONEditorModal}\n  />\n{:else}\n  <!-- mode === Mode.tree -->\n  <TreeMode\n    bind:this={refTreeMode}\n    externalContent={content}\n    externalSelection={selection}\n    {history}\n    {readOnly}\n    {indentation}\n    {truncateTextSize}\n    {mainMenuBar}\n    {navigationBar}\n    {escapeControlCharacters}\n    {escapeUnicodeCharacters}\n    {parser}\n    {parseMemoizeOne}\n    {validator}\n    {validationParser}\n    {pathParser}\n    {onError}\n    {onChange}\n    {onChangeMode}\n    {onSelect}\n    onUndo={handleUndo}\n    onRedo={handleRedo}\n    {onRenderValue}\n    {onClassName}\n    {onFocus}\n    {onBlur}\n    onRenderMenu={handleRenderMenu}\n    onRenderContextMenu={handleRenderContextMenu}\n    {onSortModal}\n    {onTransformModal}\n    {onJSONEditorModal}\n  />\n{/if}\n","import type { NumberOption, PathOption } from '$lib/types.js'\n\nexport interface SortModalState {\n  selectedProperty: PathOption\n  selectedDirection: NumberOption\n}\n\nexport const sortModalStates: Record<string, SortModalState> = {}\n","<svelte:options accessors={false} immutable={true} />\n\n<script lang=\"ts\">\n  import { createDebug } from '../utils/debug.js'\n  import { uniqueId } from '../utils/uniqueId.js'\n  import { isEqualParser, isJSONContent, validateContentType } from '../utils/jsonUtils.js'\n  import AbsolutePopup from './modals/popup/AbsolutePopup.svelte'\n  import { jsonQueryLanguage } from '$lib/plugins/query/jsonQueryLanguage.js'\n  import { renderValue } from '$lib/plugins/value/renderValue.js'\n  import { flushSync } from 'svelte'\n  import TransformModal from './modals/TransformModal.svelte'\n  import type {\n    Content,\n    ContentErrors,\n    ContextMenuItem,\n    JSONEditorModalCallback,\n    JSONEditorModalProps,\n    JSONEditorPropsOptional,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPatchResult,\n    JSONPathParser,\n    MenuItem,\n    OnBlur,\n    OnChange,\n    OnChangeMode,\n    OnChangeQueryLanguage,\n    OnChangeStatus,\n    OnClassName,\n    OnError,\n    OnExpand,\n    OnFocus,\n    OnRenderMenu,\n    OnRenderValue,\n    OnSelect,\n    QueryLanguage,\n    SortModalCallback,\n    TransformModalCallback,\n    TransformModalOptions,\n    TransformModalProps,\n    Validator\n  } from '$lib/types'\n  import type { OnRenderContextMenu } from '$lib/types.js'\n  import { Mode } from '$lib/types.js'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { noop } from '../utils/noop.js'\n  import { parseJSONPath, stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import JSONEditorRoot from './modes/JSONEditorRoot.svelte'\n  import JSONEditorModal from './modals/JSONEditorModal.svelte'\n  import memoizeOne from 'memoize-one'\n  import { cloneDeep } from 'lodash-es'\n  import SortModal from './modals/SortModal.svelte'\n\n  // TODO: document how to enable debugging in the readme: localStorage.debug=\"jsoneditor:*\", then reload\n  const debug = createDebug('jsoneditor:JSONEditor')\n\n  const contentDefault = { text: '' }\n  const selectionDefault = undefined\n  const readOnlyDefault = false\n  const indentationDefault = 2\n  const tabSizeDefault = 4\n  const truncateTextSizeDefault = 1000\n  const modeDefault = Mode.tree\n  const mainMenuBarDefault = true\n  const navigationBarDefault = true\n  const statusBarDefault = true\n  const askToFormatDefault = true\n  const escapeControlCharactersDefault = false\n  const escapeUnicodeCharactersDefault = false\n  const flattenColumnsDefault = true\n  const parserDefault = JSON\n  const validatorDefault = undefined\n  const validationParserDefault = JSON\n  const pathParserDefault = {\n    parse: parseJSONPath,\n    stringify: stringifyJSONPath\n  }\n  const queryLanguagesDefault = [jsonQueryLanguage]\n  const queryLanguageIdDefault = queryLanguagesDefault[0].id\n  const onChangeQueryLanguageDefault = noop\n  const onChangeDefault = undefined\n  const onSelectDefault = undefined\n  const onRenderValueDefault = renderValue\n  const onClassNameDefault = noop\n  const onRenderMenuDefault = noop\n  const onRenderContextMenuDefault = noop\n  const onChangeModeDefault = noop\n  const onErrorDefault: OnError = (err) => {\n    console.error(err)\n    alert(err.toString()) // TODO: create a nice alert modal\n  }\n  const onFocusDefault = noop\n  const onBlurDefault = noop\n\n  export let content: Content = contentDefault\n  export let selection: JSONEditorSelection | undefined = selectionDefault\n  export let readOnly: boolean = readOnlyDefault\n  export let indentation: number | string = indentationDefault\n  export let tabSize: number = tabSizeDefault\n  export let truncateTextSize: number = truncateTextSizeDefault\n  export let mode: Mode = modeDefault\n  export let mainMenuBar: boolean = mainMenuBarDefault\n  export let navigationBar: boolean = navigationBarDefault\n  export let statusBar: boolean = statusBarDefault\n  export let askToFormat: boolean = askToFormatDefault\n  export let escapeControlCharacters: boolean = escapeControlCharactersDefault\n  export let escapeUnicodeCharacters: boolean = escapeUnicodeCharactersDefault\n  export let flattenColumns: boolean = flattenColumnsDefault\n  export let parser: JSONParser = parserDefault\n  export let validator: Validator | undefined = validatorDefault\n  export let validationParser: JSONParser = validationParserDefault\n  export let pathParser: JSONPathParser = pathParserDefault\n  export let queryLanguages: QueryLanguage[] = queryLanguagesDefault\n  export let queryLanguageId: string = queryLanguageIdDefault\n  export let onChangeQueryLanguage: OnChangeQueryLanguage = onChangeQueryLanguageDefault\n  export let onChange: OnChange | undefined = onChangeDefault\n  export let onSelect: OnSelect | undefined = onSelectDefault\n  export let onRenderValue: OnRenderValue = onRenderValueDefault\n  export let onClassName: OnClassName = onClassNameDefault\n  export let onRenderMenu: OnRenderMenu = onRenderMenuDefault\n  export let onRenderContextMenu: OnRenderContextMenu = onRenderContextMenuDefault\n  export let onChangeMode: OnChangeMode = onChangeModeDefault\n  export let onError: OnError = onErrorDefault\n  export let onFocus: OnFocus = onFocusDefault\n  export let onBlur: OnBlur = onBlurDefault\n\n  let instanceId = uniqueId()\n  let hasFocus = false\n  let refJSONEditorRoot: JSONEditorRoot\n  let jsonEditorModalProps: JSONEditorModalProps | undefined = undefined\n  let sortModalProps: SortModalCallback | undefined\n  let transformModalProps: TransformModalProps | undefined\n\n  $: {\n    const contentError = validateContentType(content)\n    if (contentError) {\n      console.error('Error: ' + contentError)\n    }\n  }\n\n  // backward compatibility warning since v1.0.0\n  $: if (selection === null) {\n    console.warn('selection is invalid: it is null but should be undefined')\n  }\n\n  // We memoize the last parse result for the case when the content is text and very large.\n  // In that case parsing takes a few seconds. When the user switches between tree and table mode,\n  // without having made a change, we do not want to parse the text again.\n  $: parseMemoizeOne = memoizeOne(parser.parse)\n\n  // rerender the full editor when the parser changes. This is needed because\n  // numeric state is hold at many places in the editor.\n  let previousParser = parser\n  $: {\n    if (!isEqualParser(parser, previousParser)) {\n      debug('parser changed, recreate editor')\n\n      if (isJSONContent(content)) {\n        const text = previousParser.stringify(content.json)\n        content = {\n          json: text !== undefined ? parser.parse(text) : undefined\n        }\n      }\n\n      previousParser = parser\n\n      // new editor id -> will re-create the editor\n      instanceId = uniqueId()\n    }\n  }\n\n  export function get(): Content {\n    return content\n  }\n\n  export function set(newContent: Content): void {\n    debug('set')\n\n    const contentError = validateContentType(newContent)\n    if (contentError) {\n      throw new Error(contentError)\n    }\n\n    // new editor id -> will re-create the editor\n    instanceId = uniqueId()\n\n    // update content *after* re-render, so that the new editor will trigger an onChange event\n    content = newContent\n\n    flushSync()\n  }\n\n  export function update(updatedContent: Content): void {\n    debug('update')\n\n    const contentError = validateContentType(updatedContent)\n    if (contentError) {\n      throw new Error(contentError)\n    }\n\n    content = updatedContent\n\n    flushSync()\n  }\n\n  export function patch(operations: JSONPatchDocument): JSONPatchResult {\n    // Note that patch has an optional afterPatch callback.\n    // right now we don's support this in the public API.\n    const result = refJSONEditorRoot.patch(operations)\n\n    flushSync()\n\n    return result\n  }\n\n  export function select(newSelection: JSONEditorSelection | undefined): void {\n    selection = newSelection\n\n    flushSync()\n  }\n\n  export function expand(path: JSONPath, callback?: OnExpand): void {\n    refJSONEditorRoot.expand(path, callback)\n\n    flushSync()\n  }\n\n  export function collapse(path: JSONPath, recursive = false): void {\n    refJSONEditorRoot.collapse(path, recursive)\n\n    flushSync()\n  }\n\n  /**\n   * Open the transform modal\n   */\n  export function transform(options: TransformModalOptions = {}): void {\n    refJSONEditorRoot.transform(options)\n\n    flushSync()\n  }\n\n  /**\n   * Validate the contents of the editor using the configured validator.\n   * Returns a parse error or a list with validation warnings\n   */\n  export function validate(): ContentErrors | undefined {\n    return refJSONEditorRoot.validate()\n  }\n\n  /**\n   * In tree mode, invalid JSON is automatically repaired when loaded. When the\n   * repair was successful, the repaired contents are rendered but not yet\n   * applied to the document itself until the user clicks \"Ok\" or starts editing\n   * the data. Instead of accepting the repair, the user can also click\n   * \"Repair manually instead\". Invoking `.acceptAutoRepair()` will\n   * programmatically accept the repair. This will trigger an update,\n   * and the method itself also returns the updated contents. In case of text\n   * mode or when the editor is not in an \"accept auto repair\" status, nothing\n   * will happen, and the contents will be returned as is.\n   */\n  export function acceptAutoRepair(): Content {\n    const content = refJSONEditorRoot.acceptAutoRepair()\n\n    flushSync()\n\n    return content\n  }\n\n  export async function scrollTo(path: JSONPath): Promise<void> {\n    await refJSONEditorRoot.scrollTo(path)\n  }\n\n  export function findElement(path: JSONPath): Element | undefined {\n    return refJSONEditorRoot.findElement(path)\n  }\n\n  export function focus(): void {\n    refJSONEditorRoot.focus()\n\n    flushSync()\n  }\n\n  export async function refresh(): Promise<void> {\n    await refJSONEditorRoot.refresh()\n  }\n\n  export function updateProps(props: JSONEditorPropsOptional): void {\n    const names = Object.keys(props) as (keyof JSONEditorPropsOptional)[]\n\n    for (const name of names) {\n      switch (name) {\n        case 'content':\n          content = props[name] ?? contentDefault\n          break\n        case 'selection':\n          selection = props[name] ?? selectionDefault\n          break\n        case 'readOnly':\n          readOnly = props[name] ?? readOnlyDefault\n          break\n        case 'indentation':\n          indentation = props[name] ?? indentationDefault\n          break\n        case 'tabSize':\n          tabSize = props[name] ?? tabSizeDefault\n          break\n        case 'truncateTextSize':\n          truncateTextSize = props[name] ?? truncateTextSizeDefault\n          break\n        case 'mode':\n          mode = props[name] ?? modeDefault\n          break\n        case 'mainMenuBar':\n          mainMenuBar = props[name] ?? mainMenuBarDefault\n          break\n        case 'navigationBar':\n          navigationBar = props[name] ?? navigationBarDefault\n          break\n        case 'statusBar':\n          statusBar = props[name] ?? statusBarDefault\n          break\n        case 'askToFormat':\n          askToFormat = props[name] ?? askToFormatDefault\n          break\n        case 'escapeControlCharacters':\n          escapeControlCharacters = props[name] ?? escapeControlCharactersDefault\n          break\n        case 'escapeUnicodeCharacters':\n          escapeUnicodeCharacters = props[name] ?? escapeUnicodeCharactersDefault\n          break\n        case 'flattenColumns':\n          flattenColumns = props[name] ?? flattenColumnsDefault\n          break\n        case 'parser':\n          parser = props[name] ?? parserDefault\n          break\n        case 'validator':\n          validator = props[name] ?? validatorDefault\n          break\n        case 'validationParser':\n          validationParser = props[name] ?? validationParserDefault\n          break\n        case 'pathParser':\n          pathParser = props[name] ?? pathParserDefault\n          break\n        case 'queryLanguages':\n          queryLanguages = props[name] ?? queryLanguagesDefault\n          break\n        case 'queryLanguageId':\n          queryLanguageId = props[name] ?? queryLanguageIdDefault\n          break\n        case 'onChangeQueryLanguage':\n          onChangeQueryLanguage = props[name] ?? onChangeQueryLanguageDefault\n          break\n        case 'onChange':\n          onChange = props[name] ?? onChangeDefault\n          break\n        case 'onRenderValue':\n          onRenderValue = props[name] ?? onRenderValueDefault\n          break\n        case 'onClassName':\n          onClassName = props[name] ?? onClassNameDefault\n          break\n        case 'onRenderMenu':\n          onRenderMenu = props[name] ?? onRenderMenuDefault\n          break\n        case 'onRenderContextMenu':\n          onRenderContextMenu = props[name] ?? onRenderContextMenuDefault\n          break\n        case 'onChangeMode':\n          onChangeMode = props[name] ?? onChangeModeDefault\n          break\n        case 'onSelect':\n          onSelect = props[name] ?? onSelectDefault\n          break\n        case 'onError':\n          onError = props[name] ?? onErrorDefault\n          break\n        case 'onFocus':\n          onFocus = props[name] ?? onFocusDefault\n          break\n        case 'onBlur':\n          onBlur = props[name] ?? onBlurDefault\n          break\n\n        default:\n          // We should never reach this default case\n          unknownProperty(name)\n      }\n    }\n\n    if (!queryLanguages.some((queryLanguage) => queryLanguage.id === queryLanguageId)) {\n      queryLanguageId = queryLanguages[0].id\n    }\n\n    function unknownProperty(name: never) {\n      debug(`Unknown property \"${name}\"`)\n    }\n\n    flushSync()\n  }\n\n  export async function destroy() {\n    throw new Error(\n      'class method destroy() is deprecated. ' +\n        'It is replaced with a method destroy() in the vanilla library.'\n    )\n  }\n\n  function handleChange(updatedContent: Content, previousContent: Content, status: OnChangeStatus) {\n    content = updatedContent\n\n    if (onChange) {\n      onChange(updatedContent, previousContent, status)\n    }\n  }\n\n  function handleSelect(updatedSelection: JSONEditorSelection | undefined) {\n    selection = updatedSelection\n\n    if (onSelect) {\n      onSelect(cloneDeep(updatedSelection))\n    }\n  }\n\n  function handleFocus() {\n    hasFocus = true\n    if (onFocus) {\n      onFocus()\n    }\n  }\n\n  function handleBlur() {\n    hasFocus = false\n    if (onBlur) {\n      onBlur()\n    }\n  }\n\n  async function toggleMode(newMode: Mode) {\n    if (mode === newMode) {\n      return\n    }\n\n    mode = newMode\n\n    flushSync()\n    focus()\n\n    onChangeMode(newMode)\n  }\n\n  function handleChangeQueryLanguage(newQueryLanguageId: string) {\n    debug('handleChangeQueryLanguage', newQueryLanguageId)\n    queryLanguageId = newQueryLanguageId\n    onChangeQueryLanguage(newQueryLanguageId)\n  }\n\n  // The onTransformModal method is located in JSONEditor to prevent circular references:\n  //     TreeMode -> TransformModal -> TreeMode\n  function onTransformModal({ id, json, rootPath, onTransform, onClose }: TransformModalCallback) {\n    if (readOnly) {\n      return\n    }\n\n    transformModalProps = {\n      id,\n      json,\n      rootPath,\n      indentation,\n      truncateTextSize,\n      escapeControlCharacters,\n      escapeUnicodeCharacters,\n      parser,\n      parseMemoizeOne,\n      validationParser,\n      pathParser,\n      queryLanguages,\n      queryLanguageId,\n      onChangeQueryLanguage: handleChangeQueryLanguage,\n      onRenderValue,\n      onRenderMenu: (items: MenuItem[]) => onRenderMenu(items, { mode, modal: true, readOnly }),\n      onRenderContextMenu: (items: ContextMenuItem[]) =>\n        onRenderContextMenu(items, { mode, modal: true, readOnly, selection }),\n      onClassName,\n      onTransform,\n      onClose\n    }\n  }\n\n  // The onSortModal is positioned here for consistency with TransformModal\n  function onSortModal(props: SortModalCallback) {\n    if (readOnly) {\n      return\n    }\n\n    sortModalProps = props\n  }\n\n  // The onJSONEditorModal method is located in JSONEditor to prevent circular references:\n  //     JSONEditor -> TableMode -> JSONEditorModal -> JSONEditor\n  function onJSONEditorModal({ content, path, onPatch, onClose }: JSONEditorModalCallback) {\n    debug('onJSONEditorModal', { content, path })\n\n    jsonEditorModalProps = {\n      content,\n      path,\n      onPatch,\n\n      readOnly,\n      indentation,\n      tabSize,\n      truncateTextSize,\n      mainMenuBar,\n      navigationBar,\n      statusBar,\n      askToFormat,\n      escapeControlCharacters,\n      escapeUnicodeCharacters,\n      flattenColumns,\n      parser,\n      validator: undefined, // TODO: support partial JSON validation?\n      validationParser,\n      pathParser,\n      onRenderValue,\n      onClassName,\n      onRenderMenu,\n      onRenderContextMenu,\n      onSortModal,\n      onTransformModal,\n      onClose\n    }\n  }\n\n  function handleKeyDown(event: KeyboardEvent) {\n    // prevent browser addons from reacting to keyboard inputs inside the editor\n    // see https://github.com/josdejong/svelte-jsoneditor/issues/512\n    event.stopPropagation()\n  }\n\n  $: debug('mode changed to', mode)\n</script>\n\n<AbsolutePopup>\n  <div class=\"jse-main\" class:jse-focus={hasFocus} on:keydown={handleKeyDown} role=\"none\">\n    {#key instanceId}\n      <JSONEditorRoot\n        bind:this={refJSONEditorRoot}\n        externalMode={mode}\n        {content}\n        {selection}\n        {readOnly}\n        {indentation}\n        {tabSize}\n        {truncateTextSize}\n        {statusBar}\n        {askToFormat}\n        {mainMenuBar}\n        {navigationBar}\n        {escapeControlCharacters}\n        {escapeUnicodeCharacters}\n        {flattenColumns}\n        {parser}\n        {parseMemoizeOne}\n        {validator}\n        {validationParser}\n        {pathParser}\n        insideModal={false}\n        {onError}\n        onChange={handleChange}\n        onChangeMode={toggleMode}\n        onSelect={handleSelect}\n        {onRenderValue}\n        {onClassName}\n        onFocus={handleFocus}\n        onBlur={handleBlur}\n        {onRenderMenu}\n        {onRenderContextMenu}\n        {onSortModal}\n        {onTransformModal}\n        {onJSONEditorModal}\n      />\n    {/key}\n  </div>\n\n  {#if sortModalProps}\n    <SortModal\n      {...sortModalProps}\n      onClose={() => {\n        sortModalProps?.onClose()\n        sortModalProps = undefined\n      }}\n    />\n  {/if}\n\n  {#if transformModalProps}\n    <TransformModal\n      {...transformModalProps}\n      onClose={() => {\n        transformModalProps?.onClose()\n        transformModalProps = undefined\n      }}\n    />\n  {/if}\n\n  {#if jsonEditorModalProps}\n    <JSONEditorModal\n      {...jsonEditorModalProps}\n      onClose={() => {\n        jsonEditorModalProps?.onClose()\n        jsonEditorModalProps = undefined\n      }}\n    />\n  {/if}\n</AbsolutePopup>\n\n<style src=\"./JSONEditor.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { isEmpty } from 'lodash-es'\n  import Select from 'svelte-select'\n  import Header from './Header.svelte'\n  import { getNestedPaths } from '$lib/utils/arrayUtils.js'\n  import { pathToOption, stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import { sortJson } from '$lib/logic/sort.js'\n  import { sortModalStates } from './sortModalStates'\n  import type { JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer, getIn } from 'immutable-json-patch'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type { OnSort } from '$lib/types.js'\n  import Modal from './Modal.svelte'\n\n  const debug = createDebug('jsoneditor:SortModal')\n\n  export let id: string\n  export let json: unknown // the whole document\n  export let rootPath: JSONPath\n  export let onSort: OnSort\n  export let onClose: () => void\n\n  $: selectedJson = getIn(json, rootPath)\n  $: jsonIsArray = Array.isArray(selectedJson)\n  $: paths = jsonIsArray ? getNestedPaths(selectedJson) : undefined\n  $: properties = paths ? paths.map(pathToOption) : undefined\n\n  const asc = {\n    value: 1,\n    label: 'ascending'\n  }\n  const desc = {\n    value: -1,\n    label: 'descending'\n  }\n  const directions = [asc, desc]\n\n  const stateId = `${id}:${compileJSONPointer(rootPath)}`\n  let selectedProperty = sortModalStates[stateId]?.selectedProperty\n  let selectedDirection = sortModalStates[stateId]?.selectedDirection || asc\n  let sortError: string | undefined = undefined\n\n  $: {\n    // remember the selected values for the next time we open the SortModal\n    // just in memory, not persisted\n    sortModalStates[stateId] = {\n      selectedProperty,\n      selectedDirection\n    }\n\n    debug('store state in memory', stateId, sortModalStates[stateId])\n  }\n\n  function handleSort() {\n    try {\n      sortError = undefined\n\n      const itemPath: JSONPath = selectedProperty?.value || properties?.[0]?.value || []\n      const direction = selectedDirection?.value\n      const operations = sortJson(json, rootPath, itemPath, direction)\n      if (onSort !== undefined && rootPath !== undefined) {\n        onSort({ operations, rootPath, itemPath, direction })\n      }\n\n      onClose()\n    } catch (err) {\n      sortError = String(err)\n    }\n  }\n\n  function focus(element: HTMLElement) {\n    element.focus()\n  }\n</script>\n\n<Modal {onClose} className=\"jse-sort-modal\">\n  <Header title={jsonIsArray ? 'Sort array items' : 'Sort object keys'} {onClose} />\n\n  <div class=\"jse-modal-contents\">\n    <table>\n      <colgroup>\n        <col width=\"25%\" />\n        <col width=\"75%\" />\n      </colgroup>\n      <tbody>\n        <tr>\n          <th>Path</th>\n          <td>\n            <input\n              class=\"jse-path\"\n              type=\"text\"\n              readonly\n              title=\"Selected path\"\n              value={rootPath && !isEmpty(rootPath)\n                ? stringifyJSONPath(rootPath)\n                : '(document root)'}\n            />\n          </td>\n        </tr>\n        {#if jsonIsArray && properties && properties?.length > 1}\n          <tr>\n            <th>Property</th>\n            <td>\n              <Select showChevron items={properties} bind:value={selectedProperty} />\n            </td>\n          </tr>\n        {/if}\n        <tr>\n          <th>Direction</th>\n          <td>\n            <Select\n              showChevron\n              clearable={false}\n              items={directions}\n              bind:value={selectedDirection}\n            />\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <div class=\"jse-space\">\n      {#if sortError}\n        <div class=\"jse-error\">\n          {sortError}\n        </div>\n      {/if}\n    </div>\n\n    <div class=\"jse-actions\">\n      <button\n        type=\"button\"\n        class=\"jse-primary\"\n        on:click={handleSort}\n        use:focus\n        disabled={jsonIsArray && properties && properties?.length > 1 ? !selectedProperty : false}\n      >\n        Sort\n      </button>\n    </div>\n  </div>\n</Modal>\n\n<style src=\"./SortModal.scss\"></style>\n","<svelte:options immutable={true} />\n\n<script lang=\"ts\">\n  import { flushSync, onMount } from 'svelte'\n  import Header from './Header.svelte'\n  import type { JSONPatchDocument, JSONPath } from 'immutable-json-patch'\n  import { compileJSONPointer, immutableJSONPatch, isJSONArray } from 'immutable-json-patch'\n  import { createDebug } from '$lib/utils/debug.js'\n  import type {\n    Content,\n    JSONEditorModalCallback,\n    JSONEditorSelection,\n    JSONParser,\n    JSONPathParser,\n    OnClassName,\n    OnPatch,\n    OnRenderContextMenu,\n    OnRenderMenu,\n    OnRenderValue,\n    OnSortModal,\n    OnTransformModal,\n    Validator\n  } from '$lib/types'\n  import { Mode } from '$lib/types.js'\n  import JSONEditorRoot from '../modes/JSONEditorRoot.svelte'\n  import { noop } from '$lib/utils/noop.js'\n  import { stringifyJSONPath } from '$lib/utils/pathUtils.js'\n  import { initial, isEmpty, last } from 'lodash-es'\n  import { isJSONContent, toJSONContent } from '$lib/utils/jsonUtils.js'\n  import Icon from 'svelte-awesome'\n  import { faCaretLeft } from '@fortawesome/free-solid-svg-icons'\n  import memoizeOne from 'memoize-one'\n  import { getFocusPath, isJSONSelection } from '$lib/logic/selection.js'\n  import Modal from './Modal.svelte'\n  import AbsolutePopup from './popup/AbsolutePopup.svelte'\n\n  const debug = createDebug('jsoneditor:JSONEditorModal')\n\n  export let content: Content // the nested document\n  export let path: JSONPath\n  export let onPatch: OnPatch\n\n  export let readOnly: boolean\n  export let indentation: number | string\n  export let tabSize: number\n  export let truncateTextSize: number\n  export let mainMenuBar: boolean\n  export let navigationBar: boolean\n  export let statusBar: boolean\n  export let askToFormat: boolean\n  export let escapeControlCharacters: boolean\n  export let escapeUnicodeCharacters: boolean\n  export let flattenColumns: boolean\n  export let parser: JSONParser\n  export let validator: Validator | undefined\n  export let validationParser: JSONParser\n  export let pathParser: JSONPathParser\n\n  export let onRenderValue: OnRenderValue\n  export let onClassName: OnClassName\n  export let onRenderMenu: OnRenderMenu\n  export let onRenderContextMenu: OnRenderContextMenu\n\n  export let onSortModal: OnSortModal\n  export let onTransformModal: OnTransformModal\n\n  export let onClose: () => void\n\n  interface ModalState {\n    mode: Mode\n    content: Content\n    selection: JSONEditorSelection | undefined\n    relativePath: JSONPath\n  }\n\n  let refEditor: JSONEditorRoot\n  let fullscreen: boolean\n\n  const rootState: ModalState = {\n    mode: determineMode(content),\n    content,\n    selection: undefined,\n    relativePath: path\n  }\n  let stack: ModalState[] = [rootState]\n\n  $: currentState = last(stack) || rootState\n  $: absolutePath = stack.flatMap((state) => state.relativePath)\n  $: pathDescription = !isEmpty(absolutePath) ? stringifyJSONPath(absolutePath) : '(document root)'\n\n  // not relevant in this Modal setting, but well\n  $: parseMemoizeOne = memoizeOne(parser.parse)\n\n  let error: string | undefined = undefined\n\n  onMount(() => {\n    refEditor?.focus()\n  })\n\n  function determineMode(content: Content): Mode {\n    return isJSONContent(content) && isJSONArray(content.json) ? Mode.table : Mode.tree\n  }\n\n  function scrollToSelection() {\n    const selection: JSONEditorSelection | undefined = last(stack)?.selection\n    if (isJSONSelection(selection)) {\n      refEditor.scrollTo(getFocusPath(selection))\n    }\n  }\n\n  function handleApply() {\n    debug('handleApply')\n\n    if (readOnly) {\n      return\n    }\n\n    try {\n      error = undefined\n\n      const path = currentState.relativePath\n      const content = currentState.content\n      const operations: JSONPatchDocument = [\n        {\n          op: 'replace',\n          path: compileJSONPointer(path),\n          value: toJSONContent(content, parser).json // this can throw an error\n        }\n      ]\n\n      if (stack.length > 1) {\n        const parentContent = stack[stack.length - 2].content\n        const parentJson = toJSONContent(parentContent, parser).json\n        const updatedParentContent = {\n          json: immutableJSONPatch(parentJson, operations)\n        }\n\n        // after successfully updated, remove from the stack and apply the change to the parent\n        const parentState = stack[stack.length - 2] || rootState\n        const updatedParentState: ModalState = { ...parentState, content: updatedParentContent }\n        stack = [...stack.slice(0, stack.length - 2), updatedParentState]\n        flushSync()\n        scrollToSelection()\n      } else {\n        onPatch(operations)\n\n        onClose()\n      }\n    } catch (err) {\n      error = String(err)\n    }\n  }\n\n  function handleClose() {\n    debug('handleClose')\n\n    if (fullscreen) {\n      // exit fullscreen\n      fullscreen = false\n    } else if (stack.length > 1) {\n      // remove the last item from the stack\n      stack = initial(stack)\n      flushSync()\n      refEditor?.focus()\n      scrollToSelection()\n\n      // clear any error from the just closed state\n      error = undefined\n    } else {\n      // this is the first modal, the root state, close the modal\n      onClose()\n    }\n  }\n\n  function handleChange(updatedContent: Content) {\n    debug('handleChange', updatedContent)\n    updateState((state) => ({ ...state, content: updatedContent }))\n  }\n\n  function handleChangeSelection(newSelection: JSONEditorSelection | undefined) {\n    debug('handleChangeSelection', newSelection)\n    updateState((state) => ({ ...state, selection: newSelection }))\n  }\n\n  function handleChangeMode(newMode: Mode) {\n    debug('handleChangeMode', newMode)\n    updateState((state) => ({ ...state, mode: newMode }))\n  }\n\n  function updateState(callback: (state: ModalState) => ModalState) {\n    const state = last(stack) as ModalState\n    const updatedState = callback(state)\n    stack = [...initial(stack), updatedState]\n  }\n\n  function handleError(newError: Error) {\n    error = newError.toString()\n    console.error(newError)\n  }\n\n  function handleJSONEditorModal({ content, path }: JSONEditorModalCallback) {\n    debug('handleJSONEditorModal', { content, path })\n\n    const nestedModalState = {\n      mode: determineMode(content),\n      content,\n      selection: undefined,\n      relativePath: path\n    }\n    stack = [...stack, nestedModalState]\n\n    flushSync()\n    refEditor?.focus()\n  }\n\n  function focus(element: HTMLElement) {\n    element.focus()\n  }\n</script>\n\n<Modal onClose={handleClose} className=\"jse-jsoneditor-modal\" {fullscreen}>\n  <div class=\"jse-modal-wrapper\">\n    <AbsolutePopup>\n      <Header\n        title=\"Edit nested content {stack.length > 1 ? ` (${stack.length})` : ''}\"\n        fullScreenButton={true}\n        bind:fullscreen\n        onClose={handleClose}\n      />\n\n      <div class=\"jse-modal-contents\">\n        <div class=\"jse-label\">\n          <div class=\"jse-label-inner\">Path</div>\n        </div>\n        <input\n          class=\"jse-path\"\n          type=\"text\"\n          readonly\n          title=\"Selected path\"\n          value={pathDescription}\n        />\n\n        <div class=\"jse-label\">\n          <div class=\"jse-label-inner\">Contents</div>\n        </div>\n\n        <div class=\"jse-modal-inline-editor\">\n          <JSONEditorRoot\n            bind:this={refEditor}\n            externalMode={currentState.mode}\n            content={currentState.content}\n            selection={currentState.selection}\n            {readOnly}\n            {indentation}\n            {tabSize}\n            {truncateTextSize}\n            {statusBar}\n            {askToFormat}\n            {mainMenuBar}\n            {navigationBar}\n            {escapeControlCharacters}\n            {escapeUnicodeCharacters}\n            {flattenColumns}\n            {parser}\n            {parseMemoizeOne}\n            {validator}\n            {validationParser}\n            {pathParser}\n            insideModal={true}\n            onError={handleError}\n            onChange={handleChange}\n            onChangeMode={handleChangeMode}\n            onSelect={handleChangeSelection}\n            {onRenderValue}\n            {onClassName}\n            onFocus={noop}\n            onBlur={noop}\n            {onRenderMenu}\n            {onRenderContextMenu}\n            {onSortModal}\n            {onTransformModal}\n            onJSONEditorModal={handleJSONEditorModal}\n          />\n        </div>\n\n        <div class=\"jse-actions\">\n          {#if error}\n            <div class=\"jse-error\">\n              {error}\n            </div>\n          {/if}\n\n          {#if stack.length > 1}\n            <button type=\"button\" class=\"jse-secondary\" on:click={handleClose}>\n              <Icon data={faCaretLeft} /> Back\n            </button>\n          {/if}\n          {#if !readOnly}\n            <button type=\"button\" class=\"jse-primary\" on:click={handleApply} use:focus>\n              Apply\n            </button>\n          {:else}\n            <button type=\"button\" class=\"jse-primary\" on:click={handleClose}> Close </button>\n          {/if}\n        </div>\n      </div>\n    </AbsolutePopup>\n  </div>\n</Modal>\n\n<style src=\"./JSONEditorModal.scss\"></style>\n","import JsonEditor from './components/JSONEditor.svelte'\nimport type { JSONEditorPropsOptional } from '$lib/types'\nimport { flushSync, mount, unmount } from 'svelte'\n\n// Note: index.ts exports `JSONEditor`, but we will override this on purpose\n//  since we cannot use it in the vanilla environment starting in Svelte 5.\nexport * from './index'\n\nexport interface CreateJSONEditorProps {\n  target: HTMLDivElement\n  props: JSONEditorPropsOptional\n}\n\nexport { JsonEditor }\n\nexport function createJSONEditor({ target, props }: Parameters<typeof mount>[1]): JsonEditor {\n  const editor = mount(JsonEditor, { target, props })\n\n  editor.destroy = async () => unmount(editor)\n\n  flushSync()\n\n  return editor as JsonEditor\n}\n\n/**\n * @deprecated The constructor \"new JSONEditor(...)\" is deprecated. Please use \"createJSONEditor(...)\" instead.\n */\nexport function JSONEditor({ target, props }: CreateJSONEditorProps) {\n  // TODO: deprecation warning since v1. Remove some day\n  console.warn(\n    'WARNING: the constructor \"new JSONEditor(...)\" is deprecated since v1. ' +\n      'Please use \"createJSONEditor(...)\" instead.'\n  )\n\n  return createJSONEditor({ target, props })\n}\n"],"names":["_window$__svelte","_window$__svelte$v","_window","_window$__svelte2","window","__svelte","v","Set","add","legacy_mode_flag","UNINITIALIZED","Symbol","is_array","Array","isArray","index_of","prototype","indexOf","array_from","from","define_property","Object","defineProperty","get_descriptor","getOwnPropertyDescriptor","get_descriptors","getOwnPropertyDescriptors","object_prototype","array_prototype","get_prototype_of","getPrototypeOf","is_extensible","isExtensible","is_function","thing","noop","noop$2","run","fn","run_all","arr","i","length","BRANCH_EFFECT","ROOT_EFFECT","UNOWNED","DISCONNECTED","CLEAN","DIRTY","MAYBE_DIRTY","INERT","DESTROYED","EFFECT_TRANSPARENT","INSPECT_EFFECT","EFFECT_PRESERVED","EFFECT_IS_UPDATING","USER_EFFECT","STATE_SYMBOL","LEGACY_PROPS","LOADING_ATTR_SYMBOL","STALE_REACTION","Error","constructor","super","arguments","_defineProperty","this","equals","value","safe_not_equal","a","b","not_equal","safe_equals","lifecycle_outside_component","name","component_context","set_component_context","context","getContext","key","get_or_init_context_map","get","push","props","p","c","e","s","x","l","undefined","u","r1","r2","source","pop","component","effects","create_user_effect","is_runes","_component_context","_component_context$c","Map","parent","context_map","get_parent_context","proxy","sources","is_proxied_array","version","parent_version","update_version","with_parent","reaction","active_reaction","set_active_reaction","set_update_version","result","set","Proxy","_","prop","descriptor","configurable","enumerable","writable","e.state_descriptors_fixed","deleteProperty","target","increment","ls","n","Number","isInteger","receiver","_get_descriptor","exists","Reflect","has","_get_descriptor2","active_effect","_get_descriptor3","other_s","call","ownKeys","own_keys","filter","setPrototypeOf","e.state_prototype_fixed","get_proxied_value","_unused","is","derived","flags","DERIVED","parent_derived","f","ctx","deps","reactions","rv","wv","ac","user_derived","d","push_reaction_value","derived_safe_equal","signal","destroy_derived_effects","destroy_effect","execute_derived","prev_active_effect","set_active_effect","get_derived_parent_effect","update_reaction","update_derived","increment_write_version","is_destroying_effect","set_signal_status","skip_reaction","old_values","stack","state","mutable_source","initial_value","_component_context$l","_component_context$l$","immutable","trackable","mutate","untrack","_current_sources","should_proxy","untracking","current_sources","includes","e.state_unsafe_mutation","internal_set","old_value","mark_reactions","untracked_writes","set_untracked_writes","update","status","runes","schedule_effect","$window","is_firefox","first_child_getter","next_sibling_getter","create_text","document","createTextNode","get_first_child","node","get_next_sibling","child","is_text","first_child","fragment","first","Comment","data","sibling","count","next_sibling","validate_effect","rune","e.effect_orphan","e.effect_in_unowned_derived","e.effect_in_teardown","create_effect","type","sync","effect","nodes_start","nodes_end","last","next","prev","teardown","transitions","update_effect","parent_effect","parent_last","push_effect","_derived$effects","user_effect","_context$e","EFFECT","legacy_pre_effect","token","ran","render_effect","legacy_pre_effect_reset","check_dirtiness","template_effect","deriveds","map","block","RENDER_EFFECT","branch","execute_effect_teardown","previously_destroying_effect","previous_reaction","set_is_destroying_effect","destroy_effect_children","remove_dom","_effect$ac","abort","removed","remove_effect_dom","remove_reactions","transition","stop","unlink_effect","end","remove","pause_effect","callback","pause_children","run_out_transitions","remaining","check","out","local","is_global","resume_effect","resume_children","in","micro_tasks","idle_tasks","run_micro_tasks","tasks","queue_micro_task","queueMicrotask","flush_tasks","invoke_error_boundary","error","_unused2","is_flushing","last_scheduled_effect","is_updating_effect","queued_root_effects","new_deps","skipped_deps","write_version","read_version","captured_signals","dependencies","is_unowned","dependency","is_disconnected","is_unowned_connected","_dependency","_dependency2","_dependency2$reaction","schedule_possible_effect_self_invalidation","_current_sources2","root","previous_deps","previous_skipped_deps","previous_untracked_writes","previous_skip_reaction","previous_sources","previous_component_context","previous_untracking","previous_update_version","_deps$i","_deps$i$reactions","handle_error","remove_reaction","index","new_length","start_index","previous_effect","was_updating_effect","destroy_block_effect_children","infinite_loop_guard","e.effect_update_depth_exceeded","flush_queued_root_effects","flush_count","root_effects","flush_queued_effects","process_effects","clear","is_branch","flushSync","_tick","_asyncToGenerator","Promise","resolve","apply","_current_sources3","is_derived","depends_on_old_values","dep","invalidate_inner_signals","captured","previous_captured_signals","capture_signals","STATUS_MASK","deep_read_state","EventTarget","deep_read","visited","Date","getTime","proto","descriptors","listening_to_form_reset","without_reactive_context","listen_to_event_and_reset_event","element","event","handler","on_reset","addEventListener","__on_r","evt","then","defaultPrevented","elements","_e$__on_r","capture","all_registered_events","root_event_handles","create_event","event_name","dom","options","target_handler","handle_event_propagation","cancelBubble","startsWith","passive","body","HTMLMediaElement","removeEventListener","delegate","events","_event$composedPath","handler_element","owner_document","ownerDocument","path","composedPath","current_target","path_idx","handled_at","__root","at_idx","handler_idx","throw_error","other_errors","parent_element","assignedSlot","parentNode","host","delegated","_loop","currentTarget","create_fragment_from_html","html","elem","createElement","innerHTML","replaceAll","content","assign_nodes","start","from_html","is_fragment","use_import_node","has_start","clone","importNode","cloneNode","lastChild","from_svg","ns","wrapped","concat","createDocumentFragment","appendChild","from_namespace","text","t","comment","frag","createComment","anchor","append","before","DELEGATED_EVENTS","ATTRIBUTE_ALIASES","formnovalidate","ismap","nomodule","playsinline","readonly","defaultvalue","defaultchecked","srcobject","novalidate","allowfullscreen","disablepictureinpicture","disableremoteplayback","PASSIVE_EVENTS","is_passive_event","set_text","_text$__t","str","__t","nodeValue","mount","Component","_ref2","intro","test","navigator","userAgent","element_prototype","Element","node_prototype","Node","text_prototype","Text","__click","__className","__attributes","__style","__e","init_operations","registered_events","event_handle","document_listeners","unmount","fulfil","outro","component_root","anchor_node","$$events","delete","_anchor_node$parentNo","removeChild","mounted_components","_mount","WeakMap","onMount","init_update_callbacks","m","cleanup","onDestroy","createEventDispatcher","active_component_context","detail","_active_component_con","callbacks","slice","bubbles","cancelable","CustomEvent","create_custom_event","beforeUpdate","e.lifecycle_legacy_only","_l$u","if_block","root_index","hydrate_index","consequent_effect","alternate_effect","condition","has_branch","set_branch","update_branch","new_condition","key_block","get_key","render_fn","changed","each","get_collection","fallback_fn","items","fallback","was_empty","each_array","collection","array","seen","to_animate","item","is_animated","should_update","current","matched","stashed","_item$a","measure","_item$a2","update_item","unfix","j","move","link","k","create_item","to_destroy","destroy_length","controlled_anchor","_to_destroy$i$a","_to_destroy$i$a2","fix","items_map","is_controlled","parent_node","textContent","pause_effects","_item$a3","reconcile","dest","next_node","get_value","svg","mathml","_get_value","slot","$$props","slot_props","_$$props$$$slots","slot_fn","$$slots","is_interop","get_component","action","payload","inited","destroy","attach","get_fn","r","o","clsx","_clsx","whitespace","append_styles","styles","separator","css","to_css_name","toLowerCase","set_class","is_html","hash","prev_classes","next_classes","next_class_name","directives","classname","len","substring","to_class","removeAttribute","className","setAttribute","is_present","classList","toggle","update_styles","priority","style","removeProperty","setProperty","set_style","prev_styles","next_styles","next_style_attr","normal_styles","important_styles","new_style","String","trim","in_str","in_apo","in_comment","reserved_names","keys","name_index","to_style","cssText","select_option","select","mounting","multiple","console","warn","option","selected","get_option_value","selectedIndex","init_select","observer","MutationObserver","__value","observe","childList","subtree","attributes","attributeFilter","disconnect","CLASS","STYLE","IS_CUSTOM_ELEMENT","IS_HTML","set_value","get_attributes","nodeName","set_attribute","attribute","skip_warning","get_setters","set_attributes","css_hash","_next$style","is_custom_element","preserve_attribute_case","is_option_element","tagName","class","prev_value","prefix","is_default","setters","_loop2","_key3","namespaceURI","hasAttribute","opts","event_handle_key","is_delegated","endsWith","is_capture_event","handle","autofocus","activeElement","focus","Boolean","set_selected","_ATTRIBUTE_ALIASES$na","normalize_attribute","input","use_default","previous","defaultValue","defaultChecked","checked","attribute_effect","is_select","symbol","getOwnPropertySymbols","description","_element$__attributes","setters_cache","element_proto","bind_value","is_reset","is_numberlike_input","to_number","selectionStart","selectionEnd","Math","min","bind_prop","desc","is_bound_this","bound_value","element_or_component","bind_this","old_parts","parts","stopPropagation","_len3","args","_key5","preventDefault","_len4","_key6","init","observe_all","fns","reactive_import","bubble_event","_$$props$$$events","is_store_binding","legacy_rest_props_handler","exclude","special","legacy_rest_props","spread_props_handler","spread_props","_len5","_key8","setter","bindable","lazy","fallback_value","fallback_dirty","get_fallback","_get_descriptor$set","_get_descriptor4","is_entry_props","getter","is_store_sub","previous_is_store_binding","capture_store_binding","e.props_invalid_value","legacy_parent","$$legacy","mutation","overridden","new_value","createDebug","namespace","enabled","debug","localStorage","_unused3","tryReadLocalStorage","enableDebug","color","charCodeAt","colors","abs","selectColor","_len6","_key9","log","id","uniqueId","int","parseInt","containsNumber","NUMBER_REGEX","isObject","isObjectOrArray","isBoolean","isTimestamp","isFinite","floor","isNaN","valueOf","_unused4","getColorCSS","colorTestDiv","applied","replace","isColor","valueType","parser","valueStr","stringify","isUrlRegex","isUrl","stringConvert","strTrim","parse","INTEGER_REGEX","ROOT_PATH","strictShallowEqual","getNestedPaths","includeObjects","pointersMap","TypeError","recurseNestedPaths","obj","compileJSONPointer","forEach","max","sort","parseJSONPointer","forEachIndex","iteratee","limit","arrayToObject","_objectSpread","objectToArray","object","values","moveItems","offset","copy","moving","splice","insertItemsAt","parseAndRepair","jsonText","_unused5","jsonrepair","parseAndRepairOrUndefined","partialJson","_unused6","parsePartialJson","END_WITH_COMMA_AND_OPTIONAL_WHITESPACES_REGEX","_unused7","_unused8","_unused9","repairPartialJson","_unused0","repaired","_unused1","_unused10","normalizeJsonParseError","parseErrorMessage","positionMatch","POSITION_REGEX","exec","position","line","character","charAt","countCharacterOccurrences","column","lastIndexOf","message","lineMatch","LINE_REGEX","lineOneBased","columnMatch","COLUMN_REGEX","columnOneBased","calculatePosition","findTextLocation","jsmap","jsonSourceMap","pointerName","pointer","pointers","pos","to","keyEnd","valueEnd","err","validateContentType","json","isContent","isTextContent","isJSONContent","toTextContent","indentation","JSON","toJSONContent","getText","isLargeContent","maxSize","estimateSerializedSize","Infinity","estimatedSize","recurse","isEqualParser","needsFormatting","head","DELIMITER_WITHOUT_SPACING_REGEX","Mode","SelectionType","CaretType","ValidationSeverity","SearchField","SortDirection","UpdateSelectionAfterChange","createNormalizationFunctions","_ref3","escapeControlCharacters","escapeUnicodeCharacters","normalizeControlAndUnicode","normalizeControl","normalizeUnicode","normalizeNothing","escapeValue","jsonEscapeUnicode","jsonEscapeControl","unescapeValue","jsonUnescapeControl","jsonUnescapeUnicode","_x$codePointAt","codePointAt","toString","unescaped","controlCharacters","_unused13","escapedControlCharacters","addNewLineSuffix","isChildOfNodeName","isChildOf","toUpperCase","isChildOfAttribute","getAttribute","predicate","findParent","getWindow","_element$ownerDocumen","_element$ownerDocumen2","defaultView","activeElementIsChildOf","findParentWithNodeName","getSelectionTypeFromTarget","inside","after","multi","encodeDataPath","encodeURIComponent","getDataPathFromTarget","_parent$getAttribute","dataPath","decodeURIComponent","findNearestElement","_ref4","allElements","currentElement","direction","hasPrio","margin","all","rect","getBoundingClientRect","width","height","calculateCenter","left","y","top","distance","weightY","diffX","diffY","sqrt","distanceToCurrent","candidate","candidatesLeft","button","isLeft","isRight","right","candidatesLeftOnRow","isOnSameRow","nearest","minBy","candidates","isAbove","isBelow","prioCandidates","isMacDevice","_ref5","_navigator$platform$t","_navigator","_navigator2","platform","userAgentData","keyComboFromEvent","combi","isCtrlKeyDown","altKey","shiftKey","keyName","metaKeys","join","isMac","ctrlKey","metaKey","Ctrl","Command","Control","Alt","Option","Shift","styleInject","ref","insertAt","getElementsByTagName","firstChild","insertBefore","styleSheet","popup","$.prop","closeAbsolutePopup","refRootPopup","$.mutable_source","refHiddenInput","closeWhenOutside","closeOnOuterClick","$.get","handleKeyDown","$.bind_this","$$value","$.set","$.component","$$anchor","$$component","$.spread_props","$.untrack","rootRect","positionAbove","positionLeft","offsetTop","offsetLeft","bottom","innerHeight","innerWidth","calculateStyle","$$render","consequent","div","popups","popupId","popupIndex","findIndex","onClose","openAbsolutePopup","$.each","findUniqueName","keysSet","nameWithoutCopySuffix","validName","truncate","maxLength","maxTextLength","ellipsis","parseString","lower","num","numFloat","parseFloat","jsonQueryLanguage","_json","queryOptions","projection","queryFunctions","relation","operator","paths","query","preprocessedJson","stringifyAndParse","jsonquery","cursor","raw","getRaw","rawData","ids","match","rawId","pointerId","iconData","scale","spin","inverse","pulse","flip","label","combinedStyle","box","normalisedScale","numScale","calculateRatio","iconName","icon","normaliseData","combined","size","_className","$$restProps","_get2","_get3","polygons","polygon","_get4","readOnly","onPatch","expression","$.derived_safe_equal","faCheckSquare","faSquare","$.set_attribute","op","onChange","showOnTop","destroyColorPicker","_yield$import","colorPicker","default","onDone","hex","rgba","show","title","_get5","_getWindow$1$innerHei","_getWindow$","ColorPickerPopup","MAX_SEARCH_RESULTS","ARRAY_SECTION_SIZE","MAX_VALIDATION_ERRORS","MAX_CHARACTERS_TEXT_PREVIEW","DEFAULT_VISIBLE_SECTIONS","MAX_AUTO_REPAIRABLE_SIZE","MAX_MULTILINE_PASTE_SIZE","MAX_DOCUMENT_SIZE_TEXT_MODE","INSERT_EXPLANATION","CONTEXT_MENU_EXPLANATION","HOVER_INSERT_INSIDE","HOVER_INSERT_AFTER","HOVER_COLLECTION","JSON_STATUS_VALID","JSON_STATUS_REPAIRABLE","CONTEXT_MENU_HEIGHT","CONTEXT_MENU_WIDTH","SEARCH_BOX_HEIGHT","SORT_DIRECTION_NAMES","asc","mergeSections","sections","sortedSections","sortBy","section","mergedSections","sortedIndex","mergedIndex","nextRoundNumber","currentRoundNumber","isMenuSpace","isMenuSeparator","isMenuLabel","isMenuButton","isMenuDropDownButton","isContextMenuRow","isContextMenuColumn","isContentParseError","contentErrors","isContentValidationErrors","isValidationError","isNestedValidationError","isChildError","isSvelteComponentRenderer","isSvelteActionRenderer","isObjectRecursiveState","isArrayRecursiveState","isValueRecursiveState","isExpandableState","hasSearchResults","searchResults","isTreeHistoryItem","historyItem","isTextHistoryItem","isModeHistoryItem","createDocumentState","_ref8","expand","documentState","_ref7","factory","createArrayDocumentState","createObjectDocumentState","createValueDocumentState","createRecursiveState","documentStateFactory","expandPath","expanded","visibleSections","properties","ensureRecursiveState","_ref9","arrayState","itemState","setIn","objectState","syncDocumentState","_transformDocumentState","nestedJson","nestedState","updatedState","forEachVisibleIndex","itemPath","updatedItem","propPath","updatedProp","jsonArray","_ref0","toRecursiveStatePath","recursiveStatePath","partialPath","updateInDocumentState","some","inVisibleSection","newVisibleSection","expandVisibleSection","_loop3","nestedValue","nestedPath","_expandRecursively","collapsePath","recursive","_collapse","_collapseRecursively","documentStatePatch","operations","initial","reduce","operation","immutableJSONPatch","_documentStatePatch","isJSONPatchAdd","documentStateAdd","isJSONPatchRemove","documentStateRemove","isJSONPatchReplace","parsePath","enforceString","getEnforceString","setInDocumentState","isJSONPatchCopy","isJSONPatchMove","stateValue","getInRecursiveState","documentStateMoveOrCopy","getIn","_unused14","updateInRecursiveState","transform","ensuredState","updateIn","recursiveState","setInRecursiveState","_parent","shiftVisibleSections","parentPath","recursivePath","existsIn","deleteIn","deleteInDocumentState","merged","mergeAdjacentSections","getNextKeys","includeKey","getVisiblePaths","_recurse","isJSONArray","isJSONObject","getVisibleCaretPositions","includeInside","valueState","propertyPath","getNextVisiblePath","visiblePaths","expandSmart","expandMinimal","expandAll","expandSmartIfCollapsed","relativePath","expandSelf","expandNone","isAfterSelection","selection","isInsideSelection","isKeySelection","isValueSelection","isMultiSelection","isMultiSelectionWithOneItem","isEqual","focusPath","anchorPath","isJSONSelection","isTextSelection","getSelectionPaths","getAnchorPath","getFocusPath","sharedPath","findSharedPath","createMultiSelection","startPath","getStartPath","endPath","getEndPath","startIndex","getChildIndex","endIndex","iterateOverSelection","getParentPath","anchorIndex","getSelectionUp","keepAnchorPath","previousPath","visiblePathPointers","pathPointer","getPreviousVisiblePath","createValueSelection","isEmpty","createKeySelection","findCaretAndSiblings","caret","visibleCaretPositions","getInitialSelection","createSelectionFromOperations","every","firstOp","otherOps","path1","path2","singleItemSelected","findRootPath","pathStartsWith","removeEditModeFromSelection","isEditingSelection","createEditKeySelection","initialValue","edit","createEditValueSelection","createInsideSelection","createAfterSelection","isParent","selectionToPartialJson","hasSelectionContents","canConvert","fromCaretPosition","caretPosition","fromSelectionType","selectionType","selectionIfOverlapping","pathInSelection","pathIndex","classnames","classes","_len7","_key0","arg","hasOwnProperty","getValueClass","mode","table","shortText","onCancel","onFind","onPaste","onValueClass","domValue","valueClass","closed","getDomValue","removeNewLineSuffix","innerText","setDomValue","updatedValue","$.mutate","range","createRange","getSelection","setStart","collapse","removeAllRanges","addRange","setCursorToEnd","newValue","no","combo","nextInside","clipboardData","clipboardText","getData","hasFocus","self","normalization","onPasteJson","onSelect","findNextInside","convert","handleCancelChange","updateSelection","patchedState","patchedSelection","pastedText","pastedJson","contents","onPasteAsJson","patchedJson","_unused15","entry","afterKey","nextKeys","newProp","moveDown","rename","oldKey","newKey","newKeyUnique","duplicate","lastPath","beforeKey","extract","insert","clipboard","_unused16","newValues","clipboardToValues","firstPath","removeAll","removeKeys","filteredKeys","nextKey","firstKey","reverse","textIsObject","textIsArray","clipboardOriginal","clipboardRepaired","createRemoveOperations","newSelection","previousKey","revertJSONPatchWithMoveOperations","filteredOperations","processedOps","splitParentKey","_equalParentPath","movedKeys","_findKeyWithLowestKeyIndex","getOperation","renameOps","_filterRedundantMoveOperations","revertJSONPatch","revertOperations","createRevertMoveOperations","searchNext","searchResult","nextActiveIndex","activeIndex","nextActiveItem","active","activeItem","search","searchText","_options$maxResults","searchTextLowerCase","maxResults","columns","results","onMatch","searchRecursive","level","findCaseInsensitiveMatches","field","textLower","fieldIndex","replaceText","replacementText","replaceAllText","occurrences","updatedText","forEachRight","occurrence","createSearchAndReplaceOperations","searchResultItem","currentValue","currentValueText","getSearchResultPath","filterKeySearchResults","filtered","filterValueSearchResults","searchResultsFactory","toRecursiveSearchResults","searchResultItems","updateInSearchResults","flattenSearchResults","_node$searchResults","nested","flatMap","matches","previousEnd","precedingText","resultIndex","matchingText","lastMatch","splitValue","part","alternate","formatSize","kilo","factor","toFixed","KB","MB","GB","handleClick","$.derived","_get6","$$args","get_snippet","_len","_key2","snippet_effect","snippet","handleValueClick","valueIsUrl","open","handleValueDoubleClick","doTruncate","isTruncated","truncateTextSize","truncatedValue","handleShowMore","$.template_effect","$0","$.set_text","text_1","consequent_1","tooltip","_ref1","handleMouseEnter","Tooltip","handleMouseLeave","absolutePopupContext","faClock","renderValue","renderers","isEditing","BooleanToggle","ColorPicker","EditableValue","ReadonlyValue","TimestampTag","stringifyJSONPath","integerNumberRegex","escapeQuotes","parseJSONPath","pathStr","parseProp","eatCharacter","isEnd","unescape","char","SyntaxError","pathToOption","stringifyLodashProperty","javaScriptPropertyRegex","propStr","createPropertySelector","transformModalStates","transformModalStateShared","showWizard","showOriginal","round","createCoords","oppositeSideMap","oppositeAlignmentMap","clamp","evaluate","param","getSide","placement","split","getAlignment","getOppositeAxis","axis","getAxisLength","yAxisSides","getSideAxis","getAlignmentAxis","getOppositeAlignmentPlacement","alignment","lrPlacement","rlPlacement","tbPlacement","btPlacement","getOppositeAxisPlacements","flipAlignment","rtl","list","side","isStart","getSideList","getOppositePlacement","getPaddingObject","padding","expandPaddingObject","rectToClientRect","computeCoordsFromPlacement","_ref","coords","reference","floating","sideAxis","alignmentAxis","alignLength","isVertical","commonX","commonY","commonAlign","computePosition","_ref10","config","strategy","middleware","validMiddleware","isRTL","rects","getElementRects","statefulPlacement","middlewareData","resetCount","nextX","nextY","reset","initialPlacement","_x","_x2","_x3","detectOverflow","_x4","_x5","_detectOverflow","_await$platform$isEle","boundary","rootBoundary","elementContext","altBoundary","paddingObject","clippingClientRect","getClippingRect","isElement","contextElement","getDocumentElement","offsetParent","getOffsetParent","offsetScale","getScale","elementClientRect","convertOffsetParentRelativeRectToViewportRelativeRect","originSides","_convertValueToCoords","mainAxisMulti","crossAxisMulti","rawValue","mainAxis","crossAxis","hasWindow","getNodeName","isNode","_node$ownerDocument","documentElement","isHTMLElement","HTMLElement","isShadowRoot","ShadowRoot","invalidOverflowDisplayValues","isOverflowElement","overflow","overflowX","overflowY","display","getComputedStyle","tableElements","isTableElement","topLayerSelectors","isTopLayer","selector","_e","transformProperties","willChangeValues","containValues","isContainingBlock","elementOrCss","webkit","isWebKit","containerType","backdropFilter","willChange","contain","CSS","supports","lastTraversableNodeNames","isLastTraversableNode","getNodeScroll","scrollLeft","scrollTop","scrollX","scrollY","getParentNode","getNearestOverflowAncestor","getOverflowAncestors","traverseIframes","_node$ownerDocument2","scrollableAncestor","isBody","win","frameElement","getFrameElement","visualViewport","getCssDimensions","hasOffset","offsetWidth","offsetHeight","shouldFallback","$","unwrapElement","domElement","noOffsets","getVisualOffsets","includeScale","isFixedStrategy","clientRect","visualOffsets","isFixed","floatingOffsetParent","shouldAddVisualOffsets","offsetWin","currentWin","currentIFrame","iframeScale","iframeRect","clientLeft","paddingLeft","clientTop","paddingTop","getWindowScrollBarX","leftScroll","getHTMLOffset","scroll","ignoreScrollbarX","htmlRect","absoluteOrFixed","getClientRectFromClippingAncestor","clippingAncestor","clientWidth","clientHeight","visualViewportBased","getViewportRect","scrollWidth","scrollHeight","getDocumentRect","getInnerBoundingClientRect","hasFixedPositionAncestor","stopNode","getRectRelativeToOffsetParent","isOffsetParentAnElement","offsets","setLeftRTLScrollbarOffset","offsetRect","htmlOffset","isStaticPositioned","getTrueOffsetParent","polyfill","rawOffsetParent","svgOffsetParent","currentNode","getContainingBlock","topLayer","clippingAncestors","cache","cachedResult","el","currentContainingBlockComputedStyle","elementIsFixed","computedStyle","currentNodeIsContaining","ancestor","getClippingElementAncestors","_c","firstClippingAncestor","clippingRect","accRect","_ref11","getOffsetParentFn","getDimensionsFn","getDimensions","floatingDimensions","_x8","getClientRects","rectsAreEqual","autoUpdate","ancestorScroll","ancestorResize","elementResize","ResizeObserver","layoutShift","IntersectionObserver","animationFrame","referenceEl","ancestors","frameId","cleanupIo","onMove","timeoutId","io","_io","clearTimeout","refresh","skip","threshold","elementRectForRootMargin","rootMargin","isFirstUpdate","handleObserve","entries","ratio","intersectionRatio","setTimeout","observeMove","reobserveFrame","resizeObserver","firstEntry","unobserve","cancelAnimationFrame","requestAnimationFrame","_resizeObserver","prevRefRect","frameLoop","nextRefRect","_resizeObserver2","_middlewareData$offse","_middlewareData$arrow","diffCoords","_x6","_x7","convertValueToCoords","arrow","alignmentOffset","shift","_evaluate2","checkMainAxis","checkCrossAxis","limiter","detectOverflowOptions","_objectWithoutProperties","_excluded2","mainAxisCoord","crossAxisCoord","maxSide","limitedCoords","_middlewareData$flip","_evaluate","fallbackPlacements","specifiedFallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","_excluded","initialSideAxis","isBasePlacement","oppositePlacement","getExpandedPlacements","hasFallbackAxisSideDirection","placements","overflows","overflowsData","sides","mainAlignmentSide","getAlignmentSides","_middlewareData$flip2","_overflowsData$filter","nextIndex","nextPlacement","resetPlacement","_overflowsData$filter2","currentSideAxis","acc","createFloatingActions","initOptions","referenceElement","floatingElement","defaultOptions","getOptions","mixin","updatePosition","updateOptions","mergedOptions","platformWithCache","computePosition$1","_options","assign","onComputed","setupVirtualElementObserver","subscribe","$node","contentAction","contentOptions","autoUpdateDestroy","destroyAutoUpdate","initAutoUpdate","tick","_autoUpdate","_ref12","loadOptions","filterText","itemId","groupBy","filterSelectedItems","itemFilter","convertStringItemsToObjects","filterGroupedItems","filterResults","matchesFilter","getItems","_x9","_getItems","_ref13","dispatch","res","catch","details","cancelled","filteredItems","loading","focused","listOpen","sanitized","children","timeout","justValue","_filter","container","multiFullItemClearable","disabled","placeholder","placeholderAlwaysShow","groupFilter","groups","groupHeaderSelectable","containerStyles","hasError","required","closeListOnChange","clearFilterTextOnBlur","createGroupHeaderItem","groupValue","getFilteredItems","searchable","inputStyles","clearable","debounce","wait","debounceWait","hideEmptyState","inputAttributes","listAutoWidth","showChevron","listOffset","hoverItemIndex","floatingConfig","containerClasses","activeValue","prev_filterText","prev_multiple","_inputAttributes","_items","groupValues","groupHeader","selectable","groupItem","sortedGroupedItems","checkHoverSelectable","startingIndex","ignoreGroup","setHoverIndex","checkValueForDuplicates","noDuplicates","uniqueValues","val","findItem","matchTo","find","handleMultiItemClear","_x0","_handleMultiItemClear","itemToRemove","closeList","hoverItem","handleSelect","handleFocus","_document","_input","handleBlur","_x1","_handleBlur","_input2","isScrolling","blur","handleClear","ariaValues","ariaListOpen","ariaFocused","isScrollingTimer","handleListScroll","_get8","itemSelected","handleHover","hasOwn","hover","isItemActive","activeScroll","scrollAction","hoverScroll","scrollIntoView","behavior","_floatingConfig","floatingRef","floatingContent","floatingUpdate","prefloat","setValue","autocapitalize","autocomplete","autocorrect","spellcheck","tabindex","hasValue","hideSelectedItem","showClear","placeholderText","_value5","_multiple","ariaSelection","ariaContext","_item","handleAriaContent","updateValueDisplay","handleFilterEvent","listDom","listMounted","setListWidth","scrollToHoverItem","_floatingConfig2","_get7","contains","_get9","itemIndex","_get0","$.event","div_2","$.stopPropagation","isItemSelectable","handleItemClick","consequent_3","consequent_4","div_1","consequent_5","consequent_6","div_8","$.preventDefault","ClearIcon","consequent_7","consequent_8","alternate_2","consequent_9","input_1","consequent_10","consequent_11","consequent_12","_containerClasses","_queryOptions","_filterRelationOption","_queryOptions2","_queryOptions3","_sortDirectionOptions","filterRelationOptions","sortDirectionOptions","filterPath","filterRelation","_queryOptions$filter","filterValue","sortPath","sortDirection","_queryOptions$sort","jsonIsArray","pathsIncludingObjects","fieldOptions","projectionOptions","projectionPaths","_queryOptions0","_queryOptions4","_get1","_queryOptions5","_get10","_queryOptions6","_queryOptions7","_get11","_queryOptions8","_get12","_queryOptions9","changeProjectionPaths","$.bind_value","queryLanguages","queryLanguageId","onChangeQueryLanguage","queryLanguage","_ref16","handleChangeQueryLanguage","newQueryLanguageId","fullScreenButton","fullscreen","faDownLeftAndUpRightToCenter","faUpRightAndDownLeftFromCenter","faTimes","_onClose","createAutoScrollHandler","scrollableElement","autoScrollSpeed","autoScrollTimer","calculateSpeed","diff","autoScrollCallback","startAutoScroll","speed","stopAutoScroll","setInterval","clearInterval","onDrag","clientY","onDragEnd","easeInOutQuad","createJump","easing","a11y","duration","timeStart","timeElapsed","scrolling","scrollTo","loop","timeCurrent","done","querySelector","onDuration","now","validationErrorsFactory","updateInValidationErrors","errors","validateJSON","validator","validationParser","validateText","validationErrors","severity","info","convertedJSON","isRepairable","_unused17","canAutoRepair","parseError","createFocusTracker","_ref17","blurTimeoutHandle","onFocus","onBlur","handleFocusIn","newFocus","handleFocusOut","actions","onClick","_ref18","onMouseDown","_type","_message","selectError","validationError","faExclamationTriangle","faAngleDown","_ref19","tr","text_2","faAngleRight","_get13","getMaxSeverity","warning","consequent_2","onEscape","dialog","close","showModal","dialog_1","_len2","_key4","ctrl","_onClose2","node_1","_ref20","_get$onClick","unknownMenuItem","onParse","onRepair","onApply","domTextArea","goToError","setSelectionRange","handleApply","handleRepair","_unused19","getErrorMessage","repairable","_unused18","gotoAction","faArrowDown","repairAction","faWrench","errorActions","successActions","faCheck","textarea","repairedText","handleCancel","sectionIndex","total","onExpandSection","visibleSection","getJson","expandItemsSections","section1","start2","section2","currentIndex","previousIndex","section3","showSection2","getExpandItemsSections","expandItemsSection","_ref21","_ref22","_get14","_get15","onContextMenu","faCaretDown","buttonElem","showTip","onRenderValue","renderer","$.action","$$node","$$action_arg","_get16","Component_1","singleton","selecting","selectionAnchor","selectionAnchorType","selectionFocus","dragging","onMoveSelection","_ref23","deltaY","updatedSelection","dragInsideAction","_ref24","initialPath","initialIndex","prevHeight","_items2","cumulativeHeight","beforePath","findSwapPathUp","_ref25","_items$beforeIndex","nextHeight","_items3","beforeIndex","findSwapPathDown","startKey","endKey","toKey","toIndex","times","moveInsideParent","_ref26","_items4","_items5","createUpdatedArraySelection","onExpand","_onExpand","_ref27","onDragSelectionStart","hoverTimer","isNodeSelected","toggleExpand","handleExpand","handleUpdateKey","handleMouseMoveGlobal","handleMouseUpGlobal","$$_import_singleton","findContentTop","_context$findElement","findElement","calculateDeltaY","contentOffset","initialContentTop","initialClientY","handleDragSelectionStart","selectionParentPath","addHeight","currentSection","getVisibleItemsWithHeights","selectionStartIndex","initialTarget","selectionItemsCount","didMoveItems","handleDragSelection","handleDragSelectionEnd","handleInsertInside","handleInsertAfter","handleInsertInsideOpenContextMenu","contextMenuProps","handleInsertAfterOpenContextMenu","_validationErrors","faCaretRight","_ref28","_ref29","_ref30","_ref31","alternate_1","$.index","indices","gutterIndex","nestedValidationErrors","nestedSelection","appendToJSONPointer","expression_4","alternate_4","consequent_13","alternate_5","consequent_17","consequent_16","alternate_6","getKeys","propPointer","nestedSearchResults","onUpdateKey","handleKeyDoubleClick","isEditingKey","handleChangeValue","updatedKey","updatedPath","isKeySelected","$.set_class","consequent_19","consequent_20","consequent_22","consequent_24","consequent_25","onClassName","buttons","contentEditable","anchorType","getDocumentState","fullSelection","lastCaretPosition","empty","faJSONEditorExpand","faJSONEditorCollapse","faJSONEditorFormat","faJSONEditorCompact","handleCreateObject","handleCreateArray","caseInsensitiveNaturalCompare","aLower","bLower","naturalCompare","sortJson","rootPath","comparator","sortableTypes","boolean","number","string","otherTypes","valueA","valueB","_sortableTypes$valueA","_sortableTypes$valueB","aIndex","bIndex","createObjectComparator","sortArray","sortedKeys","keyA","keyB","sortedObject","sortObjectKeys","selectedItem","refNavigationBarItem","handleSelectItem","button_1","NavigationBarDropdown","copyToClipBoard","_document$queryComman","_document2","writeText","queryCommandSupported","opacity","execCommand","pathParser","onError","pathExists","inputRef","inputPath","validationActive","copiedTimer","copied","parseAndValidate","validatePathExists","inputValidationError","faCopy","refNavigationBar","editing","handleCloseEditor","handleChangePath","hasNextItem","node_2","faClose","faEdit","showSearch","showReplace","onSearch","appliedText","searching","applyChangedSearchTextDebounced","_x11","_applyChangedSearchText","applyChangedJsonDebounced","_x12","_applyChangedJson","toggleShowReplace","flush","handleNext","handlePrevious","handleReplace","handleClose","handleReplaceKeyDown","handlePaste","_handlePaste","_handleReplace","_get20","handleReplaceAll","_handleReplaceAll","deduplicatedMatches","previousItem","lastNewSelection","allOperations","createSearchAndReplaceAllOperations","initSearchInput","_handleNext","_handlePrevious","previousActiveIndex","previousActiveItem","searchPrevious","_handleFocus","_get21","_applyChangedShowSearch","applySearch","_x13","_x14","_x15","_applySearch","newResultItems","previousResult","activePath","matchingActiveIndex","updateSearchResult","cancel","resultCount","_get17","_get18","formattedResultCount","_x10","applyChangedShowSearch","faCircleNotch","faSearch","$.effect","faChevronDown","faChevronUp","_get19","endOfPath","getColumns","flatten","maxSampleCount","step","forEachSample","_recurseObject","_collectPaths","valueMerged","calculateVisibleSection","viewPortHeight","itemHeights","defaultItemHeight","searchBoxOffset","itemCount","averageItemHeight","calculateAverageItemHeight","viewPortTop","viewPortBottom","getItemHeight","startHeight","visibleHeight","endHeight","visibleItems","calculateAbsolutePosition","rowIndex","toTableCellPosition","columnIndex","fromTableCellPosition","groupValidationErrors","arrayErrors","rootErrors","partition","errorsByRow","findRowIndex","groupedErrorsByRow","mapValues","groupByRow","row","findColumnIndex","rows","mergeValidationErrors","clearSortedColumnWhenAffectedByOperations","sortedColumn","columms","mustBeCleared","selectedColumnIndex","operationAffectsSortedColumn","onCut","_x16","_onCut","_ref32","copyToClipboard","onCopy","_x17","_onCopy","_ref33","_ref34","onChangeText","onPasteMultilineText","openRepairModal","doPaste","_unused20","ensureSelection","pasteMultilineText","operators","containsNewline","replaceArrayOperation","multipleAddOperations","_unused21","isMultilineTextPastedAsArray","onRemove","_ref35","keepSelection","removeSelection","patchResult","onInsert","_ref40","insertType","selectInside","onReplaceJson","jsonExample","cloneDeepWith","createNewValue","onInsertCharacter","_x18","_onInsertCharacter","_ref41","_x19","_onInsertValueWithCharacter","onInsertValueWithCharacter","_ref42","truncated","onRequestClose","visible","allItemsDisabled","_ref43","_width3","wasVisible","$.deep_read_state","main","_ref44","tip","refContextMenu","firstEnabledButton","querySelectorAll","directionByCombo","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","rowItem","columnItem","faLightbulb","refSelect","bindValue","applyFocus","_option_1$__value","_select$querySelector","selected_option","$.bind_select_value","getJSONSchemaOptions","schema","schemaDefinitions","schemaForPath","findSchema","composite","enum","findEnum","topLevelSchema","currentSchema","nextPath","possibleSchemas","subSchemas","oneOf","anyOf","allOf","$ref","_ref$match","schemaUrl","referencedSchema","auxNextPath","refPath","segment","patternProperties","additionalProperties","renderJSONSchemaEnum","enumValues","enumValue","optionsWithValue","EnumValue","createAjvValidator","createValidateFunction","createAjvInstance","compile","createAjvValidatorAsync","_x20","_createAjvValidatorAsync","ajv","compileAsync","_options$onCreateAjv","_options$onCreateAjv2","ajvOptions","AjvDist","allErrors","verbose","$data","addSchema","onCreateAjv","ajvValidator","_ajvValidator$errors","improveAjvError","ajvError","_ajvError$message","_options$errorSeverit","instancePath","errorSeverity","normalizeAjvError","keyword","enums","more","params","additionalProperty","jmespathQueryLanguage","examplePath","exampleValue","filterValueStr","stringifyPathForJmespath","stringifyProp","jmespath","jsonpathQueryLanguage","pathToString","output","JSONPathPlus","lettersOnlyRegex","lodashQueryLanguage","queryParts","actualValueGetter","isSafeInteger","createLodashPropertySelector","_query$match","_query$match2","chainCount","valueCount","validate","Function","queryFn","javascriptQueryLanguage","createQuery","executeQuery","onResize","isSSR","sortModalId","transformModalId","refContents","refJsonEditor","jump","externalContent","externalSelection","history","mainMenuBar","navigationBar","parseMemoizeOne","onChangeMode","onUndo","onRedo","onRenderMenu","onRenderContextMenu","onSortModal","onTransformModal","onJSONEditorModal","modalOpen","copyPasteModalOpen","jsonRepairModalProps","documentStateInitialized","searchResultDetails","pastedMultilineText","handleSearch","handleFocusSearch","_x21","_x22","_handleFocusSearch","findSearchResult","handleCloseSearch","handleSelectValidationError","isSelectionInsidePath","textIsRepaired","validationErrorList","memoizedValidate","memoizeOne","updateValidationErrors","newValidationErrorList","toRecursiveValidationErrors","applyExternalContent","updatedContent","updatedJson","isChanged","currentlyText","previousState","expandWhenNotInitialized","clearSelectionWhenNotExisting","addHistoryItem","applyExternalJson","_unused22","applyExternalText","canPatch","undo","patch","redo","afterPatch","_createSelectionFromO","previousJson","patched","handleEditKey","handleEditValue","openJSONEditorModal","handleToggleEnforceString","handlePatch","acceptAutoRepair","handleReplaceJson","handleCut","_handleCut","indent","handleCopy","_handleCopy","_event$clipboardData","_paste","handlePasteFromMenu","_handlePasteFromMenu","readText","handleChangeText","handlePasteMultilineText","handleRemove","handleDuplicate","handleExtract","handleInsert","handleInsertFromContextMenu","handleConvert","convertedValue","parsedValue","_unused11","_unused12","convertValue","handleInsertBefore","selectionBefore","handleContextMenu","handleInsertCharacter","_x23","_handleInsertCharacter","handleUndo","canUndo","previousContent","emitOnChange","scrollToWhenVisible","handleRedo","canRedo","openSortModal","_onSort","onSort","_ref46","_x24","handleSortSelection","handleSortAll","openTransformModal","onTransform","transformedJson","handleTransformSelection","handleTransformAll","_x25","_scrollTo","viewPortRect","elemRect","_get$querySelector","_get22","_get$querySelector2","_get23","elemHeight","_onChange","_onChange2","_unused23","handleExpandAll","handleCollapseAll","openFind","findAndReplace","handleExpandSection","_value","expandSection","handlePasteJson","newPastedJson","openContextMenu","_ref47","_onRenderContextMenu","defaultItems","_ref45","onEditKey","onEditValue","onToggleEnforceString","onDuplicate","onExtract","onInsertBefore","onConvert","onInsertAfter","hasJson","hasSelection","rootSelected","focusValue","editValueText","canEditKey","canEditValue","canEnforceString","canCut","canCopy","canPaste","canDuplicate","canExtract","convertMode","insertOrConvertText","canInsertOrConvertStructure","canInsertOrConvertObject","canInsertOrConvertArray","canInsertOrConvertValue","handleInsertOrConvert","faPen","faCut","faPaste","faClone","faCropAlt","faSortAmountDownAlt","faFilter","faTrashCan","faArrowRightArrowLeft","faPlus","faCaretSquareUp","faCaretSquareDown","createTreeContextMenuItems","ContextMenu","clientX","_get24","_get25","handleContextMenuFromTreeMenu","handleParsePastedJson","_handleParsePastedJson","handleParsePastedMultilineText","_handleParsePastedMultilineText","handleClearPastedJson","handleClearPastedMultilineText","handleRequestRepair","handleNavigationBarSelect","childPath","nextPathInside","getSelectionNextInside","handleDrag","autoScrollHandler","handleDragEnd","overflowAnchor","applySearchBoxSpacing","applyExternalSelection","tree","onExpandAll","onCollapseAll","handleToggleSearch","expandMenuItem","collapseMenuItem","searchMenuItem","faEllipsisV","faUndo","faRedo","onCreateObject","onCreateArray","faCode","CopyPasteModal","_get26","collapsedState","nextPathAfter","getSelectionDown","getSelectionLeft","getSelectionRight","isContentEditable","readonlyProxy","property","createHistoryInstance","maxItems","reverseItems","handleChange","_$$_import_transformM","_state$queryOptions","_state$isManual","refQueryInput","updatedHistory","selectedJson","selectedContent","stateId","$$_import_transformModalStateShared","isManual","queryError","previewError","previewContent","getSelectedQueryLanguage","_queryLanguages$find","updateQueryByWizard","newQueryOptions","handleChangeQuery","_get27","previewTransformDebounced","previewJson","jsonTransformed","handleTransform","toggleShowWizard","toggleShowOriginal","handleEscape","refConfigButton","openConfig","SelectQueryLanguage","faCog","highlightStyle","HighlightStyle","define","tag","tags","propertyName","bool","highlighter","syntaxHighlighting","originalStyle","wrappedLineIndent","ViewPlugin","fromClass","view","indentUnit","getIndentUnit","initialPaddingLeft","isChrome","generate","docChanged","viewportChanged","builder","RangeSetBuilder","addStyleToBuilder","requestMeasure","read","lineElement","contentDOM","getPropertyValue","decorations","finish","visibleLines","getVisibleLines","numColumns","containsTab","tabSize","paddingValue","textIndentValue","Decoration","lines","lastLine","visibleRanges","doc","lineAt","cols","statusBar","askToFormat","formatCompactKeyBinding","handleFormat","handleCompact","codeMirrorView","codeMirrorRef","domTextMode","editorState","acceptTooLarge","askToFormatApplied","linterCompartment","Compartment","readOnlyCompartment","indentCompartment","tabSizeCompartment","themeCompartment","historyAnnotation","Annotation","historyUpdatesQueue","startState","endState","mergedChanges","changes","change","compose","invert","toJSON","toTextSelection","previousEscapeUnicodeCharacters","_ref51","initialText","ranges","isValidSelection","fromTextSelection","EditorState","create","extensions","keymap","of","indentWithTab","createLinter","lintGutter","lineNumbers","highlightActiveLineGutter","highlightSpecialChars","foldGutter","drawSelection","dropCursor","allowMultipleSelections","indentOnInput","defaultHighlightStyle","bracketMatching","closeBrackets","autocompletion","rectangularSelection","crosshairCursor","highlightActiveLine","highlightSelectionMatches","closeBracketsKeymap","defaultKeymap","searchKeymap","mac","foldKeymap","completionKeymap","lintKeymap","indentationMarkers","hideFirstIndent","EditorView","domEventHandlers","dblclick","handleDoubleClick","updateListener","transactions","transaction","annotation","onChangeCodeMirrorValueDebounced","selectionSet","emitOnSelect","jsonLang","lineWrapping","createIndent","theme","dark","hasDarkTheme","createCodeMirrorView","disableTextEditor","foldCode","foldAll","unfoldCode","unfoldAll","emitChange","setCodeMirrorContent","jsonStatus","jsonParseError","handleSort","_onSort2","_ref49","_x26","_ref50","closeSearchPanel","openSearchPanel","annotations","ChangeSet","fromJSON","EditorSelection","handleAcceptTooLarge","handleSwitchToTreeMode","cancelLoadTooLarge","onChangeCodeMirrorValue","toRichValidationError","setSelection","_event","selectedText","_pointer$value","linter","linterCallback","delay","toRichParseError","toDiagnostic","newContent","forceUpdate","newText","_refresh","_updateTheme","updateTheme","codeMirrorText","reconfigure","repeat","memoizedValidateText","handleShowMe","richParseError","handleSelectParseError","repairActionShowMe","faEye","eq","updateLinter","updateIndentation","updateTabSize","updateReadOnly","repairActions","isNewDocument","onFormat","onCompact","onToggleSearch","canFormat","canCompact","canSort","canTransform","searchItem","editorDisabled","lineNumber","columnNumber","charCount","_editorState","_editorState2","_editorState3","_get28","_get29","_get30","nestedArrayPath","on_click_3","__3","nestedArrayPaths","maxLevel","findNestedArrays","hasNestedArrays","isEmptyDocument","documentType","_get31","countItems","text_5","_get32","text_6","flattenColumns","_x27","_handleFocusSearch2","containsValidArray","itemHeightsCache","onSortByHeader","newSortedColumn","newValidationErrors","patchedSortedColumn","handleScroll","createDefaultSelectionWhenUndefined","createDefaultSelection","searchBoxHeight","roughDistance","scrollToHorizontal","headerHeight","scrollToVertical","_get$querySelector3","_get33","resolvedPath","_ref53","_onRenderContextMenu2","_ref52","onEditRow","onDuplicateRow","onInsertBeforeRow","onInsertAfterRow","onRemoveRow","createTableContextMenuItems","handleEditRow","handleDuplicateRow","handleInsertBeforeRow","handleInsertAfterRow","handleRemoveRow","_get34","_get35","handleContextMenuFromTableMenu","_handleParsePastedJson2","_handlePasteFromMenu2","_handleParsePastedMultilineText2","_x28","_handleCut2","_handleCopy2","_ref36","rowPath","_ref37","_ref38","nextRowIndex","nextRowPath","_ref39","newRowIndex","_handleInsertCharacter2","_event$clipboardData2","_unused25","_ref54","handleResizeContents","currentContent","_unused24","newColumns","previousColumns","orderedColumns","newColumnsSet","maintainColumnOrder","showRefreshButton","extendedOperations","unshift","createNestedValueOperations","groupedValidationErrors","_get36","_get37","node_7","columnName","_sortedColumn","sortDirectionName","faCaretUp","onRefresh","faRotate","visibleIndex","validationErrorsByRow","_get38","searchResultByRow","th_3","handleResizeRow","_get39","node_14","$$array","isSelected","validationErrorsByColumn","_get40","searchResultsByCell","containsActiveSearchResult","containsSearchResult","onEdit","_parser$stringify","searchResultItemsByCell","_getInRecursiveState","expression_2","ContextMenuPointer","expression_8","expression_9","alternate_3","consequent_14","consequent_15","_get41","selectPreviousColumn","selectNextColumn","selectPreviousRow","selectNextRow","_x29","externalMode","insideModal","refTreeMode","refTableMode","refTextMode","prevItem","nextItem","modeMenuItems","separatorMenuItem","handleRenderMenu","handleRenderContextMenu","_refresh2","applyExternalMode","updatedItems","updatedItemsOriginal","cloneDeep","modal","_onRenderContextMenu3","itemsOriginal","sortModalStates","contentDefault","selectionDefault","readOnlyDefault","modeDefault","mainMenuBarDefault","navigationBarDefault","statusBarDefault","askToFormatDefault","escapeControlCharactersDefault","escapeUnicodeCharactersDefault","flattenColumnsDefault","parserDefault","validatorDefault","validationParserDefault","pathParserDefault","queryLanguagesDefault","queryLanguageIdDefault","onChangeQueryLanguageDefault","onChangeDefault","onSelectDefault","onRenderValueDefault","onClassNameDefault","onRenderMenuDefault","onRenderContextMenuDefault","onChangeModeDefault","onErrorDefault","alert","onFocusDefault","onBlurDefault","instanceId","refJSONEditorRoot","jsonEditorModalProps","sortModalProps","transformModalProps","previousParser","contentError","_x30","_scrollTo2","_refresh3","updateProps","_props$name","_props$name2","_props$name3","_props$name4","_props$name5","_props$name6","_props$name7","_props$name8","_props$name9","_props$name0","_props$name1","_props$name10","_props$name11","_props$name12","_props$name13","_props$name14","_props$name15","_props$name16","_props$name17","_props$name18","_props$name19","_props$name20","_props$name21","_props$name22","_props$name23","_props$name24","_props$name25","_props$name26","_props$name27","_props$name28","_props$name29","names","unknownProperty","_destroy","toggleMode","_x31","_toggleMode","newMode","_ref56","_ref57","_$$_import_sortModalS","_$$_import_sortModalS2","directions","selectedProperty","$$_import_sortModalStates","selectedDirection","sortError","_get46","_get47","_get48","_get49","_get50","_get51","_get52","refEditor","rootState","determineMode","scrollToSelection","_last","currentState","parentJson","updatedParentContent","updatedParentState","_get43","updateState","handleChangeSelection","handleChangeMode","handleError","newError","handleJSONEditorModal","_ref55","_get44","nestedModalState","_get42","absolutePath","pathDescription","faCaretLeft","_get53","createJSONEditor","_ref58","editor","JsonEditor","JSONEditor","_ref60"],"mappings":"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SACN63B,KAAM8vD,GACNr6E,KAAMq5E,EACNjtD,MAAO,6CACPmiC,QAASA,IAAMmqB,IACf/4B,UAAW45B,GAEb,CACE7mF,KAAM,SACN63B,KAAMuJ,EAAgBxI,GAAgBC,GACtCvrB,KAAM,iBACNosB,MAAO,uEACPmiC,QAASA,IAAMoqB,IACfh5B,UAAW65B,OAMrB,CAAE9mF,KAAM,aACR,CACEA,KAAM,MACNwT,MAAO,CACL,CACExT,KAAM,kBACNi2E,KAAM,CACJj2E,KAAM,SACN67D,QAASA,IAAMgX,GAAM,GACrBh7C,KAAM+vD,GACNt6E,KAAM,MACNosB,MAAO,6DACPuzB,UAAW85B,GAEb93D,MAAO,OACPzb,MAAO,CACL,CACExT,KAAM,SACN63B,KAAM+vD,GACNt6E,KAAM,gBACNosB,MAAO,6DACPmiC,QAASA,IAAMgX,GAAM,GACrB5lB,UAAW85B,GAEb,CACE/mF,KAAM,SACN63B,KAAM+vD,GACNt6E,KAAM,gBACNosB,MAAO,4DACPmiC,QAASA,IAAMgX,GAAM,GACrB5lB,UAAW85B,KAIjB,CACE/mF,KAAM,kBACNi2E,KAAM,CACJj2E,KAAM,SACN67D,QAASA,IAAMqX,GAAO,GACtBr7C,KAAM0zC,GACNj+D,KAAM,OACNosB,MAAO,8DACPuzB,UAAW+5B,GAEb/3D,MAAO,OACPzb,MAAO,CACL,CACExT,KAAM,SACN63B,KAAM0zC,GACNj+D,KAAM,iBACNosB,MAAO,8DACPmiC,QAASA,IAAMqX,GAAO,GACtBjmB,UAAW+5B,GAEb,CACEhnF,KAAM,SACN63B,KAAM0zC,GACNj+D,KAAM,iBACNosB,MAAO,6DACPmiC,QAASA,IAAMqX,GAAO,GACtBjmB,UAAW+5B,KAIjB,CACEhnF,KAAM,SACN67D,QAASA,IAAM5yB,IACfpR,KAAMgwD,GACNv6E,KAAM,QACNosB,MAAO,oCACPuzB,UAAWg6B,KAIjB,CAAEjnF,KAAM,aACR,CACEA,KAAM,MACNwT,MAAO,CACL,CACExT,KAAM,SACNwT,MAAO,CACL,CACExT,KAAM,SACN67D,QAASA,IAAMqqB,IACfruD,KA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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,60,65,66,67,85,93,94,95,96,97,98,99,100,160]}